const a228_0x40f6=['getDocument','Action','isOwner','exports','info','abs','createModerationLog','banThreshold','balance','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','kick','credit','send','document','Constants','test','length','constructor','MIN_SAFE_INTEGER','canManage','ownerID','save','\x20/\x20','catch','MAX_SAFE_INTEGER','name','cache','push','ban','memberInfractions','roles','COLORS','getString','@bastion/tesseract','../utils/numbers','addInfraction','bannable','infractions','Ban','tag','Logger','client','has','clamp','roleId','guild','user','music','error','default','debit','kickable','highest','create','Reason','return\x20/\x22\x20+\x20this\x20+\x20\x22/','discord.js','apply'];(function(_0x14207d,_0x3f1bd6){const _0x40f695=function(_0x2707b7){while(--_0x2707b7){_0x14207d['push'](_0x14207d['shift']());}},_0x295e27=function(){const _0x9f895c={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1caba8,_0x4355be,_0x1904a4,_0x55af34){_0x55af34=_0x55af34||{};let _0x2ffc25=_0x4355be+'='+_0x1904a4,_0x45e1de=0x0;for(let _0x67468=0x0,_0x4c7063=_0x1caba8['length'];_0x67468<_0x4c7063;_0x67468++){const _0x2375fb=_0x1caba8[_0x67468];_0x2ffc25+=';\x20'+_0x2375fb;const _0x298bbe=_0x1caba8[_0x2375fb];_0x1caba8['push'](_0x298bbe),_0x4c7063=_0x1caba8['length'],_0x298bbe!==!![]&&(_0x2ffc25+='='+_0x298bbe);}_0x55af34['cookie']=_0x2ffc25;},'removeCookie':function(){return'dev';},'getCookie':function(_0x21a8a2,_0x5d06c8){_0x21a8a2=_0x21a8a2||function(_0x1ed163){return _0x1ed163;};const _0x24f025=_0x21a8a2(new RegExp('(?:^|;\x20)'+_0x5d06c8['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0xdb1585=function(_0x1a34fc,_0x4a9fa8){_0x1a34fc(++_0x4a9fa8);};return _0xdb1585(_0x40f695,_0x3f1bd6),_0x24f025?decodeURIComponent(_0x24f025[0x1]):undefined;}},_0x186411=function(){const _0x3ecba4=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x3ecba4['test'](_0x9f895c['removeCookie']['toString']());};_0x9f895c['updateCookie']=_0x186411;let _0x472a10='';const _0x480d1f=_0x9f895c['updateCookie']();if(!_0x480d1f)_0x9f895c['setCookie'](['*'],'counter',0x1);else _0x480d1f?_0x472a10=_0x9f895c['getCookie'](null,'counter'):_0x9f895c['removeCookie']();};_0x295e27();}(a228_0x40f6,0x1c1));const a228_0x295e=function(_0x14207d,_0x3f1bd6){_0x14207d=_0x14207d-0x14d;let _0x40f695=a228_0x40f6[_0x14207d];return _0x40f695;};const a228_0xb3bcc0=a228_0x295e,a228_0x186411=function(){let _0x480d1f=!![];return function(_0x1caba8,_0x4355be){const _0x1904a4=_0x480d1f?function(){const _0x5ea78d=a228_0x295e;if(_0x4355be){const _0x55af34=_0x4355be[_0x5ea78d(0x15b)](_0x1caba8,arguments);return _0x4355be=null,_0x55af34;}}:function(){};return _0x480d1f=![],_0x1904a4;};}(),a228_0x9f895c=a228_0x186411(this,function(){const _0x2ffc25=function(){const _0x19d343=a228_0x295e,_0x45e1de=_0x2ffc25[_0x19d343(0x16d)](_0x19d343(0x159))()['constructor'](_0x19d343(0x165));return!_0x45e1de[_0x19d343(0x16b)](a228_0x9f895c);};return _0x2ffc25();});a228_0x9f895c();'use strict';const tesseract_1=require(a228_0xb3bcc0(0x17d)),discord_js_1=require(a228_0xb3bcc0(0x15a)),Member_1=require('../models/Member'),Transaction_1=require('../models/Transaction'),numbers=require(a228_0xb3bcc0(0x17e));module[a228_0xb3bcc0(0x15f)]=class BastionGuildMember extends discord_js_1['GuildMember']{constructor(_0x67468,_0x4c7063,_0x2375fb){super(_0x67468,_0x4c7063,_0x2375fb);}[a228_0xb3bcc0(0x16f)](_0x298bbe){const _0x3696de=a228_0xb3bcc0;if(this['id']===this[_0x3696de(0x14f)][_0x3696de(0x170)])return!![];if(_0x298bbe['id']===this['guild'][_0x3696de(0x170)])return![];if(this['id']===_0x298bbe['id'])return![];return this[_0x3696de(0x17a)][_0x3696de(0x156)]['comparePositionTo'](_0x298bbe[_0x3696de(0x17a)][_0x3696de(0x156)])>0x0;}async['getDocument'](){const _0xd5944=a228_0xb3bcc0;return await Member_1[_0xd5944(0x153)]['findOne']({'user':this['id'],'guild':this[_0xd5944(0x14f)]['id']});}['isMusicMaster'](){const _0x245cb4=a228_0xb3bcc0;if(this['user'][_0x245cb4(0x15e)]())return!![];return this[_0x245cb4(0x14f)][_0x245cb4(0x169)][_0x245cb4(0x151)]&&this[_0x245cb4(0x14f)]['document'][_0x245cb4(0x151)][_0x245cb4(0x14e)]&&this[_0x245cb4(0x17a)][_0x245cb4(0x176)][_0x245cb4(0x186)](this[_0x245cb4(0x14f)]['document']['music'][_0x245cb4(0x14e)]);}async[a228_0xb3bcc0(0x17f)](_0x21a8a2){const _0x23b5d7=a228_0xb3bcc0;let _0x5d06c8=await this['getDocument']();_0x5d06c8?_0x5d06c8[_0x23b5d7(0x181)]?_0x5d06c8['infractions'][_0x23b5d7(0x177)](_0x21a8a2):_0x5d06c8[_0x23b5d7(0x181)]=[_0x21a8a2]:_0x5d06c8=await Member_1[_0x23b5d7(0x153)]['create']({'user':this['id'],'guild':this[_0x23b5d7(0x14f)]['id'],'infractions':[_0x21a8a2]});const _0x24f025=this['guild'][_0x23b5d7(0x169)]?this[_0x23b5d7(0x14f)]['document']:await this['guild'][_0x23b5d7(0x15c)]();if(_0x24f025[_0x23b5d7(0x181)]){const _0xdb1585=_0x5d06c8[_0x23b5d7(0x181)][_0x23b5d7(0x16c)];let _0x1ed163;this[_0x23b5d7(0x155)]&&_0x5d06c8['infractions'][_0x23b5d7(0x16c)]===_0x24f025[_0x23b5d7(0x181)]['kickThreshold']&&(_0x1ed163='Kick',await this[_0x23b5d7(0x166)](_0x5d06c8['infractions'][_0x23b5d7(0x16c)]+'\x20infractions.')),this[_0x23b5d7(0x180)]&&_0x5d06c8[_0x23b5d7(0x181)][_0x23b5d7(0x16c)]===_0x24f025[_0x23b5d7(0x181)][_0x23b5d7(0x163)]&&(_0x1ed163=_0x23b5d7(0x182),await this[_0x23b5d7(0x178)]({'reason':_0x5d06c8['infractions']['length']+'\x20infractions.'}),_0x5d06c8['infractions']=undefined,delete _0x5d06c8[_0x23b5d7(0x181)]),_0x1ed163&&(this[_0x23b5d7(0x14f)]['createModerationLog']({'event':'infractionAdd','fields':[{'name':'User','value':this[_0x23b5d7(0x150)][_0x23b5d7(0x183)]+'\x20/\x20'+this['id']},{'name':_0x23b5d7(0x15d),'value':_0x1ed163},{'name':'Reason','value':_0x21a8a2}]})[_0x23b5d7(0x173)](tesseract_1[_0x23b5d7(0x184)][_0x23b5d7(0x152)]),await this[_0x23b5d7(0x168)]({'embed':{'color':tesseract_1[_0x23b5d7(0x16a)][_0x23b5d7(0x17b)]['ORANGE'],'description':this['client']['locale'][_0x23b5d7(0x17c)](_0x24f025['language'],_0x23b5d7(0x160),_0x23b5d7(0x179)+_0x1ed163,this[_0x23b5d7(0x14f)][_0x23b5d7(0x175)],_0xdb1585)}})[_0x23b5d7(0x173)](()=>{}));}return _0x5d06c8['save']();}async['clearInfractions'](_0x1a34fc){const _0x3bed95=a228_0xb3bcc0,_0x4a9fa8=this[_0x3bed95(0x169)]?this[_0x3bed95(0x169)]:await this[_0x3bed95(0x15c)]();return _0x4a9fa8['infractions']=undefined,delete _0x4a9fa8[_0x3bed95(0x181)],this[_0x3bed95(0x14f)][_0x3bed95(0x162)]({'event':'infractionClear','fields':[{'name':'User','value':this[_0x3bed95(0x150)][_0x3bed95(0x183)]+_0x3bed95(0x172)+this['id']},{'name':_0x3bed95(0x158),'value':_0x1a34fc}]})[_0x3bed95(0x173)](tesseract_1[_0x3bed95(0x184)]['error']),_0x4a9fa8[_0x3bed95(0x171)]();}async[a228_0xb3bcc0(0x167)](_0x3ecba4,_0x53daa7,_0x38081c){const _0xc7ae4f=a228_0xb3bcc0;_0x3ecba4=Math[_0xc7ae4f(0x161)](_0x3ecba4);const _0x2fdaee=_0x38081c||await this['getDocument']();return _0x3ecba4&&(_0x2fdaee[_0xc7ae4f(0x164)]=numbers[_0xc7ae4f(0x14d)](_0x2fdaee[_0xc7ae4f(0x164)]+_0x3ecba4,Number[_0xc7ae4f(0x174)]),!_0x38081c&&await Transaction_1[_0xc7ae4f(0x153)][_0xc7ae4f(0x157)]({'guild':this['guild']['id'],'sender':this[_0xc7ae4f(0x185)][_0xc7ae4f(0x150)]['id'],'receiver':_0x2fdaee['user'],'amount':_0x3ecba4,'time':new Date(),'note':_0x53daa7})[_0xc7ae4f(0x173)](tesseract_1[_0xc7ae4f(0x184)][_0xc7ae4f(0x152)])),_0x38081c?_0x2fdaee:_0x2fdaee[_0xc7ae4f(0x171)]();}async[a228_0xb3bcc0(0x154)](_0x46dfdc,_0x93c28c,_0x4eb89d){const _0x5b4cab=a228_0xb3bcc0;_0x46dfdc=Math[_0x5b4cab(0x161)](_0x46dfdc);const _0x5adead=_0x4eb89d||await this['getDocument']();return _0x46dfdc&&(_0x5adead[_0x5b4cab(0x164)]=numbers['clamp'](_0x5adead[_0x5b4cab(0x164)]-_0x46dfdc,Number[_0x5b4cab(0x16e)],Number[_0x5b4cab(0x174)]),!_0x4eb89d&&await Transaction_1[_0x5b4cab(0x153)][_0x5b4cab(0x157)]({'guild':this[_0x5b4cab(0x14f)]['id'],'sender':_0x5adead[_0x5b4cab(0x150)],'receiver':this['client'][_0x5b4cab(0x150)]['id'],'amount':_0x46dfdc,'time':new Date(),'note':_0x93c28c})[_0x5b4cab(0x173)](tesseract_1[_0x5b4cab(0x184)][_0x5b4cab(0x152)])),_0x4eb89d?_0x5adead:_0x5adead[_0x5b4cab(0x171)]();}};