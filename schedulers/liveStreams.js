const a194_0x3996=['twitch','&user_login=','viewer_count','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','credentials','client','node-fetch','accessToken','started_at','map','../utils/constants','clientId','compile','then','test','1280','language','title','{height}','cache','ðŸ”´\x20LIVE','includes','_id','json','join','TWITCH','exec','../models/Guild','0\x20*/5\x20*\x20*\x20*\x20*','get','channels','default','COLORS','channelId','constructor','length','720','toUpperCase','find','streamers','guilds','handleTwitchStreamers','data','apply','catch','twitchSubscriptions','https://api.twitch.tv/helix/streams/?user_login=','liveStreams','users','user_name'];(function(_0x4db9cb,_0x399642){const _0x3d2bae=function(_0x19e98a){while(--_0x19e98a){_0x4db9cb['push'](_0x4db9cb['shift']());}};const _0x56ba9d=function(){const _0x5ca001={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x48fb3a,_0x27c788,_0x27912b,_0x11a764){_0x11a764=_0x11a764||{};let _0x5156b4=_0x27c788+'='+_0x27912b;let _0x2a506c=0x0;for(let _0x10a1f0=0x0,_0x234d57=_0x48fb3a['length'];_0x10a1f0<_0x234d57;_0x10a1f0++){const _0x57b679=_0x48fb3a[_0x10a1f0];_0x5156b4+=';\x20'+_0x57b679;const _0x5085b6=_0x48fb3a[_0x57b679];_0x48fb3a['push'](_0x5085b6);_0x234d57=_0x48fb3a['length'];if(_0x5085b6!==!![]){_0x5156b4+='='+_0x5085b6;}}_0x11a764['cookie']=_0x5156b4;},'removeCookie':function(){return'dev';},'getCookie':function(_0xa5b9e5,_0x1bf16b){_0xa5b9e5=_0xa5b9e5||function(_0x4e5b4e){return _0x4e5b4e;};const _0x3b3e45=_0xa5b9e5(new RegExp('(?:^|;\x20)'+_0x1bf16b['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x54c473=function(_0x443f2a,_0x4fa23a){_0x443f2a(++_0x4fa23a);};_0x54c473(_0x3d2bae,_0x399642);return _0x3b3e45?decodeURIComponent(_0x3b3e45[0x1]):undefined;}};const _0x53ec33=function(){const _0x4b2917=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4b2917['test'](_0x5ca001['removeCookie']['toString']());};_0x5ca001['updateCookie']=_0x53ec33;let _0x30cc6d='';const _0xdd0b5d=_0x5ca001['updateCookie']();if(!_0xdd0b5d){_0x5ca001['setCookie'](['*'],'counter',0x1);}else if(_0xdd0b5d){_0x30cc6d=_0x5ca001['getCookie'](null,'counter');}else{_0x5ca001['removeCookie']();}};_0x56ba9d();}(a194_0x3996,0x1aa));const a194_0x3d2b=function(_0x4db9cb,_0x399642){_0x4db9cb=_0x4db9cb-0x0;let _0x3d2bae=a194_0x3996[_0x4db9cb];return _0x3d2bae;};const a194_0x5ca001=function(){let _0x291dfe=!![];return function(_0x114fc8,_0x42dad9){const _0x30b022=_0x291dfe?function(){if(_0x42dad9){const _0x387f81=_0x42dad9[a194_0x3d2b('0x11')](_0x114fc8,arguments);_0x42dad9=null;return _0x387f81;}}:function(){};_0x291dfe=![];return _0x30b022;};}();const a194_0x19e98a=a194_0x5ca001(this,function(){const _0x4f47f1=function(){const _0xcbb3a1=_0x4f47f1[a194_0x3d2b('0x8')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a194_0x3d2b('0x24')](a194_0x3d2b('0x1b'));return!_0xcbb3a1[a194_0x3d2b('0x26')](a194_0x19e98a);};return _0x4f47f1();});a194_0x19e98a();'use strict';const tesseract_1=require('@bastion/tesseract');const node_fetch_1=require(a194_0x3d2b('0x1e'));const Guild_1=require(a194_0x3d2b('0x1'));const constants=require(a194_0x3d2b('0x22'));module['exports']=class LiveStreams extends tesseract_1['Scheduler']{constructor(){super(a194_0x3d2b('0x15'),{'cronTime':a194_0x3d2b('0x2')});this[a194_0x3d2b('0xf')]=async(_0xaae65b,_0x5340bf)=>{if(!this['client']['readyTimestamp'])return;if(!this[a194_0x3d2b('0x13')]['has'](_0xaae65b))this['twitchSubscriptions']['set'](_0xaae65b,[]);const _0x2ba5b0=this['twitchSubscriptions'][a194_0x3d2b('0x3')](_0xaae65b);const _0x4adfed=await node_fetch_1[a194_0x3d2b('0x5')](a194_0x3d2b('0x14')+_0x5340bf[a194_0x3d2b('0x16')][a194_0x3d2b('0x30')](a194_0x3d2b('0x19')),{'headers':{'Accept':'application/json','Authorization':'Bearer\x20'+this[a194_0x3d2b('0x1d')][a194_0x3d2b('0x1c')][a194_0x3d2b('0x18')][a194_0x3d2b('0x1f')],'Client-ID':this[a194_0x3d2b('0x1d')][a194_0x3d2b('0x1c')][a194_0x3d2b('0x18')][a194_0x3d2b('0x23')]}});const _0x47a3b9=(await _0x4adfed[a194_0x3d2b('0x2f')]())[a194_0x3d2b('0x10')];for(const _0x3a9d1e of _0x47a3b9){if(_0x2ba5b0[a194_0x3d2b('0x2d')](_0x3a9d1e['id']))continue;if(this[a194_0x3d2b('0x1d')][a194_0x3d2b('0x4')][a194_0x3d2b('0x2b')]['has'](_0x5340bf['channelId'])){await this[a194_0x3d2b('0x1d')][a194_0x3d2b('0x4')][a194_0x3d2b('0x2b')][a194_0x3d2b('0x3')](_0x5340bf['channelId'])['send']({'embed':{'color':constants[a194_0x3d2b('0x6')][a194_0x3d2b('0x31')],'author':{'name':_0x3a9d1e['user_name'],'url':'https://twitch.tv/'+_0x3a9d1e[a194_0x3d2b('0x17')]},'description':_0x3a9d1e[a194_0x3d2b('0x29')],'fields':[{'name':'Viewers','value':_0x3a9d1e[a194_0x3d2b('0x1a')]['toString'](),'inline':!![]},{'name':'Language','value':_0x3a9d1e[a194_0x3d2b('0x28')][a194_0x3d2b('0xb')](),'inline':!![]}],'image':{'url':_0x3a9d1e['thumbnail_url']['replace']('{width}',a194_0x3d2b('0x27'))['replace'](a194_0x3d2b('0x2a'),a194_0x3d2b('0xa'))},'footer':{'text':a194_0x3d2b('0x2c')},'timestamp':_0x3a9d1e[a194_0x3d2b('0x20')]}})[a194_0x3d2b('0x25')](()=>{_0x2ba5b0['push'](_0x3a9d1e['id']);})[a194_0x3d2b('0x12')](()=>{});}}this['twitchSubscriptions']['set'](_0xaae65b,_0x2ba5b0);};this[a194_0x3d2b('0x0')]=async()=>{if(!this[a194_0x3d2b('0x1d')]['guilds']['cache']['size'])return;const _0x220eba=await Guild_1[a194_0x3d2b('0x5')][a194_0x3d2b('0xc')]({'$or':this[a194_0x3d2b('0x1d')][a194_0x3d2b('0xe')][a194_0x3d2b('0x2b')][a194_0x3d2b('0x21')](_0x1a7a1b=>({'_id':_0x1a7a1b['id']})),'streamers':{'$exists':!![]}});for(const _0x3dbb0e of _0x220eba){if(_0x3dbb0e[a194_0x3d2b('0xd')][a194_0x3d2b('0x18')]&&_0x3dbb0e[a194_0x3d2b('0xd')][a194_0x3d2b('0x18')][a194_0x3d2b('0x7')]&&_0x3dbb0e['streamers'][a194_0x3d2b('0x18')][a194_0x3d2b('0x16')][a194_0x3d2b('0x9')]){this['handleTwitchStreamers'](_0x3dbb0e[a194_0x3d2b('0x2e')],_0x3dbb0e['streamers'][a194_0x3d2b('0x18')]);}}};this[a194_0x3d2b('0x13')]=new Map();}};