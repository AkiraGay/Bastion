const a193_0x5671=['Viewers','default','language','exports','has','client','toUpperCase','thumbnail_url','map','liveStreams','get','accessToken','_id','set','TWITCH','then','apply','compile','{height}','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../utils/constants','users','includes','twitch','credentials','test','application/json','1280','Bearer\x20','channelId','exec','push','Language','streamers','data','constructor','&user_login=','twitchSubscriptions','guilds','0\x20*/5\x20*\x20*\x20*\x20*','cache','json','720','channels','user_name','send','viewer_count','return\x20/\x22\x20+\x20this\x20+\x20\x22/','ðŸ”´\x20LIVE','catch','node-fetch','https://twitch.tv/','size','replace','find','handleTwitchStreamers','Scheduler','length'];(function(_0x104259,_0x5671ab){const _0x152199=function(_0x4d5722){while(--_0x4d5722){_0x104259['push'](_0x104259['shift']());}};const _0x5374b6=function(){const _0x4d0fd7={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2e4e2d,_0x188538,_0x43441e,_0x2861e5){_0x2861e5=_0x2861e5||{};let _0x5ca023=_0x188538+'='+_0x43441e;let _0x11447a=0x0;for(let _0x5b6d01=0x0,_0x17dcf5=_0x2e4e2d['length'];_0x5b6d01<_0x17dcf5;_0x5b6d01++){const _0x35de94=_0x2e4e2d[_0x5b6d01];_0x5ca023+=';\x20'+_0x35de94;const _0x4417fa=_0x2e4e2d[_0x35de94];_0x2e4e2d['push'](_0x4417fa);_0x17dcf5=_0x2e4e2d['length'];if(_0x4417fa!==!![]){_0x5ca023+='='+_0x4417fa;}}_0x2861e5['cookie']=_0x5ca023;},'removeCookie':function(){return'dev';},'getCookie':function(_0x2cd3d8,_0x147efb){_0x2cd3d8=_0x2cd3d8||function(_0x5d96c0){return _0x5d96c0;};const _0x384e92=_0x2cd3d8(new RegExp('(?:^|;\x20)'+_0x147efb['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x4e992a=function(_0x4a5c81,_0x2112dc){_0x4a5c81(++_0x2112dc);};_0x4e992a(_0x152199,_0x5671ab);return _0x384e92?decodeURIComponent(_0x384e92[0x1]):undefined;}};const _0x3e03ac=function(){const _0x47b88a=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x47b88a['test'](_0x4d0fd7['removeCookie']['toString']());};_0x4d0fd7['updateCookie']=_0x3e03ac;let _0x2b3f06='';const _0x381947=_0x4d0fd7['updateCookie']();if(!_0x381947){_0x4d0fd7['setCookie'](['*'],'counter',0x1);}else if(_0x381947){_0x2b3f06=_0x4d0fd7['getCookie'](null,'counter');}else{_0x4d0fd7['removeCookie']();}};_0x5374b6();}(a193_0x5671,0xa8));const a193_0x1521=function(_0x104259,_0x5671ab){_0x104259=_0x104259-0x0;let _0x152199=a193_0x5671[_0x104259];return _0x152199;};const a193_0x4d0fd7=function(){let _0x33fc1a=!![];return function(_0xf85f0d,_0x4e69c8){const _0x42899e=_0x33fc1a?function(){if(_0x4e69c8){const _0x333ed9=_0x4e69c8[a193_0x1521('0x16')](_0xf85f0d,arguments);_0x4e69c8=null;return _0x333ed9;}}:function(){};_0x33fc1a=![];return _0x42899e;};}();const a193_0x4d5722=a193_0x4d0fd7(this,function(){const _0x1b6f4b=function(){const _0x3719aa=_0x1b6f4b[a193_0x1521('0x29')](a193_0x1521('0x35'))()[a193_0x1521('0x17')](a193_0x1521('0x19'));return!_0x3719aa[a193_0x1521('0x1f')](a193_0x4d5722);};return _0x1b6f4b();});a193_0x4d5722();'use strict';const tesseract_1=require('@bastion/tesseract');const node_fetch_1=require(a193_0x1521('0x38'));const Guild_1=require('../models/Guild');const constants=require(a193_0x1521('0x1a'));module[a193_0x1521('0x9')]=class LiveStreams extends tesseract_1[a193_0x1521('0x4')]{constructor(){super(a193_0x1521('0xf'),{'cronTime':a193_0x1521('0x2d')});this[a193_0x1521('0x3')]=async(_0x310567,_0x5c739a)=>{if(!this['client']['readyTimestamp'])return;if(!this['twitchSubscriptions'][a193_0x1521('0xa')](_0x310567))this['twitchSubscriptions'][a193_0x1521('0x13')](_0x310567,[]);const _0x10784b=this[a193_0x1521('0x2b')][a193_0x1521('0x10')](_0x310567);const _0x1d554a=await node_fetch_1[a193_0x1521('0x7')]('https://api.twitch.tv/helix/streams/?user_login='+_0x5c739a[a193_0x1521('0x1b')]['join'](a193_0x1521('0x2a')),{'headers':{'Accept':a193_0x1521('0x20'),'Authorization':a193_0x1521('0x22')+this[a193_0x1521('0xb')][a193_0x1521('0x1e')]['twitch'][a193_0x1521('0x11')],'Client-ID':this['client'][a193_0x1521('0x1e')]['twitch']['clientId']}});const _0x385715=(await _0x1d554a[a193_0x1521('0x2f')]())[a193_0x1521('0x28')];for(const _0xbea6c of _0x385715){if(_0x10784b[a193_0x1521('0x1c')](_0xbea6c['id']))continue;if(this[a193_0x1521('0xb')][a193_0x1521('0x31')]['cache'][a193_0x1521('0xa')](_0x5c739a[a193_0x1521('0x23')])){await this[a193_0x1521('0xb')]['channels'][a193_0x1521('0x2e')][a193_0x1521('0x10')](_0x5c739a['channelId'])[a193_0x1521('0x33')]({'embed':{'color':constants['COLORS'][a193_0x1521('0x14')],'author':{'name':_0xbea6c[a193_0x1521('0x32')],'url':a193_0x1521('0x39')+_0xbea6c[a193_0x1521('0x32')]},'description':_0xbea6c['title'],'fields':[{'name':a193_0x1521('0x6'),'value':_0xbea6c[a193_0x1521('0x34')]['toString'](),'inline':!![]},{'name':a193_0x1521('0x26'),'value':_0xbea6c[a193_0x1521('0x8')][a193_0x1521('0xc')](),'inline':!![]}],'image':{'url':_0xbea6c[a193_0x1521('0xd')]['replace']('{width}',a193_0x1521('0x21'))[a193_0x1521('0x1')](a193_0x1521('0x18'),a193_0x1521('0x30'))},'footer':{'text':a193_0x1521('0x36')},'timestamp':_0xbea6c['started_at']}})[a193_0x1521('0x15')](()=>{_0x10784b[a193_0x1521('0x25')](_0xbea6c['id']);})[a193_0x1521('0x37')](()=>{});}}this[a193_0x1521('0x2b')][a193_0x1521('0x13')](_0x310567,_0x10784b);};this[a193_0x1521('0x24')]=async()=>{if(!this['client']['guilds'][a193_0x1521('0x2e')][a193_0x1521('0x0')])return;const _0x5e70cd=await Guild_1[a193_0x1521('0x7')][a193_0x1521('0x2')]({'$or':this[a193_0x1521('0xb')][a193_0x1521('0x2c')][a193_0x1521('0x2e')][a193_0x1521('0xe')](_0x5a685b=>({'_id':_0x5a685b['id']})),'streamers':{'$exists':!![]}});for(const _0x54cba3 of _0x5e70cd){if(_0x54cba3[a193_0x1521('0x27')]['twitch']&&_0x54cba3[a193_0x1521('0x27')]['twitch'][a193_0x1521('0x23')]&&_0x54cba3['streamers']['twitch']['users'][a193_0x1521('0x5')]){this['handleTwitchStreamers'](_0x54cba3[a193_0x1521('0x12')],_0x54cba3[a193_0x1521('0x27')][a193_0x1521('0x1d')]);}}};this[a193_0x1521('0x2b')]=new Map();}};