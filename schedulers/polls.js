const a225_0x175d=['readyTimestamp','bot','fields','error','test','then','edit','reactions','guild','Logger','messages','\x20/\x20','value','deleteMany','polls','exports','fetch','return\x20/\x22\x20+\x20this\x20+\x20\x22/','channels','cache','length','toFixed','channel','size','default','Constants','name','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','client','catch','@bastion/tesseract','0\x20*/15\x20*\x20*\x20*\x20*','embeds','guilds','find','filter','constructor','title','Scheduler','get'];(function(_0x5eb205,_0x58fd63){const _0x175d2a=function(_0x3a58b9){while(--_0x3a58b9){_0x5eb205['push'](_0x5eb205['shift']());}},_0x4c7e40=function(){const _0x1d75a2={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5da25c,_0x5abc14,_0x4082c3,_0x1fcf8a){_0x1fcf8a=_0x1fcf8a||{};let _0x34fa04=_0x5abc14+'='+_0x4082c3,_0x2f712b=0x0;for(let _0x25f8ef=0x0,_0x362ba1=_0x5da25c['length'];_0x25f8ef<_0x362ba1;_0x25f8ef++){const _0x10fe07=_0x5da25c[_0x25f8ef];_0x34fa04+=';\x20'+_0x10fe07;const _0x55bd3e=_0x5da25c[_0x10fe07];_0x5da25c['push'](_0x55bd3e),_0x362ba1=_0x5da25c['length'],_0x55bd3e!==!![]&&(_0x34fa04+='='+_0x55bd3e);}_0x1fcf8a['cookie']=_0x34fa04;},'removeCookie':function(){return'dev';},'getCookie':function(_0x99a736,_0xd3640f){_0x99a736=_0x99a736||function(_0x3f021c){return _0x3f021c;};const _0x5a5926=_0x99a736(new RegExp('(?:^|;\x20)'+_0xd3640f['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x3ea969=function(_0x2dd698,_0x3904a6){_0x2dd698(++_0x3904a6);};return _0x3ea969(_0x175d2a,_0x58fd63),_0x5a5926?decodeURIComponent(_0x5a5926[0x1]):undefined;}},_0x32b9ee=function(){const _0x30934e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x30934e['test'](_0x1d75a2['removeCookie']['toString']());};_0x1d75a2['updateCookie']=_0x32b9ee;let _0x17594a='';const _0x4a0348=_0x1d75a2['updateCookie']();if(!_0x4a0348)_0x1d75a2['setCookie'](['*'],'counter',0x1);else _0x4a0348?_0x17594a=_0x1d75a2['getCookie'](null,'counter'):_0x1d75a2['removeCookie']();};_0x4c7e40();}(a225_0x175d,0x169));const a225_0x4c7e=function(_0x5eb205,_0x58fd63){_0x5eb205=_0x5eb205-0xf9;let _0x175d2a=a225_0x175d[_0x5eb205];return _0x175d2a;};const a225_0x56fc48=a225_0x4c7e,a225_0x32b9ee=function(){let _0x4a0348=!![];return function(_0x5da25c,_0x5abc14){const _0x4082c3=_0x4a0348?function(){if(_0x5abc14){const _0x1fcf8a=_0x5abc14['apply'](_0x5da25c,arguments);return _0x5abc14=null,_0x1fcf8a;}}:function(){};return _0x4a0348=![],_0x4082c3;};}(),a225_0x1d75a2=a225_0x32b9ee(this,function(){const _0x34fa04=function(){const _0x46e64b=a225_0x4c7e,_0x2f712b=_0x34fa04[_0x46e64b(0x11c)](_0x46e64b(0x109))()[_0x46e64b(0x11c)](_0x46e64b(0x113));return!_0x2f712b[_0x46e64b(0xfc)](a225_0x1d75a2);};return _0x34fa04();});a225_0x1d75a2();'use strict';const tesseract_1=require(a225_0x56fc48(0x116)),Poll_1=require('../models/Poll');module[a225_0x56fc48(0x107)]=class PollScheduler extends tesseract_1[a225_0x56fc48(0x11e)]{constructor(){const _0x2c45e7=a225_0x56fc48;super(_0x2c45e7(0x106),{'cronTime':_0x2c45e7(0x117)}),this['exec']=async()=>{const _0x3b41c4=_0x2c45e7;try{if(!this[_0x3b41c4(0x114)][_0x3b41c4(0x120)])return;if(!this[_0x3b41c4(0x114)]['guilds'][_0x3b41c4(0x10b)][_0x3b41c4(0x10f)])return;const _0x25f8ef=await Poll_1['default'][_0x3b41c4(0x11a)]({'$or':this[_0x3b41c4(0x114)][_0x3b41c4(0x119)]['cache']['map'](_0x10fe07=>({'guild':_0x10fe07['id']})),'ends':{'$lte':new Date()}}),_0x362ba1=[];for(const _0x55bd3e of _0x25f8ef){const _0x99a736=this[_0x3b41c4(0x114)][_0x3b41c4(0x119)][_0x3b41c4(0x10b)][_0x3b41c4(0x11f)](_0x55bd3e[_0x3b41c4(0x100)]);if(_0x99a736[_0x3b41c4(0x10a)]['cache']['has'](_0x55bd3e[_0x3b41c4(0x10e)])){const _0xd3640f=_0x99a736[_0x3b41c4(0x10a)][_0x3b41c4(0x10b)][_0x3b41c4(0x11f)](_0x55bd3e['channel']),_0x5a5926=await _0xd3640f[_0x3b41c4(0x102)][_0x3b41c4(0x108)](_0x55bd3e['_id'])[_0x3b41c4(0x115)](()=>{});if(!_0x5a5926)continue;const _0x3ea969=_0x5a5926['embeds'][0x0][_0x3b41c4(0xfa)]['map'](_0x30934e=>_0x30934e['value']),_0x3f021c=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],_0x2dd698={};let _0x3904a6=0x0;for(const _0x33695b in _0x3f021c['slice'](0x0,_0x3ea969[_0x3b41c4(0x10c)])){if(_0x5a5926[_0x3b41c4(0xff)][_0x3b41c4(0x10b)]['has'](_0x3f021c[_0x33695b])){await _0x5a5926['reactions'][_0x3b41c4(0x10b)][_0x3b41c4(0x11f)](_0x3f021c[_0x33695b])['users']['fetch']()[_0x3b41c4(0x115)](()=>{});const _0x797a2d=_0x5a5926[_0x3b41c4(0xff)][_0x3b41c4(0x10b)]['get'](_0x3f021c[_0x33695b])['users'][_0x3b41c4(0x10b)][_0x3b41c4(0x11b)](_0x365186=>!_0x365186[_0x3b41c4(0xf9)])[_0x3b41c4(0x10f)];_0x2dd698[_0x3f021c[_0x33695b]]=_0x797a2d,_0x3904a6+=_0x797a2d;}}await _0x5a5926[_0x3b41c4(0xfe)]({'embed':{'color':tesseract_1[_0x3b41c4(0x111)]['COLORS']['SOMEWHAT_DARK'],'author':{'name':'POLL\x20ENDED'},'title':_0x5a5926[_0x3b41c4(0x118)][0x0][_0x3b41c4(0x11d)],'fields':_0x5a5926['embeds'][0x0]['fields']['map'](_0x323dcc=>({'name':_0x323dcc[_0x3b41c4(0x112)]+'\x20'+_0x323dcc[_0x3b41c4(0x104)],'value':(_0x2dd698[_0x323dcc[_0x3b41c4(0x112)]]||0x0)+_0x3b41c4(0x103)+_0x3904a6+'\x20votes\x20('+(_0x2dd698[_0x323dcc['name']]?_0x2dd698[_0x323dcc[_0x3b41c4(0x112)]]/_0x3904a6*0x64:0x0)[_0x3b41c4(0x10d)](0x2)+'%)'})),'footer':{'text':'Ended'},'timestamp':new Date()}})[_0x3b41c4(0xfd)](()=>{_0x362ba1['push'](_0x5a5926['id']);})['catch'](()=>{});}}_0x362ba1[_0x3b41c4(0x10c)]&&await Poll_1[_0x3b41c4(0x110)][_0x3b41c4(0x105)]({'$or':_0x362ba1['map'](_0x5a6af9=>({'_id':_0x5a6af9}))})[_0x3b41c4(0x115)](()=>{});}catch(_0x32a2db){tesseract_1[_0x3b41c4(0x101)][_0x3b41c4(0xfb)](_0x32a2db);}};}};