const a197_0x54d5=['embeds','filter','get','messages','fields','\x20/\x20','length','COLORS','users','map','channel','return\x20/\x22\x20+\x20this\x20+\x20\x22/','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','0\x20*/15\x20*\x20*\x20*\x20*','edit','Ended','Constants','_id','constructor','@bastion/tesseract','name','fetch','POLL\x20ENDED','guilds','exec','apply','find','reactions','value','error','bot','toFixed','client','has','default','catch','polls','cache','SOMEWHAT_DARK','test','Logger'];(function(_0x5389c4,_0x54d5e8){const _0x2c6a95=function(_0x11fb22){while(--_0x11fb22){_0x5389c4['push'](_0x5389c4['shift']());}},_0x110ab1=function(){const _0x1c5ef3={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x481fa0,_0x5b2298,_0x481a81,_0x1da5e4){_0x1da5e4=_0x1da5e4||{};let _0x2865a1=_0x5b2298+'='+_0x481a81,_0x418b8e=0x0;for(let _0x9190cd=0x0,_0x68bedf=_0x481fa0['length'];_0x9190cd<_0x68bedf;_0x9190cd++){const _0x3740d9=_0x481fa0[_0x9190cd];_0x2865a1+=';\x20'+_0x3740d9;const _0x34f3ed=_0x481fa0[_0x3740d9];_0x481fa0['push'](_0x34f3ed),_0x68bedf=_0x481fa0['length'],_0x34f3ed!==!![]&&(_0x2865a1+='='+_0x34f3ed);}_0x1da5e4['cookie']=_0x2865a1;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3d2d30,_0x5f3cdd){_0x3d2d30=_0x3d2d30||function(_0x12af6f){return _0x12af6f;};const _0x4ed07c=_0x3d2d30(new RegExp('(?:^|;\x20)'+_0x5f3cdd['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x5b22a9=function(_0xfdc066,_0x303033){_0xfdc066(++_0x303033);};return _0x5b22a9(_0x2c6a95,_0x54d5e8),_0x4ed07c?decodeURIComponent(_0x4ed07c[0x1]):undefined;}},_0x4b82c6=function(){const _0x596fa7=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x596fa7['test'](_0x1c5ef3['removeCookie']['toString']());};_0x1c5ef3['updateCookie']=_0x4b82c6;let _0x186b8e='';const _0x34c37f=_0x1c5ef3['updateCookie']();if(!_0x34c37f)_0x1c5ef3['setCookie'](['*'],'counter',0x1);else _0x34c37f?_0x186b8e=_0x1c5ef3['getCookie'](null,'counter'):_0x1c5ef3['removeCookie']();};_0x110ab1();}(a197_0x54d5,0x1c3));const a197_0x2c6a=function(_0x5389c4,_0x54d5e8){_0x5389c4=_0x5389c4-0x0;let _0x2c6a95=a197_0x54d5[_0x5389c4];return _0x2c6a95;};const a197_0x481a81=function(){let _0x4c8f27=!![];return function(_0x5775da,_0x50c5c2){const _0x546789=_0x4c8f27?function(){if(_0x50c5c2){const _0x3d3b3e=_0x50c5c2[a197_0x2c6a('0x19')](_0x5775da,arguments);return _0x50c5c2=null,_0x3d3b3e;}}:function(){};return _0x4c8f27=![],_0x546789;};}(),a197_0x5b2298=a197_0x481a81(this,function(){const _0x54b7b0=function(){const _0x1f7fd1=_0x54b7b0[a197_0x2c6a('0x12')](a197_0x2c6a('0xb'))()[a197_0x2c6a('0x12')](a197_0x2c6a('0xc'));return!_0x1f7fd1[a197_0x2c6a('0x27')](a197_0x5b2298);};return _0x54b7b0();});a197_0x5b2298();'use strict';const tesseract_1=require(a197_0x2c6a('0x13')),Poll_1=require('../models/Poll');module['exports']=class PollScheduler extends tesseract_1['Scheduler']{constructor(){super(a197_0x2c6a('0x24'),{'cronTime':a197_0x2c6a('0xd')}),this[a197_0x2c6a('0x18')]=async()=>{try{if(!this['client']['readyTimestamp'])return;if(!this['client'][a197_0x2c6a('0x17')]['cache']['size'])return;const _0x315e04=await Poll_1[a197_0x2c6a('0x22')][a197_0x2c6a('0x1a')]({'$or':this['client'][a197_0x2c6a('0x17')]['cache'][a197_0x2c6a('0x9')](_0x46cf81=>({'guild':_0x46cf81['id']})),'ends':{'$lte':new Date()}}),_0x40710e=[];for(const _0x2d1985 of _0x315e04){const _0x5e3700=this[a197_0x2c6a('0x20')][a197_0x2c6a('0x17')][a197_0x2c6a('0x25')]['get'](_0x2d1985['guild']);if(_0x5e3700['channels'][a197_0x2c6a('0x25')]['has'](_0x2d1985['channel'])){const _0x42366f=_0x5e3700['channels'][a197_0x2c6a('0x25')][a197_0x2c6a('0x2')](_0x2d1985[a197_0x2c6a('0xa')]),_0x290269=await _0x42366f[a197_0x2c6a('0x3')][a197_0x2c6a('0x15')](_0x2d1985[a197_0x2c6a('0x11')])[a197_0x2c6a('0x23')](()=>{});if(!_0x290269)continue;const _0x2c82b2=_0x290269[a197_0x2c6a('0x0')][0x0][a197_0x2c6a('0x4')][a197_0x2c6a('0x9')](_0x169ad0=>_0x169ad0[a197_0x2c6a('0x1c')]),_0x25ba04=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],_0x4b99a7={};let _0x36b421=0x0;for(const _0x470cf9 in _0x25ba04['slice'](0x0,_0x2c82b2[a197_0x2c6a('0x6')])){if(_0x290269[a197_0x2c6a('0x1b')]['cache'][a197_0x2c6a('0x21')](_0x25ba04[_0x470cf9])){await _0x290269[a197_0x2c6a('0x1b')][a197_0x2c6a('0x25')][a197_0x2c6a('0x2')](_0x25ba04[_0x470cf9])[a197_0x2c6a('0x8')][a197_0x2c6a('0x15')]()[a197_0x2c6a('0x23')](()=>{});const _0xb978a6=_0x290269[a197_0x2c6a('0x1b')][a197_0x2c6a('0x25')][a197_0x2c6a('0x2')](_0x25ba04[_0x470cf9])['users'][a197_0x2c6a('0x25')][a197_0x2c6a('0x1')](_0x4939b0=>!_0x4939b0[a197_0x2c6a('0x1e')])['size'];_0x4b99a7[_0x25ba04[_0x470cf9]]=_0xb978a6,_0x36b421+=_0xb978a6;}}await _0x290269[a197_0x2c6a('0xe')]({'embed':{'color':tesseract_1[a197_0x2c6a('0x10')][a197_0x2c6a('0x7')][a197_0x2c6a('0x26')],'author':{'name':a197_0x2c6a('0x16')},'title':_0x290269[a197_0x2c6a('0x0')][0x0]['title'],'fields':_0x290269[a197_0x2c6a('0x0')][0x0][a197_0x2c6a('0x4')][a197_0x2c6a('0x9')](_0x557940=>({'name':_0x557940['name']+'\x20'+_0x557940[a197_0x2c6a('0x1c')],'value':(_0x4b99a7[_0x557940[a197_0x2c6a('0x14')]]||0x0)+a197_0x2c6a('0x5')+_0x36b421+'\x20votes\x20('+(_0x4b99a7[_0x557940[a197_0x2c6a('0x14')]]?_0x4b99a7[_0x557940['name']]/_0x36b421*0x64:0x0)[a197_0x2c6a('0x1f')](0x2)+'%)'})),'footer':{'text':a197_0x2c6a('0xf')},'timestamp':new Date()}})['then'](()=>{_0x40710e['push'](_0x290269['id']);})[a197_0x2c6a('0x23')](()=>{});}}_0x40710e[a197_0x2c6a('0x6')]&&await Poll_1[a197_0x2c6a('0x22')]['deleteMany']({'$or':_0x40710e[a197_0x2c6a('0x9')](_0x5ea0b8=>({'_id':_0x5ea0b8}))})[a197_0x2c6a('0x23')](()=>{});}catch(_0x27c73a){tesseract_1[a197_0x2c6a('0x28')][a197_0x2c6a('0x1d')](_0x27c73a);}};}};