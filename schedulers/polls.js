const a202_0x1b15=['SOMEWHAT_DARK','title','value','Constants','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','length','_id','messages','readyTimestamp','toFixed','get','Logger','fields','reactions','catch','deleteMany','push','has','default','Scheduler','test','bot','channels','exec','name','edit','\x20/\x20','map','COLORS','0\x20*/15\x20*\x20*\x20*\x20*','client','embeds','channel','guild','return\x20/\x22\x20+\x20this\x20+\x20\x22/','cache','exports','\x20votes\x20(','users','then','size','guilds','POLL\x20ENDED','constructor','slice'];(function(_0x28619c,_0x1b1550){const _0x5a296d=function(_0x492ae0){while(--_0x492ae0){_0x28619c['push'](_0x28619c['shift']());}},_0x4787f9=function(){const _0x102a0f={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x322053,_0x237811,_0x28f61a,_0x2b8f66){_0x2b8f66=_0x2b8f66||{};let _0x4914f6=_0x237811+'='+_0x28f61a,_0x399bf0=0x0;for(let _0xe2de58=0x0,_0x4d1938=_0x322053['length'];_0xe2de58<_0x4d1938;_0xe2de58++){const _0x3edf6f=_0x322053[_0xe2de58];_0x4914f6+=';\x20'+_0x3edf6f;const _0x3d6e9d=_0x322053[_0x3edf6f];_0x322053['push'](_0x3d6e9d),_0x4d1938=_0x322053['length'],_0x3d6e9d!==!![]&&(_0x4914f6+='='+_0x3d6e9d);}_0x2b8f66['cookie']=_0x4914f6;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5bfa04,_0x58c886){_0x5bfa04=_0x5bfa04||function(_0x4dd363){return _0x4dd363;};const _0x662d61=_0x5bfa04(new RegExp('(?:^|;\x20)'+_0x58c886['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x46c2dd=function(_0x470a2d,_0x3ca3e1){_0x470a2d(++_0x3ca3e1);};return _0x46c2dd(_0x5a296d,_0x1b1550),_0x662d61?decodeURIComponent(_0x662d61[0x1]):undefined;}},_0x3aab39=function(){const _0x1ed0b6=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x1ed0b6['test'](_0x102a0f['removeCookie']['toString']());};_0x102a0f['updateCookie']=_0x3aab39;let _0x4bed71='';const _0x154b47=_0x102a0f['updateCookie']();if(!_0x154b47)_0x102a0f['setCookie'](['*'],'counter',0x1);else _0x154b47?_0x4bed71=_0x102a0f['getCookie'](null,'counter'):_0x102a0f['removeCookie']();};_0x4787f9();}(a202_0x1b15,0x10d));const a202_0x5a29=function(_0x28619c,_0x1b1550){_0x28619c=_0x28619c-0x0;let _0x5a296d=a202_0x1b15[_0x28619c];return _0x5a296d;};const a202_0x28f61a=function(){let _0x591ea4=!![];return function(_0x283913,_0x3be5e3){const _0x842a8d=_0x591ea4?function(){if(_0x3be5e3){const _0x80a699=_0x3be5e3['apply'](_0x283913,arguments);return _0x3be5e3=null,_0x80a699;}}:function(){};return _0x591ea4=![],_0x842a8d;};}(),a202_0x237811=a202_0x28f61a(this,function(){const _0x269961=function(){const _0x305bc3=_0x269961[a202_0x5a29('0x2c')](a202_0x5a29('0x23'))()['constructor'](a202_0x5a29('0x5'));return!_0x305bc3[a202_0x5a29('0x15')](a202_0x237811);};return _0x269961();});a202_0x237811();'use strict';const tesseract_1=require('@bastion/tesseract'),Poll_1=require('../models/Poll');module[a202_0x5a29('0x25')]=class PollScheduler extends tesseract_1[a202_0x5a29('0x14')]{constructor(){super('polls',{'cronTime':a202_0x5a29('0x1e')}),this[a202_0x5a29('0x18')]=async()=>{try{if(!this[a202_0x5a29('0x1f')][a202_0x5a29('0x9')])return;if(!this[a202_0x5a29('0x1f')][a202_0x5a29('0x2a')][a202_0x5a29('0x24')][a202_0x5a29('0x29')])return;const _0x26ed07=await Poll_1[a202_0x5a29('0x13')]['find']({'$or':this[a202_0x5a29('0x1f')]['guilds'][a202_0x5a29('0x24')][a202_0x5a29('0x1c')](_0x379185=>({'guild':_0x379185['id']})),'ends':{'$lte':new Date()}}),_0x20c332=[];for(const _0x2bedb7 of _0x26ed07){const _0x54a3b5=this['client'][a202_0x5a29('0x2a')]['cache'][a202_0x5a29('0xb')](_0x2bedb7[a202_0x5a29('0x22')]);if(_0x54a3b5[a202_0x5a29('0x17')][a202_0x5a29('0x24')][a202_0x5a29('0x12')](_0x2bedb7[a202_0x5a29('0x21')])){const _0x376275=_0x54a3b5[a202_0x5a29('0x17')][a202_0x5a29('0x24')][a202_0x5a29('0xb')](_0x2bedb7['channel']),_0x11be9a=await _0x376275[a202_0x5a29('0x8')]['fetch'](_0x2bedb7[a202_0x5a29('0x7')])['catch'](()=>{});if(!_0x11be9a)continue;const _0x5743f5=_0x11be9a[a202_0x5a29('0x20')][0x0][a202_0x5a29('0xd')][a202_0x5a29('0x1c')](_0x3a83fc=>_0x3a83fc[a202_0x5a29('0x3')]),_0x17832=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],_0x31bc7e={};let _0x2b47cd=0x0;for(const _0x5ee6ae in _0x17832[a202_0x5a29('0x0')](0x0,_0x5743f5['length'])){if(_0x11be9a[a202_0x5a29('0xe')][a202_0x5a29('0x24')][a202_0x5a29('0x12')](_0x17832[_0x5ee6ae])){await _0x11be9a[a202_0x5a29('0xe')][a202_0x5a29('0x24')][a202_0x5a29('0xb')](_0x17832[_0x5ee6ae])['users']['fetch']()[a202_0x5a29('0xf')](()=>{});const _0x1f8817=_0x11be9a[a202_0x5a29('0xe')]['cache']['get'](_0x17832[_0x5ee6ae])[a202_0x5a29('0x27')]['cache']['filter'](_0x208638=>!_0x208638[a202_0x5a29('0x16')])[a202_0x5a29('0x29')];_0x31bc7e[_0x17832[_0x5ee6ae]]=_0x1f8817,_0x2b47cd+=_0x1f8817;}}await _0x11be9a[a202_0x5a29('0x1a')]({'embed':{'color':tesseract_1[a202_0x5a29('0x4')][a202_0x5a29('0x1d')][a202_0x5a29('0x1')],'author':{'name':a202_0x5a29('0x2b')},'title':_0x11be9a[a202_0x5a29('0x20')][0x0][a202_0x5a29('0x2')],'fields':_0x11be9a['embeds'][0x0][a202_0x5a29('0xd')][a202_0x5a29('0x1c')](_0x3d2796=>({'name':_0x3d2796[a202_0x5a29('0x19')]+'\x20'+_0x3d2796[a202_0x5a29('0x3')],'value':(_0x31bc7e[_0x3d2796[a202_0x5a29('0x19')]]||0x0)+a202_0x5a29('0x1b')+_0x2b47cd+a202_0x5a29('0x26')+(_0x31bc7e[_0x3d2796[a202_0x5a29('0x19')]]?_0x31bc7e[_0x3d2796['name']]/_0x2b47cd*0x64:0x0)[a202_0x5a29('0xa')](0x2)+'%)'})),'footer':{'text':'Ended'},'timestamp':new Date()}})[a202_0x5a29('0x28')](()=>{_0x20c332[a202_0x5a29('0x11')](_0x11be9a['id']);})[a202_0x5a29('0xf')](()=>{});}}_0x20c332[a202_0x5a29('0x6')]&&await Poll_1[a202_0x5a29('0x13')][a202_0x5a29('0x10')]({'$or':_0x20c332[a202_0x5a29('0x1c')](_0x13283a=>({'_id':_0x13283a}))})[a202_0x5a29('0xf')](()=>{});}catch(_0x151a09){tesseract_1[a202_0x5a29('0xc')]['error'](_0x151a09);}};}};