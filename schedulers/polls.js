const a207_0x55d5=['catch','channels','map','exports','edit','title','apply','slice','\x20/\x20','reactions','toFixed','users','error','messages','has','Scheduler','fields','@bastion/tesseract','channel','embeds','COLORS','then','length','test','size','get','push','bot','polls','return\x20/\x22\x20+\x20this\x20+\x20\x22/','guilds','../models/Poll','guild','0\x20*/15\x20*\x20*\x20*\x20*','client','\x20votes\x20(','name','Ended','cache','_id'];(function(_0x2a352a,_0x55d554){const _0x875d6e=function(_0x47e928){while(--_0x47e928){_0x2a352a['push'](_0x2a352a['shift']());}},_0x2427c0=function(){const _0x241004={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x48f761,_0x396855,_0x36c6b1,_0x26d2e2){_0x26d2e2=_0x26d2e2||{};let _0x1a15bc=_0x396855+'='+_0x36c6b1,_0x1d9b5d=0x0;for(let _0x573a43=0x0,_0x421272=_0x48f761['length'];_0x573a43<_0x421272;_0x573a43++){const _0x49edee=_0x48f761[_0x573a43];_0x1a15bc+=';\x20'+_0x49edee;const _0x4b9f9e=_0x48f761[_0x49edee];_0x48f761['push'](_0x4b9f9e),_0x421272=_0x48f761['length'],_0x4b9f9e!==!![]&&(_0x1a15bc+='='+_0x4b9f9e);}_0x26d2e2['cookie']=_0x1a15bc;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1fff68,_0x544f05){_0x1fff68=_0x1fff68||function(_0x304f6f){return _0x304f6f;};const _0x2af326=_0x1fff68(new RegExp('(?:^|;\x20)'+_0x544f05['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x307c18=function(_0x571a8c,_0x44f47a){_0x571a8c(++_0x44f47a);};return _0x307c18(_0x875d6e,_0x55d554),_0x2af326?decodeURIComponent(_0x2af326[0x1]):undefined;}},_0x2a02ec=function(){const _0x34e8e6=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x34e8e6['test'](_0x241004['removeCookie']['toString']());};_0x241004['updateCookie']=_0x2a02ec;let _0x3d0e64='';const _0x364fca=_0x241004['updateCookie']();if(!_0x364fca)_0x241004['setCookie'](['*'],'counter',0x1);else _0x364fca?_0x3d0e64=_0x241004['getCookie'](null,'counter'):_0x241004['removeCookie']();};_0x2427c0();}(a207_0x55d5,0x115));const a207_0x875d=function(_0x2a352a,_0x55d554){_0x2a352a=_0x2a352a-0x0;let _0x875d6e=a207_0x55d5[_0x2a352a];return _0x875d6e;};const a207_0x241004=function(){let _0x3d0e64=!![];return function(_0x364fca,_0x48f761){const _0x396855=_0x3d0e64?function(){if(_0x48f761){const _0x36c6b1=_0x48f761[a207_0x875d('0x9')](_0x364fca,arguments);return _0x48f761=null,_0x36c6b1;}}:function(){};return _0x3d0e64=![],_0x396855;};}(),a207_0x47e928=a207_0x241004(this,function(){const _0x26d2e2=function(){const _0x1a15bc=_0x26d2e2['constructor'](a207_0x875d('0x20'))()['constructor']('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x1a15bc[a207_0x875d('0x1a')](a207_0x47e928);};return _0x26d2e2();});a207_0x47e928();'use strict';const tesseract_1=require(a207_0x875d('0x14')),Poll_1=require(a207_0x875d('0x22'));module[a207_0x875d('0x6')]=class PollScheduler extends tesseract_1[a207_0x875d('0x12')]{constructor(){super(a207_0x875d('0x1f'),{'cronTime':a207_0x875d('0x24')}),this['exec']=async()=>{try{if(!this['client']['readyTimestamp'])return;if(!this[a207_0x875d('0x25')]['guilds'][a207_0x875d('0x1')]['size'])return;const _0x1d9b5d=await Poll_1['default']['find']({'$or':this['client'][a207_0x875d('0x21')]['cache']['map'](_0x421272=>({'guild':_0x421272['id']})),'ends':{'$lte':new Date()}}),_0x573a43=[];for(const _0x49edee of _0x1d9b5d){const _0x4b9f9e=this[a207_0x875d('0x25')]['guilds']['cache'][a207_0x875d('0x1c')](_0x49edee[a207_0x875d('0x23')]);if(_0x4b9f9e[a207_0x875d('0x4')]['cache'][a207_0x875d('0x11')](_0x49edee[a207_0x875d('0x15')])){const _0x1fff68=_0x4b9f9e['channels'][a207_0x875d('0x1')][a207_0x875d('0x1c')](_0x49edee[a207_0x875d('0x15')]),_0x544f05=await _0x1fff68[a207_0x875d('0x10')]['fetch'](_0x49edee[a207_0x875d('0x2')])[a207_0x875d('0x3')](()=>{});if(!_0x544f05)continue;const _0x2af326=_0x544f05[a207_0x875d('0x16')][0x0][a207_0x875d('0x13')]['map'](_0x44f47a=>_0x44f47a['value']),_0x307c18=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],_0x304f6f={};let _0x571a8c=0x0;for(const _0x34e8e6 in _0x307c18[a207_0x875d('0xa')](0x0,_0x2af326[a207_0x875d('0x19')])){if(_0x544f05[a207_0x875d('0xc')]['cache'][a207_0x875d('0x11')](_0x307c18[_0x34e8e6])){await _0x544f05[a207_0x875d('0xc')][a207_0x875d('0x1')][a207_0x875d('0x1c')](_0x307c18[_0x34e8e6])[a207_0x875d('0xe')]['fetch']()['catch'](()=>{});const _0x532d79=_0x544f05[a207_0x875d('0xc')]['cache'][a207_0x875d('0x1c')](_0x307c18[_0x34e8e6])['users'][a207_0x875d('0x1')]['filter'](_0x4b4ffe=>!_0x4b4ffe[a207_0x875d('0x1e')])[a207_0x875d('0x1b')];_0x304f6f[_0x307c18[_0x34e8e6]]=_0x532d79,_0x571a8c+=_0x532d79;}}await _0x544f05[a207_0x875d('0x7')]({'embed':{'color':tesseract_1['Constants'][a207_0x875d('0x17')]['SOMEWHAT_DARK'],'author':{'name':'POLL\x20ENDED'},'title':_0x544f05['embeds'][0x0][a207_0x875d('0x8')],'fields':_0x544f05[a207_0x875d('0x16')][0x0][a207_0x875d('0x13')][a207_0x875d('0x5')](_0x4b2306=>({'name':_0x4b2306[a207_0x875d('0x27')]+'\x20'+_0x4b2306['value'],'value':(_0x304f6f[_0x4b2306[a207_0x875d('0x27')]]||0x0)+a207_0x875d('0xb')+_0x571a8c+a207_0x875d('0x26')+(_0x304f6f[_0x4b2306[a207_0x875d('0x27')]]?_0x304f6f[_0x4b2306[a207_0x875d('0x27')]]/_0x571a8c*0x64:0x0)[a207_0x875d('0xd')](0x2)+'%)'})),'footer':{'text':a207_0x875d('0x0')},'timestamp':new Date()}})[a207_0x875d('0x18')](()=>{_0x573a43[a207_0x875d('0x1d')](_0x544f05['id']);})[a207_0x875d('0x3')](()=>{});}}_0x573a43[a207_0x875d('0x19')]&&await Poll_1['default']['deleteMany']({'$or':_0x573a43[a207_0x875d('0x5')](_0x469f0c=>({'_id':_0x469f0c}))})['catch'](()=>{});}catch(_0x176723){tesseract_1['Logger'][a207_0x875d('0xf')](_0x176723);}};}};