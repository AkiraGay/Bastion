const a68_0x63c4=['PREMIUM_MEMBERSHIP_REQUIRED','test','catch','Constants','LIMITS','map','COLORS','exports','save','GOLD','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','Roles\x20Store','name','countDocuments','roleBought','../../models/Role','sell','INSUFFICIENT_BALANCE','user','roleStore\x20ROLE\x20--buy','MANAGE_ROLES','compile','roleStore\x20ROLE\x20--unlist','price','guild','send','Command','roleStoreAdd','fetchPremiumTier','client','language','BASTION_ERROR_TYPE','tag','return\x20/\x22\x20+\x20this\x20+\x20\x22/','premiumPaidRoles','info','default','DiscordError','author','error','locale','roleStore','\x20/\x20','RED','permissions','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','findOne','getString','LIMITED_PREMIUM_MEMBERSHIP','ROLE_ALREADY_ASSIGNED','NO_PERMISSION','constructor','_id','exec','document','errors','GREEN','cache','channel','@bastion/tesseract','../../utils/constants','PAID_ROLES','MAX_SAFE_INTEGER','isPublicBastion','member','length','join','get','debit','PLATINUM','findOneAndUpdate','unlist','\x20Bastion\x20Coins','roles','ROLE_NOT_FOUND','IRIS','roleStoreRemove','PremiumTier','../../utils/errors','membershipLimitPaidRoles','clamp','buy','has'];(function(_0x1d4588,_0x63c468){const _0x236374=function(_0x529d42){while(--_0x529d42){_0x1d4588['push'](_0x1d4588['shift']());}};const _0x27506c=function(){const _0x3003e7={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x79e592,_0x7d515,_0x3cb501,_0x2a408b){_0x2a408b=_0x2a408b||{};let _0x259903=_0x7d515+'='+_0x3cb501;let _0x5e98a0=0x0;for(let _0x43b166=0x0,_0x2e3e5f=_0x79e592['length'];_0x43b166<_0x2e3e5f;_0x43b166++){const _0x5a5210=_0x79e592[_0x43b166];_0x259903+=';\x20'+_0x5a5210;const _0x58603d=_0x79e592[_0x5a5210];_0x79e592['push'](_0x58603d);_0x2e3e5f=_0x79e592['length'];if(_0x58603d!==!![]){_0x259903+='='+_0x58603d;}}_0x2a408b['cookie']=_0x259903;},'removeCookie':function(){return'dev';},'getCookie':function(_0x310288,_0x213e3d){_0x310288=_0x310288||function(_0x2ac017){return _0x2ac017;};const _0x57ee4d=_0x310288(new RegExp('(?:^|;\x20)'+_0x213e3d['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x5df44f=function(_0x210876,_0x59ba02){_0x210876(++_0x59ba02);};_0x5df44f(_0x236374,_0x63c468);return _0x57ee4d?decodeURIComponent(_0x57ee4d[0x1]):undefined;}};const _0x4e1bca=function(){const _0x4699e5=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4699e5['test'](_0x3003e7['removeCookie']['toString']());};_0x3003e7['updateCookie']=_0x4e1bca;let _0x58dce6='';const _0x2b1a5c=_0x3003e7['updateCookie']();if(!_0x2b1a5c){_0x3003e7['setCookie'](['*'],'counter',0x1);}else if(_0x2b1a5c){_0x58dce6=_0x3003e7['getCookie'](null,'counter');}else{_0x3003e7['removeCookie']();}};_0x27506c();}(a68_0x63c4,0xdf));const a68_0x2363=function(_0x1d4588,_0x63c468){_0x1d4588=_0x1d4588-0x0;let _0x236374=a68_0x63c4[_0x1d4588];return _0x236374;};const a68_0x3003e7=function(){let _0x49c7d8=!![];return function(_0x537e49,_0x16b43c){const _0x586c5d=_0x49c7d8?function(){if(_0x16b43c){const _0x49e67f=_0x16b43c['apply'](_0x537e49,arguments);_0x16b43c=null;return _0x49e67f;}}:function(){};_0x49c7d8=![];return _0x586c5d;};}();const a68_0x529d42=a68_0x3003e7(this,function(){const _0x4c7526=function(){const _0x33f69d=_0x4c7526[a68_0x2363('0x4d')](a68_0x2363('0x3b'))()[a68_0x2363('0x2f')](a68_0x2363('0x47'));return!_0x33f69d[a68_0x2363('0x1b')](a68_0x529d42);};return _0x4c7526();});a68_0x529d42();'use strict';const tesseract_1=require(a68_0x2363('0x2'));const Role_1=require(a68_0x2363('0x29'));const constants=require(a68_0x2363('0x3'));const errors=require(a68_0x2363('0x15'));const numbers=require('../../utils/numbers');const omnic=require('../../utils/omnic');module[a68_0x2363('0x21')]=class RoleStoreCommand extends tesseract_1[a68_0x2363('0x34')]{constructor(){super('roleStore',{'description':a68_0x2363('0x24'),'triggers':[],'arguments':{'boolean':[a68_0x2363('0x18'),a68_0x2363('0xe')],'number':['sell'],'coerce':{'sell':_0x4b255a=>numbers[a68_0x2363('0x17')](_0x4b255a,0x1,Number[a68_0x2363('0x5')])}},'scope':a68_0x2363('0x32'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[a68_0x2363('0x43'),'roleStore\x20ROLE\x20--sell\x20AMOUNT',a68_0x2363('0x2d'),a68_0x2363('0x30')]});this[a68_0x2363('0x4f')]=async(_0xbf16cc,_0x357065)=>{if(_0x357065['_'][a68_0x2363('0x8')]){const _0x2d2c15=this['client']['resolver']['resolveRole'](_0xbf16cc['guild'],_0x357065['_'][a68_0x2363('0x9')]('\x20'));if(!_0x2d2c15)throw new errors[(a68_0x2363('0x3f'))](errors[a68_0x2363('0x39')][a68_0x2363('0x11')],this['client'][a68_0x2363('0x42')][a68_0x2363('0x49')](_0xbf16cc[a68_0x2363('0x32')][a68_0x2363('0x50')][a68_0x2363('0x38')],a68_0x2363('0x41'),'roleNotFound'));if(_0x357065[a68_0x2363('0x2a')]>0x0){if(constants[a68_0x2363('0x6')](this['client'][a68_0x2363('0x2c')])){const _0x461372=await Role_1[a68_0x2363('0x3e')][a68_0x2363('0x27')]({'guild':_0xbf16cc['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(_0x461372>=constants[a68_0x2363('0x1e')][a68_0x2363('0x4')]){const _0x261cdc=await omnic[a68_0x2363('0x36')](_0xbf16cc[a68_0x2363('0x32')])[a68_0x2363('0x1c')](()=>{});if(_0x261cdc){if(_0x261cdc===omnic[a68_0x2363('0x14')][a68_0x2363('0x23')]&&_0x461372>=constants['LIMITS'][a68_0x2363('0x23')][a68_0x2363('0x4')]){throw new errors[(a68_0x2363('0x3f'))](errors[a68_0x2363('0x39')][a68_0x2363('0x4a')],this[a68_0x2363('0x37')][a68_0x2363('0x42')]['getString'](_0xbf16cc[a68_0x2363('0x32')]['document']['language'],a68_0x2363('0x51'),a68_0x2363('0x16'),constants[a68_0x2363('0x1e')][a68_0x2363('0x23')][a68_0x2363('0x4')]));}else if(_0x261cdc===omnic['PremiumTier'][a68_0x2363('0xc')]&&_0x461372>=constants['LIMITS'][a68_0x2363('0xc')][a68_0x2363('0x4')]){throw new errors[(a68_0x2363('0x3f'))](errors[a68_0x2363('0x39')][a68_0x2363('0x4a')],this[a68_0x2363('0x37')][a68_0x2363('0x42')][a68_0x2363('0x49')](_0xbf16cc[a68_0x2363('0x32')][a68_0x2363('0x50')][a68_0x2363('0x38')],'errors','membershipLimitPaidRoles',constants[a68_0x2363('0x1e')][a68_0x2363('0xc')][a68_0x2363('0x4')]));}}else{throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a68_0x2363('0x1a')],this[a68_0x2363('0x37')]['locale']['getString'](_0xbf16cc[a68_0x2363('0x32')][a68_0x2363('0x50')][a68_0x2363('0x38')],a68_0x2363('0x51'),a68_0x2363('0x3c'),constants['LIMITS'][a68_0x2363('0x4')]));}}}if(!_0xbf16cc[a68_0x2363('0x7')]['permissions'][a68_0x2363('0x19')](a68_0x2363('0x2e')))throw new Error(a68_0x2363('0x4c'));await Role_1[a68_0x2363('0x3e')][a68_0x2363('0xd')]({'_id':_0x2d2c15['id'],'guild':_0xbf16cc[a68_0x2363('0x32')]['id']},{'_id':_0x2d2c15['id'],'guild':_0xbf16cc[a68_0x2363('0x32')]['id'],'price':_0x357065[a68_0x2363('0x2a')]},{'upsert':!![]});return await _0xbf16cc[a68_0x2363('0x1')][a68_0x2363('0x33')]({'embed':{'color':tesseract_1['Constants'][a68_0x2363('0x20')][a68_0x2363('0x52')],'description':this[a68_0x2363('0x37')][a68_0x2363('0x42')]['getString'](_0xbf16cc[a68_0x2363('0x32')][a68_0x2363('0x50')][a68_0x2363('0x38')],'info',a68_0x2363('0x35'),_0xbf16cc['author'][a68_0x2363('0x3a')],_0x2d2c15[a68_0x2363('0x26')],_0x357065[a68_0x2363('0x2a')])}})[a68_0x2363('0x1c')](()=>{});}if(_0x357065['buy']){if(_0xbf16cc[a68_0x2363('0x7')]['roles']['cache'][a68_0x2363('0x19')](_0x2d2c15['id']))throw new Error(a68_0x2363('0x4b'));const _0x4adcc1=await Role_1[a68_0x2363('0x3e')][a68_0x2363('0x48')]({'_id':_0x2d2c15['id'],'guild':_0xbf16cc[a68_0x2363('0x32')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4adcc1)throw new Error('ROLE_NOT_FOR_SALE');if(_0xbf16cc['member'][a68_0x2363('0x50')]['balance']<_0x4adcc1[a68_0x2363('0x31')])throw new Error(a68_0x2363('0x2b'));await _0xbf16cc[a68_0x2363('0x7')][a68_0x2363('0x10')]['add'](_0x2d2c15);_0xbf16cc[a68_0x2363('0x7')][a68_0x2363('0xb')](_0x4adcc1[a68_0x2363('0x31')],'Paid\x20Role',_0xbf16cc[a68_0x2363('0x7')][a68_0x2363('0x50')]);await _0xbf16cc['member'][a68_0x2363('0x50')][a68_0x2363('0x22')]();return await _0xbf16cc['channel'][a68_0x2363('0x33')]({'embed':{'color':tesseract_1[a68_0x2363('0x1d')][a68_0x2363('0x20')]['GREEN'],'description':this[a68_0x2363('0x37')]['locale'][a68_0x2363('0x49')](_0xbf16cc[a68_0x2363('0x32')][a68_0x2363('0x50')]['language'],a68_0x2363('0x3d'),a68_0x2363('0x28'),_0xbf16cc[a68_0x2363('0x40')]['tag'],_0x2d2c15[a68_0x2363('0x26')],_0x357065[a68_0x2363('0x2a')])}})['catch'](()=>{});}if(_0x357065['unlist']){if(!_0xbf16cc[a68_0x2363('0x7')][a68_0x2363('0x46')][a68_0x2363('0x19')](a68_0x2363('0x2e')))throw new Error(a68_0x2363('0x4c'));await Role_1[a68_0x2363('0x3e')][a68_0x2363('0xd')]({'_id':_0x2d2c15['id'],'guild':_0xbf16cc[a68_0x2363('0x32')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x2d2c15['id'],'guild':_0xbf16cc['guild']['id'],'$unset':{'price':0x1}});return await _0xbf16cc[a68_0x2363('0x1')]['send']({'embed':{'color':tesseract_1[a68_0x2363('0x1d')][a68_0x2363('0x20')][a68_0x2363('0x45')],'description':this[a68_0x2363('0x37')][a68_0x2363('0x42')][a68_0x2363('0x49')](_0xbf16cc[a68_0x2363('0x32')]['document']['language'],'info',a68_0x2363('0x13'),_0xbf16cc[a68_0x2363('0x40')]['tag'],_0x2d2c15[a68_0x2363('0x26')])}})[a68_0x2363('0x1c')](()=>{});}}const _0x5bf32c=await Role_1[a68_0x2363('0x3e')]['find']({'guild':_0xbf16cc[a68_0x2363('0x32')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x5bf32c[a68_0x2363('0x8')])throw new Error('NO_ROLES_ON_SALE');return await _0xbf16cc[a68_0x2363('0x1')]['send']({'embed':{'color':tesseract_1[a68_0x2363('0x1d')][a68_0x2363('0x20')][a68_0x2363('0x12')],'title':a68_0x2363('0x25'),'fields':_0x5bf32c[a68_0x2363('0x1f')](_0x2e6f6e=>({'name':(_0xbf16cc[a68_0x2363('0x32')]['roles'][a68_0x2363('0x0')][a68_0x2363('0x19')](_0x2e6f6e[a68_0x2363('0x4e')])?_0xbf16cc[a68_0x2363('0x32')]['roles'][a68_0x2363('0x0')][a68_0x2363('0xa')](_0x2e6f6e[a68_0x2363('0x4e')])['name']+a68_0x2363('0x44'):'')+_0x2e6f6e[a68_0x2363('0x4e')],'value':_0x2e6f6e['price']+a68_0x2363('0xf')}))}})[a68_0x2363('0x1c')](()=>{});};}};