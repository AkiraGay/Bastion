const a93_0x1595=['map','test','premiumPaidRoles','apply','name','roleBought','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','roleStoreRemove','tag','join','locale','roleStore\x20ROLE\x20--buy','debit','NO_ROLES_ON_SALE','DiscordError','length','roleStoreAdd','language','PAID_ROLES','exec','sell','RED','LIMITED_PREMIUM_MEMBERSHIP','ROLE_ALREADY_ASSIGNED','document','../../utils/constants','clamp','ROLE_NOT_FOUND','roles','unlist','errors','PremiumTier','Roles\x20Store','Constants','../../utils/errors','info','../../utils/omnic','default','_id','resolveRole','guild','IRIS','channel','catch','PLATINUM','author','add','getString','user','GOLD','roleStore\x20ROLE\x20--sell\x20AMOUNT','price','balance','buy','findOne','MANAGE_ROLES','save','../../models/Role','NO_PERMISSION','resolver','constructor','membershipLimitPaidRoles','Paid\x20Role','countDocuments','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','BASTION_ERROR_TYPE','find','ROLE_NOT_FOR_SALE','LIMITS','exports','client','has','@bastion/tesseract','send','cache','COLORS','member','permissions','INSUFFICIENT_BALANCE','return\x20/\x22\x20+\x20this\x20+\x20\x22/','findOneAndUpdate'];(function(_0x2d7064,_0x24c0f5){const _0x15956b=function(_0x53d974){while(--_0x53d974){_0x2d7064['push'](_0x2d7064['shift']());}},_0x1ef69f=function(){const _0x7eb57e={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1ed610,_0x36ecae,_0x208dec,_0x1aa30e){_0x1aa30e=_0x1aa30e||{};let _0xc8ccf4=_0x36ecae+'='+_0x208dec,_0x35547f=0x0;for(let _0x3374e3=0x0,_0x450bd5=_0x1ed610['length'];_0x3374e3<_0x450bd5;_0x3374e3++){const _0x116f48=_0x1ed610[_0x3374e3];_0xc8ccf4+=';\x20'+_0x116f48;const _0x3788d7=_0x1ed610[_0x116f48];_0x1ed610['push'](_0x3788d7),_0x450bd5=_0x1ed610['length'],_0x3788d7!==!![]&&(_0xc8ccf4+='='+_0x3788d7);}_0x1aa30e['cookie']=_0xc8ccf4;},'removeCookie':function(){return'dev';},'getCookie':function(_0x30d131,_0x15f9aa){_0x30d131=_0x30d131||function(_0x17cc1f){return _0x17cc1f;};const _0x1fcb0f=_0x30d131(new RegExp('(?:^|;\x20)'+_0x15f9aa['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x4641f2=function(_0x259ef8,_0x4878bc){_0x259ef8(++_0x4878bc);};return _0x4641f2(_0x15956b,_0x24c0f5),_0x1fcb0f?decodeURIComponent(_0x1fcb0f[0x1]):undefined;}},_0x1199e4=function(){const _0x21bf87=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x21bf87['test'](_0x7eb57e['removeCookie']['toString']());};_0x7eb57e['updateCookie']=_0x1199e4;let _0x28da77='';const _0x1dc835=_0x7eb57e['updateCookie']();if(!_0x1dc835)_0x7eb57e['setCookie'](['*'],'counter',0x1);else _0x1dc835?_0x28da77=_0x7eb57e['getCookie'](null,'counter'):_0x7eb57e['removeCookie']();};_0x1ef69f();}(a93_0x1595,0x70));const a93_0x1ef6=function(_0x2d7064,_0x24c0f5){_0x2d7064=_0x2d7064-0xc8;let _0x15956b=a93_0x1595[_0x2d7064];return _0x15956b;};const _0x2cbacb=a93_0x1ef6,a93_0x1199e4=function(){let _0x1dc835=!![];return function(_0x1ed610,_0x36ecae){const _0x208dec=_0x1dc835?function(){const _0x5b190b=a93_0x1ef6;if(_0x36ecae){const _0x1aa30e=_0x36ecae[_0x5b190b(0xfd)](_0x1ed610,arguments);return _0x36ecae=null,_0x1aa30e;}}:function(){};return _0x1dc835=![],_0x208dec;};}(),a93_0x7eb57e=a93_0x1199e4(this,function(){const _0xc8ccf4=function(){const _0x2c3b8a=a93_0x1ef6,_0x35547f=_0xc8ccf4[_0x2c3b8a(0xe5)](_0x2c3b8a(0xf8))()[_0x2c3b8a(0xe5)](_0x2c3b8a(0xe9));return!_0x35547f[_0x2c3b8a(0xfb)](a93_0x7eb57e);};return _0xc8ccf4();});a93_0x7eb57e();'use strict';const tesseract_1=require(_0x2cbacb(0xf1)),Role_1=require(_0x2cbacb(0xe2)),constants=require(_0x2cbacb(0x113)),errors=require(_0x2cbacb(0xcb)),numbers=require('../../utils/numbers'),omnic=require(_0x2cbacb(0xcd));module[_0x2cbacb(0xee)]=class RoleStoreCommand extends tesseract_1['Command']{constructor(){const _0x12789f=_0x2cbacb;super('roleStore',{'description':_0x12789f(0x100),'triggers':[],'arguments':{'boolean':['buy',_0x12789f(0x117)],'number':['sell'],'coerce':{'sell':_0x3374e3=>numbers[_0x12789f(0x114)](_0x3374e3,0x1,Number['MAX_SAFE_INTEGER'])}},'scope':_0x12789f(0xd1),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':['roleStore',_0x12789f(0xdb),_0x12789f(0x105),'roleStore\x20ROLE\x20--unlist']}),this[_0x12789f(0x10d)]=async(_0x450bd5,_0x116f48)=>{const _0x3b1082=_0x12789f;if(_0x116f48['_'][_0x3b1082(0x109)]){const _0x30d131=this[_0x3b1082(0xef)][_0x3b1082(0xe4)][_0x3b1082(0xd0)](_0x450bd5['guild'],_0x116f48['_'][_0x3b1082(0x103)]('\x20'));if(!_0x30d131)throw new errors[(_0x3b1082(0x108))](errors[_0x3b1082(0xea)][_0x3b1082(0x115)],this[_0x3b1082(0xef)][_0x3b1082(0x104)][_0x3b1082(0xd8)](_0x450bd5[_0x3b1082(0xd1)][_0x3b1082(0x112)][_0x3b1082(0x10b)],_0x3b1082(0x118),'roleNotFound'));if(_0x116f48['sell']>0x0){if(constants['isPublicBastion'](this['client'][_0x3b1082(0xd9)])){const _0x15f9aa=await Role_1[_0x3b1082(0xce)][_0x3b1082(0xe8)]({'guild':_0x450bd5[_0x3b1082(0xd1)]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x15f9aa>=constants[_0x3b1082(0xed)]['PAID_ROLES']){const _0x1fcb0f=await omnic['fetchPremiumTier'](_0x450bd5[_0x3b1082(0xd1)])['catch'](()=>{});if(_0x1fcb0f){if(_0x1fcb0f===omnic[_0x3b1082(0xc8)]['GOLD']&&_0x15f9aa>=constants[_0x3b1082(0xed)][_0x3b1082(0xda)]['PAID_ROLES'])throw new errors[(_0x3b1082(0x108))](errors[_0x3b1082(0xea)][_0x3b1082(0x110)],this['client'][_0x3b1082(0x104)]['getString'](_0x450bd5['guild'][_0x3b1082(0x112)][_0x3b1082(0x10b)],_0x3b1082(0x118),'membershipLimitPaidRoles',constants[_0x3b1082(0xed)][_0x3b1082(0xda)][_0x3b1082(0x10c)]));else{if(_0x1fcb0f===omnic[_0x3b1082(0xc8)][_0x3b1082(0xd5)]&&_0x15f9aa>=constants[_0x3b1082(0xed)]['PLATINUM']['PAID_ROLES'])throw new errors[(_0x3b1082(0x108))](errors[_0x3b1082(0xea)][_0x3b1082(0x110)],this['client'][_0x3b1082(0x104)]['getString'](_0x450bd5[_0x3b1082(0xd1)][_0x3b1082(0x112)][_0x3b1082(0x10b)],_0x3b1082(0x118),_0x3b1082(0xe6),constants[_0x3b1082(0xed)][_0x3b1082(0xd5)][_0x3b1082(0x10c)]));}}else throw new errors[(_0x3b1082(0x108))](errors[_0x3b1082(0xea)]['PREMIUM_MEMBERSHIP_REQUIRED'],this['client'][_0x3b1082(0x104)][_0x3b1082(0xd8)](_0x450bd5[_0x3b1082(0xd1)]['document'][_0x3b1082(0x10b)],'errors',_0x3b1082(0xfc),constants[_0x3b1082(0xed)]['PAID_ROLES']));}}if(!_0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0xf6)]['has'](_0x3b1082(0xe0)))throw new Error(_0x3b1082(0xe3));return await Role_1['default'][_0x3b1082(0xf9)]({'_id':_0x30d131['id'],'guild':_0x450bd5['guild']['id']},{'_id':_0x30d131['id'],'guild':_0x450bd5[_0x3b1082(0xd1)]['id'],'price':_0x116f48[_0x3b1082(0x10e)]},{'upsert':!![]}),await _0x450bd5[_0x3b1082(0xd3)][_0x3b1082(0xf2)]({'embed':{'color':tesseract_1[_0x3b1082(0xca)][_0x3b1082(0xf4)]['GREEN'],'description':this[_0x3b1082(0xef)][_0x3b1082(0x104)]['getString'](_0x450bd5['guild'][_0x3b1082(0x112)]['language'],_0x3b1082(0xcc),_0x3b1082(0x10a),_0x450bd5[_0x3b1082(0xd6)][_0x3b1082(0x102)],_0x30d131['name'],_0x116f48[_0x3b1082(0x10e)])}})['catch'](()=>{});}if(_0x116f48[_0x3b1082(0xde)]){if(_0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0x116)]['cache'][_0x3b1082(0xf0)](_0x30d131['id']))throw new Error(_0x3b1082(0x111));const _0x4641f2=await Role_1[_0x3b1082(0xce)][_0x3b1082(0xdf)]({'_id':_0x30d131['id'],'guild':_0x450bd5['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4641f2)throw new Error(_0x3b1082(0xec));if(_0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0x112)][_0x3b1082(0xdd)]<_0x4641f2[_0x3b1082(0xdc)])throw new Error(_0x3b1082(0xf7));return await _0x450bd5[_0x3b1082(0xf5)]['roles'][_0x3b1082(0xd7)](_0x30d131),_0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0x106)](_0x4641f2['price'],_0x3b1082(0xe7),_0x450bd5[_0x3b1082(0xf5)]['document']),await _0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0x112)][_0x3b1082(0xe1)](),await _0x450bd5[_0x3b1082(0xd3)][_0x3b1082(0xf2)]({'embed':{'color':tesseract_1['Constants'][_0x3b1082(0xf4)]['GREEN'],'description':this[_0x3b1082(0xef)][_0x3b1082(0x104)][_0x3b1082(0xd8)](_0x450bd5['guild'][_0x3b1082(0x112)][_0x3b1082(0x10b)],_0x3b1082(0xcc),_0x3b1082(0xff),_0x450bd5['author'][_0x3b1082(0x102)],_0x30d131['name'],_0x4641f2[_0x3b1082(0xdc)])}})[_0x3b1082(0xd4)](()=>{});}if(_0x116f48[_0x3b1082(0x117)]){if(!_0x450bd5[_0x3b1082(0xf5)][_0x3b1082(0xf6)][_0x3b1082(0xf0)]('MANAGE_ROLES'))throw new Error(_0x3b1082(0xe3));return await Role_1[_0x3b1082(0xce)]['findOneAndUpdate']({'_id':_0x30d131['id'],'guild':_0x450bd5[_0x3b1082(0xd1)]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x30d131['id'],'guild':_0x450bd5['guild']['id'],'$unset':{'price':0x1}}),await _0x450bd5[_0x3b1082(0xd3)][_0x3b1082(0xf2)]({'embed':{'color':tesseract_1[_0x3b1082(0xca)]['COLORS'][_0x3b1082(0x10f)],'description':this[_0x3b1082(0xef)][_0x3b1082(0x104)]['getString'](_0x450bd5['guild'][_0x3b1082(0x112)]['language'],_0x3b1082(0xcc),_0x3b1082(0x101),_0x450bd5[_0x3b1082(0xd6)][_0x3b1082(0x102)],_0x30d131[_0x3b1082(0xfe)])}})[_0x3b1082(0xd4)](()=>{});}}const _0x3788d7=await Role_1['default'][_0x3b1082(0xeb)]({'guild':_0x450bd5[_0x3b1082(0xd1)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3788d7[_0x3b1082(0x109)])throw new Error(_0x3b1082(0x107));return await _0x450bd5[_0x3b1082(0xd3)][_0x3b1082(0xf2)]({'embed':{'color':tesseract_1[_0x3b1082(0xca)][_0x3b1082(0xf4)][_0x3b1082(0xd2)],'title':_0x3b1082(0xc9),'fields':_0x3788d7[_0x3b1082(0xfa)](_0x17cc1f=>({'name':(_0x450bd5[_0x3b1082(0xd1)]['roles'][_0x3b1082(0xf3)]['has'](_0x17cc1f['_id'])?_0x450bd5[_0x3b1082(0xd1)]['roles'][_0x3b1082(0xf3)]['get'](_0x17cc1f[_0x3b1082(0xcf)])[_0x3b1082(0xfe)]+'\x20/\x20':'')+_0x17cc1f[_0x3b1082(0xcf)],'value':_0x17cc1f[_0x3b1082(0xdc)]+'\x20Bastion\x20Coins'}))}})['catch'](()=>{});};}};