const a94_0x776f=['It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','join','PremiumTier','../../utils/errors','\x20/\x20','MAX_SAFE_INTEGER','countDocuments','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','NO_PERMISSION','default','constructor','price','205ZPNHHb','Roles\x20Store','channel','document','getString','exec','has','author','roleStoreAdd','../../models/Role','errors','Constants','info','premiumPaidRoles','roleStore\x20ROLE\x20--buy','ROLE_NOT_FOR_SALE','413894VoIecI','roleStore','name','member','../../utils/constants','balance','unlist','permissions','PLATINUM','GREEN','RED','DiscordError','BASTION_ERROR_TYPE','roles','LIMITED_PREMIUM_MEMBERSHIP','find','ROLE_NOT_FOUND','roleStore\x20ROLE\x20--unlist','74MBwGNf','_id','roleBought','send','locale','LIMITS','findOneAndUpdate','../../utils/omnic','language','INSUFFICIENT_BALANCE','IRIS','ROLE_ALREADY_ASSIGNED','GOLD','tag','19NNmRDX','save','membershipLimitPaidRoles','sell','fetchPremiumTier','user','debit','test','resolver','791750SPYaWA','1367NDzjFk','COLORS','979637MJjnkH','22769EkopGb','Paid\x20Role','apply','MANAGE_ROLES','../../utils/numbers','PAID_ROLES','cache','guild','resolveRole','catch','client','length','442KlNrfN','6366PMupCC','buy','53TRUAMr','roleStore\x20ROLE\x20--sell\x20AMOUNT','map'];const a94_0x1d64=function(_0x4e3212,_0x251168){_0x4e3212=_0x4e3212-0x1e4;let _0x2e2c8d=a94_0x776f[_0x4e3212];return _0x2e2c8d;};const a94_0x5a2aa7=a94_0x1d64;(function(_0x465b34,_0xb07f09){const _0x87d67c=a94_0x1d64;while(!![]){try{const _0x415705=parseInt(_0x87d67c(0x22d))*parseInt(_0x87d67c(0x20c))+parseInt(_0x87d67c(0x21c))*parseInt(_0x87d67c(0x1f4))+parseInt(_0x87d67c(0x21e))*-parseInt(_0x87d67c(0x21b))+-parseInt(_0x87d67c(0x20e))+parseInt(_0x87d67c(0x20b))+parseInt(_0x87d67c(0x23d))+-parseInt(_0x87d67c(0x20f))*parseInt(_0x87d67c(0x202));if(_0x415705===_0xb07f09)break;else _0x465b34['push'](_0x465b34['shift']());}catch(_0x57719){_0x465b34['push'](_0x465b34['shift']());}}}(a94_0x776f,0x7f449));const a94_0x2dcee5=function(){let _0x20bf02=!![];return function(_0xe56a8e,_0xb038ec){const _0x5830b3=_0x20bf02?function(){const _0x275276=a94_0x1d64;if(_0xb038ec){const _0x1223f4=_0xb038ec[_0x275276(0x211)](_0xe56a8e,arguments);return _0xb038ec=null,_0x1223f4;}}:function(){};return _0x20bf02=![],_0x5830b3;};}(),a94_0x34cccd=a94_0x2dcee5(this,function(){const _0x13bb67=function(){const _0x6cfd14=a94_0x1d64,_0x503ac7=_0x13bb67['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x6cfd14(0x22b)](_0x6cfd14(0x228));return!_0x503ac7[_0x6cfd14(0x209)](a94_0x34cccd);};return _0x13bb67();});a94_0x34cccd();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require(a94_0x5a2aa7(0x236)),constants=require(a94_0x5a2aa7(0x1e6)),errors=require(a94_0x5a2aa7(0x224)),numbers=require(a94_0x5a2aa7(0x213)),omnic=require(a94_0x5a2aa7(0x1fb));module['exports']=class RoleStoreCommand extends tesseract_1['Command']{constructor(){const _0x533119=a94_0x5a2aa7;super(_0x533119(0x23e),{'description':_0x533119(0x221),'triggers':[],'arguments':{'boolean':['buy',_0x533119(0x1e8)],'number':[_0x533119(0x205)],'coerce':{'sell':_0x3aea2e=>numbers['clamp'](_0x3aea2e,0x1,Number[_0x533119(0x226)])}},'scope':_0x533119(0x216),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[_0x533119(0x23e),_0x533119(0x21f),_0x533119(0x23b),_0x533119(0x1f3)]}),this[_0x533119(0x232)]=async(_0x43272e,_0xff1c6c)=>{const _0x13f0e1=_0x533119;if(_0xff1c6c['_']['length']){const _0x1c16aa=this[_0x13f0e1(0x219)][_0x13f0e1(0x20a)][_0x13f0e1(0x217)](_0x43272e['guild'],_0xff1c6c['_'][_0x13f0e1(0x222)]('\x20'));if(!_0x1c16aa)throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][_0x13f0e1(0x1f2)],this['client'][_0x13f0e1(0x1f8)][_0x13f0e1(0x231)](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)][_0x13f0e1(0x1fc)],_0x13f0e1(0x237),'roleNotFound'));if(_0xff1c6c[_0x13f0e1(0x205)]>0x0){if(constants['isPublicBastion'](this[_0x13f0e1(0x219)][_0x13f0e1(0x207)])){const _0x5eada2=await Role_1[_0x13f0e1(0x22a)][_0x13f0e1(0x227)]({'guild':_0x43272e[_0x13f0e1(0x216)]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x5eada2>=constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x214)]){const _0x2c91bb=await omnic[_0x13f0e1(0x206)](_0x43272e[_0x13f0e1(0x216)])[_0x13f0e1(0x218)](()=>{});if(_0x2c91bb){if(_0x2c91bb===omnic[_0x13f0e1(0x223)]['GOLD']&&_0x5eada2>=constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x200)][_0x13f0e1(0x214)])throw new errors[(_0x13f0e1(0x1ed))](errors[_0x13f0e1(0x1ee)][_0x13f0e1(0x1f0)],this[_0x13f0e1(0x219)][_0x13f0e1(0x1f8)]['getString'](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)][_0x13f0e1(0x1fc)],_0x13f0e1(0x237),'membershipLimitPaidRoles',constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x200)]['PAID_ROLES']));else{if(_0x2c91bb===omnic[_0x13f0e1(0x223)]['PLATINUM']&&_0x5eada2>=constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x1ea)]['PAID_ROLES'])throw new errors[(_0x13f0e1(0x1ed))](errors['BASTION_ERROR_TYPE'][_0x13f0e1(0x1f0)],this['client']['locale']['getString'](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)][_0x13f0e1(0x1fc)],_0x13f0e1(0x237),_0x13f0e1(0x204),constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x1ea)][_0x13f0e1(0x214)]));}}else throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[_0x13f0e1(0x219)][_0x13f0e1(0x1f8)][_0x13f0e1(0x231)](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)]['language'],_0x13f0e1(0x237),_0x13f0e1(0x23a),constants[_0x13f0e1(0x1f9)][_0x13f0e1(0x214)]));}}if(!_0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x1e9)][_0x13f0e1(0x233)](_0x13f0e1(0x212)))throw new Error('NO_PERMISSION');return await Role_1['default'][_0x13f0e1(0x1fa)]({'_id':_0x1c16aa['id'],'guild':_0x43272e[_0x13f0e1(0x216)]['id']},{'_id':_0x1c16aa['id'],'guild':_0x43272e[_0x13f0e1(0x216)]['id'],'price':_0xff1c6c[_0x13f0e1(0x205)]},{'upsert':!![]}),await _0x43272e['channel'][_0x13f0e1(0x1f7)]({'embed':{'color':tesseract_1[_0x13f0e1(0x238)]['COLORS'][_0x13f0e1(0x1eb)],'description':this[_0x13f0e1(0x219)][_0x13f0e1(0x1f8)]['getString'](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)]['language'],_0x13f0e1(0x239),_0x13f0e1(0x235),_0x43272e[_0x13f0e1(0x234)]['tag'],_0x1c16aa['name'],_0xff1c6c[_0x13f0e1(0x205)])}})[_0x13f0e1(0x218)](()=>{});}if(_0xff1c6c[_0x13f0e1(0x21d)]){if(_0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x1ef)][_0x13f0e1(0x215)][_0x13f0e1(0x233)](_0x1c16aa['id']))throw new Error(_0x13f0e1(0x1ff));const _0x1c86ac=await Role_1['default']['findOne']({'_id':_0x1c16aa['id'],'guild':_0x43272e['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x1c86ac)throw new Error(_0x13f0e1(0x23c));if(_0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x230)][_0x13f0e1(0x1e7)]<_0x1c86ac['price'])throw new Error(_0x13f0e1(0x1fd));return await _0x43272e[_0x13f0e1(0x1e5)]['roles']['add'](_0x1c16aa),_0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x208)](_0x1c86ac['price'],_0x13f0e1(0x210),_0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x230)]),await _0x43272e[_0x13f0e1(0x1e5)][_0x13f0e1(0x230)][_0x13f0e1(0x203)](),await _0x43272e[_0x13f0e1(0x22f)][_0x13f0e1(0x1f7)]({'embed':{'color':tesseract_1[_0x13f0e1(0x238)][_0x13f0e1(0x20d)][_0x13f0e1(0x1eb)],'description':this[_0x13f0e1(0x219)][_0x13f0e1(0x1f8)][_0x13f0e1(0x231)](_0x43272e['guild'][_0x13f0e1(0x230)][_0x13f0e1(0x1fc)],_0x13f0e1(0x239),_0x13f0e1(0x1f6),_0x43272e[_0x13f0e1(0x234)][_0x13f0e1(0x201)],_0x1c16aa[_0x13f0e1(0x1e4)],_0x1c86ac[_0x13f0e1(0x22c)])}})[_0x13f0e1(0x218)](()=>{});}if(_0xff1c6c[_0x13f0e1(0x1e8)]){if(!_0x43272e['member']['permissions']['has'](_0x13f0e1(0x212)))throw new Error(_0x13f0e1(0x229));return await Role_1['default'][_0x13f0e1(0x1fa)]({'_id':_0x1c16aa['id'],'guild':_0x43272e[_0x13f0e1(0x216)]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x1c16aa['id'],'guild':_0x43272e[_0x13f0e1(0x216)]['id'],'$unset':{'price':0x1}}),await _0x43272e[_0x13f0e1(0x22f)][_0x13f0e1(0x1f7)]({'embed':{'color':tesseract_1[_0x13f0e1(0x238)][_0x13f0e1(0x20d)][_0x13f0e1(0x1ec)],'description':this['client']['locale'][_0x13f0e1(0x231)](_0x43272e[_0x13f0e1(0x216)][_0x13f0e1(0x230)]['language'],_0x13f0e1(0x239),'roleStoreRemove',_0x43272e[_0x13f0e1(0x234)][_0x13f0e1(0x201)],_0x1c16aa[_0x13f0e1(0x1e4)])}})[_0x13f0e1(0x218)](()=>{});}}const _0x43785d=await Role_1[_0x13f0e1(0x22a)][_0x13f0e1(0x1f1)]({'guild':_0x43272e[_0x13f0e1(0x216)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x43785d[_0x13f0e1(0x21a)])throw new Error('NO_ROLES_ON_SALE');return await _0x43272e[_0x13f0e1(0x22f)][_0x13f0e1(0x1f7)]({'embed':{'color':tesseract_1['Constants']['COLORS'][_0x13f0e1(0x1fe)],'title':_0x13f0e1(0x22e),'fields':_0x43785d[_0x13f0e1(0x220)](_0x4dfdc5=>({'name':(_0x43272e[_0x13f0e1(0x216)]['roles'][_0x13f0e1(0x215)][_0x13f0e1(0x233)](_0x4dfdc5['_id'])?_0x43272e['guild'][_0x13f0e1(0x1ef)]['cache']['get'](_0x4dfdc5[_0x13f0e1(0x1f5)])['name']+_0x13f0e1(0x225):'')+_0x4dfdc5[_0x13f0e1(0x1f5)],'value':_0x4dfdc5[_0x13f0e1(0x22c)]+'\x20Bastion\x20Coins'}))}})[_0x13f0e1(0x218)](()=>{});};}};