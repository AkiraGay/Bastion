const a94_0x1a54=['send','getString','COLORS','roles','exec','GOLD','errors','PLATINUM','BASTION_ERROR_TYPE','debit','channel','membershipLimitPaidRoles','user','length','roleStore\x20ROLE\x20--sell\x20AMOUNT','isPublicBastion','document','\x20/\x20','map','ROLE_ALREADY_ASSIGNED','info','../../utils/errors','PremiumTier','client','cache','IRIS','resolver','Paid\x20Role','default','MANAGE_ROLES','apply','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','author','findOne','test','sell','locale','language','@bastion/tesseract','constructor','name','price','buy','Roles\x20Store','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','DiscordError','../../utils/numbers','get','roleStore','ROLE_NOT_FOR_SALE','LIMITS','unlist','guild','balance','roleStoreAdd','find','GREEN','LIMITED_PREMIUM_MEMBERSHIP','ROLE_NOT_FOUND','catch','member','findOneAndUpdate','roleStore\x20ROLE\x20--buy','tag','_id','has','roleBought','premiumPaidRoles','PAID_ROLES','save','Constants','NO_PERMISSION','NO_ROLES_ON_SALE','permissions'];(function(_0x160f49,_0x24bc05){const _0x1a54ad=function(_0x264b67){while(--_0x264b67){_0x160f49['push'](_0x160f49['shift']());}},_0x449442=function(){const _0x4bf0d3={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2e1747,_0x1b111,_0x3070c8,_0x22b669){_0x22b669=_0x22b669||{};let _0x1d5ba6=_0x1b111+'='+_0x3070c8,_0x8b6eb0=0x0;for(let _0x190b0d=0x0,_0x1fe94b=_0x2e1747['length'];_0x190b0d<_0x1fe94b;_0x190b0d++){const _0x16a1e2=_0x2e1747[_0x190b0d];_0x1d5ba6+=';\x20'+_0x16a1e2;const _0x3380b7=_0x2e1747[_0x16a1e2];_0x2e1747['push'](_0x3380b7),_0x1fe94b=_0x2e1747['length'],_0x3380b7!==!![]&&(_0x1d5ba6+='='+_0x3380b7);}_0x22b669['cookie']=_0x1d5ba6;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5d9fd5,_0x296c73){_0x5d9fd5=_0x5d9fd5||function(_0x44542e){return _0x44542e;};const _0x438b18=_0x5d9fd5(new RegExp('(?:^|;\x20)'+_0x296c73['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x3ffa30=function(_0x43cfc9,_0x1f4d4a){_0x43cfc9(++_0x1f4d4a);};return _0x3ffa30(_0x1a54ad,_0x24bc05),_0x438b18?decodeURIComponent(_0x438b18[0x1]):undefined;}},_0x57df26=function(){const _0x17008a=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x17008a['test'](_0x4bf0d3['removeCookie']['toString']());};_0x4bf0d3['updateCookie']=_0x57df26;let _0x5dfe69='';const _0x1a812e=_0x4bf0d3['updateCookie']();if(!_0x1a812e)_0x4bf0d3['setCookie'](['*'],'counter',0x1);else _0x1a812e?_0x5dfe69=_0x4bf0d3['getCookie'](null,'counter'):_0x4bf0d3['removeCookie']();};_0x449442();}(a94_0x1a54,0x1b6));const a94_0x4494=function(_0x160f49,_0x24bc05){_0x160f49=_0x160f49-0x8b;let _0x1a54ad=a94_0x1a54[_0x160f49];return _0x1a54ad;};const a94_0x489a22=a94_0x4494,a94_0x57df26=function(){let _0x1a812e=!![];return function(_0x2e1747,_0x1b111){const _0x3070c8=_0x1a812e?function(){const _0x207dc2=a94_0x4494;if(_0x1b111){const _0x22b669=_0x1b111[_0x207dc2(0xaf)](_0x2e1747,arguments);return _0x1b111=null,_0x22b669;}}:function(){};return _0x1a812e=![],_0x3070c8;};}(),a94_0x4bf0d3=a94_0x57df26(this,function(){const _0x1d5ba6=function(){const _0x106209=a94_0x4494,_0x8b6eb0=_0x1d5ba6[_0x106209(0xb8)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](_0x106209(0xb0));return!_0x8b6eb0[_0x106209(0xb3)](a94_0x4bf0d3);};return _0x1d5ba6();});a94_0x4bf0d3();'use strict';const tesseract_1=require(a94_0x489a22(0xb7)),Role_1=require('../../models/Role'),constants=require('../../utils/constants'),errors=require(a94_0x489a22(0xa6)),numbers=require(a94_0x489a22(0xbf)),omnic=require('../../utils/omnic');module['exports']=class RoleStoreCommand extends tesseract_1['Command']{constructor(){const _0x209bb3=a94_0x489a22;super(_0x209bb3(0xc1),{'description':_0x209bb3(0xbd),'triggers':[],'arguments':{'boolean':[_0x209bb3(0xbb),_0x209bb3(0xc4)],'number':['sell'],'coerce':{'sell':_0x190b0d=>numbers['clamp'](_0x190b0d,0x1,Number['MAX_SAFE_INTEGER'])}},'scope':_0x209bb3(0xc5),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[_0x209bb3(0xc1),_0x209bb3(0x9f),_0x209bb3(0xcf),'roleStore\x20ROLE\x20--unlist']}),this[_0x209bb3(0x95)]=async(_0x1fe94b,_0x16a1e2)=>{const _0x4f9c50=_0x209bb3;if(_0x16a1e2['_'][_0x4f9c50(0x9e)]){const _0x5d9fd5=this[_0x4f9c50(0xa8)][_0x4f9c50(0xab)]['resolveRole'](_0x1fe94b[_0x4f9c50(0xc5)],_0x16a1e2['_']['join']('\x20'));if(!_0x5d9fd5)throw new errors[(_0x4f9c50(0xbe))](errors['BASTION_ERROR_TYPE'][_0x4f9c50(0xcb)],this['client'][_0x4f9c50(0xb5)][_0x4f9c50(0x92)](_0x1fe94b['guild'][_0x4f9c50(0xa1)][_0x4f9c50(0xb6)],_0x4f9c50(0x97),'roleNotFound'));if(_0x16a1e2['sell']>0x0){if(constants[_0x4f9c50(0xa0)](this[_0x4f9c50(0xa8)][_0x4f9c50(0x9d)])){const _0x296c73=await Role_1['default']['countDocuments']({'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x296c73>=constants[_0x4f9c50(0xc3)][_0x4f9c50(0x8b)]){const _0x438b18=await omnic['fetchPremiumTier'](_0x1fe94b[_0x4f9c50(0xc5)])[_0x4f9c50(0xcc)](()=>{});if(_0x438b18){if(_0x438b18===omnic[_0x4f9c50(0xa7)][_0x4f9c50(0x96)]&&_0x296c73>=constants[_0x4f9c50(0xc3)][_0x4f9c50(0x96)][_0x4f9c50(0x8b)])throw new errors[(_0x4f9c50(0xbe))](errors[_0x4f9c50(0x99)][_0x4f9c50(0xca)],this['client']['locale'][_0x4f9c50(0x92)](_0x1fe94b['guild'][_0x4f9c50(0xa1)][_0x4f9c50(0xb6)],_0x4f9c50(0x97),_0x4f9c50(0x9c),constants[_0x4f9c50(0xc3)][_0x4f9c50(0x96)][_0x4f9c50(0x8b)]));else{if(_0x438b18===omnic[_0x4f9c50(0xa7)]['PLATINUM']&&_0x296c73>=constants[_0x4f9c50(0xc3)][_0x4f9c50(0x98)][_0x4f9c50(0x8b)])throw new errors[(_0x4f9c50(0xbe))](errors[_0x4f9c50(0x99)][_0x4f9c50(0xca)],this[_0x4f9c50(0xa8)][_0x4f9c50(0xb5)]['getString'](_0x1fe94b[_0x4f9c50(0xc5)][_0x4f9c50(0xa1)][_0x4f9c50(0xb6)],_0x4f9c50(0x97),'membershipLimitPaidRoles',constants[_0x4f9c50(0xc3)][_0x4f9c50(0x98)][_0x4f9c50(0x8b)]));}}else throw new errors[(_0x4f9c50(0xbe))](errors[_0x4f9c50(0x99)]['PREMIUM_MEMBERSHIP_REQUIRED'],this['client'][_0x4f9c50(0xb5)][_0x4f9c50(0x92)](_0x1fe94b[_0x4f9c50(0xc5)]['document'][_0x4f9c50(0xb6)],'errors',_0x4f9c50(0xd4),constants[_0x4f9c50(0xc3)]['PAID_ROLES']));}}if(!_0x1fe94b[_0x4f9c50(0xcd)]['permissions'][_0x4f9c50(0xd2)]('MANAGE_ROLES'))throw new Error(_0x4f9c50(0x8e));return await Role_1[_0x4f9c50(0xad)][_0x4f9c50(0xce)]({'_id':_0x5d9fd5['id'],'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id']},{'_id':_0x5d9fd5['id'],'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'price':_0x16a1e2[_0x4f9c50(0xb4)]},{'upsert':!![]}),await _0x1fe94b[_0x4f9c50(0x9b)][_0x4f9c50(0x91)]({'embed':{'color':tesseract_1[_0x4f9c50(0x8d)][_0x4f9c50(0x93)][_0x4f9c50(0xc9)],'description':this[_0x4f9c50(0xa8)][_0x4f9c50(0xb5)][_0x4f9c50(0x92)](_0x1fe94b[_0x4f9c50(0xc5)][_0x4f9c50(0xa1)][_0x4f9c50(0xb6)],_0x4f9c50(0xa5),_0x4f9c50(0xc7),_0x1fe94b[_0x4f9c50(0xb1)]['tag'],_0x5d9fd5[_0x4f9c50(0xb9)],_0x16a1e2[_0x4f9c50(0xb4)])}})[_0x4f9c50(0xcc)](()=>{});}if(_0x16a1e2[_0x4f9c50(0xbb)]){if(_0x1fe94b[_0x4f9c50(0xcd)]['roles']['cache'][_0x4f9c50(0xd2)](_0x5d9fd5['id']))throw new Error(_0x4f9c50(0xa4));const _0x3ffa30=await Role_1[_0x4f9c50(0xad)][_0x4f9c50(0xb2)]({'_id':_0x5d9fd5['id'],'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3ffa30)throw new Error(_0x4f9c50(0xc2));if(_0x1fe94b[_0x4f9c50(0xcd)]['document'][_0x4f9c50(0xc6)]<_0x3ffa30[_0x4f9c50(0xba)])throw new Error('INSUFFICIENT_BALANCE');return await _0x1fe94b[_0x4f9c50(0xcd)][_0x4f9c50(0x94)]['add'](_0x5d9fd5),_0x1fe94b[_0x4f9c50(0xcd)][_0x4f9c50(0x9a)](_0x3ffa30[_0x4f9c50(0xba)],_0x4f9c50(0xac),_0x1fe94b[_0x4f9c50(0xcd)][_0x4f9c50(0xa1)]),await _0x1fe94b[_0x4f9c50(0xcd)][_0x4f9c50(0xa1)][_0x4f9c50(0x8c)](),await _0x1fe94b[_0x4f9c50(0x9b)]['send']({'embed':{'color':tesseract_1[_0x4f9c50(0x8d)][_0x4f9c50(0x93)][_0x4f9c50(0xc9)],'description':this[_0x4f9c50(0xa8)][_0x4f9c50(0xb5)][_0x4f9c50(0x92)](_0x1fe94b[_0x4f9c50(0xc5)][_0x4f9c50(0xa1)]['language'],'info',_0x4f9c50(0xd3),_0x1fe94b[_0x4f9c50(0xb1)][_0x4f9c50(0xd0)],_0x5d9fd5[_0x4f9c50(0xb9)],_0x3ffa30[_0x4f9c50(0xba)])}})['catch'](()=>{});}if(_0x16a1e2[_0x4f9c50(0xc4)]){if(!_0x1fe94b[_0x4f9c50(0xcd)][_0x4f9c50(0x90)][_0x4f9c50(0xd2)](_0x4f9c50(0xae)))throw new Error(_0x4f9c50(0x8e));return await Role_1[_0x4f9c50(0xad)][_0x4f9c50(0xce)]({'_id':_0x5d9fd5['id'],'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x5d9fd5['id'],'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'$unset':{'price':0x1}}),await _0x1fe94b[_0x4f9c50(0x9b)]['send']({'embed':{'color':tesseract_1[_0x4f9c50(0x8d)][_0x4f9c50(0x93)]['RED'],'description':this[_0x4f9c50(0xa8)][_0x4f9c50(0xb5)][_0x4f9c50(0x92)](_0x1fe94b[_0x4f9c50(0xc5)][_0x4f9c50(0xa1)][_0x4f9c50(0xb6)],_0x4f9c50(0xa5),'roleStoreRemove',_0x1fe94b[_0x4f9c50(0xb1)]['tag'],_0x5d9fd5[_0x4f9c50(0xb9)])}})[_0x4f9c50(0xcc)](()=>{});}}const _0x3380b7=await Role_1[_0x4f9c50(0xad)][_0x4f9c50(0xc8)]({'guild':_0x1fe94b[_0x4f9c50(0xc5)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3380b7[_0x4f9c50(0x9e)])throw new Error(_0x4f9c50(0x8f));return await _0x1fe94b[_0x4f9c50(0x9b)][_0x4f9c50(0x91)]({'embed':{'color':tesseract_1['Constants']['COLORS'][_0x4f9c50(0xaa)],'title':_0x4f9c50(0xbc),'fields':_0x3380b7[_0x4f9c50(0xa3)](_0x44542e=>({'name':(_0x1fe94b[_0x4f9c50(0xc5)]['roles'][_0x4f9c50(0xa9)][_0x4f9c50(0xd2)](_0x44542e[_0x4f9c50(0xd1)])?_0x1fe94b[_0x4f9c50(0xc5)]['roles'][_0x4f9c50(0xa9)][_0x4f9c50(0xc0)](_0x44542e[_0x4f9c50(0xd1)])[_0x4f9c50(0xb9)]+_0x4f9c50(0xa2):'')+_0x44542e[_0x4f9c50(0xd1)],'value':_0x44542e[_0x4f9c50(0xba)]+'\x20Bastion\x20Coins'}))}})['catch'](()=>{});};}};