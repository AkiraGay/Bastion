const a73_0x3650=['isPublicBastion','ROLE_NOT_FOR_SALE','test','PremiumTier','../../utils/omnic','error','Roles\x20Store','channel','guild','COLORS','clamp','\x20/\x20','IRIS','ROLE_ALREADY_ASSIGNED','price','../../utils/errors','join','NO_PERMISSION','Command','roleStoreRemove','member','tag','user','getString','resolver','document','PREMIUM_MEMBERSHIP_REQUIRED','_id','BASTION_ERROR_TYPE','../../models/Role','unlist','roleStoreAdd','findOne','length','get','countDocuments','locale','errors','PAID_ROLES','client','roles','buy','GOLD','roleStore\x20ROLE\x20--buy','info','Constants','Paid\x20Role','exports','language','\x20Bastion\x20Coins','map','findOneAndUpdate','INSUFFICIENT_BALANCE','GREEN','exec','LIMITS','permissions','NO_ROLES_ON_SALE','PLATINUM','DiscordError','default','find','catch','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','author','roleBought','balance','name','MAX_SAFE_INTEGER','send','membershipLimitPaidRoles','roleStore','cache','../../utils/numbers','sell','MANAGE_ROLES','apply','constructor','RED','has','save'];(function(_0x4a7466,_0x36509c){const _0x1c987c=function(_0x27a666){while(--_0x27a666){_0x4a7466['push'](_0x4a7466['shift']());}},_0x2bdc14=function(){const _0x5ac482={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x490949,_0x481d84,_0x90354f,_0x4cc430){_0x4cc430=_0x4cc430||{};let _0x29829e=_0x481d84+'='+_0x90354f,_0x5e38d0=0x0;for(let _0x4ecbfb=0x0,_0x49a9df=_0x490949['length'];_0x4ecbfb<_0x49a9df;_0x4ecbfb++){const _0x2400a7=_0x490949[_0x4ecbfb];_0x29829e+=';\x20'+_0x2400a7;const _0x20c12c=_0x490949[_0x2400a7];_0x490949['push'](_0x20c12c),_0x49a9df=_0x490949['length'],_0x20c12c!==!![]&&(_0x29829e+='='+_0x20c12c);}_0x4cc430['cookie']=_0x29829e;},'removeCookie':function(){return'dev';},'getCookie':function(_0x58b1db,_0xe3b0b5){_0x58b1db=_0x58b1db||function(_0x478482){return _0x478482;};const _0x4e974a=_0x58b1db(new RegExp('(?:^|;\x20)'+_0xe3b0b5['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x2dbca7=function(_0x4b0dca,_0x4314cd){_0x4b0dca(++_0x4314cd);};return _0x2dbca7(_0x1c987c,_0x36509c),_0x4e974a?decodeURIComponent(_0x4e974a[0x1]):undefined;}},_0x423c81=function(){const _0xb12bee=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xb12bee['test'](_0x5ac482['removeCookie']['toString']());};_0x5ac482['updateCookie']=_0x423c81;let _0x593124='';const _0x267593=_0x5ac482['updateCookie']();if(!_0x267593)_0x5ac482['setCookie'](['*'],'counter',0x1);else _0x267593?_0x593124=_0x5ac482['getCookie'](null,'counter'):_0x5ac482['removeCookie']();};_0x2bdc14();}(a73_0x3650,0x77));const a73_0x1c98=function(_0x4a7466,_0x36509c){_0x4a7466=_0x4a7466-0x0;let _0x1c987c=a73_0x3650[_0x4a7466];return _0x1c987c;};const a73_0x90354f=function(){let _0x5d5626=!![];return function(_0x27e26e,_0x2cf5ca){const _0x779b43=_0x5d5626?function(){if(_0x2cf5ca){const _0xd7ac3d=_0x2cf5ca[a73_0x1c98('0x26')](_0x27e26e,arguments);return _0x2cf5ca=null,_0xd7ac3d;}}:function(){};return _0x5d5626=![],_0x779b43;};}(),a73_0x481d84=a73_0x90354f(this,function(){const _0x2ecc8e=function(){const _0x2269b8=_0x2ecc8e[a73_0x1c98('0x27')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](a73_0x1c98('0x19'));return!_0x2269b8[a73_0x1c98('0x2d')](a73_0x481d84);};return _0x2ecc8e();});a73_0x481d84();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require(a73_0x1c98('0x48')),constants=require('../../utils/constants'),errors=require(a73_0x1c98('0x3a')),numbers=require(a73_0x1c98('0x23')),omnic=require(a73_0x1c98('0x2f'));module[a73_0x1c98('0x9')]=class RoleStoreCommand extends tesseract_1[a73_0x1c98('0x3d')]{constructor(){super('roleStore',{'description':'It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','triggers':[],'arguments':{'boolean':[a73_0x1c98('0x3'),'unlist'],'number':[a73_0x1c98('0x24')],'coerce':{'sell':_0x2fde8f=>numbers[a73_0x1c98('0x35')](_0x2fde8f,0x1,Number[a73_0x1c98('0x1e')])}},'scope':a73_0x1c98('0x33'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a73_0x1c98('0x25')],'userPermissions':[],'syntax':[a73_0x1c98('0x21'),'roleStore\x20ROLE\x20--sell\x20AMOUNT',a73_0x1c98('0x5'),'roleStore\x20ROLE\x20--unlist']}),this[a73_0x1c98('0x10')]=async(_0x338ed5,_0x480b1a)=>{if(_0x480b1a['_'][a73_0x1c98('0x4c')]){const _0x2ea81c=this['client'][a73_0x1c98('0x43')]['resolveRole'](_0x338ed5['guild'],_0x480b1a['_'][a73_0x1c98('0x3b')]('\x20'));if(!_0x2ea81c)throw new errors[(a73_0x1c98('0x15'))](errors[a73_0x1c98('0x47')]['ROLE_NOT_FOUND'],this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')]['getString'](_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x44')][a73_0x1c98('0xa')],a73_0x1c98('0x30'),'roleNotFound'));if(_0x480b1a[a73_0x1c98('0x24')]>0x0){if(constants[a73_0x1c98('0x2b')](this[a73_0x1c98('0x1')][a73_0x1c98('0x41')])){const _0x25165c=await Role_1[a73_0x1c98('0x16')][a73_0x1c98('0x4e')]({'guild':_0x338ed5['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(_0x25165c>=constants[a73_0x1c98('0x11')][a73_0x1c98('0x0')]){const _0x2f38fd=await omnic['fetchPremiumTier'](_0x338ed5[a73_0x1c98('0x33')])[a73_0x1c98('0x18')](()=>{});if(_0x2f38fd){if(_0x2f38fd===omnic[a73_0x1c98('0x2e')][a73_0x1c98('0x4')]&&_0x25165c>=constants['LIMITS'][a73_0x1c98('0x4')]['PAID_ROLES'])throw new errors[(a73_0x1c98('0x15'))](errors[a73_0x1c98('0x47')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')][a73_0x1c98('0x42')](_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x44')]['language'],a73_0x1c98('0x50'),a73_0x1c98('0x20'),constants[a73_0x1c98('0x11')]['GOLD']['PAID_ROLES']));else{if(_0x2f38fd===omnic[a73_0x1c98('0x2e')][a73_0x1c98('0x14')]&&_0x25165c>=constants['LIMITS'][a73_0x1c98('0x14')]['PAID_ROLES'])throw new errors['DiscordError'](errors[a73_0x1c98('0x47')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')]['getString'](_0x338ed5['guild'][a73_0x1c98('0x44')][a73_0x1c98('0xa')],'errors',a73_0x1c98('0x20'),constants['LIMITS'][a73_0x1c98('0x14')][a73_0x1c98('0x0')]));}}else throw new errors[(a73_0x1c98('0x15'))](errors['BASTION_ERROR_TYPE'][a73_0x1c98('0x45')],this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')]['getString'](_0x338ed5[a73_0x1c98('0x33')]['document'][a73_0x1c98('0xa')],a73_0x1c98('0x50'),'premiumPaidRoles',constants['LIMITS'][a73_0x1c98('0x0')]));}}if(!_0x338ed5['member'][a73_0x1c98('0x12')][a73_0x1c98('0x29')]('MANAGE_ROLES'))throw new Error(a73_0x1c98('0x3c'));return await Role_1['default'][a73_0x1c98('0xd')]({'_id':_0x2ea81c['id'],'guild':_0x338ed5[a73_0x1c98('0x33')]['id']},{'_id':_0x2ea81c['id'],'guild':_0x338ed5[a73_0x1c98('0x33')]['id'],'price':_0x480b1a[a73_0x1c98('0x24')]},{'upsert':!![]}),await _0x338ed5[a73_0x1c98('0x32')][a73_0x1c98('0x1f')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a73_0x1c98('0xf')],'description':this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')][a73_0x1c98('0x42')](_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x44')][a73_0x1c98('0xa')],a73_0x1c98('0x6'),a73_0x1c98('0x4a'),_0x338ed5[a73_0x1c98('0x1a')][a73_0x1c98('0x40')],_0x2ea81c[a73_0x1c98('0x1d')],_0x480b1a[a73_0x1c98('0x24')])}})[a73_0x1c98('0x18')](()=>{});}if(_0x480b1a['buy']){if(_0x338ed5[a73_0x1c98('0x3f')][a73_0x1c98('0x2')][a73_0x1c98('0x22')][a73_0x1c98('0x29')](_0x2ea81c['id']))throw new Error(a73_0x1c98('0x38'));const _0x39a3bb=await Role_1['default'][a73_0x1c98('0x4b')]({'_id':_0x2ea81c['id'],'guild':_0x338ed5['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x39a3bb)throw new Error(a73_0x1c98('0x2c'));if(_0x338ed5[a73_0x1c98('0x3f')][a73_0x1c98('0x44')][a73_0x1c98('0x1c')]<_0x39a3bb[a73_0x1c98('0x39')])throw new Error(a73_0x1c98('0xe'));return await _0x338ed5[a73_0x1c98('0x3f')]['roles']['add'](_0x2ea81c),_0x338ed5['member']['debit'](_0x39a3bb[a73_0x1c98('0x39')],a73_0x1c98('0x8'),_0x338ed5[a73_0x1c98('0x3f')][a73_0x1c98('0x44')]),await _0x338ed5[a73_0x1c98('0x3f')]['document'][a73_0x1c98('0x2a')](),await _0x338ed5[a73_0x1c98('0x32')][a73_0x1c98('0x1f')]({'embed':{'color':tesseract_1[a73_0x1c98('0x7')][a73_0x1c98('0x34')]['GREEN'],'description':this[a73_0x1c98('0x1')][a73_0x1c98('0x4f')][a73_0x1c98('0x42')](_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x44')][a73_0x1c98('0xa')],a73_0x1c98('0x6'),a73_0x1c98('0x1b'),_0x338ed5[a73_0x1c98('0x1a')][a73_0x1c98('0x40')],_0x2ea81c['name'],_0x39a3bb[a73_0x1c98('0x39')])}})[a73_0x1c98('0x18')](()=>{});}if(_0x480b1a[a73_0x1c98('0x49')]){if(!_0x338ed5[a73_0x1c98('0x3f')]['permissions'][a73_0x1c98('0x29')](a73_0x1c98('0x25')))throw new Error(a73_0x1c98('0x3c'));return await Role_1['default'][a73_0x1c98('0xd')]({'_id':_0x2ea81c['id'],'guild':_0x338ed5[a73_0x1c98('0x33')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x2ea81c['id'],'guild':_0x338ed5[a73_0x1c98('0x33')]['id'],'$unset':{'price':0x1}}),await _0x338ed5[a73_0x1c98('0x32')][a73_0x1c98('0x1f')]({'embed':{'color':tesseract_1[a73_0x1c98('0x7')][a73_0x1c98('0x34')][a73_0x1c98('0x28')],'description':this[a73_0x1c98('0x1')]['locale'][a73_0x1c98('0x42')](_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x44')][a73_0x1c98('0xa')],a73_0x1c98('0x6'),a73_0x1c98('0x3e'),_0x338ed5[a73_0x1c98('0x1a')]['tag'],_0x2ea81c[a73_0x1c98('0x1d')])}})[a73_0x1c98('0x18')](()=>{});}}const _0x4b68e6=await Role_1['default'][a73_0x1c98('0x17')]({'guild':_0x338ed5[a73_0x1c98('0x33')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4b68e6['length'])throw new Error(a73_0x1c98('0x13'));return await _0x338ed5['channel'][a73_0x1c98('0x1f')]({'embed':{'color':tesseract_1[a73_0x1c98('0x7')][a73_0x1c98('0x34')][a73_0x1c98('0x37')],'title':a73_0x1c98('0x31'),'fields':_0x4b68e6[a73_0x1c98('0xc')](_0x106756=>({'name':(_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x2')][a73_0x1c98('0x22')][a73_0x1c98('0x29')](_0x106756['_id'])?_0x338ed5[a73_0x1c98('0x33')][a73_0x1c98('0x2')]['cache'][a73_0x1c98('0x4d')](_0x106756[a73_0x1c98('0x46')])[a73_0x1c98('0x1d')]+a73_0x1c98('0x36'):'')+_0x106756[a73_0x1c98('0x46')],'value':_0x106756[a73_0x1c98('0x39')]+a73_0x1c98('0xb')}))}})[a73_0x1c98('0x18')](()=>{});};}};