const a69_0xf7f0=['locale','../../utils/numbers','NO_ROLES_ON_SALE','price','resolver','add','constructor','join','document','findOneAndUpdate','COLORS','GOLD','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','clamp','apply','roleNotFound','roleBought','balance','getString','roleStore\x20ROLE\x20--buy','name','roles','PremiumTier','debit','NO_PERMISSION','IRIS','sell','Paid\x20Role','default','cache','buy','ROLE_NOT_FOR_SALE','PLATINUM','get','guild','membershipLimitPaidRoles','info','DiscordError','PAID_ROLES','roleStoreAdd','roleStore','_id','permissions','language','Command','INSUFFICIENT_BALANCE','compile','../../models/Role','Roles\x20Store','tag','LIMITED_PREMIUM_MEMBERSHIP','roleStore\x20ROLE\x20--unlist','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','client','has','\x20/\x20','findOne','member','unlist','Constants','\x20Bastion\x20Coins','save','channel','return\x20/\x22\x20+\x20this\x20+\x20\x22/','RED','catch','exports','premiumPaidRoles','send','LIMITS','length','../../utils/omnic','exec','author','MAX_SAFE_INTEGER','map','BASTION_ERROR_TYPE','errors','GREEN','MANAGE_ROLES'];(function(_0x46f076,_0xf7f020){const _0x347831=function(_0x18624f){while(--_0x18624f){_0x46f076['push'](_0x46f076['shift']());}};const _0x2528ed=function(){const _0x470cfb={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x39b239,_0x18837a,_0x20339d,_0x5eeaf0){_0x5eeaf0=_0x5eeaf0||{};let _0x5e2aac=_0x18837a+'='+_0x20339d;let _0x37a214=0x0;for(let _0x4f74fc=0x0,_0x590ef7=_0x39b239['length'];_0x4f74fc<_0x590ef7;_0x4f74fc++){const _0x7f94be=_0x39b239[_0x4f74fc];_0x5e2aac+=';\x20'+_0x7f94be;const _0x30b5f3=_0x39b239[_0x7f94be];_0x39b239['push'](_0x30b5f3);_0x590ef7=_0x39b239['length'];if(_0x30b5f3!==!![]){_0x5e2aac+='='+_0x30b5f3;}}_0x5eeaf0['cookie']=_0x5e2aac;},'removeCookie':function(){return'dev';},'getCookie':function(_0x2da1ac,_0xb142bf){_0x2da1ac=_0x2da1ac||function(_0x327159){return _0x327159;};const _0x2dc586=_0x2da1ac(new RegExp('(?:^|;\x20)'+_0xb142bf['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x45429f=function(_0x486cc6,_0x56e28d){_0x486cc6(++_0x56e28d);};_0x45429f(_0x347831,_0xf7f020);return _0x2dc586?decodeURIComponent(_0x2dc586[0x1]):undefined;}};const _0x19ac17=function(){const _0x2cf2d9=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2cf2d9['test'](_0x470cfb['removeCookie']['toString']());};_0x470cfb['updateCookie']=_0x19ac17;let _0x1de0c3='';const _0x45f792=_0x470cfb['updateCookie']();if(!_0x45f792){_0x470cfb['setCookie'](['*'],'counter',0x1);}else if(_0x45f792){_0x1de0c3=_0x470cfb['getCookie'](null,'counter');}else{_0x470cfb['removeCookie']();}};_0x2528ed();}(a69_0xf7f0,0x18e));const a69_0x3478=function(_0x46f076,_0xf7f020){_0x46f076=_0x46f076-0x0;let _0x347831=a69_0xf7f0[_0x46f076];return _0x347831;};const a69_0x470cfb=function(){let _0x4299c4=!![];return function(_0x314adb,_0x4014b4){const _0x434732=_0x4299c4?function(){if(_0x4014b4){const _0x22ebc8=_0x4014b4[a69_0x3478('0x10')](_0x314adb,arguments);_0x4014b4=null;return _0x22ebc8;}}:function(){};_0x4299c4=![];return _0x434732;};}();const a69_0x18624f=a69_0x470cfb(this,function(){const _0x4927f7=function(){const _0x2195e7=_0x4927f7[a69_0x3478('0x8')](a69_0x3478('0x41'))()[a69_0x3478('0x30')](a69_0x3478('0x36'));return!_0x2195e7['test'](a69_0x18624f);};return _0x4927f7();});a69_0x18624f();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require(a69_0x3478('0x31'));const constants=require('../../utils/constants');const errors=require('../../utils/errors');const numbers=require(a69_0x3478('0x3'));const omnic=require(a69_0x3478('0x49'));module[a69_0x3478('0x44')]=class RoleStoreCommand extends tesseract_1[a69_0x3478('0x2e')]{constructor(){super(a69_0x3478('0x2a'),{'description':a69_0x3478('0xe'),'triggers':[],'arguments':{'boolean':[a69_0x3478('0x20'),'unlist'],'number':['sell'],'coerce':{'sell':_0x1da9d4=>numbers[a69_0x3478('0xf')](_0x1da9d4,0x1,Number[a69_0x3478('0x4c')])}},'scope':a69_0x3478('0x24'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a69_0x3478('0x1')],'userPermissions':[],'syntax':[a69_0x3478('0x2a'),'roleStore\x20ROLE\x20--sell\x20AMOUNT',a69_0x3478('0x15'),a69_0x3478('0x35')]});this[a69_0x3478('0x4a')]=async(_0x38c7a9,_0x5bbf2a)=>{if(_0x5bbf2a['_'][a69_0x3478('0x48')]){const _0x364624=this[a69_0x3478('0x37')][a69_0x3478('0x6')]['resolveRole'](_0x38c7a9['guild'],_0x5bbf2a['_'][a69_0x3478('0x9')]('\x20'));if(!_0x364624)throw new errors['DiscordError'](errors[a69_0x3478('0x4e')]['ROLE_NOT_FOUND'],this[a69_0x3478('0x37')]['locale']['getString'](_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0xa')][a69_0x3478('0x2d')],'error',a69_0x3478('0x11')));if(_0x5bbf2a[a69_0x3478('0x1c')]>0x0){if(constants['isPublicBastion'](this[a69_0x3478('0x37')]['user'])){const _0x25f809=await Role_1[a69_0x3478('0x1e')]['countDocuments']({'guild':_0x38c7a9['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(_0x25f809>=constants['LIMITS']['PAID_ROLES']){const _0x588c3b=await omnic['fetchPremiumTier'](_0x38c7a9['guild'])[a69_0x3478('0x43')](()=>{});if(_0x588c3b){if(_0x588c3b===omnic[a69_0x3478('0x18')][a69_0x3478('0xd')]&&_0x25f809>=constants['LIMITS'][a69_0x3478('0xd')]['PAID_ROLES']){throw new errors['DiscordError'](errors[a69_0x3478('0x4e')][a69_0x3478('0x34')],this['client'][a69_0x3478('0x2')][a69_0x3478('0x14')](_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0xa')][a69_0x3478('0x2d')],a69_0x3478('0x4f'),a69_0x3478('0x25'),constants['LIMITS'][a69_0x3478('0xd')][a69_0x3478('0x28')]));}else if(_0x588c3b===omnic[a69_0x3478('0x18')][a69_0x3478('0x22')]&&_0x25f809>=constants[a69_0x3478('0x47')][a69_0x3478('0x22')]['PAID_ROLES']){throw new errors[(a69_0x3478('0x27'))](errors[a69_0x3478('0x4e')][a69_0x3478('0x34')],this['client'][a69_0x3478('0x2')]['getString'](_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0xa')][a69_0x3478('0x2d')],'errors',a69_0x3478('0x25'),constants[a69_0x3478('0x47')][a69_0x3478('0x22')]['PAID_ROLES']));}}else{throw new errors['DiscordError'](errors[a69_0x3478('0x4e')]['PREMIUM_MEMBERSHIP_REQUIRED'],this[a69_0x3478('0x37')][a69_0x3478('0x2')][a69_0x3478('0x14')](_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0xa')]['language'],a69_0x3478('0x4f'),a69_0x3478('0x45'),constants['LIMITS'][a69_0x3478('0x28')]));}}}if(!_0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0x2c')][a69_0x3478('0x38')](a69_0x3478('0x1')))throw new Error(a69_0x3478('0x1a'));await Role_1[a69_0x3478('0x1e')][a69_0x3478('0xb')]({'_id':_0x364624['id'],'guild':_0x38c7a9[a69_0x3478('0x24')]['id']},{'_id':_0x364624['id'],'guild':_0x38c7a9[a69_0x3478('0x24')]['id'],'price':_0x5bbf2a[a69_0x3478('0x1c')]},{'upsert':!![]});return await _0x38c7a9[a69_0x3478('0x40')]['send']({'embed':{'color':tesseract_1[a69_0x3478('0x3d')]['COLORS'][a69_0x3478('0x0')],'description':this[a69_0x3478('0x37')][a69_0x3478('0x2')][a69_0x3478('0x14')](_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0xa')][a69_0x3478('0x2d')],a69_0x3478('0x26'),a69_0x3478('0x29'),_0x38c7a9[a69_0x3478('0x4b')]['tag'],_0x364624[a69_0x3478('0x16')],_0x5bbf2a[a69_0x3478('0x1c')])}})[a69_0x3478('0x43')](()=>{});}if(_0x5bbf2a[a69_0x3478('0x20')]){if(_0x38c7a9['member'][a69_0x3478('0x17')][a69_0x3478('0x1f')]['has'](_0x364624['id']))throw new Error('ROLE_ALREADY_ASSIGNED');const _0x5e014a=await Role_1[a69_0x3478('0x1e')][a69_0x3478('0x3a')]({'_id':_0x364624['id'],'guild':_0x38c7a9[a69_0x3478('0x24')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x5e014a)throw new Error(a69_0x3478('0x21'));if(_0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0xa')][a69_0x3478('0x13')]<_0x5e014a[a69_0x3478('0x5')])throw new Error(a69_0x3478('0x2f'));await _0x38c7a9[a69_0x3478('0x3b')]['roles'][a69_0x3478('0x7')](_0x364624);_0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0x19')](_0x5e014a['price'],a69_0x3478('0x1d'),_0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0xa')]);await _0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0xa')][a69_0x3478('0x3f')]();return await _0x38c7a9[a69_0x3478('0x40')][a69_0x3478('0x46')]({'embed':{'color':tesseract_1[a69_0x3478('0x3d')]['COLORS'][a69_0x3478('0x0')],'description':this[a69_0x3478('0x37')]['locale'][a69_0x3478('0x14')](_0x38c7a9['guild'][a69_0x3478('0xa')][a69_0x3478('0x2d')],a69_0x3478('0x26'),a69_0x3478('0x12'),_0x38c7a9['author'][a69_0x3478('0x33')],_0x364624['name'],_0x5bbf2a[a69_0x3478('0x1c')])}})[a69_0x3478('0x43')](()=>{});}if(_0x5bbf2a[a69_0x3478('0x3c')]){if(!_0x38c7a9[a69_0x3478('0x3b')][a69_0x3478('0x2c')][a69_0x3478('0x38')](a69_0x3478('0x1')))throw new Error('NO_PERMISSION');await Role_1[a69_0x3478('0x1e')][a69_0x3478('0xb')]({'_id':_0x364624['id'],'guild':_0x38c7a9[a69_0x3478('0x24')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x364624['id'],'guild':_0x38c7a9['guild']['id'],'$unset':{'price':0x1}});return await _0x38c7a9[a69_0x3478('0x40')][a69_0x3478('0x46')]({'embed':{'color':tesseract_1[a69_0x3478('0x3d')][a69_0x3478('0xc')][a69_0x3478('0x42')],'description':this[a69_0x3478('0x37')][a69_0x3478('0x2')][a69_0x3478('0x14')](_0x38c7a9['guild'][a69_0x3478('0xa')][a69_0x3478('0x2d')],a69_0x3478('0x26'),'roleStoreRemove',_0x38c7a9[a69_0x3478('0x4b')][a69_0x3478('0x33')],_0x364624[a69_0x3478('0x16')])}})[a69_0x3478('0x43')](()=>{});}}const _0x3af00c=await Role_1['default']['find']({'guild':_0x38c7a9[a69_0x3478('0x24')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3af00c[a69_0x3478('0x48')])throw new Error(a69_0x3478('0x4'));return await _0x38c7a9['channel'][a69_0x3478('0x46')]({'embed':{'color':tesseract_1[a69_0x3478('0x3d')]['COLORS'][a69_0x3478('0x1b')],'title':a69_0x3478('0x32'),'fields':_0x3af00c[a69_0x3478('0x4d')](_0x3af95c=>({'name':(_0x38c7a9[a69_0x3478('0x24')]['roles']['cache'][a69_0x3478('0x38')](_0x3af95c[a69_0x3478('0x2b')])?_0x38c7a9[a69_0x3478('0x24')][a69_0x3478('0x17')]['cache'][a69_0x3478('0x23')](_0x3af95c[a69_0x3478('0x2b')])[a69_0x3478('0x16')]+a69_0x3478('0x39'):'')+_0x3af95c[a69_0x3478('0x2b')],'value':_0x3af95c[a69_0x3478('0x5')]+a69_0x3478('0x3e')}))}})[a69_0x3478('0x43')](()=>{});};}};