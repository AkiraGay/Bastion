const a68_0x50ce=['roleNotFound','premiumPaidRoles','map','locale','user','length','_id','author','catch','buy','../../utils/omnic','resolveRole','MAX_SAFE_INTEGER','roleStoreAdd','findOneAndUpdate','Paid\x20Role','channel','test','apply','IRIS','send','has','roles','client','roleStore\x20ROLE\x20--unlist','price','LIMITS','Constants','PAID_ROLES','GREEN','BASTION_ERROR_TYPE','constructor','findOne','tag','PLATINUM','Roles\x20Store','PREMIUM_MEMBERSHIP_REQUIRED','ROLE_NOT_FOR_SALE','fetchPremiumTier','default','return\x20/\x22\x20+\x20this\x20+\x20\x22/','../../utils/numbers','info','roleStore','COLORS','compile','countDocuments','DiscordError','roleStore\x20ROLE\x20--buy','getString','language','error','roleBought','ROLE_ALREADY_ASSIGNED','../../models/Role','\x20Bastion\x20Coins','sell','unlist','\x20/\x20','@bastion/tesseract','GOLD','NO_PERMISSION','balance','NO_ROLES_ON_SALE','membershipLimitPaidRoles','PremiumTier','MANAGE_ROLES','ROLE_NOT_FOUND','join','member','resolver','errors','roleStore\x20ROLE\x20--sell\x20AMOUNT','document','guild','add','../../utils/errors','permissions','name','save','cache','debit','RED','LIMITED_PREMIUM_MEMBERSHIP'];(function(_0x2393da,_0x50ced2){const _0xc83509=function(_0x3eba40){while(--_0x3eba40){_0x2393da['push'](_0x2393da['shift']());}};const _0x4b6488=function(){const _0x3f789a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x15725c,_0x30c574,_0x5a627d,_0x38fc44){_0x38fc44=_0x38fc44||{};let _0x207790=_0x30c574+'='+_0x5a627d;let _0x1014c7=0x0;for(let _0x512d18=0x0,_0xf9f2a1=_0x15725c['length'];_0x512d18<_0xf9f2a1;_0x512d18++){const _0x1b2787=_0x15725c[_0x512d18];_0x207790+=';\x20'+_0x1b2787;const _0x2cf0bb=_0x15725c[_0x1b2787];_0x15725c['push'](_0x2cf0bb);_0xf9f2a1=_0x15725c['length'];if(_0x2cf0bb!==!![]){_0x207790+='='+_0x2cf0bb;}}_0x38fc44['cookie']=_0x207790;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4d6145,_0x5a6662){_0x4d6145=_0x4d6145||function(_0x47176c){return _0x47176c;};const _0x1ddb8f=_0x4d6145(new RegExp('(?:^|;\x20)'+_0x5a6662['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x47e721=function(_0x445a3d,_0x1c53cb){_0x445a3d(++_0x1c53cb);};_0x47e721(_0xc83509,_0x50ced2);return _0x1ddb8f?decodeURIComponent(_0x1ddb8f[0x1]):undefined;}};const _0x4e1d4c=function(){const _0x4c909e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4c909e['test'](_0x3f789a['removeCookie']['toString']());};_0x3f789a['updateCookie']=_0x4e1d4c;let _0xb6198e='';const _0x3b6d79=_0x3f789a['updateCookie']();if(!_0x3b6d79){_0x3f789a['setCookie'](['*'],'counter',0x1);}else if(_0x3b6d79){_0xb6198e=_0x3f789a['getCookie'](null,'counter');}else{_0x3f789a['removeCookie']();}};_0x4b6488();}(a68_0x50ce,0xf9));const a68_0xc835=function(_0x2393da,_0x50ced2){_0x2393da=_0x2393da-0x0;let _0xc83509=a68_0x50ce[_0x2393da];return _0xc83509;};const a68_0x3f789a=function(){let _0x145ddb=!![];return function(_0xb2be46,_0x20f64e){const _0x258090=_0x145ddb?function(){if(_0x20f64e){const _0x4bac9c=_0x20f64e[a68_0xc835('0x15')](_0xb2be46,arguments);_0x20f64e=null;return _0x4bac9c;}}:function(){};_0x145ddb=![];return _0x258090;};}();const a68_0x3eba40=a68_0x3f789a(this,function(){const _0x44a582=function(){const _0x4394e8=_0x44a582[a68_0xc835('0x22')](a68_0xc835('0x2b'))()[a68_0xc835('0x30')]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x4394e8[a68_0xc835('0x14')](a68_0x3eba40);};return _0x44a582();});a68_0x3eba40();'use strict';const tesseract_1=require(a68_0xc835('0x3e'));const Role_1=require(a68_0xc835('0x39'));const constants=require('../../utils/constants');const errors=require(a68_0xc835('0x4f'));const numbers=require(a68_0xc835('0x2c'));const omnic=require(a68_0xc835('0xd'));module['exports']=class RoleStoreCommand extends tesseract_1['Command']{constructor(){super(a68_0xc835('0x2e'),{'description':'It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','triggers':[],'arguments':{'boolean':[a68_0xc835('0xc'),a68_0xc835('0x3c')],'number':[a68_0xc835('0x3b')],'coerce':{'sell':_0x3fb8b8=>numbers['clamp'](_0x3fb8b8,0x1,Number[a68_0xc835('0xf')])}},'scope':a68_0xc835('0x4d'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a68_0xc835('0x45')],'userPermissions':[],'syntax':['roleStore',a68_0xc835('0x4b'),a68_0xc835('0x33'),a68_0xc835('0x1b')]});this['exec']=async(_0xc8d2cc,_0x25ee61)=>{if(_0x25ee61['_'][a68_0xc835('0x8')]){const _0x5b1602=this['client'][a68_0xc835('0x49')][a68_0xc835('0xe')](_0xc8d2cc['guild'],_0x25ee61['_'][a68_0xc835('0x47')]('\x20'));if(!_0x5b1602)throw new errors[(a68_0xc835('0x32'))](errors[a68_0xc835('0x21')][a68_0xc835('0x46')],this[a68_0xc835('0x1a')][a68_0xc835('0x6')][a68_0xc835('0x34')](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x36'),a68_0xc835('0x3')));if(_0x25ee61[a68_0xc835('0x3b')]>0x0){if(constants['isPublicBastion'](this[a68_0xc835('0x1a')][a68_0xc835('0x7')])){const _0x4bc469=await Role_1[a68_0xc835('0x2a')][a68_0xc835('0x31')]({'guild':_0xc8d2cc[a68_0xc835('0x4d')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x4bc469>=constants['LIMITS'][a68_0xc835('0x1f')]){const _0x4b237f=await omnic[a68_0xc835('0x29')](_0xc8d2cc[a68_0xc835('0x4d')])[a68_0xc835('0xb')](()=>{});if(_0x4b237f){if(_0x4b237f===omnic['PremiumTier']['GOLD']&&_0x4bc469>=constants[a68_0xc835('0x1d')][a68_0xc835('0x3f')]['PAID_ROLES']){throw new errors[(a68_0xc835('0x32'))](errors['BASTION_ERROR_TYPE'][a68_0xc835('0x2')],this[a68_0xc835('0x1a')][a68_0xc835('0x6')][a68_0xc835('0x34')](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x4a'),a68_0xc835('0x43'),constants[a68_0xc835('0x1d')][a68_0xc835('0x3f')][a68_0xc835('0x1f')]));}else if(_0x4b237f===omnic[a68_0xc835('0x44')][a68_0xc835('0x25')]&&_0x4bc469>=constants[a68_0xc835('0x1d')][a68_0xc835('0x25')][a68_0xc835('0x1f')]){throw new errors[(a68_0xc835('0x32'))](errors[a68_0xc835('0x21')][a68_0xc835('0x2')],this['client'][a68_0xc835('0x6')][a68_0xc835('0x34')](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x4a'),a68_0xc835('0x43'),constants[a68_0xc835('0x1d')]['PLATINUM'][a68_0xc835('0x1f')]));}}else{throw new errors[(a68_0xc835('0x32'))](errors[a68_0xc835('0x21')][a68_0xc835('0x27')],this[a68_0xc835('0x1a')][a68_0xc835('0x6')]['getString'](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x4a'),a68_0xc835('0x4'),constants[a68_0xc835('0x1d')][a68_0xc835('0x1f')]));}}}if(!_0xc8d2cc['member'][a68_0xc835('0x50')][a68_0xc835('0x18')]('MANAGE_ROLES'))throw new Error(a68_0xc835('0x40'));await Role_1[a68_0xc835('0x2a')][a68_0xc835('0x11')]({'_id':_0x5b1602['id'],'guild':_0xc8d2cc[a68_0xc835('0x4d')]['id']},{'_id':_0x5b1602['id'],'guild':_0xc8d2cc[a68_0xc835('0x4d')]['id'],'price':_0x25ee61[a68_0xc835('0x3b')]},{'upsert':!![]});return await _0xc8d2cc['channel'][a68_0xc835('0x17')]({'embed':{'color':tesseract_1[a68_0xc835('0x1e')][a68_0xc835('0x2f')][a68_0xc835('0x20')],'description':this[a68_0xc835('0x1a')]['locale']['getString'](_0xc8d2cc[a68_0xc835('0x4d')]['document'][a68_0xc835('0x35')],a68_0xc835('0x2d'),a68_0xc835('0x10'),_0xc8d2cc[a68_0xc835('0xa')][a68_0xc835('0x24')],_0x5b1602['name'],_0x25ee61[a68_0xc835('0x3b')])}})[a68_0xc835('0xb')](()=>{});}if(_0x25ee61[a68_0xc835('0xc')]){if(_0xc8d2cc[a68_0xc835('0x48')]['roles'][a68_0xc835('0x53')]['has'](_0x5b1602['id']))throw new Error(a68_0xc835('0x38'));const _0x4828ec=await Role_1[a68_0xc835('0x2a')][a68_0xc835('0x23')]({'_id':_0x5b1602['id'],'guild':_0xc8d2cc['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4828ec)throw new Error(a68_0xc835('0x28'));if(_0xc8d2cc[a68_0xc835('0x48')][a68_0xc835('0x4c')][a68_0xc835('0x41')]<_0x4828ec[a68_0xc835('0x1c')])throw new Error('INSUFFICIENT_BALANCE');await _0xc8d2cc['member']['roles'][a68_0xc835('0x4e')](_0x5b1602);_0xc8d2cc[a68_0xc835('0x48')][a68_0xc835('0x0')](_0x4828ec[a68_0xc835('0x1c')],a68_0xc835('0x12'),_0xc8d2cc[a68_0xc835('0x48')]['document']);await _0xc8d2cc[a68_0xc835('0x48')][a68_0xc835('0x4c')][a68_0xc835('0x52')]();return await _0xc8d2cc[a68_0xc835('0x13')][a68_0xc835('0x17')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a68_0xc835('0x20')],'description':this[a68_0xc835('0x1a')]['locale']['getString'](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x2d'),a68_0xc835('0x37'),_0xc8d2cc[a68_0xc835('0xa')][a68_0xc835('0x24')],_0x5b1602['name'],_0x25ee61[a68_0xc835('0x3b')])}})['catch'](()=>{});}if(_0x25ee61[a68_0xc835('0x3c')]){if(!_0xc8d2cc['member'][a68_0xc835('0x50')][a68_0xc835('0x18')](a68_0xc835('0x45')))throw new Error(a68_0xc835('0x40'));await Role_1[a68_0xc835('0x2a')][a68_0xc835('0x11')]({'_id':_0x5b1602['id'],'guild':_0xc8d2cc['guild']['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x5b1602['id'],'guild':_0xc8d2cc[a68_0xc835('0x4d')]['id'],'$unset':{'price':0x1}});return await _0xc8d2cc[a68_0xc835('0x13')][a68_0xc835('0x17')]({'embed':{'color':tesseract_1[a68_0xc835('0x1e')][a68_0xc835('0x2f')][a68_0xc835('0x1')],'description':this[a68_0xc835('0x1a')][a68_0xc835('0x6')]['getString'](_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x4c')][a68_0xc835('0x35')],a68_0xc835('0x2d'),'roleStoreRemove',_0xc8d2cc[a68_0xc835('0xa')][a68_0xc835('0x24')],_0x5b1602[a68_0xc835('0x51')])}})[a68_0xc835('0xb')](()=>{});}}const _0x4a4b0e=await Role_1[a68_0xc835('0x2a')]['find']({'guild':_0xc8d2cc[a68_0xc835('0x4d')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4a4b0e[a68_0xc835('0x8')])throw new Error(a68_0xc835('0x42'));return await _0xc8d2cc['channel'][a68_0xc835('0x17')]({'embed':{'color':tesseract_1[a68_0xc835('0x1e')][a68_0xc835('0x2f')][a68_0xc835('0x16')],'title':a68_0xc835('0x26'),'fields':_0x4a4b0e[a68_0xc835('0x5')](_0x3a7f1f=>({'name':(_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x19')]['cache']['has'](_0x3a7f1f[a68_0xc835('0x9')])?_0xc8d2cc[a68_0xc835('0x4d')][a68_0xc835('0x19')][a68_0xc835('0x53')]['get'](_0x3a7f1f[a68_0xc835('0x9')])[a68_0xc835('0x51')]+a68_0xc835('0x3d'):'')+_0x3a7f1f['_id'],'value':_0x3a7f1f[a68_0xc835('0x1c')]+a68_0xc835('0x3a')}))}})[a68_0xc835('0xb')](()=>{});};}};