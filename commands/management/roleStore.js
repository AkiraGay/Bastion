const a69_0x5d0c=['roleStore','name','roleStore\x20ROLE\x20--unlist','sell','LIMITED_PREMIUM_MEMBERSHIP','resolver','tag','join','Constants','debit','buy','roles','NO_PERMISSION','PREMIUM_MEMBERSHIP_REQUIRED','user','guild','channel','GOLD','locale','findOneAndUpdate','isPublicBastion','has','resolveRole','membershipLimitPaidRoles','info','COLORS','return\x20/\x22\x20+\x20this\x20+\x20\x22/','@bastion/tesseract','catch','IRIS','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','cache','clamp','member','countDocuments','GREEN','save','premiumPaidRoles','author','ROLE_NOT_FOUND','roleBought','length','DiscordError','client','getString','language','PAID_ROLES','find','Paid\x20Role','roleStoreRemove','constructor','roleStoreAdd','../../utils/constants','PLATINUM','../../utils/omnic','../../utils/numbers','_id','unlist','PremiumTier','default','LIMITS','map','MANAGE_ROLES','send','apply','get','fetchPremiumTier','price','permissions','Roles\x20Store','document','errors','balance','MAX_SAFE_INTEGER','BASTION_ERROR_TYPE','../../utils/errors'];(function(_0x127462,_0x5d0ceb){const _0x3a7f8b=function(_0x1887eb){while(--_0x1887eb){_0x127462['push'](_0x127462['shift']());}};const _0x2d2cc9=function(){const _0x1fae54={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2610a3,_0x5494cd,_0x1aabde,_0x4a0d84){_0x4a0d84=_0x4a0d84||{};let _0x234e7b=_0x5494cd+'='+_0x1aabde;let _0x5acfd8=0x0;for(let _0x3744fc=0x0,_0x407a10=_0x2610a3['length'];_0x3744fc<_0x407a10;_0x3744fc++){const _0x149040=_0x2610a3[_0x3744fc];_0x234e7b+=';\x20'+_0x149040;const _0x47092f=_0x2610a3[_0x149040];_0x2610a3['push'](_0x47092f);_0x407a10=_0x2610a3['length'];if(_0x47092f!==!![]){_0x234e7b+='='+_0x47092f;}}_0x4a0d84['cookie']=_0x234e7b;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5434e8,_0x4a4c2e){_0x5434e8=_0x5434e8||function(_0x468598){return _0x468598;};const _0x61b03d=_0x5434e8(new RegExp('(?:^|;\x20)'+_0x4a4c2e['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x5eb3bf=function(_0x4749f1,_0x32eb01){_0x4749f1(++_0x32eb01);};_0x5eb3bf(_0x3a7f8b,_0x5d0ceb);return _0x61b03d?decodeURIComponent(_0x61b03d[0x1]):undefined;}};const _0x5c30fa=function(){const _0x36ab50=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x36ab50['test'](_0x1fae54['removeCookie']['toString']());};_0x1fae54['updateCookie']=_0x5c30fa;let _0x38b6db='';const _0x1b98a1=_0x1fae54['updateCookie']();if(!_0x1b98a1){_0x1fae54['setCookie'](['*'],'counter',0x1);}else if(_0x1b98a1){_0x38b6db=_0x1fae54['getCookie'](null,'counter');}else{_0x1fae54['removeCookie']();}};_0x2d2cc9();}(a69_0x5d0c,0x68));const a69_0x3a7f=function(_0x127462,_0x5d0ceb){_0x127462=_0x127462-0x0;let _0x3a7f8b=a69_0x5d0c[_0x127462];return _0x3a7f8b;};const a69_0x1fae54=function(){let _0x6b5877=!![];return function(_0x280d89,_0x3177f5){const _0x2c2bc6=_0x6b5877?function(){if(_0x3177f5){const _0x5a5800=_0x3177f5[a69_0x3a7f('0x24')](_0x280d89,arguments);_0x3177f5=null;return _0x5a5800;}}:function(){};_0x6b5877=![];return _0x2c2bc6;};}();const a69_0x1887eb=a69_0x1fae54(this,function(){const _0x23e259=function(){const _0x58f184=_0x23e259[a69_0x3a7f('0x16')](a69_0x3a7f('0x4a'))()['compile'](a69_0x3a7f('0x2'));return!_0x58f184['test'](a69_0x1887eb);};return _0x23e259();});a69_0x1887eb();'use strict';const tesseract_1=require(a69_0x3a7f('0x4b'));const Role_1=require('../../models/Role');const constants=require(a69_0x3a7f('0x18'));const errors=require(a69_0x3a7f('0x2f'));const numbers=require(a69_0x3a7f('0x1b'));const omnic=require(a69_0x3a7f('0x1a'));module['exports']=class RoleStoreCommand extends tesseract_1['Command']{constructor(){super(a69_0x3a7f('0x30'),{'description':'It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','triggers':[],'arguments':{'boolean':[a69_0x3a7f('0x3a'),a69_0x3a7f('0x1d')],'number':[a69_0x3a7f('0x33')],'coerce':{'sell':_0x1cd04c=>numbers[a69_0x3a7f('0x4')](_0x1cd04c,0x1,Number[a69_0x3a7f('0x2d')])}},'scope':a69_0x3a7f('0x3f'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a69_0x3a7f('0x22')],'userPermissions':[],'syntax':['roleStore','roleStore\x20ROLE\x20--sell\x20AMOUNT','roleStore\x20ROLE\x20--buy',a69_0x3a7f('0x32')]});this['exec']=async(_0x4869ed,_0x56ff21)=>{if(_0x56ff21['_'][a69_0x3a7f('0xd')]){const _0x298df4=this['client'][a69_0x3a7f('0x35')][a69_0x3a7f('0x46')](_0x4869ed[a69_0x3a7f('0x3f')],_0x56ff21['_'][a69_0x3a7f('0x37')]('\x20'));if(!_0x298df4)throw new errors[(a69_0x3a7f('0xe'))](errors[a69_0x3a7f('0x2e')][a69_0x3a7f('0xb')],this[a69_0x3a7f('0xf')][a69_0x3a7f('0x42')][a69_0x3a7f('0x10')](_0x4869ed[a69_0x3a7f('0x3f')]['document'][a69_0x3a7f('0x11')],'error','roleNotFound'));if(_0x56ff21[a69_0x3a7f('0x33')]>0x0){if(constants[a69_0x3a7f('0x44')](this[a69_0x3a7f('0xf')][a69_0x3a7f('0x3e')])){const _0x128311=await Role_1['default'][a69_0x3a7f('0x6')]({'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x128311>=constants['LIMITS'][a69_0x3a7f('0x12')]){const _0x33d749=await omnic[a69_0x3a7f('0x26')](_0x4869ed[a69_0x3a7f('0x3f')])[a69_0x3a7f('0x0')](()=>{});if(_0x33d749){if(_0x33d749===omnic[a69_0x3a7f('0x1e')]['GOLD']&&_0x128311>=constants[a69_0x3a7f('0x20')][a69_0x3a7f('0x41')]['PAID_ROLES']){throw new errors['DiscordError'](errors[a69_0x3a7f('0x2e')][a69_0x3a7f('0x34')],this['client'][a69_0x3a7f('0x42')]['getString'](_0x4869ed[a69_0x3a7f('0x3f')][a69_0x3a7f('0x2a')]['language'],a69_0x3a7f('0x2b'),a69_0x3a7f('0x47'),constants[a69_0x3a7f('0x20')][a69_0x3a7f('0x41')][a69_0x3a7f('0x12')]));}else if(_0x33d749===omnic[a69_0x3a7f('0x1e')][a69_0x3a7f('0x19')]&&_0x128311>=constants[a69_0x3a7f('0x20')][a69_0x3a7f('0x19')][a69_0x3a7f('0x12')]){throw new errors[(a69_0x3a7f('0xe'))](errors[a69_0x3a7f('0x2e')][a69_0x3a7f('0x34')],this[a69_0x3a7f('0xf')][a69_0x3a7f('0x42')][a69_0x3a7f('0x10')](_0x4869ed[a69_0x3a7f('0x3f')][a69_0x3a7f('0x2a')][a69_0x3a7f('0x11')],a69_0x3a7f('0x2b'),a69_0x3a7f('0x47'),constants[a69_0x3a7f('0x20')]['PLATINUM'][a69_0x3a7f('0x12')]));}}else{throw new errors[(a69_0x3a7f('0xe'))](errors[a69_0x3a7f('0x2e')][a69_0x3a7f('0x3d')],this[a69_0x3a7f('0xf')]['locale'][a69_0x3a7f('0x10')](_0x4869ed[a69_0x3a7f('0x3f')]['document'][a69_0x3a7f('0x11')],a69_0x3a7f('0x2b'),a69_0x3a7f('0x9'),constants[a69_0x3a7f('0x20')][a69_0x3a7f('0x12')]));}}}if(!_0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x28')][a69_0x3a7f('0x45')](a69_0x3a7f('0x22')))throw new Error(a69_0x3a7f('0x3c'));await Role_1[a69_0x3a7f('0x1f')][a69_0x3a7f('0x43')]({'_id':_0x298df4['id'],'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id']},{'_id':_0x298df4['id'],'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'price':_0x56ff21[a69_0x3a7f('0x33')]},{'upsert':!![]});return await _0x4869ed[a69_0x3a7f('0x40')][a69_0x3a7f('0x23')]({'embed':{'color':tesseract_1[a69_0x3a7f('0x38')][a69_0x3a7f('0x49')]['GREEN'],'description':this['client'][a69_0x3a7f('0x42')][a69_0x3a7f('0x10')](_0x4869ed[a69_0x3a7f('0x3f')]['document'][a69_0x3a7f('0x11')],a69_0x3a7f('0x48'),a69_0x3a7f('0x17'),_0x4869ed[a69_0x3a7f('0xa')][a69_0x3a7f('0x36')],_0x298df4['name'],_0x56ff21['sell'])}})[a69_0x3a7f('0x0')](()=>{});}if(_0x56ff21[a69_0x3a7f('0x3a')]){if(_0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x3b')][a69_0x3a7f('0x3')][a69_0x3a7f('0x45')](_0x298df4['id']))throw new Error('ROLE_ALREADY_ASSIGNED');const _0x1110a2=await Role_1[a69_0x3a7f('0x1f')]['findOne']({'_id':_0x298df4['id'],'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x1110a2)throw new Error('ROLE_NOT_FOR_SALE');if(_0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x2a')][a69_0x3a7f('0x2c')]<_0x1110a2['price'])throw new Error('INSUFFICIENT_BALANCE');await _0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x3b')]['add'](_0x298df4);_0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x39')](_0x1110a2[a69_0x3a7f('0x27')],a69_0x3a7f('0x14'),_0x4869ed['member'][a69_0x3a7f('0x2a')]);await _0x4869ed[a69_0x3a7f('0x5')]['document'][a69_0x3a7f('0x8')]();return await _0x4869ed['channel'][a69_0x3a7f('0x23')]({'embed':{'color':tesseract_1[a69_0x3a7f('0x38')][a69_0x3a7f('0x49')][a69_0x3a7f('0x7')],'description':this['client'][a69_0x3a7f('0x42')][a69_0x3a7f('0x10')](_0x4869ed[a69_0x3a7f('0x3f')][a69_0x3a7f('0x2a')][a69_0x3a7f('0x11')],'info',a69_0x3a7f('0xc'),_0x4869ed['author'][a69_0x3a7f('0x36')],_0x298df4[a69_0x3a7f('0x31')],_0x56ff21[a69_0x3a7f('0x33')])}})[a69_0x3a7f('0x0')](()=>{});}if(_0x56ff21[a69_0x3a7f('0x1d')]){if(!_0x4869ed[a69_0x3a7f('0x5')][a69_0x3a7f('0x28')][a69_0x3a7f('0x45')](a69_0x3a7f('0x22')))throw new Error(a69_0x3a7f('0x3c'));await Role_1[a69_0x3a7f('0x1f')][a69_0x3a7f('0x43')]({'_id':_0x298df4['id'],'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x298df4['id'],'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'$unset':{'price':0x1}});return await _0x4869ed[a69_0x3a7f('0x40')][a69_0x3a7f('0x23')]({'embed':{'color':tesseract_1[a69_0x3a7f('0x38')][a69_0x3a7f('0x49')]['RED'],'description':this[a69_0x3a7f('0xf')]['locale']['getString'](_0x4869ed['guild'][a69_0x3a7f('0x2a')][a69_0x3a7f('0x11')],a69_0x3a7f('0x48'),a69_0x3a7f('0x15'),_0x4869ed[a69_0x3a7f('0xa')][a69_0x3a7f('0x36')],_0x298df4[a69_0x3a7f('0x31')])}})[a69_0x3a7f('0x0')](()=>{});}}const _0x3e585e=await Role_1[a69_0x3a7f('0x1f')][a69_0x3a7f('0x13')]({'guild':_0x4869ed[a69_0x3a7f('0x3f')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3e585e[a69_0x3a7f('0xd')])throw new Error('NO_ROLES_ON_SALE');return await _0x4869ed[a69_0x3a7f('0x40')][a69_0x3a7f('0x23')]({'embed':{'color':tesseract_1[a69_0x3a7f('0x38')][a69_0x3a7f('0x49')][a69_0x3a7f('0x1')],'title':a69_0x3a7f('0x29'),'fields':_0x3e585e[a69_0x3a7f('0x21')](_0x2c72ca=>({'name':(_0x4869ed[a69_0x3a7f('0x3f')][a69_0x3a7f('0x3b')][a69_0x3a7f('0x3')][a69_0x3a7f('0x45')](_0x2c72ca[a69_0x3a7f('0x1c')])?_0x4869ed[a69_0x3a7f('0x3f')][a69_0x3a7f('0x3b')][a69_0x3a7f('0x3')][a69_0x3a7f('0x25')](_0x2c72ca[a69_0x3a7f('0x1c')])[a69_0x3a7f('0x31')]+'\x20/\x20':'')+_0x2c72ca['_id'],'value':_0x2c72ca[a69_0x3a7f('0x27')]+'\x20Bastion\x20Coins'}))}})[a69_0x3a7f('0x0')](()=>{});};}};