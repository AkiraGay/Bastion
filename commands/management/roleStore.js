const a68_0x2487=['NO_PERMISSION','PremiumTier','roleNotFound','DiscordError','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','test','ROLE_NOT_FOUND','channel','Constants','buy','IRIS','\x20Bastion\x20Coins','language','author','member','../../utils/errors','errors','getString','permissions','price','roleStore\x20ROLE\x20--buy','sell','GREEN','user','roleBought','constructor','locale','LIMITS','balance','client','PLATINUM','PREMIUM_MEMBERSHIP_REQUIRED','Command','findOne','has','default','compile','resolver','map','findOneAndUpdate','INSUFFICIENT_BALANCE','roleStoreRemove','return\x20/\x22\x20+\x20this\x20+\x20\x22/','exec','../../utils/omnic','_id','ROLE_NOT_FOR_SALE','COLORS','tag','roles','MANAGE_ROLES','isPublicBastion','GOLD','countDocuments','document','LIMITED_PREMIUM_MEMBERSHIP','MAX_SAFE_INTEGER','catch','roleStore\x20ROLE\x20--unlist','roleStore','length','cache','BASTION_ERROR_TYPE','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','send','clamp','roleStoreAdd','find','premiumPaidRoles','fetchPremiumTier','get','\x20/\x20','guild','save','name','info','PAID_ROLES','roleStore\x20ROLE\x20--sell\x20AMOUNT','add','exports'];(function(_0x961aac,_0x248758){const _0xe5d331=function(_0x47776e){while(--_0x47776e){_0x961aac['push'](_0x961aac['shift']());}};const _0x2fe93c=function(){const _0x6e825={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4e93eb,_0x2e6351,_0x1dca8b,_0x20a59f){_0x20a59f=_0x20a59f||{};let _0x50e1a7=_0x2e6351+'='+_0x1dca8b;let _0x53b91d=0x0;for(let _0x5405b0=0x0,_0x7a708b=_0x4e93eb['length'];_0x5405b0<_0x7a708b;_0x5405b0++){const _0x4e87e4=_0x4e93eb[_0x5405b0];_0x50e1a7+=';\x20'+_0x4e87e4;const _0x1e6be1=_0x4e93eb[_0x4e87e4];_0x4e93eb['push'](_0x1e6be1);_0x7a708b=_0x4e93eb['length'];if(_0x1e6be1!==!![]){_0x50e1a7+='='+_0x1e6be1;}}_0x20a59f['cookie']=_0x50e1a7;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3d35b4,_0x40d386){_0x3d35b4=_0x3d35b4||function(_0x29d0b2){return _0x29d0b2;};const _0x3fd47f=_0x3d35b4(new RegExp('(?:^|;\x20)'+_0x40d386['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x25f757=function(_0x551edb,_0x343ff0){_0x551edb(++_0x343ff0);};_0x25f757(_0xe5d331,_0x248758);return _0x3fd47f?decodeURIComponent(_0x3fd47f[0x1]):undefined;}};const _0x55764f=function(){const _0x363cb1=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x363cb1['test'](_0x6e825['removeCookie']['toString']());};_0x6e825['updateCookie']=_0x55764f;let _0x4da611='';const _0x21ac43=_0x6e825['updateCookie']();if(!_0x21ac43){_0x6e825['setCookie'](['*'],'counter',0x1);}else if(_0x21ac43){_0x4da611=_0x6e825['getCookie'](null,'counter');}else{_0x6e825['removeCookie']();}};_0x2fe93c();}(a68_0x2487,0x8b));const a68_0xe5d3=function(_0x961aac,_0x248758){_0x961aac=_0x961aac-0x0;let _0xe5d331=a68_0x2487[_0x961aac];return _0xe5d331;};const a68_0x6e825=function(){let _0x5c3278=!![];return function(_0x523198,_0x153af8){const _0x15569e=_0x5c3278?function(){if(_0x153af8){const _0x26813a=_0x153af8['apply'](_0x523198,arguments);_0x153af8=null;return _0x26813a;}}:function(){};_0x5c3278=![];return _0x15569e;};}();const a68_0x47776e=a68_0x6e825(this,function(){const _0x1ce2e3=function(){const _0x232891=_0x1ce2e3[a68_0xe5d3('0x2e')](a68_0xe5d3('0x3f'))()[a68_0xe5d3('0x39')](a68_0xe5d3('0x4'));return!_0x232891[a68_0xe5d3('0x1a')](a68_0x47776e);};return _0x1ce2e3();});a68_0x47776e();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require('../../models/Role');const constants=require('../../utils/constants');const errors=require(a68_0xe5d3('0x24'));const numbers=require('../../utils/numbers');const omnic=require(a68_0xe5d3('0x41'));module[a68_0xe5d3('0x14')]=class RoleStoreCommand extends tesseract_1[a68_0xe5d3('0x35')]{constructor(){super(a68_0xe5d3('0x0'),{'description':a68_0xe5d3('0x19'),'triggers':[],'arguments':{'boolean':[a68_0xe5d3('0x1e'),'unlist'],'number':[a68_0xe5d3('0x2a')],'coerce':{'sell':_0x2c03e1=>numbers[a68_0xe5d3('0x6')](_0x2c03e1,0x1,Number[a68_0xe5d3('0x4d')])}},'scope':a68_0xe5d3('0xd'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a68_0xe5d3('0x47')],'userPermissions':[],'syntax':[a68_0xe5d3('0x0'),a68_0xe5d3('0x12'),a68_0xe5d3('0x29'),a68_0xe5d3('0x4f')]});this[a68_0xe5d3('0x40')]=async(_0x3eec0d,_0x41ad77)=>{if(_0x41ad77['_'][a68_0xe5d3('0x1')]){const _0x60b4d1=this[a68_0xe5d3('0x32')][a68_0xe5d3('0x3a')]['resolveRole'](_0x3eec0d['guild'],_0x41ad77['_']['join']('\x20'));if(!_0x60b4d1)throw new errors[(a68_0xe5d3('0x18'))](errors[a68_0xe5d3('0x3')][a68_0xe5d3('0x1b')],this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')][a68_0xe5d3('0x26')](_0x3eec0d[a68_0xe5d3('0xd')][a68_0xe5d3('0x4b')]['language'],'error',a68_0xe5d3('0x17')));if(_0x41ad77[a68_0xe5d3('0x2a')]>0x0){if(constants[a68_0xe5d3('0x48')](this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2c')])){const _0x3a582a=await Role_1[a68_0xe5d3('0x38')][a68_0xe5d3('0x4a')]({'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x3a582a>=constants[a68_0xe5d3('0x30')][a68_0xe5d3('0x11')]){const _0x5ef0b2=await omnic[a68_0xe5d3('0xa')](_0x3eec0d[a68_0xe5d3('0xd')])[a68_0xe5d3('0x4e')](()=>{});if(_0x5ef0b2){if(_0x5ef0b2===omnic['PremiumTier'][a68_0xe5d3('0x49')]&&_0x3a582a>=constants['LIMITS'][a68_0xe5d3('0x49')][a68_0xe5d3('0x11')]){throw new errors[(a68_0xe5d3('0x18'))](errors['BASTION_ERROR_TYPE'][a68_0xe5d3('0x4c')],this[a68_0xe5d3('0x32')]['locale'][a68_0xe5d3('0x26')](_0x3eec0d[a68_0xe5d3('0xd')]['document']['language'],'errors','membershipLimitPaidRoles',constants[a68_0xe5d3('0x30')][a68_0xe5d3('0x49')][a68_0xe5d3('0x11')]));}else if(_0x5ef0b2===omnic[a68_0xe5d3('0x16')][a68_0xe5d3('0x33')]&&_0x3a582a>=constants['LIMITS'][a68_0xe5d3('0x33')]['PAID_ROLES']){throw new errors[(a68_0xe5d3('0x18'))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')]['getString'](_0x3eec0d[a68_0xe5d3('0xd')]['document'][a68_0xe5d3('0x21')],a68_0xe5d3('0x25'),'membershipLimitPaidRoles',constants[a68_0xe5d3('0x30')][a68_0xe5d3('0x33')][a68_0xe5d3('0x11')]));}}else{throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a68_0xe5d3('0x34')],this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')]['getString'](_0x3eec0d['guild'][a68_0xe5d3('0x4b')][a68_0xe5d3('0x21')],a68_0xe5d3('0x25'),a68_0xe5d3('0x9'),constants[a68_0xe5d3('0x30')]['PAID_ROLES']));}}}if(!_0x3eec0d['member'][a68_0xe5d3('0x27')]['has'](a68_0xe5d3('0x47')))throw new Error(a68_0xe5d3('0x15'));await Role_1[a68_0xe5d3('0x38')]['findOneAndUpdate']({'_id':_0x60b4d1['id'],'guild':_0x3eec0d['guild']['id']},{'_id':_0x60b4d1['id'],'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'price':_0x41ad77['sell']},{'upsert':!![]});return await _0x3eec0d[a68_0xe5d3('0x1c')][a68_0xe5d3('0x5')]({'embed':{'color':tesseract_1[a68_0xe5d3('0x1d')][a68_0xe5d3('0x44')][a68_0xe5d3('0x2b')],'description':this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')][a68_0xe5d3('0x26')](_0x3eec0d[a68_0xe5d3('0xd')]['document'][a68_0xe5d3('0x21')],a68_0xe5d3('0x10'),a68_0xe5d3('0x7'),_0x3eec0d[a68_0xe5d3('0x22')][a68_0xe5d3('0x45')],_0x60b4d1['name'],_0x41ad77[a68_0xe5d3('0x2a')])}})[a68_0xe5d3('0x4e')](()=>{});}if(_0x41ad77['buy']){if(_0x3eec0d[a68_0xe5d3('0x23')][a68_0xe5d3('0x46')][a68_0xe5d3('0x2')][a68_0xe5d3('0x37')](_0x60b4d1['id']))throw new Error('ROLE_ALREADY_ASSIGNED');const _0x5bd1f4=await Role_1[a68_0xe5d3('0x38')][a68_0xe5d3('0x36')]({'_id':_0x60b4d1['id'],'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x5bd1f4)throw new Error(a68_0xe5d3('0x43'));if(_0x3eec0d[a68_0xe5d3('0x23')]['document'][a68_0xe5d3('0x31')]<_0x5bd1f4['price'])throw new Error(a68_0xe5d3('0x3d'));await _0x3eec0d[a68_0xe5d3('0x23')]['roles'][a68_0xe5d3('0x13')](_0x60b4d1);_0x3eec0d['member']['debit'](_0x5bd1f4['price'],'Paid\x20Role',_0x3eec0d[a68_0xe5d3('0x23')][a68_0xe5d3('0x4b')]);await _0x3eec0d[a68_0xe5d3('0x23')][a68_0xe5d3('0x4b')][a68_0xe5d3('0xe')]();return await _0x3eec0d[a68_0xe5d3('0x1c')]['send']({'embed':{'color':tesseract_1[a68_0xe5d3('0x1d')]['COLORS'][a68_0xe5d3('0x2b')],'description':this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')][a68_0xe5d3('0x26')](_0x3eec0d[a68_0xe5d3('0xd')][a68_0xe5d3('0x4b')][a68_0xe5d3('0x21')],a68_0xe5d3('0x10'),a68_0xe5d3('0x2d'),_0x3eec0d[a68_0xe5d3('0x22')]['tag'],_0x60b4d1[a68_0xe5d3('0xf')],_0x41ad77['sell'])}})[a68_0xe5d3('0x4e')](()=>{});}if(_0x41ad77['unlist']){if(!_0x3eec0d[a68_0xe5d3('0x23')][a68_0xe5d3('0x27')][a68_0xe5d3('0x37')](a68_0xe5d3('0x47')))throw new Error('NO_PERMISSION');await Role_1['default'][a68_0xe5d3('0x3c')]({'_id':_0x60b4d1['id'],'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x60b4d1['id'],'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'$unset':{'price':0x1}});return await _0x3eec0d[a68_0xe5d3('0x1c')][a68_0xe5d3('0x5')]({'embed':{'color':tesseract_1['Constants'][a68_0xe5d3('0x44')]['RED'],'description':this[a68_0xe5d3('0x32')][a68_0xe5d3('0x2f')][a68_0xe5d3('0x26')](_0x3eec0d[a68_0xe5d3('0xd')][a68_0xe5d3('0x4b')][a68_0xe5d3('0x21')],a68_0xe5d3('0x10'),a68_0xe5d3('0x3e'),_0x3eec0d[a68_0xe5d3('0x22')][a68_0xe5d3('0x45')],_0x60b4d1[a68_0xe5d3('0xf')])}})[a68_0xe5d3('0x4e')](()=>{});}}const _0x3bd7fb=await Role_1[a68_0xe5d3('0x38')][a68_0xe5d3('0x8')]({'guild':_0x3eec0d[a68_0xe5d3('0xd')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3bd7fb['length'])throw new Error('NO_ROLES_ON_SALE');return await _0x3eec0d[a68_0xe5d3('0x1c')][a68_0xe5d3('0x5')]({'embed':{'color':tesseract_1[a68_0xe5d3('0x1d')][a68_0xe5d3('0x44')][a68_0xe5d3('0x1f')],'title':'Roles\x20Store','fields':_0x3bd7fb[a68_0xe5d3('0x3b')](_0x2389f9=>({'name':(_0x3eec0d['guild']['roles'][a68_0xe5d3('0x2')][a68_0xe5d3('0x37')](_0x2389f9['_id'])?_0x3eec0d[a68_0xe5d3('0xd')]['roles'][a68_0xe5d3('0x2')][a68_0xe5d3('0xb')](_0x2389f9[a68_0xe5d3('0x42')])[a68_0xe5d3('0xf')]+a68_0xe5d3('0xc'):'')+_0x2389f9[a68_0xe5d3('0x42')],'value':_0x2389f9[a68_0xe5d3('0x28')]+a68_0xe5d3('0x20')}))}})[a68_0xe5d3('0x4e')](()=>{});};}};