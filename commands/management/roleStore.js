const a74_0x4d5a=['errors','client','cache','DiscordError','roleStoreRemove','roleStore\x20ROLE\x20--buy','LIMITS','Roles\x20Store','BASTION_ERROR_TYPE','find','locale','error','../../utils/constants','roleNotFound','get','IRIS','../../utils/errors','catch','NO_PERMISSION','resolveRole','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','membershipLimitPaidRoles','findOneAndUpdate','add','roleStore\x20ROLE\x20--sell\x20AMOUNT','PAID_ROLES','fetchPremiumTier','GOLD','save','PLATINUM','unlist','LIMITED_PREMIUM_MEMBERSHIP','\x20/\x20','PremiumTier','sell','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','apply','channel','member','roleBought','document','COLORS','MAX_SAFE_INTEGER','debit','price','ROLE_NOT_FOUND','tag','info','guild','getString','findOne','MANAGE_ROLES','default','constructor','map','language','name','author','exec','balance','buy','../../utils/numbers','clamp','roleStore','INSUFFICIENT_BALANCE','Command','permissions','_id','GREEN','isPublicBastion','Constants','has','send','length','ROLE_ALREADY_ASSIGNED','roles','../../models/Role'];(function(_0x477ab6,_0x4d5add){const _0x4128e1=function(_0x4d1a94){while(--_0x4d1a94){_0x477ab6['push'](_0x477ab6['shift']());}},_0x2f5abe=function(){const _0xa7ce2a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2576b8,_0x1a29f3,_0x3ff8f1,_0x34f40e){_0x34f40e=_0x34f40e||{};let _0x36ec40=_0x1a29f3+'='+_0x3ff8f1,_0x4888c6=0x0;for(let _0x4c57ab=0x0,_0x4cf0ca=_0x2576b8['length'];_0x4c57ab<_0x4cf0ca;_0x4c57ab++){const _0x3b3bae=_0x2576b8[_0x4c57ab];_0x36ec40+=';\x20'+_0x3b3bae;const _0x511b9b=_0x2576b8[_0x3b3bae];_0x2576b8['push'](_0x511b9b),_0x4cf0ca=_0x2576b8['length'],_0x511b9b!==!![]&&(_0x36ec40+='='+_0x511b9b);}_0x34f40e['cookie']=_0x36ec40;},'removeCookie':function(){return'dev';},'getCookie':function(_0x543a25,_0x60a864){_0x543a25=_0x543a25||function(_0x17714e){return _0x17714e;};const _0x350081=_0x543a25(new RegExp('(?:^|;\x20)'+_0x60a864['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x3d4b59=function(_0x5c7d6d,_0x5062d6){_0x5c7d6d(++_0x5062d6);};return _0x3d4b59(_0x4128e1,_0x4d5add),_0x350081?decodeURIComponent(_0x350081[0x1]):undefined;}},_0x16a096=function(){const _0x380e1d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x380e1d['test'](_0xa7ce2a['removeCookie']['toString']());};_0xa7ce2a['updateCookie']=_0x16a096;let _0x167449='';const _0x3d9710=_0xa7ce2a['updateCookie']();if(!_0x3d9710)_0xa7ce2a['setCookie'](['*'],'counter',0x1);else _0x3d9710?_0x167449=_0xa7ce2a['getCookie'](null,'counter'):_0xa7ce2a['removeCookie']();};_0x2f5abe();}(a74_0x4d5a,0x190));const a74_0x4128=function(_0x477ab6,_0x4d5add){_0x477ab6=_0x477ab6-0x0;let _0x4128e1=a74_0x4d5a[_0x477ab6];return _0x4128e1;};const a74_0x3ff8f1=function(){let _0x355139=!![];return function(_0xbed33d,_0x9189b0){const _0x4e8bad=_0x355139?function(){if(_0x9189b0){const _0x2ce218=_0x9189b0[a74_0x4128('0x15')](_0xbed33d,arguments);return _0x9189b0=null,_0x2ce218;}}:function(){};return _0x355139=![],_0x4e8bad;};}(),a74_0x1a29f3=a74_0x3ff8f1(this,function(){const _0xa24170=function(){const _0x742414=_0xa24170[a74_0x4128('0x26')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['constructor'](a74_0x4128('0x14'));return!_0x742414['test'](a74_0x1a29f3);};return _0xa24170();});a74_0x1a29f3();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require(a74_0x4128('0x3d')),constants=require(a74_0x4128('0x4a')),errors=require(a74_0x4128('0x1')),numbers=require(a74_0x4128('0x2e')),omnic=require('../../utils/omnic');module['exports']=class RoleStoreCommand extends tesseract_1[a74_0x4128('0x32')]{constructor(){super('roleStore',{'description':a74_0x4128('0x5'),'triggers':[],'arguments':{'boolean':[a74_0x4128('0x2d'),a74_0x4128('0xf')],'number':[a74_0x4128('0x13')],'coerce':{'sell':_0x280dd1=>numbers[a74_0x4128('0x2f')](_0x280dd1,0x1,Number[a74_0x4128('0x1b')])}},'scope':a74_0x4128('0x21'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a74_0x4128('0x24')],'userPermissions':[],'syntax':[a74_0x4128('0x30'),a74_0x4128('0x9'),a74_0x4128('0x43'),'roleStore\x20ROLE\x20--unlist']}),this[a74_0x4128('0x2b')]=async(_0x10048d,_0x5d6762)=>{if(_0x5d6762['_']['length']){const _0x42b9b7=this[a74_0x4128('0x3f')]['resolver'][a74_0x4128('0x4')](_0x10048d[a74_0x4128('0x21')],_0x5d6762['_']['join']('\x20'));if(!_0x42b9b7)throw new errors['DiscordError'](errors[a74_0x4128('0x46')][a74_0x4128('0x1e')],this[a74_0x4128('0x3f')][a74_0x4128('0x48')][a74_0x4128('0x22')](_0x10048d[a74_0x4128('0x21')][a74_0x4128('0x19')]['language'],a74_0x4128('0x49'),a74_0x4128('0x4b')));if(_0x5d6762[a74_0x4128('0x13')]>0x0){if(constants[a74_0x4128('0x36')](this[a74_0x4128('0x3f')]['user'])){const _0x1500fd=await Role_1[a74_0x4128('0x25')]['countDocuments']({'guild':_0x10048d[a74_0x4128('0x21')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x1500fd>=constants[a74_0x4128('0x44')][a74_0x4128('0xa')]){const _0xf34391=await omnic[a74_0x4128('0xb')](_0x10048d[a74_0x4128('0x21')])[a74_0x4128('0x2')](()=>{});if(_0xf34391){if(_0xf34391===omnic[a74_0x4128('0x12')]['GOLD']&&_0x1500fd>=constants['LIMITS'][a74_0x4128('0xc')][a74_0x4128('0xa')])throw new errors[(a74_0x4128('0x41'))](errors['BASTION_ERROR_TYPE'][a74_0x4128('0x10')],this[a74_0x4128('0x3f')][a74_0x4128('0x48')][a74_0x4128('0x22')](_0x10048d['guild']['document'][a74_0x4128('0x28')],a74_0x4128('0x3e'),a74_0x4128('0x6'),constants[a74_0x4128('0x44')]['GOLD'][a74_0x4128('0xa')]));else{if(_0xf34391===omnic['PremiumTier']['PLATINUM']&&_0x1500fd>=constants[a74_0x4128('0x44')][a74_0x4128('0xe')][a74_0x4128('0xa')])throw new errors[(a74_0x4128('0x41'))](errors['BASTION_ERROR_TYPE'][a74_0x4128('0x10')],this[a74_0x4128('0x3f')]['locale'][a74_0x4128('0x22')](_0x10048d[a74_0x4128('0x21')]['document'][a74_0x4128('0x28')],a74_0x4128('0x3e'),a74_0x4128('0x6'),constants[a74_0x4128('0x44')][a74_0x4128('0xe')][a74_0x4128('0xa')]));}}else throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[a74_0x4128('0x3f')][a74_0x4128('0x48')][a74_0x4128('0x22')](_0x10048d[a74_0x4128('0x21')][a74_0x4128('0x19')]['language'],a74_0x4128('0x3e'),'premiumPaidRoles',constants[a74_0x4128('0x44')][a74_0x4128('0xa')]));}}if(!_0x10048d[a74_0x4128('0x17')][a74_0x4128('0x33')]['has'](a74_0x4128('0x24')))throw new Error(a74_0x4128('0x3'));return await Role_1['default'][a74_0x4128('0x7')]({'_id':_0x42b9b7['id'],'guild':_0x10048d[a74_0x4128('0x21')]['id']},{'_id':_0x42b9b7['id'],'guild':_0x10048d['guild']['id'],'price':_0x5d6762[a74_0x4128('0x13')]},{'upsert':!![]}),await _0x10048d['channel'][a74_0x4128('0x39')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a74_0x4128('0x35')],'description':this[a74_0x4128('0x3f')][a74_0x4128('0x48')][a74_0x4128('0x22')](_0x10048d['guild'][a74_0x4128('0x19')][a74_0x4128('0x28')],a74_0x4128('0x20'),'roleStoreAdd',_0x10048d[a74_0x4128('0x2a')][a74_0x4128('0x1f')],_0x42b9b7['name'],_0x5d6762['sell'])}})['catch'](()=>{});}if(_0x5d6762[a74_0x4128('0x2d')]){if(_0x10048d[a74_0x4128('0x17')]['roles'][a74_0x4128('0x40')]['has'](_0x42b9b7['id']))throw new Error(a74_0x4128('0x3b'));const _0x3c02c0=await Role_1['default'][a74_0x4128('0x23')]({'_id':_0x42b9b7['id'],'guild':_0x10048d[a74_0x4128('0x21')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3c02c0)throw new Error('ROLE_NOT_FOR_SALE');if(_0x10048d['member']['document'][a74_0x4128('0x2c')]<_0x3c02c0[a74_0x4128('0x1d')])throw new Error(a74_0x4128('0x31'));return await _0x10048d[a74_0x4128('0x17')]['roles'][a74_0x4128('0x8')](_0x42b9b7),_0x10048d['member'][a74_0x4128('0x1c')](_0x3c02c0[a74_0x4128('0x1d')],'Paid\x20Role',_0x10048d[a74_0x4128('0x17')][a74_0x4128('0x19')]),await _0x10048d[a74_0x4128('0x17')][a74_0x4128('0x19')][a74_0x4128('0xd')](),await _0x10048d[a74_0x4128('0x16')][a74_0x4128('0x39')]({'embed':{'color':tesseract_1[a74_0x4128('0x37')][a74_0x4128('0x1a')][a74_0x4128('0x35')],'description':this['client']['locale'][a74_0x4128('0x22')](_0x10048d[a74_0x4128('0x21')]['document']['language'],a74_0x4128('0x20'),a74_0x4128('0x18'),_0x10048d[a74_0x4128('0x2a')][a74_0x4128('0x1f')],_0x42b9b7[a74_0x4128('0x29')],_0x3c02c0[a74_0x4128('0x1d')])}})[a74_0x4128('0x2')](()=>{});}if(_0x5d6762['unlist']){if(!_0x10048d[a74_0x4128('0x17')][a74_0x4128('0x33')][a74_0x4128('0x38')](a74_0x4128('0x24')))throw new Error('NO_PERMISSION');return await Role_1[a74_0x4128('0x25')][a74_0x4128('0x7')]({'_id':_0x42b9b7['id'],'guild':_0x10048d[a74_0x4128('0x21')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x42b9b7['id'],'guild':_0x10048d[a74_0x4128('0x21')]['id'],'$unset':{'price':0x1}}),await _0x10048d[a74_0x4128('0x16')][a74_0x4128('0x39')]({'embed':{'color':tesseract_1['Constants']['COLORS']['RED'],'description':this[a74_0x4128('0x3f')][a74_0x4128('0x48')]['getString'](_0x10048d['guild'][a74_0x4128('0x19')][a74_0x4128('0x28')],'info',a74_0x4128('0x42'),_0x10048d['author'][a74_0x4128('0x1f')],_0x42b9b7[a74_0x4128('0x29')])}})['catch'](()=>{});}}const _0x26349b=await Role_1[a74_0x4128('0x25')][a74_0x4128('0x47')]({'guild':_0x10048d[a74_0x4128('0x21')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x26349b[a74_0x4128('0x3a')])throw new Error('NO_ROLES_ON_SALE');return await _0x10048d['channel'][a74_0x4128('0x39')]({'embed':{'color':tesseract_1['Constants'][a74_0x4128('0x1a')][a74_0x4128('0x0')],'title':a74_0x4128('0x45'),'fields':_0x26349b[a74_0x4128('0x27')](_0x2f11b6=>({'name':(_0x10048d[a74_0x4128('0x21')][a74_0x4128('0x3c')][a74_0x4128('0x40')]['has'](_0x2f11b6[a74_0x4128('0x34')])?_0x10048d[a74_0x4128('0x21')][a74_0x4128('0x3c')][a74_0x4128('0x40')][a74_0x4128('0x4c')](_0x2f11b6[a74_0x4128('0x34')])[a74_0x4128('0x29')]+a74_0x4128('0x11'):'')+_0x2f11b6['_id'],'value':_0x2f11b6['price']+'\x20Bastion\x20Coins'}))}})['catch'](()=>{});};}};