const a76_0x3021=['guild','cache','has','ROLE_NOT_FOUND','PAID_ROLES','default','../../utils/constants','save','send','exports','get','\x20/\x20','error','catch','MANAGE_ROLES','DiscordError','findOneAndUpdate','roles','roleStoreAdd','join','PLATINUM','permissions','isPublicBastion','user','constructor','premiumPaidRoles','exec','Constants','debit','Paid\x20Role','../../utils/numbers','balance','return\x20/\x22\x20+\x20this\x20+\x20\x22/','length','member','map','resolveRole','BASTION_ERROR_TYPE','buy','ROLE_NOT_FOR_SALE','Roles\x20Store','GOLD','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','MAX_SAFE_INTEGER','errors','LIMITS','add','test','locale','language','IRIS','roleStore\x20ROLE\x20--sell\x20AMOUNT','document','NO_PERMISSION','channel','PREMIUM_MEMBERSHIP_REQUIRED','membershipLimitPaidRoles','NO_ROLES_ON_SALE','getString','resolver','GREEN','RED','client','@bastion/tesseract','author','sell','\x20Bastion\x20Coins','find','price','info','name','roleBought','LIMITED_PREMIUM_MEMBERSHIP','roleNotFound','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','PremiumTier','../../utils/errors','tag','_id','INSUFFICIENT_BALANCE','clamp'];(function(_0xc613e3,_0x3021bd){const _0x563b08=function(_0x130e28){while(--_0x130e28){_0xc613e3['push'](_0xc613e3['shift']());}},_0xf91967=function(){const _0x65d95f={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3053c3,_0x10c284,_0x129524,_0x30e1ab){_0x30e1ab=_0x30e1ab||{};let _0x2cc7dd=_0x10c284+'='+_0x129524,_0x13d71f=0x0;for(let _0x5aeacd=0x0,_0x30de59=_0x3053c3['length'];_0x5aeacd<_0x30de59;_0x5aeacd++){const _0x29ea1a=_0x3053c3[_0x5aeacd];_0x2cc7dd+=';\x20'+_0x29ea1a;const _0x1dc694=_0x3053c3[_0x29ea1a];_0x3053c3['push'](_0x1dc694),_0x30de59=_0x3053c3['length'],_0x1dc694!==!![]&&(_0x2cc7dd+='='+_0x1dc694);}_0x30e1ab['cookie']=_0x2cc7dd;},'removeCookie':function(){return'dev';},'getCookie':function(_0x20edb1,_0x1cb9f3){_0x20edb1=_0x20edb1||function(_0x4be256){return _0x4be256;};const _0x47b3f9=_0x20edb1(new RegExp('(?:^|;\x20)'+_0x1cb9f3['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x33b216=function(_0x67634e,_0x4d3a47){_0x67634e(++_0x4d3a47);};return _0x33b216(_0x563b08,_0x3021bd),_0x47b3f9?decodeURIComponent(_0x47b3f9[0x1]):undefined;}},_0x9fa346=function(){const _0xe583f9=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xe583f9['test'](_0x65d95f['removeCookie']['toString']());};_0x65d95f['updateCookie']=_0x9fa346;let _0x5e41be='';const _0x1aa85b=_0x65d95f['updateCookie']();if(!_0x1aa85b)_0x65d95f['setCookie'](['*'],'counter',0x1);else _0x1aa85b?_0x5e41be=_0x65d95f['getCookie'](null,'counter'):_0x65d95f['removeCookie']();};_0xf91967();}(a76_0x3021,0x98));const a76_0x563b=function(_0xc613e3,_0x3021bd){_0xc613e3=_0xc613e3-0x0;let _0x563b08=a76_0x3021[_0xc613e3];return _0x563b08;};const a76_0x65d95f=function(){let _0x5e41be=!![];return function(_0x1aa85b,_0x3053c3){const _0x10c284=_0x5e41be?function(){if(_0x3053c3){const _0x129524=_0x3053c3['apply'](_0x1aa85b,arguments);return _0x3053c3=null,_0x129524;}}:function(){};return _0x5e41be=![],_0x10c284;};}(),a76_0x130e28=a76_0x65d95f(this,function(){const _0x30e1ab=function(){const _0x2cc7dd=_0x30e1ab[a76_0x563b('0x22')](a76_0x563b('0x2a'))()[a76_0x563b('0x22')](a76_0x563b('0x34'));return!_0x2cc7dd[a76_0x563b('0x39')](a76_0x130e28);};return _0x30e1ab();});a76_0x130e28();'use strict';const tesseract_1=require(a76_0x563b('0x49')),Role_1=require('../../models/Role'),constants=require(a76_0x563b('0x10')),errors=require(a76_0x563b('0x5')),numbers=require(a76_0x563b('0x28')),omnic=require('../../utils/omnic');module[a76_0x563b('0x13')]=class RoleStoreCommand extends tesseract_1['Command']{constructor(){super('roleStore',{'description':a76_0x563b('0x3'),'triggers':[],'arguments':{'boolean':[a76_0x563b('0x30'),'unlist'],'number':[a76_0x563b('0x4b')],'coerce':{'sell':_0x13d71f=>numbers[a76_0x563b('0x9')](_0x13d71f,0x1,Number[a76_0x563b('0x35')])}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a76_0x563b('0x18')],'userPermissions':[],'syntax':['roleStore',a76_0x563b('0x3d'),'roleStore\x20ROLE\x20--buy','roleStore\x20ROLE\x20--unlist']}),this[a76_0x563b('0x24')]=async(_0x5aeacd,_0x30de59)=>{if(_0x30de59['_']['length']){const _0x1dc694=this[a76_0x563b('0x48')][a76_0x563b('0x45')][a76_0x563b('0x2e')](_0x5aeacd[a76_0x563b('0xa')],_0x30de59['_'][a76_0x563b('0x1d')]('\x20'));if(!_0x1dc694)throw new errors[(a76_0x563b('0x19'))](errors[a76_0x563b('0x2f')][a76_0x563b('0xd')],this['client'][a76_0x563b('0x3a')]['getString'](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')]['language'],a76_0x563b('0x16'),a76_0x563b('0x2')));if(_0x30de59[a76_0x563b('0x4b')]>0x0){if(constants[a76_0x563b('0x20')](this[a76_0x563b('0x48')][a76_0x563b('0x21')])){const _0x20edb1=await Role_1[a76_0x563b('0xf')]['countDocuments']({'guild':_0x5aeacd[a76_0x563b('0xa')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x20edb1>=constants[a76_0x563b('0x37')][a76_0x563b('0xe')]){const _0x1cb9f3=await omnic['fetchPremiumTier'](_0x5aeacd[a76_0x563b('0xa')])['catch'](()=>{});if(_0x1cb9f3){if(_0x1cb9f3===omnic['PremiumTier'][a76_0x563b('0x33')]&&_0x20edb1>=constants['LIMITS'][a76_0x563b('0x33')][a76_0x563b('0xe')])throw new errors[(a76_0x563b('0x19'))](errors['BASTION_ERROR_TYPE'][a76_0x563b('0x1')],this['client'][a76_0x563b('0x3a')][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')]['language'],a76_0x563b('0x36'),a76_0x563b('0x42'),constants[a76_0x563b('0x37')]['GOLD']['PAID_ROLES']));else{if(_0x1cb9f3===omnic[a76_0x563b('0x4')][a76_0x563b('0x1e')]&&_0x20edb1>=constants[a76_0x563b('0x37')][a76_0x563b('0x1e')][a76_0x563b('0xe')])throw new errors[(a76_0x563b('0x19'))](errors['BASTION_ERROR_TYPE'][a76_0x563b('0x1')],this[a76_0x563b('0x48')][a76_0x563b('0x3a')][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')][a76_0x563b('0x3b')],a76_0x563b('0x36'),a76_0x563b('0x42'),constants['LIMITS'][a76_0x563b('0x1e')]['PAID_ROLES']));}}else throw new errors[(a76_0x563b('0x19'))](errors[a76_0x563b('0x2f')][a76_0x563b('0x41')],this['client'][a76_0x563b('0x3a')][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')][a76_0x563b('0x3b')],a76_0x563b('0x36'),a76_0x563b('0x23'),constants[a76_0x563b('0x37')]['PAID_ROLES']));}}if(!_0x5aeacd[a76_0x563b('0x2c')][a76_0x563b('0x1f')][a76_0x563b('0xc')](a76_0x563b('0x18')))throw new Error(a76_0x563b('0x3f'));return await Role_1[a76_0x563b('0xf')][a76_0x563b('0x1a')]({'_id':_0x1dc694['id'],'guild':_0x5aeacd[a76_0x563b('0xa')]['id']},{'_id':_0x1dc694['id'],'guild':_0x5aeacd['guild']['id'],'price':_0x30de59[a76_0x563b('0x4b')]},{'upsert':!![]}),await _0x5aeacd[a76_0x563b('0x40')]['send']({'embed':{'color':tesseract_1[a76_0x563b('0x25')]['COLORS'][a76_0x563b('0x46')],'description':this[a76_0x563b('0x48')][a76_0x563b('0x3a')][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')][a76_0x563b('0x3b')],'info',a76_0x563b('0x1c'),_0x5aeacd[a76_0x563b('0x4a')][a76_0x563b('0x6')],_0x1dc694[a76_0x563b('0x50')],_0x30de59[a76_0x563b('0x4b')])}})[a76_0x563b('0x17')](()=>{});}if(_0x30de59[a76_0x563b('0x30')]){if(_0x5aeacd[a76_0x563b('0x2c')][a76_0x563b('0x1b')][a76_0x563b('0xb')][a76_0x563b('0xc')](_0x1dc694['id']))throw new Error('ROLE_ALREADY_ASSIGNED');const _0x47b3f9=await Role_1[a76_0x563b('0xf')]['findOne']({'_id':_0x1dc694['id'],'guild':_0x5aeacd['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x47b3f9)throw new Error(a76_0x563b('0x31'));if(_0x5aeacd[a76_0x563b('0x2c')][a76_0x563b('0x3e')][a76_0x563b('0x29')]<_0x47b3f9[a76_0x563b('0x4e')])throw new Error(a76_0x563b('0x8'));return await _0x5aeacd['member'][a76_0x563b('0x1b')][a76_0x563b('0x38')](_0x1dc694),_0x5aeacd[a76_0x563b('0x2c')][a76_0x563b('0x26')](_0x47b3f9[a76_0x563b('0x4e')],a76_0x563b('0x27'),_0x5aeacd['member']['document']),await _0x5aeacd[a76_0x563b('0x2c')][a76_0x563b('0x3e')][a76_0x563b('0x11')](),await _0x5aeacd[a76_0x563b('0x40')][a76_0x563b('0x12')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a76_0x563b('0x46')],'description':this[a76_0x563b('0x48')]['locale'][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')][a76_0x563b('0x3b')],a76_0x563b('0x4f'),a76_0x563b('0x0'),_0x5aeacd[a76_0x563b('0x4a')]['tag'],_0x1dc694['name'],_0x47b3f9[a76_0x563b('0x4e')])}})[a76_0x563b('0x17')](()=>{});}if(_0x30de59['unlist']){if(!_0x5aeacd['member']['permissions'][a76_0x563b('0xc')]('MANAGE_ROLES'))throw new Error(a76_0x563b('0x3f'));return await Role_1[a76_0x563b('0xf')][a76_0x563b('0x1a')]({'_id':_0x1dc694['id'],'guild':_0x5aeacd[a76_0x563b('0xa')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x1dc694['id'],'guild':_0x5aeacd[a76_0x563b('0xa')]['id'],'$unset':{'price':0x1}}),await _0x5aeacd[a76_0x563b('0x40')][a76_0x563b('0x12')]({'embed':{'color':tesseract_1[a76_0x563b('0x25')]['COLORS'][a76_0x563b('0x47')],'description':this['client'][a76_0x563b('0x3a')][a76_0x563b('0x44')](_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x3e')]['language'],'info','roleStoreRemove',_0x5aeacd[a76_0x563b('0x4a')][a76_0x563b('0x6')],_0x1dc694['name'])}})['catch'](()=>{});}}const _0x29ea1a=await Role_1[a76_0x563b('0xf')][a76_0x563b('0x4d')]({'guild':_0x5aeacd[a76_0x563b('0xa')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x29ea1a[a76_0x563b('0x2b')])throw new Error(a76_0x563b('0x43'));return await _0x5aeacd['channel']['send']({'embed':{'color':tesseract_1[a76_0x563b('0x25')]['COLORS'][a76_0x563b('0x3c')],'title':a76_0x563b('0x32'),'fields':_0x29ea1a[a76_0x563b('0x2d')](_0x33b216=>({'name':(_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x1b')][a76_0x563b('0xb')][a76_0x563b('0xc')](_0x33b216[a76_0x563b('0x7')])?_0x5aeacd[a76_0x563b('0xa')][a76_0x563b('0x1b')]['cache'][a76_0x563b('0x14')](_0x33b216[a76_0x563b('0x7')])[a76_0x563b('0x50')]+a76_0x563b('0x15'):'')+_0x33b216['_id'],'value':_0x33b216[a76_0x563b('0x4e')]+a76_0x563b('0x4c')}))}})['catch'](()=>{});};}};