const a71_0x3d28=['join','BASTION_ERROR_TYPE','roleStore\x20ROLE\x20--unlist','member','\x20Bastion\x20Coins','IRIS','Constants','clamp','buy','tag','length','document','save','locale','debit','find','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','ROLE_NOT_FOUND','default','test','catch','get','ROLE_ALREADY_ASSIGNED','client','roleStore','NO_PERMISSION','balance','DiscordError','@bastion/tesseract','sell','permissions','../../utils/omnic','NO_ROLES_ON_SALE','PremiumTier','getString','info','errors','return\x20/\x22\x20+\x20this\x20+\x20\x22/','guild','roleNotFound','PLATINUM','language','GOLD','LIMITED_PREMIUM_MEMBERSHIP','roleStoreRemove','GREEN','cache','apply','ROLE_NOT_FOR_SALE','has','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','MAX_SAFE_INTEGER','channel','author','findOneAndUpdate','_id','../../utils/errors','findOne','roles','roleBought','add','unlist','Command','resolver','roleStore\x20ROLE\x20--buy','name','LIMITS','constructor','Roles\x20Store','COLORS','countDocuments','price','resolveRole','\x20/\x20','RED','send','PAID_ROLES','roleStore\x20ROLE\x20--sell\x20AMOUNT'];(function(_0x2e21e8,_0x3d2838){const _0x58dafc=function(_0x1c81b8){while(--_0x1c81b8){_0x2e21e8['push'](_0x2e21e8['shift']());}},_0x36a9d6=function(){const _0x4a5cb3={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x4579a0,_0x579af6,_0x3d2489,_0x4b3767){_0x4b3767=_0x4b3767||{};let _0x1f40a1=_0x579af6+'='+_0x3d2489,_0x5f28c6=0x0;for(let _0x461394=0x0,_0x385204=_0x4579a0['length'];_0x461394<_0x385204;_0x461394++){const _0x41ab52=_0x4579a0[_0x461394];_0x1f40a1+=';\x20'+_0x41ab52;const _0x21b6df=_0x4579a0[_0x41ab52];_0x4579a0['push'](_0x21b6df),_0x385204=_0x4579a0['length'],_0x21b6df!==!![]&&(_0x1f40a1+='='+_0x21b6df);}_0x4b3767['cookie']=_0x1f40a1;},'removeCookie':function(){return'dev';},'getCookie':function(_0xac2ab4,_0x565029){_0xac2ab4=_0xac2ab4||function(_0x4dee04){return _0x4dee04;};const _0x566500=_0xac2ab4(new RegExp('(?:^|;\x20)'+_0x565029['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x2dd4b8=function(_0x274528,_0x591bdf){_0x274528(++_0x591bdf);};return _0x2dd4b8(_0x58dafc,_0x3d2838),_0x566500?decodeURIComponent(_0x566500[0x1]):undefined;}},_0x212014=function(){const _0x267229=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x267229['test'](_0x4a5cb3['removeCookie']['toString']());};_0x4a5cb3['updateCookie']=_0x212014;let _0x3cd012='';const _0x313e47=_0x4a5cb3['updateCookie']();if(!_0x313e47)_0x4a5cb3['setCookie'](['*'],'counter',0x1);else _0x313e47?_0x3cd012=_0x4a5cb3['getCookie'](null,'counter'):_0x4a5cb3['removeCookie']();};_0x36a9d6();}(a71_0x3d28,0x125));const a71_0x58da=function(_0x2e21e8,_0x3d2838){_0x2e21e8=_0x2e21e8-0x0;let _0x58dafc=a71_0x3d28[_0x2e21e8];return _0x58dafc;};const a71_0x3d2489=function(){let _0x47fae3=!![];return function(_0x55b214,_0x2a21ea){const _0x2259fe=_0x47fae3?function(){if(_0x2a21ea){const _0x57c162=_0x2a21ea[a71_0x58da('0x42')](_0x55b214,arguments);return _0x2a21ea=null,_0x57c162;}}:function(){};return _0x47fae3=![],_0x2259fe;};}(),a71_0x579af6=a71_0x3d2489(this,function(){const _0x519162=function(){const _0x11a510=_0x519162['constructor'](a71_0x58da('0x38'))()[a71_0x58da('0x8')](a71_0x58da('0x45'));return!_0x11a510[a71_0x58da('0x26')](a71_0x579af6);};return _0x519162();});a71_0x579af6();'use strict';const tesseract_1=require(a71_0x58da('0x2f')),Role_1=require('../../models/Role'),constants=require('../../utils/constants'),errors=require(a71_0x58da('0x4b')),numbers=require('../../utils/numbers'),omnic=require(a71_0x58da('0x32'));module['exports']=class RoleStoreCommand extends tesseract_1[a71_0x58da('0x3')]{constructor(){super(a71_0x58da('0x2b'),{'description':a71_0x58da('0x23'),'triggers':[],'arguments':{'boolean':[a71_0x58da('0x1b'),a71_0x58da('0x2')],'number':[a71_0x58da('0x30')],'coerce':{'sell':_0xc3705b=>numbers[a71_0x58da('0x1a')](_0xc3705b,0x1,Number[a71_0x58da('0x46')])}},'scope':a71_0x58da('0x39'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':['roleStore',a71_0x58da('0x12'),a71_0x58da('0x5'),a71_0x58da('0x15')]}),this['exec']=async(_0x48fd10,_0x528a65)=>{if(_0x528a65['_'][a71_0x58da('0x1d')]){const _0x3a4fe6=this[a71_0x58da('0x2a')][a71_0x58da('0x4')][a71_0x58da('0xd')](_0x48fd10['guild'],_0x528a65['_'][a71_0x58da('0x13')]('\x20'));if(!_0x3a4fe6)throw new errors[(a71_0x58da('0x2e'))](errors[a71_0x58da('0x14')][a71_0x58da('0x24')],this[a71_0x58da('0x2a')][a71_0x58da('0x20')]['getString'](_0x48fd10[a71_0x58da('0x39')][a71_0x58da('0x1e')][a71_0x58da('0x3c')],'error',a71_0x58da('0x3a')));if(_0x528a65['sell']>0x0){if(constants['isPublicBastion'](this[a71_0x58da('0x2a')]['user'])){const _0xfe23a2=await Role_1[a71_0x58da('0x25')][a71_0x58da('0xb')]({'guild':_0x48fd10[a71_0x58da('0x39')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0xfe23a2>=constants[a71_0x58da('0x7')][a71_0x58da('0x11')]){const _0x4a72d4=await omnic['fetchPremiumTier'](_0x48fd10[a71_0x58da('0x39')])['catch'](()=>{});if(_0x4a72d4){if(_0x4a72d4===omnic['PremiumTier'][a71_0x58da('0x3d')]&&_0xfe23a2>=constants[a71_0x58da('0x7')][a71_0x58da('0x3d')][a71_0x58da('0x11')])throw new errors[(a71_0x58da('0x2e'))](errors[a71_0x58da('0x14')][a71_0x58da('0x3e')],this['client'][a71_0x58da('0x20')][a71_0x58da('0x35')](_0x48fd10['guild'][a71_0x58da('0x1e')]['language'],a71_0x58da('0x37'),'membershipLimitPaidRoles',constants[a71_0x58da('0x7')][a71_0x58da('0x3d')][a71_0x58da('0x11')]));else{if(_0x4a72d4===omnic[a71_0x58da('0x34')][a71_0x58da('0x3b')]&&_0xfe23a2>=constants[a71_0x58da('0x7')][a71_0x58da('0x3b')]['PAID_ROLES'])throw new errors[(a71_0x58da('0x2e'))](errors[a71_0x58da('0x14')][a71_0x58da('0x3e')],this[a71_0x58da('0x2a')]['locale'][a71_0x58da('0x35')](_0x48fd10[a71_0x58da('0x39')]['document'][a71_0x58da('0x3c')],a71_0x58da('0x37'),'membershipLimitPaidRoles',constants[a71_0x58da('0x7')][a71_0x58da('0x3b')]['PAID_ROLES']));}}else throw new errors['DiscordError'](errors[a71_0x58da('0x14')]['PREMIUM_MEMBERSHIP_REQUIRED'],this['client'][a71_0x58da('0x20')][a71_0x58da('0x35')](_0x48fd10[a71_0x58da('0x39')][a71_0x58da('0x1e')]['language'],a71_0x58da('0x37'),'premiumPaidRoles',constants['LIMITS'][a71_0x58da('0x11')]));}}if(!_0x48fd10[a71_0x58da('0x16')][a71_0x58da('0x31')]['has']('MANAGE_ROLES'))throw new Error('NO_PERMISSION');return await Role_1[a71_0x58da('0x25')]['findOneAndUpdate']({'_id':_0x3a4fe6['id'],'guild':_0x48fd10[a71_0x58da('0x39')]['id']},{'_id':_0x3a4fe6['id'],'guild':_0x48fd10[a71_0x58da('0x39')]['id'],'price':_0x528a65[a71_0x58da('0x30')]},{'upsert':!![]}),await _0x48fd10[a71_0x58da('0x47')][a71_0x58da('0x10')]({'embed':{'color':tesseract_1[a71_0x58da('0x19')][a71_0x58da('0xa')][a71_0x58da('0x40')],'description':this[a71_0x58da('0x2a')]['locale'][a71_0x58da('0x35')](_0x48fd10[a71_0x58da('0x39')]['document']['language'],a71_0x58da('0x36'),'roleStoreAdd',_0x48fd10[a71_0x58da('0x48')]['tag'],_0x3a4fe6['name'],_0x528a65[a71_0x58da('0x30')])}})[a71_0x58da('0x27')](()=>{});}if(_0x528a65[a71_0x58da('0x1b')]){if(_0x48fd10[a71_0x58da('0x16')][a71_0x58da('0x4d')]['cache'][a71_0x58da('0x44')](_0x3a4fe6['id']))throw new Error(a71_0x58da('0x29'));const _0x205a1a=await Role_1[a71_0x58da('0x25')][a71_0x58da('0x4c')]({'_id':_0x3a4fe6['id'],'guild':_0x48fd10['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x205a1a)throw new Error(a71_0x58da('0x43'));if(_0x48fd10[a71_0x58da('0x16')][a71_0x58da('0x1e')][a71_0x58da('0x2d')]<_0x205a1a[a71_0x58da('0xc')])throw new Error('INSUFFICIENT_BALANCE');return await _0x48fd10[a71_0x58da('0x16')][a71_0x58da('0x4d')][a71_0x58da('0x1')](_0x3a4fe6),_0x48fd10['member'][a71_0x58da('0x21')](_0x205a1a[a71_0x58da('0xc')],'Paid\x20Role',_0x48fd10[a71_0x58da('0x16')][a71_0x58da('0x1e')]),await _0x48fd10['member'][a71_0x58da('0x1e')][a71_0x58da('0x1f')](),await _0x48fd10[a71_0x58da('0x47')]['send']({'embed':{'color':tesseract_1[a71_0x58da('0x19')]['COLORS'][a71_0x58da('0x40')],'description':this[a71_0x58da('0x2a')][a71_0x58da('0x20')][a71_0x58da('0x35')](_0x48fd10['guild'][a71_0x58da('0x1e')][a71_0x58da('0x3c')],a71_0x58da('0x36'),a71_0x58da('0x0'),_0x48fd10[a71_0x58da('0x48')]['tag'],_0x3a4fe6[a71_0x58da('0x6')],_0x205a1a[a71_0x58da('0xc')])}})[a71_0x58da('0x27')](()=>{});}if(_0x528a65[a71_0x58da('0x2')]){if(!_0x48fd10['member']['permissions'][a71_0x58da('0x44')]('MANAGE_ROLES'))throw new Error(a71_0x58da('0x2c'));return await Role_1['default'][a71_0x58da('0x49')]({'_id':_0x3a4fe6['id'],'guild':_0x48fd10[a71_0x58da('0x39')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x3a4fe6['id'],'guild':_0x48fd10[a71_0x58da('0x39')]['id'],'$unset':{'price':0x1}}),await _0x48fd10[a71_0x58da('0x47')][a71_0x58da('0x10')]({'embed':{'color':tesseract_1[a71_0x58da('0x19')]['COLORS'][a71_0x58da('0xf')],'description':this[a71_0x58da('0x2a')][a71_0x58da('0x20')]['getString'](_0x48fd10[a71_0x58da('0x39')]['document'][a71_0x58da('0x3c')],a71_0x58da('0x36'),a71_0x58da('0x3f'),_0x48fd10[a71_0x58da('0x48')][a71_0x58da('0x1c')],_0x3a4fe6[a71_0x58da('0x6')])}})[a71_0x58da('0x27')](()=>{});}}const _0x33ca70=await Role_1[a71_0x58da('0x25')][a71_0x58da('0x22')]({'guild':_0x48fd10[a71_0x58da('0x39')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x33ca70[a71_0x58da('0x1d')])throw new Error(a71_0x58da('0x33'));return await _0x48fd10[a71_0x58da('0x47')][a71_0x58da('0x10')]({'embed':{'color':tesseract_1['Constants'][a71_0x58da('0xa')][a71_0x58da('0x18')],'title':a71_0x58da('0x9'),'fields':_0x33ca70['map'](_0x3efc0a=>({'name':(_0x48fd10[a71_0x58da('0x39')][a71_0x58da('0x4d')][a71_0x58da('0x41')][a71_0x58da('0x44')](_0x3efc0a['_id'])?_0x48fd10['guild'][a71_0x58da('0x4d')][a71_0x58da('0x41')][a71_0x58da('0x28')](_0x3efc0a[a71_0x58da('0x4a')])[a71_0x58da('0x6')]+a71_0x58da('0xe'):'')+_0x3efc0a[a71_0x58da('0x4a')],'value':_0x3efc0a[a71_0x58da('0xc')]+a71_0x58da('0x17')}))}})[a71_0x58da('0x27')](()=>{});};}};