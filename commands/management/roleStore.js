const a71_0x2b3b=['default','COLORS','buy','roleBought','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','author','price','../../utils/omnic','catch','balance','PREMIUM_MEMBERSHIP_REQUIRED','get','../../utils/errors','find','_id','client','ROLE_ALREADY_ASSIGNED','length','roleStore\x20ROLE\x20--unlist','@bastion/tesseract','user','MAX_SAFE_INTEGER','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','roleStoreAdd','send','getString','RED','GREEN','language','test','error','apply','unlist','resolveRole','LIMITED_PREMIUM_MEMBERSHIP','constructor','findOne','roleStoreRemove','Constants','cache','exec','save','roleStore','PAID_ROLES','roleStore\x20ROLE\x20--sell\x20AMOUNT','NO_PERMISSION','info','has','exports','membershipLimitPaidRoles','map','MANAGE_ROLES','document','sell','LIMITS','tag','DiscordError','member','channel','name','errors','BASTION_ERROR_TYPE','roles','guild','../../utils/constants','GOLD','resolver','PremiumTier','permissions','PLATINUM','NO_ROLES_ON_SALE','locale','ROLE_NOT_FOUND'];(function(_0x24ed05,_0x2b3bc0){const _0x196e03=function(_0x748f46){while(--_0x748f46){_0x24ed05['push'](_0x24ed05['shift']());}},_0x3946e7=function(){const _0x5d37cd={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2ddfca,_0x2b8edf,_0x455b28,_0x4088f7){_0x4088f7=_0x4088f7||{};let _0x45e2d5=_0x2b8edf+'='+_0x455b28,_0x1fb998=0x0;for(let _0x483b99=0x0,_0x23175c=_0x2ddfca['length'];_0x483b99<_0x23175c;_0x483b99++){const _0x46b341=_0x2ddfca[_0x483b99];_0x45e2d5+=';\x20'+_0x46b341;const _0x355974=_0x2ddfca[_0x46b341];_0x2ddfca['push'](_0x355974),_0x23175c=_0x2ddfca['length'],_0x355974!==!![]&&(_0x45e2d5+='='+_0x355974);}_0x4088f7['cookie']=_0x45e2d5;},'removeCookie':function(){return'dev';},'getCookie':function(_0x37a40e,_0x57d232){_0x37a40e=_0x37a40e||function(_0x5468ce){return _0x5468ce;};const _0x136452=_0x37a40e(new RegExp('(?:^|;\x20)'+_0x57d232['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x1c2837=function(_0x3c0fb7,_0x238c6a){_0x3c0fb7(++_0x238c6a);};return _0x1c2837(_0x196e03,_0x2b3bc0),_0x136452?decodeURIComponent(_0x136452[0x1]):undefined;}},_0x4799b8=function(){const _0x49455f=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x49455f['test'](_0x5d37cd['removeCookie']['toString']());};_0x5d37cd['updateCookie']=_0x4799b8;let _0x48c589='';const _0x2e1626=_0x5d37cd['updateCookie']();if(!_0x2e1626)_0x5d37cd['setCookie'](['*'],'counter',0x1);else _0x2e1626?_0x48c589=_0x5d37cd['getCookie'](null,'counter'):_0x5d37cd['removeCookie']();};_0x3946e7();}(a71_0x2b3b,0xff));const a71_0x196e=function(_0x24ed05,_0x2b3bc0){_0x24ed05=_0x24ed05-0x0;let _0x196e03=a71_0x2b3b[_0x24ed05];return _0x196e03;};const a71_0x455b28=function(){let _0x53ecaa=!![];return function(_0x58c39b,_0x2c800e){const _0x5bf856=_0x53ecaa?function(){if(_0x2c800e){const _0x4ccfae=_0x2c800e[a71_0x196e('0x44')](_0x58c39b,arguments);return _0x2c800e=null,_0x4ccfae;}}:function(){};return _0x53ecaa=![],_0x5bf856;};}(),a71_0x2b8edf=a71_0x455b28(this,function(){const _0x35a45a=function(){const _0xd2969f=_0x35a45a[a71_0x196e('0x48')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a71_0x196e('0x48')](a71_0x196e('0x3b'));return!_0xd2969f[a71_0x196e('0x42')](a71_0x2b8edf);};return _0x35a45a();});a71_0x2b8edf();'use strict';const tesseract_1=require(a71_0x196e('0x38')),Role_1=require('../../models/Role'),constants=require(a71_0x196e('0x1c')),errors=require(a71_0x196e('0x31')),numbers=require('../../utils/numbers'),omnic=require(a71_0x196e('0x2c'));module[a71_0x196e('0xc')]=class RoleStoreCommand extends tesseract_1['Command']{constructor(){super('roleStore',{'description':a71_0x196e('0x29'),'triggers':[],'arguments':{'boolean':[a71_0x196e('0x27'),a71_0x196e('0x45')],'number':[a71_0x196e('0x11')],'coerce':{'sell':_0x1e1bdf=>numbers['clamp'](_0x1e1bdf,0x1,Number[a71_0x196e('0x3a')])}},'scope':a71_0x196e('0x1b'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[a71_0x196e('0x6'),a71_0x196e('0x8'),'roleStore\x20ROLE\x20--buy',a71_0x196e('0x37')]}),this[a71_0x196e('0x4')]=async(_0xa5a9bf,_0x278055)=>{if(_0x278055['_']['length']){const _0x2ab2fe=this[a71_0x196e('0x34')][a71_0x196e('0x1e')][a71_0x196e('0x46')](_0xa5a9bf[a71_0x196e('0x1b')],_0x278055['_']['join']('\x20'));if(!_0x2ab2fe)throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a71_0x196e('0x24')],this[a71_0x196e('0x34')][a71_0x196e('0x23')]['getString'](_0xa5a9bf[a71_0x196e('0x1b')][a71_0x196e('0x10')][a71_0x196e('0x41')],a71_0x196e('0x43'),'roleNotFound'));if(_0x278055[a71_0x196e('0x11')]>0x0){if(constants['isPublicBastion'](this[a71_0x196e('0x34')][a71_0x196e('0x39')])){const _0x86cc2b=await Role_1[a71_0x196e('0x25')]['countDocuments']({'guild':_0xa5a9bf[a71_0x196e('0x1b')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x86cc2b>=constants[a71_0x196e('0x12')][a71_0x196e('0x7')]){const _0x2cd5be=await omnic['fetchPremiumTier'](_0xa5a9bf[a71_0x196e('0x1b')])['catch'](()=>{});if(_0x2cd5be){if(_0x2cd5be===omnic[a71_0x196e('0x1f')][a71_0x196e('0x1d')]&&_0x86cc2b>=constants[a71_0x196e('0x12')][a71_0x196e('0x1d')][a71_0x196e('0x7')])throw new errors[(a71_0x196e('0x14'))](errors[a71_0x196e('0x19')][a71_0x196e('0x47')],this[a71_0x196e('0x34')][a71_0x196e('0x23')][a71_0x196e('0x3e')](_0xa5a9bf[a71_0x196e('0x1b')][a71_0x196e('0x10')]['language'],a71_0x196e('0x18'),a71_0x196e('0xd'),constants[a71_0x196e('0x12')]['GOLD'][a71_0x196e('0x7')]));else{if(_0x2cd5be===omnic[a71_0x196e('0x1f')][a71_0x196e('0x21')]&&_0x86cc2b>=constants[a71_0x196e('0x12')][a71_0x196e('0x21')][a71_0x196e('0x7')])throw new errors[(a71_0x196e('0x14'))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[a71_0x196e('0x34')][a71_0x196e('0x23')][a71_0x196e('0x3e')](_0xa5a9bf[a71_0x196e('0x1b')]['document'][a71_0x196e('0x41')],a71_0x196e('0x18'),a71_0x196e('0xd'),constants[a71_0x196e('0x12')][a71_0x196e('0x21')][a71_0x196e('0x7')]));}}else throw new errors[(a71_0x196e('0x14'))](errors[a71_0x196e('0x19')][a71_0x196e('0x2f')],this['client'][a71_0x196e('0x23')][a71_0x196e('0x3e')](_0xa5a9bf[a71_0x196e('0x1b')][a71_0x196e('0x10')]['language'],a71_0x196e('0x18'),'premiumPaidRoles',constants[a71_0x196e('0x12')][a71_0x196e('0x7')]));}}if(!_0xa5a9bf[a71_0x196e('0x15')][a71_0x196e('0x20')]['has'](a71_0x196e('0xf')))throw new Error(a71_0x196e('0x9'));return await Role_1[a71_0x196e('0x25')]['findOneAndUpdate']({'_id':_0x2ab2fe['id'],'guild':_0xa5a9bf[a71_0x196e('0x1b')]['id']},{'_id':_0x2ab2fe['id'],'guild':_0xa5a9bf['guild']['id'],'price':_0x278055['sell']},{'upsert':!![]}),await _0xa5a9bf[a71_0x196e('0x16')][a71_0x196e('0x3d')]({'embed':{'color':tesseract_1[a71_0x196e('0x2')]['COLORS'][a71_0x196e('0x40')],'description':this[a71_0x196e('0x34')][a71_0x196e('0x23')][a71_0x196e('0x3e')](_0xa5a9bf[a71_0x196e('0x1b')]['document']['language'],a71_0x196e('0xa'),a71_0x196e('0x3c'),_0xa5a9bf[a71_0x196e('0x2a')][a71_0x196e('0x13')],_0x2ab2fe['name'],_0x278055[a71_0x196e('0x11')])}})[a71_0x196e('0x2d')](()=>{});}if(_0x278055['buy']){if(_0xa5a9bf[a71_0x196e('0x15')][a71_0x196e('0x1a')][a71_0x196e('0x3')][a71_0x196e('0xb')](_0x2ab2fe['id']))throw new Error(a71_0x196e('0x35'));const _0x6e710a=await Role_1[a71_0x196e('0x25')][a71_0x196e('0x0')]({'_id':_0x2ab2fe['id'],'guild':_0xa5a9bf[a71_0x196e('0x1b')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x6e710a)throw new Error('ROLE_NOT_FOR_SALE');if(_0xa5a9bf[a71_0x196e('0x15')][a71_0x196e('0x10')][a71_0x196e('0x2e')]<_0x6e710a[a71_0x196e('0x2b')])throw new Error('INSUFFICIENT_BALANCE');return await _0xa5a9bf['member'][a71_0x196e('0x1a')]['add'](_0x2ab2fe),_0xa5a9bf['member']['debit'](_0x6e710a['price'],'Paid\x20Role',_0xa5a9bf[a71_0x196e('0x15')][a71_0x196e('0x10')]),await _0xa5a9bf['member'][a71_0x196e('0x10')][a71_0x196e('0x5')](),await _0xa5a9bf['channel'][a71_0x196e('0x3d')]({'embed':{'color':tesseract_1[a71_0x196e('0x2')][a71_0x196e('0x26')][a71_0x196e('0x40')],'description':this[a71_0x196e('0x34')]['locale']['getString'](_0xa5a9bf[a71_0x196e('0x1b')]['document'][a71_0x196e('0x41')],a71_0x196e('0xa'),a71_0x196e('0x28'),_0xa5a9bf[a71_0x196e('0x2a')][a71_0x196e('0x13')],_0x2ab2fe[a71_0x196e('0x17')],_0x6e710a[a71_0x196e('0x2b')])}})[a71_0x196e('0x2d')](()=>{});}if(_0x278055['unlist']){if(!_0xa5a9bf[a71_0x196e('0x15')]['permissions'][a71_0x196e('0xb')](a71_0x196e('0xf')))throw new Error(a71_0x196e('0x9'));return await Role_1[a71_0x196e('0x25')]['findOneAndUpdate']({'_id':_0x2ab2fe['id'],'guild':_0xa5a9bf[a71_0x196e('0x1b')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x2ab2fe['id'],'guild':_0xa5a9bf[a71_0x196e('0x1b')]['id'],'$unset':{'price':0x1}}),await _0xa5a9bf['channel'][a71_0x196e('0x3d')]({'embed':{'color':tesseract_1[a71_0x196e('0x2')][a71_0x196e('0x26')][a71_0x196e('0x3f')],'description':this['client'][a71_0x196e('0x23')][a71_0x196e('0x3e')](_0xa5a9bf[a71_0x196e('0x1b')][a71_0x196e('0x10')][a71_0x196e('0x41')],a71_0x196e('0xa'),a71_0x196e('0x1'),_0xa5a9bf[a71_0x196e('0x2a')][a71_0x196e('0x13')],_0x2ab2fe['name'])}})[a71_0x196e('0x2d')](()=>{});}}const _0x208d0c=await Role_1[a71_0x196e('0x25')][a71_0x196e('0x32')]({'guild':_0xa5a9bf['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x208d0c[a71_0x196e('0x36')])throw new Error(a71_0x196e('0x22'));return await _0xa5a9bf['channel'][a71_0x196e('0x3d')]({'embed':{'color':tesseract_1[a71_0x196e('0x2')][a71_0x196e('0x26')]['IRIS'],'title':'Roles\x20Store','fields':_0x208d0c[a71_0x196e('0xe')](_0x257dfc=>({'name':(_0xa5a9bf['guild'][a71_0x196e('0x1a')]['cache'][a71_0x196e('0xb')](_0x257dfc[a71_0x196e('0x33')])?_0xa5a9bf[a71_0x196e('0x1b')][a71_0x196e('0x1a')]['cache'][a71_0x196e('0x30')](_0x257dfc[a71_0x196e('0x33')])[a71_0x196e('0x17')]+'\x20/\x20':'')+_0x257dfc[a71_0x196e('0x33')],'value':_0x257dfc[a71_0x196e('0x2b')]+'\x20Bastion\x20Coins'}))}})['catch'](()=>{});};}};