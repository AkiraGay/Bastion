const a68_0x4d88=['roleStore','roleStore\x20ROLE\x20--buy','document','Command','COLORS','user','return\x20/\x22\x20+\x20this\x20+\x20\x22/','../../utils/numbers','Constants','unlist','constructor','INSUFFICIENT_BALANCE','RED','LIMITS','isPublicBastion','PREMIUM_MEMBERSHIP_REQUIRED','_id','tag','clamp','Roles\x20Store','find','MANAGE_ROLES','send','buy','compile','NO_ROLES_ON_SALE','map','locale','getString','channel','cache','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','member','price','permissions','PAID_ROLES','exec','../../models/Role','roleStore\x20ROLE\x20--unlist','membershipLimitPaidRoles','guild','findOneAndUpdate','resolver','has','@bastion/tesseract','join','catch','\x20/\x20','debit','client','premiumPaidRoles','error','roleStoreAdd','roles','length','roleStore\x20ROLE\x20--sell\x20AMOUNT','language','ROLE_NOT_FOR_SALE','findOne','get','sell','roleNotFound','NO_PERMISSION','info','author','name','BASTION_ERROR_TYPE','fetchPremiumTier','GOLD','countDocuments','DiscordError','apply','PLATINUM','errors','GREEN','default','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','exports','LIMITED_PREMIUM_MEMBERSHIP','balance'];(function(_0x5a26e4,_0x4d882e){const _0x7744b0=function(_0x2114f4){while(--_0x2114f4){_0x5a26e4['push'](_0x5a26e4['shift']());}};const _0x355611=function(){const _0x124664={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x41a70e,_0x448ce0,_0x30901e,_0x4f421b){_0x4f421b=_0x4f421b||{};let _0x2d426d=_0x448ce0+'='+_0x30901e;let _0x2e450f=0x0;for(let _0x54270b=0x0,_0x4a004a=_0x41a70e['length'];_0x54270b<_0x4a004a;_0x54270b++){const _0x2ad179=_0x41a70e[_0x54270b];_0x2d426d+=';\x20'+_0x2ad179;const _0x4f820f=_0x41a70e[_0x2ad179];_0x41a70e['push'](_0x4f820f);_0x4a004a=_0x41a70e['length'];if(_0x4f820f!==!![]){_0x2d426d+='='+_0x4f820f;}}_0x4f421b['cookie']=_0x2d426d;},'removeCookie':function(){return'dev';},'getCookie':function(_0xce1796,_0xad60be){_0xce1796=_0xce1796||function(_0x4d6c16){return _0x4d6c16;};const _0x6d6f02=_0xce1796(new RegExp('(?:^|;\x20)'+_0xad60be['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x666ba0=function(_0x3b6023,_0x1cd81a){_0x3b6023(++_0x1cd81a);};_0x666ba0(_0x7744b0,_0x4d882e);return _0x6d6f02?decodeURIComponent(_0x6d6f02[0x1]):undefined;}};const _0x2eb1c8=function(){const _0x2e7727=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2e7727['test'](_0x124664['removeCookie']['toString']());};_0x124664['updateCookie']=_0x2eb1c8;let _0x90fc60='';const _0x28b499=_0x124664['updateCookie']();if(!_0x28b499){_0x124664['setCookie'](['*'],'counter',0x1);}else if(_0x28b499){_0x90fc60=_0x124664['getCookie'](null,'counter');}else{_0x124664['removeCookie']();}};_0x355611();}(a68_0x4d88,0x1df));const a68_0x7744=function(_0x5a26e4,_0x4d882e){_0x5a26e4=_0x5a26e4-0x0;let _0x7744b0=a68_0x4d88[_0x5a26e4];return _0x7744b0;};const a68_0x124664=function(){let _0x526460=!![];return function(_0x307d19,_0x3c0e5f){const _0x135779=_0x526460?function(){if(_0x3c0e5f){const _0x2d9715=_0x3c0e5f[a68_0x7744('0x48')](_0x307d19,arguments);_0x3c0e5f=null;return _0x2d9715;}}:function(){};_0x526460=![];return _0x135779;};}();const a68_0x2114f4=a68_0x124664(this,function(){const _0x1299fc=function(){const _0x5dade2=_0x1299fc[a68_0x7744('0xb')](a68_0x7744('0x7'))()[a68_0x7744('0x19')](a68_0x7744('0x20'));return!_0x5dade2['test'](a68_0x2114f4);};return _0x1299fc();});a68_0x2114f4();'use strict';const tesseract_1=require(a68_0x7744('0x2d'));const Role_1=require(a68_0x7744('0x26'));const constants=require('../../utils/constants');const errors=require('../../utils/errors');const numbers=require(a68_0x7744('0x8'));const omnic=require('../../utils/omnic');module[a68_0x7744('0x4e')]=class RoleStoreCommand extends tesseract_1[a68_0x7744('0x4')]{constructor(){super(a68_0x7744('0x1'),{'description':a68_0x7744('0x4d'),'triggers':[],'arguments':{'boolean':['buy',a68_0x7744('0xa')],'number':[a68_0x7744('0x3d')],'coerce':{'sell':_0x1f63d7=>numbers[a68_0x7744('0x13')](_0x1f63d7,0x1,Number['MAX_SAFE_INTEGER'])}},'scope':a68_0x7744('0x29'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a68_0x7744('0x16')],'userPermissions':[],'syntax':[a68_0x7744('0x1'),a68_0x7744('0x38'),a68_0x7744('0x2'),a68_0x7744('0x27')]});this[a68_0x7744('0x25')]=async(_0x15f288,_0x3a3379)=>{if(_0x3a3379['_'][a68_0x7744('0x37')]){const _0x13a0cc=this[a68_0x7744('0x32')][a68_0x7744('0x2b')]['resolveRole'](_0x15f288['guild'],_0x3a3379['_'][a68_0x7744('0x2e')]('\x20'));if(!_0x13a0cc)throw new errors[(a68_0x7744('0x47'))](errors[a68_0x7744('0x43')]['ROLE_NOT_FOUND'],this['client'][a68_0x7744('0x1c')][a68_0x7744('0x1d')](_0x15f288['guild']['document']['language'],a68_0x7744('0x34'),a68_0x7744('0x3e')));if(_0x3a3379[a68_0x7744('0x3d')]>0x0){if(constants[a68_0x7744('0xf')](this[a68_0x7744('0x32')][a68_0x7744('0x6')])){const _0x3b853b=await Role_1[a68_0x7744('0x4c')][a68_0x7744('0x46')]({'guild':_0x15f288[a68_0x7744('0x29')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x3b853b>=constants[a68_0x7744('0xe')][a68_0x7744('0x24')]){const _0x323f2=await omnic[a68_0x7744('0x44')](_0x15f288[a68_0x7744('0x29')])[a68_0x7744('0x2f')](()=>{});if(_0x323f2){if(_0x323f2===omnic['PremiumTier'][a68_0x7744('0x45')]&&_0x3b853b>=constants[a68_0x7744('0xe')][a68_0x7744('0x45')]['PAID_ROLES']){throw new errors[(a68_0x7744('0x47'))](errors[a68_0x7744('0x43')][a68_0x7744('0x4f')],this['client'][a68_0x7744('0x1c')][a68_0x7744('0x1d')](_0x15f288['guild']['document'][a68_0x7744('0x39')],a68_0x7744('0x4a'),'membershipLimitPaidRoles',constants[a68_0x7744('0xe')][a68_0x7744('0x45')][a68_0x7744('0x24')]));}else if(_0x323f2===omnic['PremiumTier'][a68_0x7744('0x49')]&&_0x3b853b>=constants['LIMITS'][a68_0x7744('0x49')][a68_0x7744('0x24')]){throw new errors[(a68_0x7744('0x47'))](errors['BASTION_ERROR_TYPE'][a68_0x7744('0x4f')],this[a68_0x7744('0x32')][a68_0x7744('0x1c')][a68_0x7744('0x1d')](_0x15f288[a68_0x7744('0x29')][a68_0x7744('0x3')][a68_0x7744('0x39')],'errors',a68_0x7744('0x28'),constants[a68_0x7744('0xe')][a68_0x7744('0x49')][a68_0x7744('0x24')]));}}else{throw new errors[(a68_0x7744('0x47'))](errors[a68_0x7744('0x43')][a68_0x7744('0x10')],this[a68_0x7744('0x32')][a68_0x7744('0x1c')]['getString'](_0x15f288['guild'][a68_0x7744('0x3')]['language'],a68_0x7744('0x4a'),a68_0x7744('0x33'),constants[a68_0x7744('0xe')][a68_0x7744('0x24')]));}}}if(!_0x15f288[a68_0x7744('0x21')]['permissions'][a68_0x7744('0x2c')]('MANAGE_ROLES'))throw new Error('NO_PERMISSION');await Role_1[a68_0x7744('0x4c')][a68_0x7744('0x2a')]({'_id':_0x13a0cc['id'],'guild':_0x15f288[a68_0x7744('0x29')]['id']},{'_id':_0x13a0cc['id'],'guild':_0x15f288[a68_0x7744('0x29')]['id'],'price':_0x3a3379['sell']},{'upsert':!![]});return await _0x15f288[a68_0x7744('0x1e')][a68_0x7744('0x17')]({'embed':{'color':tesseract_1['Constants'][a68_0x7744('0x5')][a68_0x7744('0x4b')],'description':this[a68_0x7744('0x32')]['locale'][a68_0x7744('0x1d')](_0x15f288['guild']['document'][a68_0x7744('0x39')],a68_0x7744('0x40'),a68_0x7744('0x35'),_0x15f288[a68_0x7744('0x41')][a68_0x7744('0x12')],_0x13a0cc['name'],_0x3a3379[a68_0x7744('0x3d')])}})['catch'](()=>{});}if(_0x3a3379[a68_0x7744('0x18')]){if(_0x15f288['member'][a68_0x7744('0x36')][a68_0x7744('0x1f')][a68_0x7744('0x2c')](_0x13a0cc['id']))throw new Error('ROLE_ALREADY_ASSIGNED');const _0x4c21a5=await Role_1[a68_0x7744('0x4c')][a68_0x7744('0x3b')]({'_id':_0x13a0cc['id'],'guild':_0x15f288[a68_0x7744('0x29')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4c21a5)throw new Error(a68_0x7744('0x3a'));if(_0x15f288[a68_0x7744('0x21')][a68_0x7744('0x3')][a68_0x7744('0x0')]<_0x4c21a5['price'])throw new Error(a68_0x7744('0xc'));await _0x15f288['member'][a68_0x7744('0x36')]['add'](_0x13a0cc);_0x15f288[a68_0x7744('0x21')][a68_0x7744('0x31')](_0x4c21a5['price'],'Paid\x20Role',_0x15f288[a68_0x7744('0x21')][a68_0x7744('0x3')]);await _0x15f288['member'][a68_0x7744('0x3')]['save']();return await _0x15f288[a68_0x7744('0x1e')]['send']({'embed':{'color':tesseract_1[a68_0x7744('0x9')]['COLORS']['GREEN'],'description':this[a68_0x7744('0x32')]['locale'][a68_0x7744('0x1d')](_0x15f288[a68_0x7744('0x29')][a68_0x7744('0x3')][a68_0x7744('0x39')],'info','roleBought',_0x15f288[a68_0x7744('0x41')][a68_0x7744('0x12')],_0x13a0cc['name'],_0x3a3379[a68_0x7744('0x3d')])}})[a68_0x7744('0x2f')](()=>{});}if(_0x3a3379[a68_0x7744('0xa')]){if(!_0x15f288[a68_0x7744('0x21')][a68_0x7744('0x23')][a68_0x7744('0x2c')](a68_0x7744('0x16')))throw new Error(a68_0x7744('0x3f'));await Role_1['default'][a68_0x7744('0x2a')]({'_id':_0x13a0cc['id'],'guild':_0x15f288[a68_0x7744('0x29')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x13a0cc['id'],'guild':_0x15f288[a68_0x7744('0x29')]['id'],'$unset':{'price':0x1}});return await _0x15f288[a68_0x7744('0x1e')][a68_0x7744('0x17')]({'embed':{'color':tesseract_1[a68_0x7744('0x9')]['COLORS'][a68_0x7744('0xd')],'description':this[a68_0x7744('0x32')]['locale']['getString'](_0x15f288['guild'][a68_0x7744('0x3')][a68_0x7744('0x39')],a68_0x7744('0x40'),'roleStoreRemove',_0x15f288[a68_0x7744('0x41')][a68_0x7744('0x12')],_0x13a0cc['name'])}})[a68_0x7744('0x2f')](()=>{});}}const _0x5e3009=await Role_1[a68_0x7744('0x4c')][a68_0x7744('0x15')]({'guild':_0x15f288[a68_0x7744('0x29')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x5e3009[a68_0x7744('0x37')])throw new Error(a68_0x7744('0x1a'));return await _0x15f288[a68_0x7744('0x1e')][a68_0x7744('0x17')]({'embed':{'color':tesseract_1['Constants'][a68_0x7744('0x5')]['IRIS'],'title':a68_0x7744('0x14'),'fields':_0x5e3009[a68_0x7744('0x1b')](_0x4991a=>({'name':(_0x15f288[a68_0x7744('0x29')][a68_0x7744('0x36')]['cache'][a68_0x7744('0x2c')](_0x4991a[a68_0x7744('0x11')])?_0x15f288[a68_0x7744('0x29')][a68_0x7744('0x36')][a68_0x7744('0x1f')][a68_0x7744('0x3c')](_0x4991a['_id'])[a68_0x7744('0x42')]+a68_0x7744('0x30'):'')+_0x4991a[a68_0x7744('0x11')],'value':_0x4991a[a68_0x7744('0x22')]+'\x20Bastion\x20Coins'}))}})[a68_0x7744('0x2f')](()=>{});};}};