const a288_0x30e7=['return\x20/\x22\x20+\x20this\x20+\x20\x22/','send','user','../../utils/errors','exec','roleStore\x20ROLE\x20--sell\x20AMOUNT','PLATINUM','LIMITS','RED','DiscordError','Constants','ROLE_ALREADY_ASSIGNED','sell','COLORS','NO_PERMISSION','ROLE_NOT_FOR_SALE','BASTION_ERROR_TYPE','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','client','fetchPremiumTier','locale','../../utils/constants','\x20Bastion\x20Coins','roleStore\x20ROLE\x20--unlist','join','test','has','permissions','unlist','exports','PAID_ROLES','PREMIUM_MEMBERSHIP_REQUIRED','../../models/Role','price','length','info','IRIS','\x20/\x20','compile','save','PremiumTier','MAX_SAFE_INTEGER','roleStoreRemove','NO_ROLES_ON_SALE','roleNotFound','../../utils/numbers','Roles\x20Store','GOLD','LIMITED_PREMIUM_MEMBERSHIP','MANAGE_ROLES','tag','roleBought','guild','clamp','roleStore','channel','cache','apply','find','_id','map','findOne','findOneAndUpdate','membershipLimitPaidRoles','name','getString','author','debit','ROLE_NOT_FOUND','../../utils/omnic','errors','member','add','buy','document','language','INSUFFICIENT_BALANCE','isPublicBastion','roles','default','catch','GREEN','premiumPaidRoles','Paid\x20Role','error'];(function(_0x47cc1a,_0x30e70d){const _0x200e2b=function(_0x1516fe){while(--_0x1516fe){_0x47cc1a['push'](_0x47cc1a['shift']());}};const _0x27c09f=function(){const _0xc84fd1={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3dafe1,_0x279918,_0x22cd83,_0x3af3ff){_0x3af3ff=_0x3af3ff||{};let _0x48d049=_0x279918+'='+_0x22cd83;let _0x2ab826=0x0;for(let _0x342033=0x0,_0x142f40=_0x3dafe1['length'];_0x342033<_0x142f40;_0x342033++){const _0x3abe24=_0x3dafe1[_0x342033];_0x48d049+=';\x20'+_0x3abe24;const _0x1ca812=_0x3dafe1[_0x3abe24];_0x3dafe1['push'](_0x1ca812);_0x142f40=_0x3dafe1['length'];if(_0x1ca812!==!![]){_0x48d049+='='+_0x1ca812;}}_0x3af3ff['cookie']=_0x48d049;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3e15f9,_0x487b34){_0x3e15f9=_0x3e15f9||function(_0x396201){return _0x396201;};const _0x5739c8=_0x3e15f9(new RegExp('(?:^|;\x20)'+_0x487b34['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x4ecbf7=function(_0x1ea921,_0x5d5829){_0x1ea921(++_0x5d5829);};_0x4ecbf7(_0x200e2b,_0x30e70d);return _0x5739c8?decodeURIComponent(_0x5739c8[0x1]):undefined;}};const _0x4a9cfb=function(){const _0x312c50=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x312c50['test'](_0xc84fd1['removeCookie']['toString']());};_0xc84fd1['updateCookie']=_0x4a9cfb;let _0x18d569='';const _0x5872e8=_0xc84fd1['updateCookie']();if(!_0x5872e8){_0xc84fd1['setCookie'](['*'],'counter',0x1);}else if(_0x5872e8){_0x18d569=_0xc84fd1['getCookie'](null,'counter');}else{_0xc84fd1['removeCookie']();}};_0x27c09f();}(a288_0x30e7,0x191));const a288_0x200e=function(_0x47cc1a,_0x30e70d){_0x47cc1a=_0x47cc1a-0x0;let _0x200e2b=a288_0x30e7[_0x47cc1a];return _0x200e2b;};const a288_0xc84fd1=function(){let _0x4cb27d=!![];return function(_0x4a8587,_0x2aa11d){const _0x4ae1b7=_0x4cb27d?function(){if(_0x2aa11d){const _0xd0ee7=_0x2aa11d[a288_0x200e('0x51')](_0x4a8587,arguments);_0x2aa11d=null;return _0xd0ee7;}}:function(){};_0x4cb27d=![];return _0x4ae1b7;};}();const a288_0x1516fe=a288_0xc84fd1(this,function(){const _0x43d616=function(){const _0x39de43=_0x43d616['constructor'](a288_0x200e('0x18'))()[a288_0x200e('0x3e')](a288_0x200e('0x29'));return!_0x39de43[a288_0x200e('0x31')](a288_0x1516fe);};return _0x43d616();});a288_0x1516fe();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require(a288_0x200e('0x38'));const constants=require(a288_0x200e('0x2d'));const errors=require(a288_0x200e('0x1b'));const numbers=require(a288_0x200e('0x45'));const omnic=require(a288_0x200e('0x8'));module[a288_0x200e('0x35')]=class RoleStoreCommand extends tesseract_1['Command']{constructor(){super('roleStore',{'description':'It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','triggers':[],'arguments':{'boolean':[a288_0x200e('0xc'),a288_0x200e('0x34')],'number':['sell'],'coerce':{'sell':_0x1f7c9a=>numbers[a288_0x200e('0x4d')](_0x1f7c9a,0x1,Number[a288_0x200e('0x41')])}},'scope':a288_0x200e('0x4c'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a288_0x200e('0x49')],'userPermissions':[],'syntax':[a288_0x200e('0x4e'),a288_0x200e('0x1d'),'roleStore\x20ROLE\x20--buy',a288_0x200e('0x2f')]});this[a288_0x200e('0x1c')]=async(_0x14db3e,_0x4c4b27)=>{if(_0x4c4b27['_'][a288_0x200e('0x3a')]){const _0x4598c0=this[a288_0x200e('0x2a')]['resolver']['resolveRole'](_0x14db3e[a288_0x200e('0x4c')],_0x4c4b27['_'][a288_0x200e('0x30')]('\x20'));if(!_0x4598c0)throw new errors[(a288_0x200e('0x21'))](errors[a288_0x200e('0x28')][a288_0x200e('0x7')],this[a288_0x200e('0x2a')][a288_0x200e('0x2c')][a288_0x200e('0x4')](_0x14db3e['guild']['document'][a288_0x200e('0xe')],a288_0x200e('0x17'),a288_0x200e('0x44')));if(_0x4c4b27[a288_0x200e('0x24')]>0x0){if(constants[a288_0x200e('0x10')](this['client'][a288_0x200e('0x1a')])){const _0x4c4253=await Role_1[a288_0x200e('0x12')]['countDocuments']({'guild':_0x14db3e[a288_0x200e('0x4c')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x4c4253>=constants[a288_0x200e('0x1f')][a288_0x200e('0x36')]){const _0xbb88d9=await omnic[a288_0x200e('0x2b')](_0x14db3e[a288_0x200e('0x4c')])[a288_0x200e('0x13')](()=>{});if(_0xbb88d9){if(_0xbb88d9===omnic[a288_0x200e('0x40')][a288_0x200e('0x47')]&&_0x4c4253>=constants[a288_0x200e('0x1f')]['GOLD'][a288_0x200e('0x36')]){throw new errors[(a288_0x200e('0x21'))](errors[a288_0x200e('0x28')][a288_0x200e('0x48')],this['client'][a288_0x200e('0x2c')][a288_0x200e('0x4')](_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0xd')]['language'],a288_0x200e('0x9'),a288_0x200e('0x2'),constants[a288_0x200e('0x1f')][a288_0x200e('0x47')][a288_0x200e('0x36')]));}else if(_0xbb88d9===omnic[a288_0x200e('0x40')]['PLATINUM']&&_0x4c4253>=constants[a288_0x200e('0x1f')][a288_0x200e('0x1e')][a288_0x200e('0x36')]){throw new errors[(a288_0x200e('0x21'))](errors[a288_0x200e('0x28')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a288_0x200e('0x2a')]['locale'][a288_0x200e('0x4')](_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0xd')][a288_0x200e('0xe')],a288_0x200e('0x9'),a288_0x200e('0x2'),constants[a288_0x200e('0x1f')][a288_0x200e('0x1e')][a288_0x200e('0x36')]));}}else{throw new errors[(a288_0x200e('0x21'))](errors['BASTION_ERROR_TYPE'][a288_0x200e('0x37')],this[a288_0x200e('0x2a')][a288_0x200e('0x2c')][a288_0x200e('0x4')](_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0xd')][a288_0x200e('0xe')],'errors',a288_0x200e('0x15'),constants['LIMITS']['PAID_ROLES']));}}}if(!_0x14db3e[a288_0x200e('0xa')][a288_0x200e('0x33')]['has'](a288_0x200e('0x49')))throw new Error(a288_0x200e('0x26'));await Role_1['default']['findOneAndUpdate']({'_id':_0x4598c0['id'],'guild':_0x14db3e['guild']['id']},{'_id':_0x4598c0['id'],'guild':_0x14db3e[a288_0x200e('0x4c')]['id'],'price':_0x4c4b27['sell']},{'upsert':!![]});return await _0x14db3e[a288_0x200e('0x4f')]['send']({'embed':{'color':tesseract_1[a288_0x200e('0x22')][a288_0x200e('0x25')][a288_0x200e('0x14')],'description':this[a288_0x200e('0x2a')][a288_0x200e('0x2c')][a288_0x200e('0x4')](_0x14db3e['guild'][a288_0x200e('0xd')]['language'],a288_0x200e('0x3b'),'roleStoreAdd',_0x14db3e[a288_0x200e('0x5')][a288_0x200e('0x4a')],_0x4598c0[a288_0x200e('0x3')],_0x4c4b27['sell'])}})['catch'](()=>{});}if(_0x4c4b27[a288_0x200e('0xc')]){if(_0x14db3e[a288_0x200e('0xa')][a288_0x200e('0x11')]['cache']['has'](_0x4598c0['id']))throw new Error(a288_0x200e('0x23'));const _0x55be73=await Role_1[a288_0x200e('0x12')][a288_0x200e('0x0')]({'_id':_0x4598c0['id'],'guild':_0x14db3e[a288_0x200e('0x4c')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x55be73)throw new Error(a288_0x200e('0x27'));if(_0x14db3e[a288_0x200e('0xa')]['document']['balance']<_0x55be73[a288_0x200e('0x39')])throw new Error(a288_0x200e('0xf'));await _0x14db3e[a288_0x200e('0xa')][a288_0x200e('0x11')][a288_0x200e('0xb')](_0x4598c0);_0x14db3e['member'][a288_0x200e('0x6')](_0x55be73[a288_0x200e('0x39')],a288_0x200e('0x16'),_0x14db3e['member']['document']);await _0x14db3e[a288_0x200e('0xa')]['document'][a288_0x200e('0x3f')]();return await _0x14db3e[a288_0x200e('0x4f')][a288_0x200e('0x19')]({'embed':{'color':tesseract_1['Constants'][a288_0x200e('0x25')][a288_0x200e('0x14')],'description':this[a288_0x200e('0x2a')]['locale']['getString'](_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0xd')]['language'],a288_0x200e('0x3b'),a288_0x200e('0x4b'),_0x14db3e[a288_0x200e('0x5')][a288_0x200e('0x4a')],_0x4598c0['name'],_0x4c4b27['sell'])}})['catch'](()=>{});}if(_0x4c4b27[a288_0x200e('0x34')]){if(!_0x14db3e[a288_0x200e('0xa')][a288_0x200e('0x33')][a288_0x200e('0x32')](a288_0x200e('0x49')))throw new Error(a288_0x200e('0x26'));await Role_1[a288_0x200e('0x12')][a288_0x200e('0x1')]({'_id':_0x4598c0['id'],'guild':_0x14db3e[a288_0x200e('0x4c')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x4598c0['id'],'guild':_0x14db3e['guild']['id'],'$unset':{'price':0x1}});return await _0x14db3e[a288_0x200e('0x4f')][a288_0x200e('0x19')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a288_0x200e('0x20')],'description':this[a288_0x200e('0x2a')][a288_0x200e('0x2c')]['getString'](_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0xd')][a288_0x200e('0xe')],a288_0x200e('0x3b'),a288_0x200e('0x42'),_0x14db3e[a288_0x200e('0x5')][a288_0x200e('0x4a')],_0x4598c0[a288_0x200e('0x3')])}})[a288_0x200e('0x13')](()=>{});}}const _0x298492=await Role_1[a288_0x200e('0x12')][a288_0x200e('0x52')]({'guild':_0x14db3e[a288_0x200e('0x4c')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x298492[a288_0x200e('0x3a')])throw new Error(a288_0x200e('0x43'));return await _0x14db3e[a288_0x200e('0x4f')]['send']({'embed':{'color':tesseract_1[a288_0x200e('0x22')][a288_0x200e('0x25')][a288_0x200e('0x3c')],'title':a288_0x200e('0x46'),'fields':_0x298492[a288_0x200e('0x54')](_0x1edd50=>({'name':(_0x14db3e[a288_0x200e('0x4c')][a288_0x200e('0x11')][a288_0x200e('0x50')][a288_0x200e('0x32')](_0x1edd50[a288_0x200e('0x53')])?_0x14db3e[a288_0x200e('0x4c')]['roles']['cache']['get'](_0x1edd50[a288_0x200e('0x53')])[a288_0x200e('0x3')]+a288_0x200e('0x3d'):'')+_0x1edd50[a288_0x200e('0x53')],'value':_0x1edd50[a288_0x200e('0x39')]+a288_0x200e('0x2e')}))}})[a288_0x200e('0x13')](()=>{});};}};