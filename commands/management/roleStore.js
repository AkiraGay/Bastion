const a69_0x46cb=['MAX_SAFE_INTEGER','author','add','premiumPaidRoles','roleStore\x20ROLE\x20--sell\x20AMOUNT','ROLE_ALREADY_ASSIGNED','buy','send','BASTION_ERROR_TYPE','_id','test','roleStoreRemove','Constants','name','document','sell','Paid\x20Role','length','GOLD','NO_PERMISSION','../../utils/constants','save','MANAGE_ROLES','channel','INSUFFICIENT_BALANCE','roleStore\x20ROLE\x20--buy','clamp','map','language','../../models/Role','RED','../../utils/errors','tag','cache','roleStoreAdd','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','roleStore\x20ROLE\x20--unlist','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','has','compile','error','findOneAndUpdate','join','default','info','resolver','price','get','../../utils/numbers','roleNotFound','balance','@bastion/tesseract','resolveRole','find','../../utils/omnic','roleBought','\x20/\x20','roles','COLORS','IRIS','client','PLATINUM','errors','ROLE_NOT_FOR_SALE','Roles\x20Store','return\x20/\x22\x20+\x20this\x20+\x20\x22/','LIMITS','PAID_ROLES','user','guild','unlist','LIMITED_PREMIUM_MEMBERSHIP','getString','member','membershipLimitPaidRoles','Command','permissions','roleStore','catch','PremiumTier','DiscordError','locale','GREEN'];(function(_0x243c4d,_0x46cb4f){const _0x29298e=function(_0x1d2895){while(--_0x1d2895){_0x243c4d['push'](_0x243c4d['shift']());}};const _0x36480c=function(){const _0x4fdcbe={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x18c674,_0x1b69c0,_0x2957ce,_0x2b9b89){_0x2b9b89=_0x2b9b89||{};let _0x159598=_0x1b69c0+'='+_0x2957ce;let _0x2825ab=0x0;for(let _0x25f80d=0x0,_0x178182=_0x18c674['length'];_0x25f80d<_0x178182;_0x25f80d++){const _0x2f86ca=_0x18c674[_0x25f80d];_0x159598+=';\x20'+_0x2f86ca;const _0xc2e629=_0x18c674[_0x2f86ca];_0x18c674['push'](_0xc2e629);_0x178182=_0x18c674['length'];if(_0xc2e629!==!![]){_0x159598+='='+_0xc2e629;}}_0x2b9b89['cookie']=_0x159598;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5228d2,_0xc31eee){_0x5228d2=_0x5228d2||function(_0x1a5661){return _0x1a5661;};const _0x439c94=_0x5228d2(new RegExp('(?:^|;\x20)'+_0xc31eee['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x382752=function(_0x27692a,_0x30fa47){_0x27692a(++_0x30fa47);};_0x382752(_0x29298e,_0x46cb4f);return _0x439c94?decodeURIComponent(_0x439c94[0x1]):undefined;}};const _0x1a35d4=function(){const _0x1675dd=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x1675dd['test'](_0x4fdcbe['removeCookie']['toString']());};_0x4fdcbe['updateCookie']=_0x1a35d4;let _0x5e2a04='';const _0x480eeb=_0x4fdcbe['updateCookie']();if(!_0x480eeb){_0x4fdcbe['setCookie'](['*'],'counter',0x1);}else if(_0x480eeb){_0x5e2a04=_0x4fdcbe['getCookie'](null,'counter');}else{_0x4fdcbe['removeCookie']();}};_0x36480c();}(a69_0x46cb,0xfc));const a69_0x2929=function(_0x243c4d,_0x46cb4f){_0x243c4d=_0x243c4d-0x0;let _0x29298e=a69_0x46cb[_0x243c4d];return _0x29298e;};const a69_0x4fdcbe=function(){let _0x10e7a4=!![];return function(_0x3b104e,_0x3a5a48){const _0x5d56cb=_0x10e7a4?function(){if(_0x3a5a48){const _0x49c883=_0x3a5a48['apply'](_0x3b104e,arguments);_0x3a5a48=null;return _0x49c883;}}:function(){};_0x10e7a4=![];return _0x5d56cb;};}();const a69_0x1d2895=a69_0x4fdcbe(this,function(){const _0x46d71b=function(){const _0x267a07=_0x46d71b['constructor'](a69_0x2929('0x3e'))()[a69_0x2929('0x24')](a69_0x2929('0x20'));return!_0x267a07[a69_0x2929('0x7')](a69_0x1d2895);};return _0x46d71b();});a69_0x1d2895();'use strict';const tesseract_1=require(a69_0x2929('0x30'));const Role_1=require(a69_0x2929('0x1a'));const constants=require(a69_0x2929('0x11'));const errors=require(a69_0x2929('0x1c'));const numbers=require(a69_0x2929('0x2d'));const omnic=require(a69_0x2929('0x33'));module['exports']=class RoleStoreCommand extends tesseract_1[a69_0x2929('0x48')]{constructor(){super(a69_0x2929('0x4a'),{'description':a69_0x2929('0x22'),'triggers':[],'arguments':{'boolean':[a69_0x2929('0x3'),a69_0x2929('0x43')],'number':[a69_0x2929('0xc')],'coerce':{'sell':_0x2eb80a=>numbers[a69_0x2929('0x17')](_0x2eb80a,0x1,Number[a69_0x2929('0x50')])}},'scope':a69_0x2929('0x42'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[a69_0x2929('0x4a'),a69_0x2929('0x1'),a69_0x2929('0x16'),a69_0x2929('0x21')]});this['exec']=async(_0x284be1,_0x48a8df)=>{if(_0x48a8df['_']['length']){const _0xc32f42=this['client'][a69_0x2929('0x2a')][a69_0x2929('0x31')](_0x284be1['guild'],_0x48a8df['_'][a69_0x2929('0x27')]('\x20'));if(!_0xc32f42)throw new errors[(a69_0x2929('0x4d'))](errors[a69_0x2929('0x5')]['ROLE_NOT_FOUND'],this[a69_0x2929('0x39')][a69_0x2929('0x4e')][a69_0x2929('0x45')](_0x284be1['guild'][a69_0x2929('0xb')][a69_0x2929('0x19')],a69_0x2929('0x25'),a69_0x2929('0x2e')));if(_0x48a8df[a69_0x2929('0xc')]>0x0){if(constants['isPublicBastion'](this[a69_0x2929('0x39')][a69_0x2929('0x41')])){const _0x5d60f8=await Role_1[a69_0x2929('0x28')]['countDocuments']({'guild':_0x284be1[a69_0x2929('0x42')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x5d60f8>=constants[a69_0x2929('0x3f')][a69_0x2929('0x40')]){const _0x49abee=await omnic['fetchPremiumTier'](_0x284be1[a69_0x2929('0x42')])['catch'](()=>{});if(_0x49abee){if(_0x49abee===omnic['PremiumTier'][a69_0x2929('0xf')]&&_0x5d60f8>=constants['LIMITS'][a69_0x2929('0xf')][a69_0x2929('0x40')]){throw new errors['DiscordError'](errors[a69_0x2929('0x5')][a69_0x2929('0x44')],this[a69_0x2929('0x39')]['locale'][a69_0x2929('0x45')](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')]['language'],a69_0x2929('0x3b'),a69_0x2929('0x47'),constants['LIMITS'][a69_0x2929('0xf')][a69_0x2929('0x40')]));}else if(_0x49abee===omnic[a69_0x2929('0x4c')][a69_0x2929('0x3a')]&&_0x5d60f8>=constants['LIMITS'][a69_0x2929('0x3a')][a69_0x2929('0x40')]){throw new errors[(a69_0x2929('0x4d'))](errors[a69_0x2929('0x5')][a69_0x2929('0x44')],this['client'][a69_0x2929('0x4e')][a69_0x2929('0x45')](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')]['language'],a69_0x2929('0x3b'),'membershipLimitPaidRoles',constants[a69_0x2929('0x3f')][a69_0x2929('0x3a')]['PAID_ROLES']));}}else{throw new errors[(a69_0x2929('0x4d'))](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[a69_0x2929('0x39')]['locale'][a69_0x2929('0x45')](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')]['language'],a69_0x2929('0x3b'),a69_0x2929('0x0'),constants['LIMITS'][a69_0x2929('0x40')]));}}}if(!_0x284be1[a69_0x2929('0x46')][a69_0x2929('0x49')][a69_0x2929('0x23')](a69_0x2929('0x13')))throw new Error('NO_PERMISSION');await Role_1[a69_0x2929('0x28')][a69_0x2929('0x26')]({'_id':_0xc32f42['id'],'guild':_0x284be1[a69_0x2929('0x42')]['id']},{'_id':_0xc32f42['id'],'guild':_0x284be1[a69_0x2929('0x42')]['id'],'price':_0x48a8df['sell']},{'upsert':!![]});return await _0x284be1[a69_0x2929('0x14')][a69_0x2929('0x4')]({'embed':{'color':tesseract_1['Constants'][a69_0x2929('0x37')][a69_0x2929('0x4f')],'description':this[a69_0x2929('0x39')][a69_0x2929('0x4e')]['getString'](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')][a69_0x2929('0x19')],a69_0x2929('0x29'),a69_0x2929('0x1f'),_0x284be1[a69_0x2929('0x51')]['tag'],_0xc32f42['name'],_0x48a8df[a69_0x2929('0xc')])}})[a69_0x2929('0x4b')](()=>{});}if(_0x48a8df[a69_0x2929('0x3')]){if(_0x284be1['member'][a69_0x2929('0x36')][a69_0x2929('0x1e')][a69_0x2929('0x23')](_0xc32f42['id']))throw new Error(a69_0x2929('0x2'));const _0x222566=await Role_1['default']['findOne']({'_id':_0xc32f42['id'],'guild':_0x284be1[a69_0x2929('0x42')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x222566)throw new Error(a69_0x2929('0x3c'));if(_0x284be1['member'][a69_0x2929('0xb')][a69_0x2929('0x2f')]<_0x222566['price'])throw new Error(a69_0x2929('0x15'));await _0x284be1['member'][a69_0x2929('0x36')][a69_0x2929('0x52')](_0xc32f42);_0x284be1['member']['debit'](_0x222566[a69_0x2929('0x2b')],a69_0x2929('0xd'),_0x284be1['member'][a69_0x2929('0xb')]);await _0x284be1[a69_0x2929('0x46')][a69_0x2929('0xb')][a69_0x2929('0x12')]();return await _0x284be1[a69_0x2929('0x14')][a69_0x2929('0x4')]({'embed':{'color':tesseract_1[a69_0x2929('0x9')][a69_0x2929('0x37')][a69_0x2929('0x4f')],'description':this[a69_0x2929('0x39')][a69_0x2929('0x4e')][a69_0x2929('0x45')](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')][a69_0x2929('0x19')],'info',a69_0x2929('0x34'),_0x284be1[a69_0x2929('0x51')][a69_0x2929('0x1d')],_0xc32f42[a69_0x2929('0xa')],_0x48a8df[a69_0x2929('0xc')])}})[a69_0x2929('0x4b')](()=>{});}if(_0x48a8df[a69_0x2929('0x43')]){if(!_0x284be1[a69_0x2929('0x46')][a69_0x2929('0x49')][a69_0x2929('0x23')](a69_0x2929('0x13')))throw new Error(a69_0x2929('0x10'));await Role_1[a69_0x2929('0x28')][a69_0x2929('0x26')]({'_id':_0xc32f42['id'],'guild':_0x284be1[a69_0x2929('0x42')]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0xc32f42['id'],'guild':_0x284be1[a69_0x2929('0x42')]['id'],'$unset':{'price':0x1}});return await _0x284be1[a69_0x2929('0x14')]['send']({'embed':{'color':tesseract_1['Constants']['COLORS'][a69_0x2929('0x1b')],'description':this[a69_0x2929('0x39')][a69_0x2929('0x4e')]['getString'](_0x284be1[a69_0x2929('0x42')][a69_0x2929('0xb')][a69_0x2929('0x19')],a69_0x2929('0x29'),a69_0x2929('0x8'),_0x284be1[a69_0x2929('0x51')][a69_0x2929('0x1d')],_0xc32f42[a69_0x2929('0xa')])}})[a69_0x2929('0x4b')](()=>{});}}const _0x3c713e=await Role_1[a69_0x2929('0x28')][a69_0x2929('0x32')]({'guild':_0x284be1['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3c713e[a69_0x2929('0xe')])throw new Error('NO_ROLES_ON_SALE');return await _0x284be1[a69_0x2929('0x14')]['send']({'embed':{'color':tesseract_1[a69_0x2929('0x9')][a69_0x2929('0x37')][a69_0x2929('0x38')],'title':a69_0x2929('0x3d'),'fields':_0x3c713e[a69_0x2929('0x18')](_0x28476d=>({'name':(_0x284be1[a69_0x2929('0x42')]['roles'][a69_0x2929('0x1e')]['has'](_0x28476d[a69_0x2929('0x6')])?_0x284be1[a69_0x2929('0x42')]['roles'][a69_0x2929('0x1e')][a69_0x2929('0x2c')](_0x28476d[a69_0x2929('0x6')])[a69_0x2929('0xa')]+a69_0x2929('0x35'):'')+_0x28476d[a69_0x2929('0x6')],'value':_0x28476d['price']+'\x20Bastion\x20Coins'}))}})['catch'](()=>{});};}};