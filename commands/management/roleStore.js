const a508_0x40e6=['errors','../../models/Role','tag','../../utils/numbers','apply','find','membershipLimitPaidRoles','_id','permissions','PLATINUM','\x20/\x20','Paid\x20Role','COLORS','Command','INSUFFICIENT_BALANCE','has','PAID_ROLES','roleStoreAdd','GOLD','roleStore\x20ROLE\x20--unlist','findOneAndUpdate','../../utils/errors','get','DiscordError','LIMITS','ROLE_ALREADY_ASSIGNED','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','unlist','BASTION_ERROR_TYPE','roleNotFound','member','fetchPremiumTier','findOne','PREMIUM_MEMBERSHIP_REQUIRED','info','../../utils/omnic','client','catch','balance','return\x20/\x22\x20+\x20this\x20+\x20\x22/','resolveRole','default','buy','roleStore\x20ROLE\x20--sell\x20AMOUNT','roleStore\x20ROLE\x20--buy','\x20Bastion\x20Coins','premiumPaidRoles','roleStore','save','NO_PERMISSION','map','document','user','clamp','roles','cache','name','ROLE_NOT_FOR_SALE','RED','resolver','sell','roleStoreRemove','author','error','compile','locale','guild','channel','send','ROLE_NOT_FOUND','LIMITED_PREMIUM_MEMBERSHIP','constructor','language','add','price','IRIS','length','MANAGE_ROLES','../../utils/constants','Constants','getString','MAX_SAFE_INTEGER','Roles\x20Store','GREEN','countDocuments'];(function(_0x5be58f,_0x40e647){const _0x3f5126=function(_0xd3dd0d){while(--_0xd3dd0d){_0x5be58f['push'](_0x5be58f['shift']());}};const _0x1631c5=function(){const _0x586cdd={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2ca0d7,_0x25f2db,_0x48a1e8,_0x5b2db8){_0x5b2db8=_0x5b2db8||{};let _0x49da5e=_0x25f2db+'='+_0x48a1e8;let _0x441cf4=0x0;for(let _0x45bc65=0x0,_0x3f95eb=_0x2ca0d7['length'];_0x45bc65<_0x3f95eb;_0x45bc65++){const _0x2484e7=_0x2ca0d7[_0x45bc65];_0x49da5e+=';\x20'+_0x2484e7;const _0x7e2844=_0x2ca0d7[_0x2484e7];_0x2ca0d7['push'](_0x7e2844);_0x3f95eb=_0x2ca0d7['length'];if(_0x7e2844!==!![]){_0x49da5e+='='+_0x7e2844;}}_0x5b2db8['cookie']=_0x49da5e;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5be5c6,_0x468c63){_0x5be5c6=_0x5be5c6||function(_0x79709){return _0x79709;};const _0x4da666=_0x5be5c6(new RegExp('(?:^|;\x20)'+_0x468c63['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x32b68c=function(_0x2ada44,_0x392450){_0x2ada44(++_0x392450);};_0x32b68c(_0x3f5126,_0x40e647);return _0x4da666?decodeURIComponent(_0x4da666[0x1]):undefined;}};const _0x187126=function(){const _0x20bd42=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x20bd42['test'](_0x586cdd['removeCookie']['toString']());};_0x586cdd['updateCookie']=_0x187126;let _0x41bf24='';const _0x393122=_0x586cdd['updateCookie']();if(!_0x393122){_0x586cdd['setCookie'](['*'],'counter',0x1);}else if(_0x393122){_0x41bf24=_0x586cdd['getCookie'](null,'counter');}else{_0x586cdd['removeCookie']();}};_0x1631c5();}(a508_0x40e6,0x1e6));const a508_0x3f51=function(_0x5be58f,_0x40e647){_0x5be58f=_0x5be58f-0x0;let _0x3f5126=a508_0x40e6[_0x5be58f];return _0x3f5126;};const a508_0x586cdd=function(){let _0x2ccf19=!![];return function(_0x227163,_0x466825){const _0x255698=_0x2ccf19?function(){if(_0x466825){const _0x2766a9=_0x466825[a508_0x3f51('0x1c')](_0x227163,arguments);_0x466825=null;return _0x2766a9;}}:function(){};_0x2ccf19=![];return _0x255698;};}();const a508_0xd3dd0d=a508_0x586cdd(this,function(){const _0x1273e1=function(){const _0x2768a9=_0x1273e1[a508_0x3f51('0xa')](a508_0x3f51('0x3f'))()[a508_0x3f51('0x3')]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x2768a9['test'](a508_0xd3dd0d);};return _0x1273e1();});a508_0xd3dd0d();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require(a508_0x3f51('0x19'));const constants=require(a508_0x3f51('0x11'));const errors=require(a508_0x3f51('0x2d'));const numbers=require(a508_0x3f51('0x1b'));const omnic=require(a508_0x3f51('0x3b'));module['exports']=class RoleStoreCommand extends tesseract_1[a508_0x3f51('0x25')]{constructor(){super('roleStore',{'description':a508_0x3f51('0x32'),'triggers':[],'arguments':{'boolean':[a508_0x3f51('0x42'),a508_0x3f51('0x33')],'number':[a508_0x3f51('0x54')],'coerce':{'sell':_0xbb2880=>numbers[a508_0x3f51('0x4d')](_0xbb2880,0x1,Number[a508_0x3f51('0x14')])}},'scope':a508_0x3f51('0x5'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[],'syntax':[a508_0x3f51('0x47'),a508_0x3f51('0x43'),a508_0x3f51('0x44'),a508_0x3f51('0x2b')]});this['exec']=async(_0x247c57,_0x46905d)=>{if(_0x46905d['_'][a508_0x3f51('0xf')]){const _0x471e3a=this['client'][a508_0x3f51('0x53')][a508_0x3f51('0x40')](_0x247c57[a508_0x3f51('0x5')],_0x46905d['_']['join']('\x20'));if(!_0x471e3a)throw new errors['DiscordError'](errors[a508_0x3f51('0x34')][a508_0x3f51('0x8')],this[a508_0x3f51('0x3c')][a508_0x3f51('0x4')][a508_0x3f51('0x13')](_0x247c57['guild'][a508_0x3f51('0x4b')][a508_0x3f51('0xb')],a508_0x3f51('0x2'),a508_0x3f51('0x35')));if(_0x46905d['sell']>0x0){if(constants['isPublicBastion'](this[a508_0x3f51('0x3c')][a508_0x3f51('0x4c')])){const _0xa43b4e=await Role_1[a508_0x3f51('0x41')][a508_0x3f51('0x17')]({'guild':_0x247c57[a508_0x3f51('0x5')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0xa43b4e>=constants[a508_0x3f51('0x30')][a508_0x3f51('0x28')]){const _0x2cae98=await omnic[a508_0x3f51('0x37')](_0x247c57[a508_0x3f51('0x5')])[a508_0x3f51('0x3d')](()=>{});if(_0x2cae98){if(_0x2cae98===omnic['PremiumTier'][a508_0x3f51('0x2a')]&&_0xa43b4e>=constants[a508_0x3f51('0x30')][a508_0x3f51('0x2a')][a508_0x3f51('0x28')]){throw new errors[(a508_0x3f51('0x2f'))](errors[a508_0x3f51('0x34')][a508_0x3f51('0x9')],this[a508_0x3f51('0x3c')][a508_0x3f51('0x4')][a508_0x3f51('0x13')](_0x247c57['guild'][a508_0x3f51('0x4b')]['language'],'errors',a508_0x3f51('0x1e'),constants[a508_0x3f51('0x30')][a508_0x3f51('0x2a')]['PAID_ROLES']));}else if(_0x2cae98===omnic['PremiumTier']['PLATINUM']&&_0xa43b4e>=constants[a508_0x3f51('0x30')][a508_0x3f51('0x21')][a508_0x3f51('0x28')]){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[a508_0x3f51('0x3c')]['locale'][a508_0x3f51('0x13')](_0x247c57[a508_0x3f51('0x5')][a508_0x3f51('0x4b')][a508_0x3f51('0xb')],a508_0x3f51('0x18'),a508_0x3f51('0x1e'),constants['LIMITS'][a508_0x3f51('0x21')][a508_0x3f51('0x28')]));}}else{throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a508_0x3f51('0x39')],this[a508_0x3f51('0x3c')][a508_0x3f51('0x4')][a508_0x3f51('0x13')](_0x247c57[a508_0x3f51('0x5')]['document'][a508_0x3f51('0xb')],'errors',a508_0x3f51('0x46'),constants[a508_0x3f51('0x30')][a508_0x3f51('0x28')]));}}}if(!_0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x20')][a508_0x3f51('0x27')](a508_0x3f51('0x10')))throw new Error('NO_PERMISSION');await Role_1[a508_0x3f51('0x41')]['findOneAndUpdate']({'_id':_0x471e3a['id'],'guild':_0x247c57[a508_0x3f51('0x5')]['id']},{'_id':_0x471e3a['id'],'guild':_0x247c57[a508_0x3f51('0x5')]['id'],'price':_0x46905d[a508_0x3f51('0x54')]},{'upsert':!![]});return await _0x247c57['channel'][a508_0x3f51('0x7')]({'embed':{'color':tesseract_1[a508_0x3f51('0x12')]['COLORS'][a508_0x3f51('0x16')],'description':this[a508_0x3f51('0x3c')]['locale'][a508_0x3f51('0x13')](_0x247c57['guild']['document'][a508_0x3f51('0xb')],a508_0x3f51('0x3a'),a508_0x3f51('0x29'),_0x247c57[a508_0x3f51('0x1')][a508_0x3f51('0x1a')],_0x471e3a[a508_0x3f51('0x50')],_0x46905d['sell'])}})[a508_0x3f51('0x3d')](()=>{});}if(_0x46905d[a508_0x3f51('0x42')]){if(_0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x4e')][a508_0x3f51('0x4f')][a508_0x3f51('0x27')](_0x471e3a['id']))throw new Error(a508_0x3f51('0x31'));const _0x16e629=await Role_1[a508_0x3f51('0x41')][a508_0x3f51('0x38')]({'_id':_0x471e3a['id'],'guild':_0x247c57[a508_0x3f51('0x5')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x16e629)throw new Error(a508_0x3f51('0x51'));if(_0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x4b')][a508_0x3f51('0x3e')]<_0x16e629[a508_0x3f51('0xd')])throw new Error(a508_0x3f51('0x26'));await _0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x4e')][a508_0x3f51('0xc')](_0x471e3a);_0x247c57[a508_0x3f51('0x36')]['debit'](_0x16e629[a508_0x3f51('0xd')],a508_0x3f51('0x23'),_0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x4b')]);await _0x247c57['member']['document'][a508_0x3f51('0x48')]();return await _0x247c57['channel'][a508_0x3f51('0x7')]({'embed':{'color':tesseract_1[a508_0x3f51('0x12')]['COLORS'][a508_0x3f51('0x16')],'description':this[a508_0x3f51('0x3c')][a508_0x3f51('0x4')]['getString'](_0x247c57[a508_0x3f51('0x5')][a508_0x3f51('0x4b')][a508_0x3f51('0xb')],a508_0x3f51('0x3a'),'roleBought',_0x247c57['author'][a508_0x3f51('0x1a')],_0x471e3a[a508_0x3f51('0x50')],_0x46905d[a508_0x3f51('0x54')])}})[a508_0x3f51('0x3d')](()=>{});}if(_0x46905d[a508_0x3f51('0x33')]){if(!_0x247c57[a508_0x3f51('0x36')][a508_0x3f51('0x20')][a508_0x3f51('0x27')](a508_0x3f51('0x10')))throw new Error(a508_0x3f51('0x49'));await Role_1[a508_0x3f51('0x41')][a508_0x3f51('0x2c')]({'_id':_0x471e3a['id'],'guild':_0x247c57['guild']['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x471e3a['id'],'guild':_0x247c57[a508_0x3f51('0x5')]['id'],'$unset':{'price':0x1}});return await _0x247c57[a508_0x3f51('0x6')]['send']({'embed':{'color':tesseract_1[a508_0x3f51('0x12')][a508_0x3f51('0x24')][a508_0x3f51('0x52')],'description':this[a508_0x3f51('0x3c')][a508_0x3f51('0x4')][a508_0x3f51('0x13')](_0x247c57[a508_0x3f51('0x5')][a508_0x3f51('0x4b')][a508_0x3f51('0xb')],'info',a508_0x3f51('0x0'),_0x247c57[a508_0x3f51('0x1')]['tag'],_0x471e3a[a508_0x3f51('0x50')])}})[a508_0x3f51('0x3d')](()=>{});}}const _0x3cfa43=await Role_1[a508_0x3f51('0x41')][a508_0x3f51('0x1d')]({'guild':_0x247c57['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x3cfa43[a508_0x3f51('0xf')])throw new Error('NO_ROLES_ON_SALE');return await _0x247c57[a508_0x3f51('0x6')][a508_0x3f51('0x7')]({'embed':{'color':tesseract_1[a508_0x3f51('0x12')][a508_0x3f51('0x24')][a508_0x3f51('0xe')],'title':a508_0x3f51('0x15'),'fields':_0x3cfa43[a508_0x3f51('0x4a')](_0x54be50=>({'name':(_0x247c57[a508_0x3f51('0x5')]['roles'][a508_0x3f51('0x4f')]['has'](_0x54be50[a508_0x3f51('0x1f')])?_0x247c57[a508_0x3f51('0x5')][a508_0x3f51('0x4e')]['cache'][a508_0x3f51('0x2e')](_0x54be50[a508_0x3f51('0x1f')])[a508_0x3f51('0x50')]+a508_0x3f51('0x22'):'')+_0x54be50[a508_0x3f51('0x1f')],'value':_0x54be50[a508_0x3f51('0xd')]+a508_0x3f51('0x45')}))}})['catch'](()=>{});};}};