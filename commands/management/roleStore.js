const a77_0x5832=['resolveRole','clamp','@bastion/tesseract','get','Constants','send','name','roleStore\x20ROLE\x20--unlist','roleNotFound','roleStoreAdd','premiumPaidRoles','client','default','unlist','Roles\x20Store','../../utils/numbers','\x20Bastion\x20Coins','user','PREMIUM_MEMBERSHIP_REQUIRED','BASTION_ERROR_TYPE','PLATINUM','price','constructor','channel','MAX_SAFE_INTEGER','findOne','DiscordError','countDocuments','has','../../utils/omnic','MANAGE_ROLES','LIMITS','PremiumTier','find','RED','errors','GREEN','sell','../../utils/constants','guild','length','roleStore','buy','ROLE_NOT_FOUND','save','join','roleBought','add','catch','ROLE_ALREADY_ASSIGNED','fetchPremiumTier','INSUFFICIENT_BALANCE','info','GOLD','isPublicBastion','tag','PAID_ROLES','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','NO_ROLES_ON_SALE','document','author','cache','language','exports','membershipLimitPaidRoles','debit','_id','LIMITED_PREMIUM_MEMBERSHIP','NO_PERMISSION','ROLE_NOT_FOR_SALE','../../models/Role','roles','locale','permissions','COLORS','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','\x20/\x20','member','findOneAndUpdate','roleStore\x20ROLE\x20--buy','test','IRIS','map','apply','getString'];(function(_0x5100f4,_0x58329d){const _0x8b7fa3=function(_0x4ab99b){while(--_0x4ab99b){_0x5100f4['push'](_0x5100f4['shift']());}},_0x412ad3=function(){const _0x267caa={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x49063a,_0x371ede,_0x1b6ef5,_0x32510b){_0x32510b=_0x32510b||{};let _0x134325=_0x371ede+'='+_0x1b6ef5,_0x3bb0c5=0x0;for(let _0xa50a19=0x0,_0x5272ed=_0x49063a['length'];_0xa50a19<_0x5272ed;_0xa50a19++){const _0x54fd3d=_0x49063a[_0xa50a19];_0x134325+=';\x20'+_0x54fd3d;const _0x1086d6=_0x49063a[_0x54fd3d];_0x49063a['push'](_0x1086d6),_0x5272ed=_0x49063a['length'],_0x1086d6!==!![]&&(_0x134325+='='+_0x1086d6);}_0x32510b['cookie']=_0x134325;},'removeCookie':function(){return'dev';},'getCookie':function(_0x28f0e4,_0x2c29e3){_0x28f0e4=_0x28f0e4||function(_0x2337d5){return _0x2337d5;};const _0x4db868=_0x28f0e4(new RegExp('(?:^|;\x20)'+_0x2c29e3['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x4585c3=function(_0x14b7a2,_0x1bb693){_0x14b7a2(++_0x1bb693);};return _0x4585c3(_0x8b7fa3,_0x58329d),_0x4db868?decodeURIComponent(_0x4db868[0x1]):undefined;}},_0x2b83fa=function(){const _0x23fa8b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x23fa8b['test'](_0x267caa['removeCookie']['toString']());};_0x267caa['updateCookie']=_0x2b83fa;let _0x151b3e='';const _0xa2dc9b=_0x267caa['updateCookie']();if(!_0xa2dc9b)_0x267caa['setCookie'](['*'],'counter',0x1);else _0xa2dc9b?_0x151b3e=_0x267caa['getCookie'](null,'counter'):_0x267caa['removeCookie']();};_0x412ad3();}(a77_0x5832,0x6f));const a77_0x8b7f=function(_0x5100f4,_0x58329d){_0x5100f4=_0x5100f4-0x0;let _0x8b7fa3=a77_0x5832[_0x5100f4];return _0x8b7fa3;};const _0x34b519=a77_0x8b7f,a77_0x267caa=function(){let _0x151b3e=!![];return function(_0xa2dc9b,_0x49063a){const _0x371ede=_0x151b3e?function(){const _0x21b78f=a77_0x8b7f;if(_0x49063a){const _0x1b6ef5=_0x49063a[_0x21b78f('0x39')](_0xa2dc9b,arguments);return _0x49063a=null,_0x1b6ef5;}}:function(){};return _0x151b3e=![],_0x371ede;};}(),a77_0x4ab99b=a77_0x267caa(this,function(){const _0x32510b=function(){const _0x21aa6f=a77_0x8b7f,_0x134325=_0x32510b[_0x21aa6f('0x51')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x21aa6f('0x51')](_0x21aa6f('0x31'));return!_0x134325[_0x21aa6f('0x36')](a77_0x4ab99b);};return _0x32510b();});a77_0x4ab99b();'use strict';const tesseract_1=require(_0x34b519('0x3d')),Role_1=require(_0x34b519('0x2c')),constants=require(_0x34b519('0xc')),errors=require('../../utils/errors'),numbers=require(_0x34b519('0x4a')),omnic=require(_0x34b519('0x3'));module[_0x34b519('0x25')]=class RoleStoreCommand extends tesseract_1['Command']{constructor(){const _0x406647=_0x34b519;super(_0x406647('0xf'),{'description':_0x406647('0x1f'),'triggers':[],'arguments':{'boolean':[_0x406647('0x10'),'unlist'],'number':[_0x406647('0xb')],'coerce':{'sell':_0x3bb0c5=>numbers[_0x406647('0x3c')](_0x3bb0c5,0x1,Number[_0x406647('0x53')])}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[_0x406647('0x4')],'userPermissions':[],'syntax':[_0x406647('0xf'),'roleStore\x20ROLE\x20--sell\x20AMOUNT',_0x406647('0x35'),_0x406647('0x42')]}),this['exec']=async(_0xa50a19,_0x5272ed)=>{const _0x5a2cc1=_0x406647;if(_0x5272ed['_'][_0x5a2cc1('0xe')]){const _0x1086d6=this[_0x5a2cc1('0x46')]['resolver'][_0x5a2cc1('0x3b')](_0xa50a19[_0x5a2cc1('0xd')],_0x5272ed['_'][_0x5a2cc1('0x13')]('\x20'));if(!_0x1086d6)throw new errors['DiscordError'](errors[_0x5a2cc1('0x4e')][_0x5a2cc1('0x11')],this[_0x5a2cc1('0x46')][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19['guild']['document'][_0x5a2cc1('0x24')],_0x5a2cc1('0x9'),_0x5a2cc1('0x43')));if(_0x5272ed[_0x5a2cc1('0xb')]>0x0){if(constants[_0x5a2cc1('0x1c')](this[_0x5a2cc1('0x46')][_0x5a2cc1('0x4c')])){const _0x28f0e4=await Role_1[_0x5a2cc1('0x47')][_0x5a2cc1('0x1')]({'guild':_0xa50a19[_0x5a2cc1('0xd')]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x28f0e4>=constants[_0x5a2cc1('0x5')][_0x5a2cc1('0x1e')]){const _0x2c29e3=await omnic[_0x5a2cc1('0x18')](_0xa50a19[_0x5a2cc1('0xd')])[_0x5a2cc1('0x16')](()=>{});if(_0x2c29e3){if(_0x2c29e3===omnic[_0x5a2cc1('0x6')]['GOLD']&&_0x28f0e4>=constants[_0x5a2cc1('0x5')][_0x5a2cc1('0x1b')]['PAID_ROLES'])throw new errors[(_0x5a2cc1('0x0'))](errors[_0x5a2cc1('0x4e')]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x5a2cc1('0x46')][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19[_0x5a2cc1('0xd')][_0x5a2cc1('0x21')][_0x5a2cc1('0x24')],_0x5a2cc1('0x9'),_0x5a2cc1('0x26'),constants['LIMITS'][_0x5a2cc1('0x1b')][_0x5a2cc1('0x1e')]));else{if(_0x2c29e3===omnic[_0x5a2cc1('0x6')][_0x5a2cc1('0x4f')]&&_0x28f0e4>=constants[_0x5a2cc1('0x5')]['PLATINUM'][_0x5a2cc1('0x1e')])throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][_0x5a2cc1('0x29')],this[_0x5a2cc1('0x46')][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19['guild']['document'][_0x5a2cc1('0x24')],_0x5a2cc1('0x9'),_0x5a2cc1('0x26'),constants['LIMITS'][_0x5a2cc1('0x4f')][_0x5a2cc1('0x1e')]));}}else throw new errors[(_0x5a2cc1('0x0'))](errors[_0x5a2cc1('0x4e')][_0x5a2cc1('0x4d')],this['client'][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19[_0x5a2cc1('0xd')][_0x5a2cc1('0x21')][_0x5a2cc1('0x24')],'errors',_0x5a2cc1('0x45'),constants[_0x5a2cc1('0x5')][_0x5a2cc1('0x1e')]));}}if(!_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x2f')][_0x5a2cc1('0x2')](_0x5a2cc1('0x4')))throw new Error(_0x5a2cc1('0x2a'));return await Role_1['default']['findOneAndUpdate']({'_id':_0x1086d6['id'],'guild':_0xa50a19[_0x5a2cc1('0xd')]['id']},{'_id':_0x1086d6['id'],'guild':_0xa50a19[_0x5a2cc1('0xd')]['id'],'price':_0x5272ed[_0x5a2cc1('0xb')]},{'upsert':!![]}),await _0xa50a19[_0x5a2cc1('0x52')][_0x5a2cc1('0x40')]({'embed':{'color':tesseract_1[_0x5a2cc1('0x3f')][_0x5a2cc1('0x30')][_0x5a2cc1('0xa')],'description':this[_0x5a2cc1('0x46')][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19[_0x5a2cc1('0xd')][_0x5a2cc1('0x21')][_0x5a2cc1('0x24')],_0x5a2cc1('0x1a'),_0x5a2cc1('0x44'),_0xa50a19['author'][_0x5a2cc1('0x1d')],_0x1086d6[_0x5a2cc1('0x41')],_0x5272ed[_0x5a2cc1('0xb')])}})[_0x5a2cc1('0x16')](()=>{});}if(_0x5272ed[_0x5a2cc1('0x10')]){if(_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x2d')][_0x5a2cc1('0x23')][_0x5a2cc1('0x2')](_0x1086d6['id']))throw new Error(_0x5a2cc1('0x17'));const _0x4db868=await Role_1[_0x5a2cc1('0x47')][_0x5a2cc1('0x54')]({'_id':_0x1086d6['id'],'guild':_0xa50a19['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4db868)throw new Error(_0x5a2cc1('0x2b'));if(_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x21')]['balance']<_0x4db868[_0x5a2cc1('0x50')])throw new Error(_0x5a2cc1('0x19'));return await _0xa50a19['member']['roles'][_0x5a2cc1('0x15')](_0x1086d6),_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x27')](_0x4db868[_0x5a2cc1('0x50')],'Paid\x20Role',_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x21')]),await _0xa50a19[_0x5a2cc1('0x33')]['document'][_0x5a2cc1('0x12')](),await _0xa50a19[_0x5a2cc1('0x52')][_0x5a2cc1('0x40')]({'embed':{'color':tesseract_1['Constants'][_0x5a2cc1('0x30')][_0x5a2cc1('0xa')],'description':this[_0x5a2cc1('0x46')][_0x5a2cc1('0x2e')][_0x5a2cc1('0x3a')](_0xa50a19[_0x5a2cc1('0xd')][_0x5a2cc1('0x21')]['language'],_0x5a2cc1('0x1a'),_0x5a2cc1('0x14'),_0xa50a19[_0x5a2cc1('0x22')][_0x5a2cc1('0x1d')],_0x1086d6['name'],_0x4db868[_0x5a2cc1('0x50')])}})[_0x5a2cc1('0x16')](()=>{});}if(_0x5272ed[_0x5a2cc1('0x48')]){if(!_0xa50a19[_0x5a2cc1('0x33')][_0x5a2cc1('0x2f')][_0x5a2cc1('0x2')](_0x5a2cc1('0x4')))throw new Error(_0x5a2cc1('0x2a'));return await Role_1[_0x5a2cc1('0x47')][_0x5a2cc1('0x34')]({'_id':_0x1086d6['id'],'guild':_0xa50a19['guild']['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x1086d6['id'],'guild':_0xa50a19['guild']['id'],'$unset':{'price':0x1}}),await _0xa50a19[_0x5a2cc1('0x52')][_0x5a2cc1('0x40')]({'embed':{'color':tesseract_1[_0x5a2cc1('0x3f')]['COLORS'][_0x5a2cc1('0x8')],'description':this['client']['locale']['getString'](_0xa50a19[_0x5a2cc1('0xd')][_0x5a2cc1('0x21')][_0x5a2cc1('0x24')],_0x5a2cc1('0x1a'),'roleStoreRemove',_0xa50a19[_0x5a2cc1('0x22')][_0x5a2cc1('0x1d')],_0x1086d6[_0x5a2cc1('0x41')])}})['catch'](()=>{});}}const _0x54fd3d=await Role_1['default'][_0x5a2cc1('0x7')]({'guild':_0xa50a19[_0x5a2cc1('0xd')]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x54fd3d[_0x5a2cc1('0xe')])throw new Error(_0x5a2cc1('0x20'));return await _0xa50a19['channel'][_0x5a2cc1('0x40')]({'embed':{'color':tesseract_1[_0x5a2cc1('0x3f')]['COLORS'][_0x5a2cc1('0x37')],'title':_0x5a2cc1('0x49'),'fields':_0x54fd3d[_0x5a2cc1('0x38')](_0x4585c3=>({'name':(_0xa50a19['guild'][_0x5a2cc1('0x2d')][_0x5a2cc1('0x23')][_0x5a2cc1('0x2')](_0x4585c3[_0x5a2cc1('0x28')])?_0xa50a19[_0x5a2cc1('0xd')]['roles'][_0x5a2cc1('0x23')][_0x5a2cc1('0x3e')](_0x4585c3[_0x5a2cc1('0x28')])[_0x5a2cc1('0x41')]+_0x5a2cc1('0x32'):'')+_0x4585c3[_0x5a2cc1('0x28')],'value':_0x4585c3[_0x5a2cc1('0x50')]+_0x5a2cc1('0x4b')}))}})['catch'](()=>{});};}};