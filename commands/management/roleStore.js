const a94_0x2795=['tag','findOne','roleStoreAdd','BASTION_ERROR_TYPE','exports','MANAGE_ROLES','\x20Bastion\x20Coins','clamp','LIMITED_PREMIUM_MEMBERSHIP','client','debit','catch','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','return\x20/\x22\x20+\x20this\x20+\x20\x22/','Constants','author','roleStore\x20ROLE\x20--sell\x20AMOUNT','9OAynwU','INSUFFICIENT_BALANCE','COLORS','PAID_ROLES','425XxfBNc','guild','Command','424wKThos','NO_PERMISSION','has','test','Roles\x20Store','3083ExUaFH','unlist','MAX_SAFE_INTEGER','exec','RED','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../models/Role','document','ROLE_ALREADY_ASSIGNED','roleBought','GOLD','member','add','user','roleStore','findOneAndUpdate','locale','GREEN','3HNMVuG','membershipLimitPaidRoles','roleStore\x20ROLE\x20--buy','countDocuments','_id','ROLE_NOT_FOUND','name','PremiumTier','language','27mtBRGh','51897lsMjpv','NO_ROLES_ON_SALE','permissions','roleNotFound','DiscordError','roles','PLATINUM','resolver','\x20/\x20','save','premiumPaidRoles','info','@bastion/tesseract','default','2HpIxlf','constructor','11902pcTojA','isPublicBastion','58657rirCOf','../../utils/errors','buy','resolveRole','sell','IRIS','getString','ROLE_NOT_FOR_SALE','67dUHEfX','roleStoreRemove','send','balance','73636Evlvaa','price','LIMITS','channel','cache','errors','../../utils/numbers','roleStore\x20ROLE\x20--unlist','465gZgGjQ'];const a94_0x117e=function(_0x149caa,_0x21b89b){_0x149caa=_0x149caa-0xce;let _0x29701f=a94_0x2795[_0x149caa];return _0x29701f;};const a94_0x48880=a94_0x117e;(function(_0x2dbb43,_0x734191){const _0x53f231=a94_0x117e;while(!![]){try{const _0x1e0a8f=-parseInt(_0x53f231(0x102))*-parseInt(_0x53f231(0x100))+parseInt(_0x53f231(0xe8))*parseInt(_0x53f231(0x110))+parseInt(_0x53f231(0xd6))*parseInt(_0x53f231(0x10c))+parseInt(_0x53f231(0x118))*parseInt(_0x53f231(0xd1))+parseInt(_0x53f231(0xce))*-parseInt(_0x53f231(0xf1))+-parseInt(_0x53f231(0x104))+parseInt(_0x53f231(0xf2))*-parseInt(_0x53f231(0x12a));if(_0x1e0a8f===_0x734191)break;else _0x2dbb43['push'](_0x2dbb43['shift']());}catch(_0x59c6fd){_0x2dbb43['push'](_0x2dbb43['shift']());}}}(a94_0x2795,0x1b27c));const a94_0x4fbeb3=function(){let _0x5ee15b=!![];return function(_0x31c9e3,_0x198fba){const _0x306f2a=_0x5ee15b?function(){if(_0x198fba){const _0x2db810=_0x198fba['apply'](_0x31c9e3,arguments);return _0x198fba=null,_0x2db810;}}:function(){};return _0x5ee15b=![],_0x306f2a;};}(),a94_0x9c7df7=a94_0x4fbeb3(this,function(){const _0x2961cd=function(){const _0x331a62=a94_0x117e,_0xb957b0=_0x2961cd[_0x331a62(0x101)](_0x331a62(0x126))()['constructor'](_0x331a62(0xdb));return!_0xb957b0[_0x331a62(0xd4)](a94_0x9c7df7);};return _0x2961cd();});a94_0x9c7df7();'use strict';const tesseract_1=require(a94_0x48880(0xfe)),Role_1=require(a94_0x48880(0xdc)),constants=require('../../utils/constants'),errors=require(a94_0x48880(0x105)),numbers=require(a94_0x48880(0x116)),omnic=require('../../utils/omnic');module[a94_0x48880(0x11d)]=class RoleStoreCommand extends tesseract_1[a94_0x48880(0xd0)]{constructor(){const _0x2aaef5=a94_0x48880;super(_0x2aaef5(0xe4),{'description':_0x2aaef5(0x125),'triggers':[],'arguments':{'boolean':['buy',_0x2aaef5(0xd7)],'number':[_0x2aaef5(0x108)],'coerce':{'sell':_0x143cbd=>numbers[_0x2aaef5(0x120)](_0x143cbd,0x1,Number[_0x2aaef5(0xd8)])}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[_0x2aaef5(0x11e)],'userPermissions':[],'syntax':['roleStore',_0x2aaef5(0x129),_0x2aaef5(0xea),_0x2aaef5(0x117)]}),this[_0x2aaef5(0xd9)]=async(_0x5b99d4,_0x5907ae)=>{const _0x4ecfa7=_0x2aaef5;if(_0x5907ae['_']['length']){const _0x1ceabc=this['client'][_0x4ecfa7(0xf9)][_0x4ecfa7(0x107)](_0x5b99d4[_0x4ecfa7(0xcf)],_0x5907ae['_']['join']('\x20'));if(!_0x1ceabc)throw new errors[(_0x4ecfa7(0xf6))](errors[_0x4ecfa7(0x11c)][_0x4ecfa7(0xed)],this['client'][_0x4ecfa7(0xe6)]['getString'](_0x5b99d4[_0x4ecfa7(0xcf)][_0x4ecfa7(0xdd)][_0x4ecfa7(0xf0)],_0x4ecfa7(0x115),_0x4ecfa7(0xf5)));if(_0x5907ae[_0x4ecfa7(0x108)]>0x0){if(constants[_0x4ecfa7(0x103)](this[_0x4ecfa7(0x122)][_0x4ecfa7(0xe3)])){const _0x1d8b93=await Role_1[_0x4ecfa7(0xff)][_0x4ecfa7(0xeb)]({'guild':_0x5b99d4['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(_0x1d8b93>=constants['LIMITS'][_0x4ecfa7(0x12d)]){const _0x500959=await omnic['fetchPremiumTier'](_0x5b99d4[_0x4ecfa7(0xcf)])[_0x4ecfa7(0x124)](()=>{});if(_0x500959){if(_0x500959===omnic[_0x4ecfa7(0xef)]['GOLD']&&_0x1d8b93>=constants[_0x4ecfa7(0x112)][_0x4ecfa7(0xe0)][_0x4ecfa7(0x12d)])throw new errors[(_0x4ecfa7(0xf6))](errors[_0x4ecfa7(0x11c)][_0x4ecfa7(0x121)],this[_0x4ecfa7(0x122)][_0x4ecfa7(0xe6)]['getString'](_0x5b99d4[_0x4ecfa7(0xcf)][_0x4ecfa7(0xdd)]['language'],_0x4ecfa7(0x115),'membershipLimitPaidRoles',constants[_0x4ecfa7(0x112)]['GOLD'][_0x4ecfa7(0x12d)]));else{if(_0x500959===omnic[_0x4ecfa7(0xef)][_0x4ecfa7(0xf8)]&&_0x1d8b93>=constants[_0x4ecfa7(0x112)][_0x4ecfa7(0xf8)]['PAID_ROLES'])throw new errors[(_0x4ecfa7(0xf6))](errors[_0x4ecfa7(0x11c)]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x4ecfa7(0x122)]['locale']['getString'](_0x5b99d4['guild'][_0x4ecfa7(0xdd)][_0x4ecfa7(0xf0)],_0x4ecfa7(0x115),_0x4ecfa7(0xe9),constants[_0x4ecfa7(0x112)][_0x4ecfa7(0xf8)][_0x4ecfa7(0x12d)]));}}else throw new errors[(_0x4ecfa7(0xf6))](errors[_0x4ecfa7(0x11c)]['PREMIUM_MEMBERSHIP_REQUIRED'],this['client']['locale'][_0x4ecfa7(0x10a)](_0x5b99d4[_0x4ecfa7(0xcf)][_0x4ecfa7(0xdd)][_0x4ecfa7(0xf0)],'errors',_0x4ecfa7(0xfc),constants[_0x4ecfa7(0x112)][_0x4ecfa7(0x12d)]));}}if(!_0x5b99d4[_0x4ecfa7(0xe1)][_0x4ecfa7(0xf4)]['has']('MANAGE_ROLES'))throw new Error(_0x4ecfa7(0xd2));return await Role_1[_0x4ecfa7(0xff)]['findOneAndUpdate']({'_id':_0x1ceabc['id'],'guild':_0x5b99d4['guild']['id']},{'_id':_0x1ceabc['id'],'guild':_0x5b99d4[_0x4ecfa7(0xcf)]['id'],'price':_0x5907ae[_0x4ecfa7(0x108)]},{'upsert':!![]}),await _0x5b99d4[_0x4ecfa7(0x113)]['send']({'embed':{'color':tesseract_1[_0x4ecfa7(0x127)][_0x4ecfa7(0x12c)][_0x4ecfa7(0xe7)],'description':this[_0x4ecfa7(0x122)][_0x4ecfa7(0xe6)]['getString'](_0x5b99d4[_0x4ecfa7(0xcf)][_0x4ecfa7(0xdd)]['language'],_0x4ecfa7(0xfd),_0x4ecfa7(0x11b),_0x5b99d4[_0x4ecfa7(0x128)][_0x4ecfa7(0x119)],_0x1ceabc[_0x4ecfa7(0xee)],_0x5907ae[_0x4ecfa7(0x108)])}})[_0x4ecfa7(0x124)](()=>{});}if(_0x5907ae[_0x4ecfa7(0x106)]){if(_0x5b99d4[_0x4ecfa7(0xe1)][_0x4ecfa7(0xf7)][_0x4ecfa7(0x114)]['has'](_0x1ceabc['id']))throw new Error(_0x4ecfa7(0xde));const _0x4d4505=await Role_1[_0x4ecfa7(0xff)][_0x4ecfa7(0x11a)]({'_id':_0x1ceabc['id'],'guild':_0x5b99d4[_0x4ecfa7(0xcf)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x4d4505)throw new Error(_0x4ecfa7(0x10b));if(_0x5b99d4['member'][_0x4ecfa7(0xdd)][_0x4ecfa7(0x10f)]<_0x4d4505[_0x4ecfa7(0x111)])throw new Error(_0x4ecfa7(0x12b));return await _0x5b99d4[_0x4ecfa7(0xe1)]['roles'][_0x4ecfa7(0xe2)](_0x1ceabc),_0x5b99d4[_0x4ecfa7(0xe1)][_0x4ecfa7(0x123)](_0x4d4505[_0x4ecfa7(0x111)],'Paid\x20Role',_0x5b99d4[_0x4ecfa7(0xe1)][_0x4ecfa7(0xdd)]),await _0x5b99d4[_0x4ecfa7(0xe1)][_0x4ecfa7(0xdd)][_0x4ecfa7(0xfb)](),await _0x5b99d4[_0x4ecfa7(0x113)]['send']({'embed':{'color':tesseract_1[_0x4ecfa7(0x127)][_0x4ecfa7(0x12c)][_0x4ecfa7(0xe7)],'description':this[_0x4ecfa7(0x122)]['locale']['getString'](_0x5b99d4[_0x4ecfa7(0xcf)]['document']['language'],_0x4ecfa7(0xfd),_0x4ecfa7(0xdf),_0x5b99d4[_0x4ecfa7(0x128)][_0x4ecfa7(0x119)],_0x1ceabc[_0x4ecfa7(0xee)],_0x4d4505['price'])}})['catch'](()=>{});}if(_0x5907ae[_0x4ecfa7(0xd7)]){if(!_0x5b99d4[_0x4ecfa7(0xe1)]['permissions'][_0x4ecfa7(0xd3)]('MANAGE_ROLES'))throw new Error(_0x4ecfa7(0xd2));return await Role_1[_0x4ecfa7(0xff)][_0x4ecfa7(0xe5)]({'_id':_0x1ceabc['id'],'guild':_0x5b99d4['guild']['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x1ceabc['id'],'guild':_0x5b99d4[_0x4ecfa7(0xcf)]['id'],'$unset':{'price':0x1}}),await _0x5b99d4[_0x4ecfa7(0x113)][_0x4ecfa7(0x10e)]({'embed':{'color':tesseract_1[_0x4ecfa7(0x127)]['COLORS'][_0x4ecfa7(0xda)],'description':this[_0x4ecfa7(0x122)][_0x4ecfa7(0xe6)][_0x4ecfa7(0x10a)](_0x5b99d4['guild'][_0x4ecfa7(0xdd)][_0x4ecfa7(0xf0)],_0x4ecfa7(0xfd),_0x4ecfa7(0x10d),_0x5b99d4[_0x4ecfa7(0x128)][_0x4ecfa7(0x119)],_0x1ceabc[_0x4ecfa7(0xee)])}})[_0x4ecfa7(0x124)](()=>{});}}const _0x36f87f=await Role_1[_0x4ecfa7(0xff)]['find']({'guild':_0x5b99d4[_0x4ecfa7(0xcf)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x36f87f['length'])throw new Error(_0x4ecfa7(0xf3));return await _0x5b99d4['channel'][_0x4ecfa7(0x10e)]({'embed':{'color':tesseract_1[_0x4ecfa7(0x127)]['COLORS'][_0x4ecfa7(0x109)],'title':_0x4ecfa7(0xd5),'fields':_0x36f87f['map'](_0x33d16b=>({'name':(_0x5b99d4[_0x4ecfa7(0xcf)][_0x4ecfa7(0xf7)][_0x4ecfa7(0x114)][_0x4ecfa7(0xd3)](_0x33d16b[_0x4ecfa7(0xec)])?_0x5b99d4['guild'][_0x4ecfa7(0xf7)][_0x4ecfa7(0x114)]['get'](_0x33d16b[_0x4ecfa7(0xec)])['name']+_0x4ecfa7(0xfa):'')+_0x33d16b[_0x4ecfa7(0xec)],'value':_0x33d16b['price']+_0x4ecfa7(0x11f)}))}})[_0x4ecfa7(0x124)](()=>{});};}};