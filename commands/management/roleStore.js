const a94_0x3f5a=['Constants','roleNotFound','has','../../utils/errors','info','get','../../models/Role','catch','isPublicBastion','author','roleBought','buy','LIMITS','cache','member','sell','MANAGE_ROLES','ROLE_NOT_FOR_SALE','clamp','permissions','constructor','balance','roleStore\x20ROLE\x20--sell\x20AMOUNT','GREEN','PLATINUM','exports','ROLE_ALREADY_ASSIGNED','Paid\x20Role','send','map','channel','user','GOLD','BASTION_ERROR_TYPE','resolveRole','guild','roleStore','exec','DiscordError','roleStore\x20ROLE\x20--unlist','test','client','MAX_SAFE_INTEGER','../../utils/numbers','return\x20/\x22\x20+\x20this\x20+\x20\x22/','RED','findOneAndUpdate','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','findOne','tag','debit','IRIS','document','ROLE_NOT_FOUND','find','name','PAID_ROLES','resolver','PremiumTier','apply','COLORS','locale','price','getString','roleStoreAdd','default','\x20/\x20','membershipLimitPaidRoles','roleStoreRemove','Command','premiumPaidRoles','length','_id','errors','Roles\x20Store','language','../../utils/constants','It\x20allows\x20you\x20to\x20set\x20up\x20a\x20Role\x20Store\x20in\x20the\x20server.\x20Server\x20managers\x20can\x20sell\x20roles\x20in\x20the\x20server\x20and\x20members\x20can\x20buy\x20them\x20with\x20Bastion\x20Coins.','roles','countDocuments','LIMITED_PREMIUM_MEMBERSHIP','join','unlist','NO_PERMISSION','PREMIUM_MEMBERSHIP_REQUIRED'];(function(_0x94a56c,_0x2f04b9){const _0x3f5af8=function(_0x443d64){while(--_0x443d64){_0x94a56c['push'](_0x94a56c['shift']());}},_0xdd01ce=function(){const _0x2da5d1={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x10e22d,_0x3f81a9,_0x4ee66d,_0x41083e){_0x41083e=_0x41083e||{};let _0x1f1764=_0x3f81a9+'='+_0x4ee66d,_0x8917e4=0x0;for(let _0x530e75=0x0,_0x243541=_0x10e22d['length'];_0x530e75<_0x243541;_0x530e75++){const _0xf41d1a=_0x10e22d[_0x530e75];_0x1f1764+=';\x20'+_0xf41d1a;const _0x2c42f5=_0x10e22d[_0xf41d1a];_0x10e22d['push'](_0x2c42f5),_0x243541=_0x10e22d['length'],_0x2c42f5!==!![]&&(_0x1f1764+='='+_0x2c42f5);}_0x41083e['cookie']=_0x1f1764;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3b80b4,_0x13092d){_0x3b80b4=_0x3b80b4||function(_0x1e0236){return _0x1e0236;};const _0x16e7be=_0x3b80b4(new RegExp('(?:^|;\x20)'+_0x13092d['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x587e67=function(_0x6b1a20,_0xf085b4){_0x6b1a20(++_0xf085b4);};return _0x587e67(_0x3f5af8,_0x2f04b9),_0x16e7be?decodeURIComponent(_0x16e7be[0x1]):undefined;}},_0x3dd2ed=function(){const _0x3a06f3=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x3a06f3['test'](_0x2da5d1['removeCookie']['toString']());};_0x2da5d1['updateCookie']=_0x3dd2ed;let _0x38758d='';const _0x1b51c9=_0x2da5d1['updateCookie']();if(!_0x1b51c9)_0x2da5d1['setCookie'](['*'],'counter',0x1);else _0x1b51c9?_0x38758d=_0x2da5d1['getCookie'](null,'counter'):_0x2da5d1['removeCookie']();};_0xdd01ce();}(a94_0x3f5a,0x6d));const a94_0xdd01=function(_0x94a56c,_0x2f04b9){_0x94a56c=_0x94a56c-0x138;let _0x3f5af8=a94_0x3f5a[_0x94a56c];return _0x3f5af8;};const a94_0x2b9aa5=a94_0xdd01,a94_0x3dd2ed=function(){let _0x1b51c9=!![];return function(_0x10e22d,_0x3f81a9){const _0x4ee66d=_0x1b51c9?function(){const _0x3c51b3=a94_0xdd01;if(_0x3f81a9){const _0x41083e=_0x3f81a9[_0x3c51b3(0x15b)](_0x10e22d,arguments);return _0x3f81a9=null,_0x41083e;}}:function(){};return _0x1b51c9=![],_0x4ee66d;};}(),a94_0x2da5d1=a94_0x3dd2ed(this,function(){const _0x1f1764=function(){const _0x50d42e=a94_0xdd01,_0x8917e4=_0x1f1764[_0x50d42e(0x189)](_0x50d42e(0x14c))()[_0x50d42e(0x189)](_0x50d42e(0x14f));return!_0x8917e4[_0x50d42e(0x148)](a94_0x2da5d1);};return _0x1f1764();});a94_0x2da5d1();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require(a94_0x2b9aa5(0x17b)),constants=require(a94_0x2b9aa5(0x16c)),errors=require(a94_0x2b9aa5(0x178)),numbers=require(a94_0x2b9aa5(0x14b)),omnic=require('../../utils/omnic');module[a94_0x2b9aa5(0x139)]=class RoleStoreCommand extends tesseract_1[a94_0x2b9aa5(0x165)]{constructor(){const _0x366906=a94_0x2b9aa5;super(_0x366906(0x144),{'description':_0x366906(0x16d),'triggers':[],'arguments':{'boolean':[_0x366906(0x180),_0x366906(0x172)],'number':[_0x366906(0x184)],'coerce':{'sell':_0x530e75=>numbers[_0x366906(0x187)](_0x530e75,0x1,Number[_0x366906(0x14a)])}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[_0x366906(0x185)],'userPermissions':[],'syntax':[_0x366906(0x144),_0x366906(0x18b),'roleStore\x20ROLE\x20--buy',_0x366906(0x147)]}),this[_0x366906(0x145)]=async(_0x243541,_0xf41d1a)=>{const _0x8e231d=_0x366906;if(_0xf41d1a['_'][_0x8e231d(0x167)]){const _0x3b80b4=this['client'][_0x8e231d(0x159)][_0x8e231d(0x142)](_0x243541[_0x8e231d(0x143)],_0xf41d1a['_'][_0x8e231d(0x171)]('\x20'));if(!_0x3b80b4)throw new errors[(_0x8e231d(0x146))](errors[_0x8e231d(0x141)][_0x8e231d(0x155)],this['client']['locale'][_0x8e231d(0x15f)](_0x243541[_0x8e231d(0x143)][_0x8e231d(0x154)][_0x8e231d(0x16b)],'errors',_0x8e231d(0x176)));if(_0xf41d1a[_0x8e231d(0x184)]>0x0){if(constants[_0x8e231d(0x17d)](this[_0x8e231d(0x149)][_0x8e231d(0x13f)])){const _0x13092d=await Role_1[_0x8e231d(0x161)][_0x8e231d(0x16f)]({'guild':_0x243541[_0x8e231d(0x143)]['id'],'price':{'$exists':!![],'$ne':null}});if(_0x13092d>=constants['LIMITS'][_0x8e231d(0x158)]){const _0x16e7be=await omnic['fetchPremiumTier'](_0x243541[_0x8e231d(0x143)])[_0x8e231d(0x17c)](()=>{});if(_0x16e7be){if(_0x16e7be===omnic[_0x8e231d(0x15a)][_0x8e231d(0x140)]&&_0x13092d>=constants['LIMITS'][_0x8e231d(0x140)]['PAID_ROLES'])throw new errors[(_0x8e231d(0x146))](errors[_0x8e231d(0x141)][_0x8e231d(0x170)],this[_0x8e231d(0x149)]['locale'][_0x8e231d(0x15f)](_0x243541[_0x8e231d(0x143)]['document']['language'],_0x8e231d(0x169),'membershipLimitPaidRoles',constants[_0x8e231d(0x181)][_0x8e231d(0x140)][_0x8e231d(0x158)]));else{if(_0x16e7be===omnic['PremiumTier'][_0x8e231d(0x138)]&&_0x13092d>=constants['LIMITS'][_0x8e231d(0x138)][_0x8e231d(0x158)])throw new errors[(_0x8e231d(0x146))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x8e231d(0x149)]['locale'][_0x8e231d(0x15f)](_0x243541['guild'][_0x8e231d(0x154)][_0x8e231d(0x16b)],_0x8e231d(0x169),_0x8e231d(0x163),constants[_0x8e231d(0x181)][_0x8e231d(0x138)]['PAID_ROLES']));}}else throw new errors[(_0x8e231d(0x146))](errors[_0x8e231d(0x141)][_0x8e231d(0x174)],this[_0x8e231d(0x149)][_0x8e231d(0x15d)]['getString'](_0x243541[_0x8e231d(0x143)][_0x8e231d(0x154)][_0x8e231d(0x16b)],_0x8e231d(0x169),_0x8e231d(0x166),constants[_0x8e231d(0x181)][_0x8e231d(0x158)]));}}if(!_0x243541['member'][_0x8e231d(0x188)]['has'](_0x8e231d(0x185)))throw new Error('NO_PERMISSION');return await Role_1['default'][_0x8e231d(0x14e)]({'_id':_0x3b80b4['id'],'guild':_0x243541['guild']['id']},{'_id':_0x3b80b4['id'],'guild':_0x243541['guild']['id'],'price':_0xf41d1a[_0x8e231d(0x184)]},{'upsert':!![]}),await _0x243541['channel'][_0x8e231d(0x13c)]({'embed':{'color':tesseract_1[_0x8e231d(0x175)]['COLORS'][_0x8e231d(0x18c)],'description':this[_0x8e231d(0x149)][_0x8e231d(0x15d)][_0x8e231d(0x15f)](_0x243541[_0x8e231d(0x143)][_0x8e231d(0x154)]['language'],'info',_0x8e231d(0x160),_0x243541[_0x8e231d(0x17e)]['tag'],_0x3b80b4[_0x8e231d(0x157)],_0xf41d1a[_0x8e231d(0x184)])}})['catch'](()=>{});}if(_0xf41d1a[_0x8e231d(0x180)]){if(_0x243541['member'][_0x8e231d(0x16e)][_0x8e231d(0x182)]['has'](_0x3b80b4['id']))throw new Error(_0x8e231d(0x13a));const _0x587e67=await Role_1[_0x8e231d(0x161)][_0x8e231d(0x150)]({'_id':_0x3b80b4['id'],'guild':_0x243541[_0x8e231d(0x143)]['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x587e67)throw new Error(_0x8e231d(0x186));if(_0x243541[_0x8e231d(0x183)][_0x8e231d(0x154)][_0x8e231d(0x18a)]<_0x587e67[_0x8e231d(0x15e)])throw new Error('INSUFFICIENT_BALANCE');return await _0x243541[_0x8e231d(0x183)][_0x8e231d(0x16e)]['add'](_0x3b80b4),_0x243541['member'][_0x8e231d(0x152)](_0x587e67[_0x8e231d(0x15e)],_0x8e231d(0x13b),_0x243541[_0x8e231d(0x183)]['document']),await _0x243541['member']['document']['save'](),await _0x243541['channel'][_0x8e231d(0x13c)]({'embed':{'color':tesseract_1[_0x8e231d(0x175)]['COLORS'][_0x8e231d(0x18c)],'description':this[_0x8e231d(0x149)][_0x8e231d(0x15d)][_0x8e231d(0x15f)](_0x243541[_0x8e231d(0x143)]['document']['language'],_0x8e231d(0x179),_0x8e231d(0x17f),_0x243541[_0x8e231d(0x17e)][_0x8e231d(0x151)],_0x3b80b4[_0x8e231d(0x157)],_0x587e67[_0x8e231d(0x15e)])}})['catch'](()=>{});}if(_0xf41d1a[_0x8e231d(0x172)]){if(!_0x243541[_0x8e231d(0x183)][_0x8e231d(0x188)][_0x8e231d(0x177)](_0x8e231d(0x185)))throw new Error(_0x8e231d(0x173));return await Role_1[_0x8e231d(0x161)][_0x8e231d(0x14e)]({'_id':_0x3b80b4['id'],'guild':_0x243541[_0x8e231d(0x143)]['id'],'price':{'$exists':!![],'$ne':null}},{'_id':_0x3b80b4['id'],'guild':_0x243541['guild']['id'],'$unset':{'price':0x1}}),await _0x243541[_0x8e231d(0x13e)]['send']({'embed':{'color':tesseract_1['Constants']['COLORS'][_0x8e231d(0x14d)],'description':this['client'][_0x8e231d(0x15d)][_0x8e231d(0x15f)](_0x243541['guild'][_0x8e231d(0x154)]['language'],_0x8e231d(0x179),_0x8e231d(0x164),_0x243541[_0x8e231d(0x17e)][_0x8e231d(0x151)],_0x3b80b4[_0x8e231d(0x157)])}})['catch'](()=>{});}}const _0x2c42f5=await Role_1[_0x8e231d(0x161)][_0x8e231d(0x156)]({'guild':_0x243541['guild']['id'],'price':{'$exists':!![],'$ne':null}});if(!_0x2c42f5[_0x8e231d(0x167)])throw new Error('NO_ROLES_ON_SALE');return await _0x243541[_0x8e231d(0x13e)][_0x8e231d(0x13c)]({'embed':{'color':tesseract_1[_0x8e231d(0x175)][_0x8e231d(0x15c)][_0x8e231d(0x153)],'title':_0x8e231d(0x16a),'fields':_0x2c42f5[_0x8e231d(0x13d)](_0x1e0236=>({'name':(_0x243541[_0x8e231d(0x143)][_0x8e231d(0x16e)]['cache']['has'](_0x1e0236[_0x8e231d(0x168)])?_0x243541[_0x8e231d(0x143)][_0x8e231d(0x16e)][_0x8e231d(0x182)][_0x8e231d(0x17a)](_0x1e0236[_0x8e231d(0x168)])[_0x8e231d(0x157)]+_0x8e231d(0x162):'')+_0x1e0236[_0x8e231d(0x168)],'value':_0x1e0236[_0x8e231d(0x15e)]+'\x20Bastion\x20Coins'}))}})[_0x8e231d(0x17c)](()=>{});};}};