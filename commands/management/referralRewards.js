const a73_0x3f27=['resolveRole','PLATINUM','items','document','../../utils/omnic','return\x20/\x22\x20+\x20this\x20+\x20\x22/','cache','errors','resolver','PREMIUM_MEMBERSHIP_REQUIRED','Command','page','PremiumTier','catch','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','tag','BASTION_ERROR_TYPE','\x20Referrals','getString','paginate','GOLD','roles','role','\x20of\x20','referralRewards','ROLE_NOT_FOUND','isPublicBastion','fetchPremiumTier','NO_REFERRAL_REWARDS','find','name','default','../../utils/errors','../../utils/constants','has','save','DiscordError','Referral\x20Rewards','language','exec','client','author','exports','remove','membershipLimitInviteRoles','GREEN','error','fetchDocument','It\x20allows\x20you\x20set\x20roles\x20as\x20rewards\x20for\x20referrals\x20(inviting\x20other\x20users\x20to\x20the\x20server).','locale','channel','countDocuments','constructor','clamp','LIMITED_PREMIUM_MEMBERSHIP','LIMITS','IRIS','info','updateMany','MAX_SAFE_INTEGER','map','roleReferralsClear','user','COLORS','referralRewards\x20-n\x20NUMBER\x20--role\x20ROLE','guild','send','Constants','createDocument','MANAGE_GUILD','../../utils/pagination','INVITE_REWARDS','join','referrals','keys','apply'];(function(_0x2ae1f8,_0x3f27d0){const _0x132ad7=function(_0x4c9677){while(--_0x4c9677){_0x2ae1f8['push'](_0x2ae1f8['shift']());}},_0x41d429=function(){const _0x4f4eb7={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x536999,_0x492f82,_0x271ca6,_0x5b3444){_0x5b3444=_0x5b3444||{};let _0x45c3fe=_0x492f82+'='+_0x271ca6,_0x574df1=0x0;for(let _0xe69633=0x0,_0x2bd1a4=_0x536999['length'];_0xe69633<_0x2bd1a4;_0xe69633++){const _0xbe23ed=_0x536999[_0xe69633];_0x45c3fe+=';\x20'+_0xbe23ed;const _0x5829a9=_0x536999[_0xbe23ed];_0x536999['push'](_0x5829a9),_0x2bd1a4=_0x536999['length'],_0x5829a9!==!![]&&(_0x45c3fe+='='+_0x5829a9);}_0x5b3444['cookie']=_0x45c3fe;},'removeCookie':function(){return'dev';},'getCookie':function(_0x27bbf6,_0x5c60a9){_0x27bbf6=_0x27bbf6||function(_0x471868){return _0x471868;};const _0x384756=_0x27bbf6(new RegExp('(?:^|;\x20)'+_0x5c60a9['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x54f74e=function(_0x3242e8,_0x1af841){_0x3242e8(++_0x1af841);};return _0x54f74e(_0x132ad7,_0x3f27d0),_0x384756?decodeURIComponent(_0x384756[0x1]):undefined;}},_0x5d53d6=function(){const _0x284c94=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x284c94['test'](_0x4f4eb7['removeCookie']['toString']());};_0x4f4eb7['updateCookie']=_0x5d53d6;let _0x3f75f2='';const _0xb6aca9=_0x4f4eb7['updateCookie']();if(!_0xb6aca9)_0x4f4eb7['setCookie'](['*'],'counter',0x1);else _0xb6aca9?_0x3f75f2=_0x4f4eb7['getCookie'](null,'counter'):_0x4f4eb7['removeCookie']();};_0x41d429();}(a73_0x3f27,0x118));const a73_0x132a=function(_0x2ae1f8,_0x3f27d0){_0x2ae1f8=_0x2ae1f8-0x0;let _0x132ad7=a73_0x3f27[_0x2ae1f8];return _0x132ad7;};const a73_0x4f4eb7=function(){let _0x3f75f2=!![];return function(_0xb6aca9,_0x536999){const _0x492f82=_0x3f75f2?function(){if(_0x536999){const _0x271ca6=_0x536999[a73_0x132a('0x17')](_0xb6aca9,arguments);return _0x536999=null,_0x271ca6;}}:function(){};return _0x3f75f2=![],_0x492f82;};}(),a73_0x4c9677=a73_0x4f4eb7(this,function(){const _0x5b3444=function(){const _0x45c3fe=_0x5b3444[a73_0x132a('0x0')](a73_0x132a('0x1d'))()['constructor'](a73_0x132a('0x26'));return!_0x45c3fe['test'](a73_0x4c9677);};return _0x5b3444();});a73_0x4c9677();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require('../../models/Role'),constants=require(a73_0x132a('0x39')),errors=require(a73_0x132a('0x38')),numbers=require('../../utils/numbers'),omnic=require(a73_0x132a('0x1c')),pagination=require(a73_0x132a('0x12'));module[a73_0x132a('0x42')]=class ReferralRewardsCommand extends tesseract_1[a73_0x132a('0x22')]{constructor(){super(a73_0x132a('0x30'),{'description':a73_0x132a('0x48'),'triggers':[],'arguments':{'alias':{'referrals':['n'],'page':['p']},'array':[a73_0x132a('0x2e')],'boolean':[a73_0x132a('0x43')],'string':[a73_0x132a('0x2e')],'number':[a73_0x132a('0x15'),'page'],'coerce':{'referrals':_0x574df1=>numbers[a73_0x132a('0x1')](_0x574df1,0x1,Number[a73_0x132a('0x7')])}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a73_0x132a('0x11')],'userPermissions':[],'syntax':[a73_0x132a('0x30'),'referralRewards\x20--page\x20NUMBER',a73_0x132a('0xc'),'referralRewards\x20-n\x20NUMBER\x20--remove']}),this[a73_0x132a('0x3f')]=async(_0xe69633,_0x2bd1a4)=>{if(_0x2bd1a4['referrals']){if(_0x2bd1a4[a73_0x132a('0x2e')]){if(constants[a73_0x132a('0x32')](this[a73_0x132a('0x40')][a73_0x132a('0xa')])){const _0x54f74e=await omnic[a73_0x132a('0x33')](_0xe69633[a73_0x132a('0xd')])[a73_0x132a('0x25')](()=>{}),_0x471868=await Role_1['default'][a73_0x132a('0x4b')]({'guild':_0xe69633['guild']['id'],'referrals':{'$exists':!![],'$ne':null}});if(_0x54f74e){if(_0x54f74e===omnic[a73_0x132a('0x24')][a73_0x132a('0x2c')]&&_0x471868>=constants[a73_0x132a('0x3')]['GOLD']['INVITE_REWARDS'])throw new errors[(a73_0x132a('0x3c'))](errors[a73_0x132a('0x28')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')][a73_0x132a('0x3e')],'errors',a73_0x132a('0x44'),constants[a73_0x132a('0x3')][a73_0x132a('0x2c')][a73_0x132a('0x13')]));else{if(_0x54f74e===omnic[a73_0x132a('0x24')][a73_0x132a('0x19')]&&_0x471868>=constants[a73_0x132a('0x3')][a73_0x132a('0x19')][a73_0x132a('0x13')])throw new errors[(a73_0x132a('0x3c'))](errors['BASTION_ERROR_TYPE'][a73_0x132a('0x2')],this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')][a73_0x132a('0x3e')],'errors','membershipLimitInviteRoles',constants[a73_0x132a('0x3')][a73_0x132a('0x19')]['INVITE_REWARDS']));}}else{if(_0x471868>=constants[a73_0x132a('0x3')]['INVITE_REWARDS'])throw new errors[(a73_0x132a('0x3c'))](errors[a73_0x132a('0x28')][a73_0x132a('0x21')],this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')]['language'],a73_0x132a('0x1f'),'premiumInviteRoles',constants['LIMITS'][a73_0x132a('0x13')]));}}const _0x5c60a9=this['client'][a73_0x132a('0x20')][a73_0x132a('0x18')](_0xe69633[a73_0x132a('0xd')],_0x2bd1a4[a73_0x132a('0x2e')][a73_0x132a('0x14')]('\x20'));if(!_0x5c60a9)throw new errors[(a73_0x132a('0x3c'))](errors[a73_0x132a('0x28')][a73_0x132a('0x31')],this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')][a73_0x132a('0x3e')],a73_0x132a('0x46'),'roleNotFound'));let _0x384756=await _0x5c60a9[a73_0x132a('0x47')]();return!_0x384756&&(_0x384756=await _0x5c60a9[a73_0x132a('0x10')]()),_0x384756['referrals']=_0x2bd1a4['referrals'],await _0x384756[a73_0x132a('0x3b')](),await _0xe69633[a73_0x132a('0x4a')][a73_0x132a('0xe')]({'embed':{'color':tesseract_1['Constants'][a73_0x132a('0xb')][a73_0x132a('0x45')],'description':this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')][a73_0x132a('0x3e')],a73_0x132a('0x5'),'roleReferralsSet',_0xe69633[a73_0x132a('0x41')][a73_0x132a('0x27')],_0x5c60a9[a73_0x132a('0x36')],_0x2bd1a4[a73_0x132a('0x15')])}});}if(_0x2bd1a4['remove'])return await Role_1['default'][a73_0x132a('0x6')]({'guild':_0xe69633[a73_0x132a('0xd')]['id'],'referrals':_0x2bd1a4['referrals']},{'$unset':{'referrals':0x1}}),await _0xe69633['channel']['send']({'embed':{'color':tesseract_1[a73_0x132a('0xf')][a73_0x132a('0xb')]['RED'],'description':this[a73_0x132a('0x40')][a73_0x132a('0x49')][a73_0x132a('0x2a')](_0xe69633[a73_0x132a('0xd')][a73_0x132a('0x1b')][a73_0x132a('0x3e')],a73_0x132a('0x5'),a73_0x132a('0x9'),_0xe69633['author'][a73_0x132a('0x27')],_0x2bd1a4[a73_0x132a('0x15')])}});}const _0xbe23ed=await Role_1[a73_0x132a('0x37')][a73_0x132a('0x35')]({'guild':_0xe69633['guild']['id'],'referrals':{'$exists':!![],'$ne':null}});if(!_0xbe23ed['length'])throw new Error(a73_0x132a('0x34'));const _0x5829a9={};for(const _0x3242e8 of _0xbe23ed){_0x3242e8[a73_0x132a('0x15')]in _0x5829a9?_0x5829a9[_0x3242e8[a73_0x132a('0x15')]]['push'](_0x3242e8['id']):_0x5829a9[_0x3242e8[a73_0x132a('0x15')]]=[_0x3242e8['id']];}const _0x27bbf6=pagination[a73_0x132a('0x2b')](Object[a73_0x132a('0x16')](_0x5829a9)['map'](_0x1af841=>({'name':_0x1af841+a73_0x132a('0x29'),'value':_0x5829a9[_0x1af841][a73_0x132a('0x8')](_0x284c94=>_0xe69633['guild'][a73_0x132a('0x2d')][a73_0x132a('0x1e')][a73_0x132a('0x3a')](_0x284c94)?_0xe69633[a73_0x132a('0xd')]['roles']['cache']['get'](_0x284c94)[a73_0x132a('0x36')]:_0x284c94)[a73_0x132a('0x14')](',\x20')})),_0x2bd1a4[a73_0x132a('0x23')]);return await _0xe69633[a73_0x132a('0x4a')][a73_0x132a('0xe')]({'embed':{'color':tesseract_1[a73_0x132a('0xf')]['COLORS'][a73_0x132a('0x4')],'title':a73_0x132a('0x3d'),'fields':_0x27bbf6[a73_0x132a('0x1a')],'footer':{'text':'Page\x20'+_0x27bbf6[a73_0x132a('0x23')]+a73_0x132a('0x2f')+_0x27bbf6['pages']}}});};}};