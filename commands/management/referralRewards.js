const a88_0x3b92=['PremiumTier','IRIS','cache','PREMIUM_MEMBERSHIP_REQUIRED','Constants','referralRewards','catch','countDocuments','default','author','fetchDocument','length','language','BASTION_ERROR_TYPE','join','../../utils/omnic','remove','roles','It\x20allows\x20you\x20set\x20roles\x20as\x20rewards\x20for\x20referrals\x20(inviting\x20other\x20users\x20to\x20the\x20server).','constructor','../../utils/pagination','send','page','document','NO_REFERRAL_REWARDS','createDocument','LIMITED_PREMIUM_MEMBERSHIP','items','PLATINUM','Page\x20','save','RED','INVITE_REWARDS','referralRewards\x20--page\x20NUMBER','Referral\x20Rewards','user','ROLE_NOT_FOUND','MANAGE_GUILD','guild','getString','referrals','role','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../utils/errors','exports','../../utils/constants','name','Command','COLORS','roleReferralsSet','premiumInviteRoles','find','referralRewards\x20-n\x20NUMBER\x20--role\x20ROLE','../../utils/numbers','info','GOLD','get','exec','map','updateMany','\x20of\x20','isPublicBastion','return\x20/\x22\x20+\x20this\x20+\x20\x22/','locale','has','errors','GREEN','membershipLimitInviteRoles','DiscordError','client','channel','paginate','push','resolver','tag','LIMITS','keys'];(function(_0x46f9a4,_0x3b926e){const _0xb289be=function(_0x1dd286){while(--_0x1dd286){_0x46f9a4['push'](_0x46f9a4['shift']());}},_0x22a014=function(){const _0x6cd9d6={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xe52697,_0x3eee65,_0x33c215,_0x2f0e6c){_0x2f0e6c=_0x2f0e6c||{};let _0x167483=_0x3eee65+'='+_0x33c215,_0x518096=0x0;for(let _0x253a6a=0x0,_0x424151=_0xe52697['length'];_0x253a6a<_0x424151;_0x253a6a++){const _0x598149=_0xe52697[_0x253a6a];_0x167483+=';\x20'+_0x598149;const _0x5033ac=_0xe52697[_0x598149];_0xe52697['push'](_0x5033ac),_0x424151=_0xe52697['length'],_0x5033ac!==!![]&&(_0x167483+='='+_0x5033ac);}_0x2f0e6c['cookie']=_0x167483;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4a6915,_0x11d239){_0x4a6915=_0x4a6915||function(_0x41ec9d){return _0x41ec9d;};const _0x1c104a=_0x4a6915(new RegExp('(?:^|;\x20)'+_0x11d239['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x28e3a8=function(_0x597c7d,_0x226ccd){_0x597c7d(++_0x226ccd);};return _0x28e3a8(_0xb289be,_0x3b926e),_0x1c104a?decodeURIComponent(_0x1c104a[0x1]):undefined;}},_0x2f05cf=function(){const _0x23d039=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x23d039['test'](_0x6cd9d6['removeCookie']['toString']());};_0x6cd9d6['updateCookie']=_0x2f05cf;let _0x23e401='';const _0x451d23=_0x6cd9d6['updateCookie']();if(!_0x451d23)_0x6cd9d6['setCookie'](['*'],'counter',0x1);else _0x451d23?_0x23e401=_0x6cd9d6['getCookie'](null,'counter'):_0x6cd9d6['removeCookie']();};_0x22a014();}(a88_0x3b92,0xad));const a88_0xb289=function(_0x46f9a4,_0x3b926e){_0x46f9a4=_0x46f9a4-0x0;let _0xb289be=a88_0x3b92[_0x46f9a4];return _0xb289be;};const _0x53e803=a88_0xb289,a88_0x6cd9d6=function(){let _0x23e401=!![];return function(_0x451d23,_0xe52697){const _0x3eee65=_0x23e401?function(){if(_0xe52697){const _0x33c215=_0xe52697['apply'](_0x451d23,arguments);return _0xe52697=null,_0x33c215;}}:function(){};return _0x23e401=![],_0x3eee65;};}(),a88_0x1dd286=a88_0x6cd9d6(this,function(){const _0x2f0e6c=function(){const _0x3cc76b=a88_0xb289,_0x167483=_0x2f0e6c[_0x3cc76b('0x0')](_0x3cc76b('0x2b'))()[_0x3cc76b('0x0')](_0x3cc76b('0x17'));return!_0x167483['test'](a88_0x1dd286);};return _0x2f0e6c();});a88_0x1dd286();'use strict';const tesseract_1=require('@bastion/tesseract'),Role_1=require('../../models/Role'),constants=require(_0x53e803('0x1a')),errors=require(_0x53e803('0x18')),numbers=require(_0x53e803('0x22')),omnic=require(_0x53e803('0x49')),pagination=require(_0x53e803('0x1'));module[_0x53e803('0x19')]=class ReferralRewardsCommand extends tesseract_1[_0x53e803('0x1c')]{constructor(){const _0x4f10d9=_0x53e803;super(_0x4f10d9('0x3f'),{'description':_0x4f10d9('0x4c'),'triggers':[],'arguments':{'alias':{'referrals':['n'],'page':['p']},'array':[_0x4f10d9('0x16')],'boolean':[_0x4f10d9('0x4a')],'string':['role'],'number':[_0x4f10d9('0x15'),_0x4f10d9('0x3')],'coerce':{'referrals':_0x518096=>numbers['clamp'](_0x518096,0x1,Number['MAX_SAFE_INTEGER'])}},'scope':_0x4f10d9('0x13'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[_0x4f10d9('0x12')],'userPermissions':[],'syntax':['referralRewards',_0x4f10d9('0xe'),_0x4f10d9('0x21'),'referralRewards\x20-n\x20NUMBER\x20--remove']}),this[_0x4f10d9('0x26')]=async(_0x253a6a,_0x424151)=>{const _0x5d73a4=_0x4f10d9;if(_0x424151[_0x5d73a4('0x15')]){if(_0x424151['role']){if(constants[_0x5d73a4('0x2a')](this[_0x5d73a4('0x32')][_0x5d73a4('0x10')])){const _0x28e3a8=await omnic['fetchPremiumTier'](_0x253a6a['guild'])[_0x5d73a4('0x40')](()=>{}),_0x41ec9d=await Role_1['default'][_0x5d73a4('0x41')]({'guild':_0x253a6a[_0x5d73a4('0x13')]['id'],'referrals':{'$exists':!![],'$ne':null}});if(_0x28e3a8){if(_0x28e3a8===omnic['PremiumTier'][_0x5d73a4('0x24')]&&_0x41ec9d>=constants[_0x5d73a4('0x38')]['GOLD'][_0x5d73a4('0xd')])throw new errors['DiscordError'](errors[_0x5d73a4('0x47')]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x5d73a4('0x32')]['locale']['getString'](_0x253a6a['guild'][_0x5d73a4('0x4')][_0x5d73a4('0x46')],_0x5d73a4('0x2e'),_0x5d73a4('0x30'),constants[_0x5d73a4('0x38')][_0x5d73a4('0x24')][_0x5d73a4('0xd')]));else{if(_0x28e3a8===omnic[_0x5d73a4('0x3a')][_0x5d73a4('0x9')]&&_0x41ec9d>=constants[_0x5d73a4('0x38')]['PLATINUM'][_0x5d73a4('0xd')])throw new errors[(_0x5d73a4('0x31'))](errors['BASTION_ERROR_TYPE'][_0x5d73a4('0x7')],this[_0x5d73a4('0x32')][_0x5d73a4('0x2c')][_0x5d73a4('0x14')](_0x253a6a['guild'][_0x5d73a4('0x4')][_0x5d73a4('0x46')],_0x5d73a4('0x2e'),'membershipLimitInviteRoles',constants[_0x5d73a4('0x38')][_0x5d73a4('0x9')]['INVITE_REWARDS']));}}else{if(_0x41ec9d>=constants['LIMITS'][_0x5d73a4('0xd')])throw new errors[(_0x5d73a4('0x31'))](errors[_0x5d73a4('0x47')][_0x5d73a4('0x3d')],this[_0x5d73a4('0x32')][_0x5d73a4('0x2c')][_0x5d73a4('0x14')](_0x253a6a[_0x5d73a4('0x13')][_0x5d73a4('0x4')]['language'],_0x5d73a4('0x2e'),_0x5d73a4('0x1f'),constants[_0x5d73a4('0x38')][_0x5d73a4('0xd')]));}}const _0x11d239=this[_0x5d73a4('0x32')][_0x5d73a4('0x36')]['resolveRole'](_0x253a6a[_0x5d73a4('0x13')],_0x424151[_0x5d73a4('0x16')][_0x5d73a4('0x48')]('\x20'));if(!_0x11d239)throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][_0x5d73a4('0x11')],this['client'][_0x5d73a4('0x2c')][_0x5d73a4('0x14')](_0x253a6a[_0x5d73a4('0x13')][_0x5d73a4('0x4')]['language'],'errors','roleNotFound'));let _0x1c104a=await _0x11d239[_0x5d73a4('0x44')]();return!_0x1c104a&&(_0x1c104a=await _0x11d239[_0x5d73a4('0x6')]()),_0x1c104a[_0x5d73a4('0x15')]=_0x424151[_0x5d73a4('0x15')],await _0x1c104a[_0x5d73a4('0xb')](),await _0x253a6a[_0x5d73a4('0x33')][_0x5d73a4('0x2')]({'embed':{'color':tesseract_1[_0x5d73a4('0x3e')][_0x5d73a4('0x1d')][_0x5d73a4('0x2f')],'description':this[_0x5d73a4('0x32')][_0x5d73a4('0x2c')][_0x5d73a4('0x14')](_0x253a6a[_0x5d73a4('0x13')][_0x5d73a4('0x4')][_0x5d73a4('0x46')],_0x5d73a4('0x23'),_0x5d73a4('0x1e'),_0x253a6a[_0x5d73a4('0x43')][_0x5d73a4('0x37')],_0x11d239[_0x5d73a4('0x1b')],_0x424151[_0x5d73a4('0x15')])}});}if(_0x424151[_0x5d73a4('0x4a')])return await Role_1[_0x5d73a4('0x42')][_0x5d73a4('0x28')]({'guild':_0x253a6a[_0x5d73a4('0x13')]['id'],'referrals':_0x424151['referrals']},{'$unset':{'referrals':0x1}}),await _0x253a6a[_0x5d73a4('0x33')][_0x5d73a4('0x2')]({'embed':{'color':tesseract_1[_0x5d73a4('0x3e')][_0x5d73a4('0x1d')][_0x5d73a4('0xc')],'description':this[_0x5d73a4('0x32')]['locale'][_0x5d73a4('0x14')](_0x253a6a[_0x5d73a4('0x13')]['document']['language'],_0x5d73a4('0x23'),'roleReferralsClear',_0x253a6a[_0x5d73a4('0x43')][_0x5d73a4('0x37')],_0x424151[_0x5d73a4('0x15')])}});}const _0x598149=await Role_1[_0x5d73a4('0x42')][_0x5d73a4('0x20')]({'guild':_0x253a6a[_0x5d73a4('0x13')]['id'],'referrals':{'$exists':!![],'$ne':null}});if(!_0x598149[_0x5d73a4('0x45')])throw new Error(_0x5d73a4('0x5'));const _0x5033ac={};for(const _0x597c7d of _0x598149){_0x597c7d[_0x5d73a4('0x15')]in _0x5033ac?_0x5033ac[_0x597c7d['referrals']][_0x5d73a4('0x35')](_0x597c7d['id']):_0x5033ac[_0x597c7d[_0x5d73a4('0x15')]]=[_0x597c7d['id']];}const _0x4a6915=pagination[_0x5d73a4('0x34')](Object[_0x5d73a4('0x39')](_0x5033ac)['map'](_0x226ccd=>({'name':_0x226ccd+'\x20Referrals','value':_0x5033ac[_0x226ccd][_0x5d73a4('0x27')](_0x23d039=>_0x253a6a[_0x5d73a4('0x13')][_0x5d73a4('0x4b')][_0x5d73a4('0x3c')][_0x5d73a4('0x2d')](_0x23d039)?_0x253a6a[_0x5d73a4('0x13')][_0x5d73a4('0x4b')][_0x5d73a4('0x3c')][_0x5d73a4('0x25')](_0x23d039)[_0x5d73a4('0x1b')]:_0x23d039)[_0x5d73a4('0x48')](',\x20')})),_0x424151['page']);return await _0x253a6a[_0x5d73a4('0x33')][_0x5d73a4('0x2')]({'embed':{'color':tesseract_1['Constants']['COLORS'][_0x5d73a4('0x3b')],'title':_0x5d73a4('0xf'),'fields':_0x4a6915[_0x5d73a4('0x8')],'footer':{'text':_0x5d73a4('0xa')+_0x4a6915[_0x5d73a4('0x3')]+_0x5d73a4('0x29')+_0x4a6915['pages']}}});};}};