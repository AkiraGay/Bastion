const a71_0xb701=['document','client','ROLES_PER_LEVEL','levelUpRoles','default','@bastion/tesseract','PLATINUM','COLORS','NO_ROLES_FOR_LEVEL','levelUpRoles\x20--level\x20NUMBER\x20--remove','author','errors','roleLevelClear','length','PremiumTier','membershipLimitRoleLevels','../../models/Role','MAX_LEVEL','locale','language','find','../../utils/gamification','keys','map','Level\x20','membershipLimitLevelRoles','PREMIUM_MEMBERSHIP_REQUIRED','role','resolver','fetchDocument','../../utils/omnic','remove','GOLD','join','BASTION_ERROR_TYPE','DiscordError','constructor','name','premiumRoleLevels','LIMITS','Command','resolveRole','level','user','NO_LEVEL_UP_ROLES','IRIS','LIMITED_PREMIUM_MEMBERSHIP','return\x20/\x22\x20+\x20this\x20+\x20\x22/','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','countDocuments','GREEN','send','cache','ROLE_LEVELS','Level-Up\x20Roles','apply','ROLE_NOT_FOUND','channel','roles','../../utils/errors','test','_id','guild','get','info','roleNotFound','Constants','tag','resolveRoles','catch','save','getString'];(function(_0x403381,_0xb701e6){const _0x3d6e64=function(_0x4b29c1){while(--_0x4b29c1){_0x403381['push'](_0x403381['shift']());}},_0x53a138=function(){const _0x510a98={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x56e909,_0x41fde1,_0x2b8715,_0x2b9167){_0x2b9167=_0x2b9167||{};let _0x298f7d=_0x41fde1+'='+_0x2b8715,_0x1f9a48=0x0;for(let _0x1972a1=0x0,_0x3aef5a=_0x56e909['length'];_0x1972a1<_0x3aef5a;_0x1972a1++){const _0x3cdfe2=_0x56e909[_0x1972a1];_0x298f7d+=';\x20'+_0x3cdfe2;const _0xc46021=_0x56e909[_0x3cdfe2];_0x56e909['push'](_0xc46021),_0x3aef5a=_0x56e909['length'],_0xc46021!==!![]&&(_0x298f7d+='='+_0xc46021);}_0x2b9167['cookie']=_0x298f7d;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3acf46,_0x1acde7){_0x3acf46=_0x3acf46||function(_0x288615){return _0x288615;};const _0x962c5a=_0x3acf46(new RegExp('(?:^|;\x20)'+_0x1acde7['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x1d2900=function(_0x2fb18c,_0x585e5b){_0x2fb18c(++_0x585e5b);};return _0x1d2900(_0x3d6e64,_0xb701e6),_0x962c5a?decodeURIComponent(_0x962c5a[0x1]):undefined;}},_0x4aae07=function(){const _0x95151d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x95151d['test'](_0x510a98['removeCookie']['toString']());};_0x510a98['updateCookie']=_0x4aae07;let _0x127525='';const _0x308e38=_0x510a98['updateCookie']();if(!_0x308e38)_0x510a98['setCookie'](['*'],'counter',0x1);else _0x308e38?_0x127525=_0x510a98['getCookie'](null,'counter'):_0x510a98['removeCookie']();};_0x53a138();}(a71_0xb701,0x187));const a71_0x3d6e=function(_0x403381,_0xb701e6){_0x403381=_0x403381-0x0;let _0x3d6e64=a71_0xb701[_0x403381];return _0x3d6e64;};const _0x1b8a0a=a71_0x3d6e,a71_0x510a98=function(){let _0x127525=!![];return function(_0x308e38,_0x56e909){const _0x41fde1=_0x127525?function(){const _0x5b9eb3=a71_0x3d6e;if(_0x56e909){const _0x2b8715=_0x56e909[_0x5b9eb3('0x18')](_0x308e38,arguments);return _0x56e909=null,_0x2b8715;}}:function(){};return _0x127525=![],_0x41fde1;};}(),a71_0x4b29c1=a71_0x510a98(this,function(){const _0x2b9167=function(){const _0x5a61f4=a71_0x3d6e,_0x298f7d=_0x2b9167[_0x5a61f4('0x5')](_0x5a61f4('0x10'))()['constructor'](_0x5a61f4('0x11'));return!_0x298f7d[_0x5a61f4('0x1d')](a71_0x4b29c1);};return _0x2b9167();});a71_0x4b29c1();'use strict';const tesseract_1=require(_0x1b8a0a('0x2e')),Role_1=require(_0x1b8a0a('0x39')),constants=require('../../utils/constants'),errors=require(_0x1b8a0a('0x1c')),gamification=require(_0x1b8a0a('0x3e')),numbers=require('../../utils/numbers'),omnic=require(_0x1b8a0a('0x47'));module['exports']=class LevelUpRolesCommand extends tesseract_1[_0x1b8a0a('0x9')]{constructor(){const _0x16aaae=_0x1b8a0a;super('levelUpRoles',{'description':'It\x20allows\x20you\x20to\x20add\x20roles\x20to\x20a\x20level.\x20When\x20members\x20reach\x20that\x20level,\x20they\x27ll\x20be\x20awarded\x20those\x20roles.','triggers':[],'arguments':{'array':['role'],'boolean':[_0x16aaae('0x0')],'string':['role'],'number':[_0x16aaae('0xb')],'coerce':{'level':_0x1f9a48=>numbers['clamp'](_0x1f9a48,0x1,gamification[_0x16aaae('0x3a')])}},'scope':_0x16aaae('0x1f'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':['MANAGE_ROLES'],'syntax':[_0x16aaae('0x2c'),'levelUpRoles\x20--level\x20NUMBER','levelUpRoles\x20--level\x20NUMBER\x20--role\x20ROLE',_0x16aaae('0x32')]}),this['exec']=async(_0x1972a1,_0x3aef5a)=>{const _0x17c10d=_0x16aaae;if(_0x3aef5a[_0x17c10d('0xb')]){if(_0x3aef5a[_0x17c10d('0x44')]){if(constants['isPublicBastion'](this[_0x17c10d('0x2a')][_0x17c10d('0xc')])){const _0x288615=await omnic['fetchPremiumTier'](_0x1972a1['guild'])[_0x17c10d('0x26')](()=>{}),_0x2fb18c=await Role_1['default']['distinct'](_0x17c10d('0xb'),{'guild':_0x1972a1[_0x17c10d('0x1f')]['id'],'level':{'$exists':!![],'$ne':null}});if(_0x288615){if(_0x288615===omnic[_0x17c10d('0x37')][_0x17c10d('0x1')]&&_0x2fb18c[_0x17c10d('0x36')]>=constants[_0x17c10d('0x8')][_0x17c10d('0x1')][_0x17c10d('0x16')])throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][_0x17c10d('0xf')],this[_0x17c10d('0x2a')][_0x17c10d('0x3b')]['getString'](_0x1972a1[_0x17c10d('0x1f')][_0x17c10d('0x29')][_0x17c10d('0x3c')],_0x17c10d('0x34'),'membershipLimitRoleLevels',constants['LIMITS']['GOLD'][_0x17c10d('0x16')]));else{if(_0x288615===omnic[_0x17c10d('0x37')][_0x17c10d('0x2f')]&&_0x2fb18c[_0x17c10d('0x36')]>=constants[_0x17c10d('0x8')][_0x17c10d('0x2f')][_0x17c10d('0x16')])throw new errors[(_0x17c10d('0x4'))](errors[_0x17c10d('0x3')]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x17c10d('0x2a')][_0x17c10d('0x3b')]['getString'](_0x1972a1['guild']['document'][_0x17c10d('0x3c')],'errors',_0x17c10d('0x38'),constants[_0x17c10d('0x8')][_0x17c10d('0x2f')][_0x17c10d('0x16')]));}}else{if(_0x2fb18c['length']>=constants[_0x17c10d('0x8')][_0x17c10d('0x16')])throw new errors[(_0x17c10d('0x4'))](errors['BASTION_ERROR_TYPE'][_0x17c10d('0x43')],this[_0x17c10d('0x2a')]['locale']['getString'](_0x1972a1[_0x17c10d('0x1f')][_0x17c10d('0x29')][_0x17c10d('0x3c')],_0x17c10d('0x34'),_0x17c10d('0x7'),constants['LIMITS'][_0x17c10d('0x16')]));}const _0x585e5b=await Role_1[_0x17c10d('0x2d')][_0x17c10d('0x12')]({'guild':_0x1972a1[_0x17c10d('0x1f')]['id'],'level':_0x3aef5a[_0x17c10d('0xb')]});if(_0x288615){if(_0x288615===omnic[_0x17c10d('0x37')][_0x17c10d('0x1')]&&_0x585e5b>=constants[_0x17c10d('0x8')][_0x17c10d('0x1')]['ROLES_PER_LEVEL'])throw new errors[(_0x17c10d('0x4'))](errors[_0x17c10d('0x3')]['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][_0x17c10d('0x3b')][_0x17c10d('0x28')](_0x1972a1[_0x17c10d('0x1f')]['document'][_0x17c10d('0x3c')],_0x17c10d('0x34'),_0x17c10d('0x42'),constants[_0x17c10d('0x8')][_0x17c10d('0x1')][_0x17c10d('0x2b')]));else{if(_0x288615===omnic['PremiumTier']['PLATINUM']&&_0x585e5b>=constants['LIMITS'][_0x17c10d('0x2f')][_0x17c10d('0x2b')])throw new errors[(_0x17c10d('0x4'))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x17c10d('0x2a')][_0x17c10d('0x3b')][_0x17c10d('0x28')](_0x1972a1[_0x17c10d('0x1f')]['document'][_0x17c10d('0x3c')],'errors','membershipLimitLevelRoles',constants[_0x17c10d('0x8')]['PLATINUM'][_0x17c10d('0x2b')]));}}else{if(_0x585e5b>=constants[_0x17c10d('0x8')][_0x17c10d('0x2b')])throw new errors[(_0x17c10d('0x4'))](errors[_0x17c10d('0x3')][_0x17c10d('0x43')],this[_0x17c10d('0x2a')][_0x17c10d('0x3b')]['getString'](_0x1972a1[_0x17c10d('0x1f')][_0x17c10d('0x29')][_0x17c10d('0x3c')],_0x17c10d('0x34'),'premiumLevelRoles',constants[_0x17c10d('0x8')][_0x17c10d('0x2b')]));}}const _0x962c5a=this[_0x17c10d('0x2a')][_0x17c10d('0x45')][_0x17c10d('0xa')](_0x1972a1['guild'],_0x3aef5a[_0x17c10d('0x44')]['join']('\x20'));if(!_0x962c5a)throw new errors[(_0x17c10d('0x4'))](errors[_0x17c10d('0x3')][_0x17c10d('0x19')],this['client']['locale']['getString'](_0x1972a1[_0x17c10d('0x1f')]['document'][_0x17c10d('0x3c')],_0x17c10d('0x34'),_0x17c10d('0x22')));let _0x1d2900=await _0x962c5a[_0x17c10d('0x46')]();return!_0x1d2900&&(_0x1d2900=await _0x962c5a['createDocument']()),_0x1d2900[_0x17c10d('0xb')]=_0x3aef5a[_0x17c10d('0xb')],await _0x1d2900[_0x17c10d('0x27')](),await _0x1972a1[_0x17c10d('0x1a')]['send']({'embed':{'color':tesseract_1['Constants'][_0x17c10d('0x30')][_0x17c10d('0x13')],'description':this[_0x17c10d('0x2a')]['locale'][_0x17c10d('0x28')](_0x1972a1[_0x17c10d('0x1f')][_0x17c10d('0x29')]['language'],'info','roleLevelAdd',_0x1972a1[_0x17c10d('0x33')][_0x17c10d('0x24')],_0x962c5a[_0x17c10d('0x6')],_0x3aef5a[_0x17c10d('0xb')])}})[_0x17c10d('0x26')](()=>{});}if(_0x3aef5a[_0x17c10d('0x0')])return await Role_1[_0x17c10d('0x2d')]['updateMany']({'guild':_0x1972a1[_0x17c10d('0x1f')]['id'],'level':_0x3aef5a['level']},{'$unset':{'level':0x1}}),await _0x1972a1[_0x17c10d('0x1a')][_0x17c10d('0x14')]({'embed':{'color':tesseract_1[_0x17c10d('0x23')]['COLORS']['RED'],'description':this[_0x17c10d('0x2a')][_0x17c10d('0x3b')][_0x17c10d('0x28')](_0x1972a1['guild']['document'][_0x17c10d('0x3c')],_0x17c10d('0x21'),_0x17c10d('0x35'),_0x1972a1['author'][_0x17c10d('0x24')],_0x3aef5a[_0x17c10d('0xb')])}})['catch'](()=>{});const _0x3acf46=await Role_1[_0x17c10d('0x2d')][_0x17c10d('0x3d')]({'guild':_0x1972a1[_0x17c10d('0x1f')]['id'],'level':_0x3aef5a[_0x17c10d('0xb')]});if(!_0x3acf46['length'])throw new Error(_0x17c10d('0x31'));const _0x1acde7=this['client']['resolver'][_0x17c10d('0x25')](_0x1972a1['guild'],_0x3acf46['map'](_0x95151d=>_0x95151d[_0x17c10d('0x1e')]));return await _0x1972a1[_0x17c10d('0x1a')]['send']({'embed':{'color':tesseract_1[_0x17c10d('0x23')][_0x17c10d('0x30')][_0x17c10d('0xe')],'title':_0x17c10d('0x41')+_0x3aef5a[_0x17c10d('0xb')],'fields':[{'name':'Roles','value':_0x1acde7['map'](_0x143474=>_0x143474['name'])[_0x17c10d('0x2')]('\x0a')}]}})[_0x17c10d('0x26')](()=>{});}const _0x3cdfe2=await Role_1[_0x17c10d('0x2d')]['find']({'guild':_0x1972a1[_0x17c10d('0x1f')]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x3cdfe2[_0x17c10d('0x36')])throw new Error(_0x17c10d('0xd'));const _0xc46021={};for(const _0x4e39dd of _0x3cdfe2){_0x4e39dd['level']in _0xc46021?_0xc46021[_0x4e39dd[_0x17c10d('0xb')]]['push'](_0x4e39dd[_0x17c10d('0x1e')]):_0xc46021[_0x4e39dd[_0x17c10d('0xb')]]=[_0x4e39dd[_0x17c10d('0x1e')]];}return await _0x1972a1[_0x17c10d('0x1a')][_0x17c10d('0x14')]({'embed':{'color':tesseract_1[_0x17c10d('0x23')][_0x17c10d('0x30')][_0x17c10d('0xe')],'title':_0x17c10d('0x17'),'fields':Object[_0x17c10d('0x3f')](_0xc46021)[_0x17c10d('0x40')](_0x2bacec=>({'name':_0x17c10d('0x41')+_0x2bacec,'value':_0xc46021[_0x2bacec][_0x17c10d('0x40')](_0x3aed58=>_0x1972a1['guild'][_0x17c10d('0x1b')][_0x17c10d('0x15')]['has'](_0x3aed58)?_0x1972a1[_0x17c10d('0x1f')][_0x17c10d('0x1b')][_0x17c10d('0x15')][_0x17c10d('0x20')](_0x3aed58)[_0x17c10d('0x6')]:_0x3aed58)['join'](',\x20')}))}})[_0x17c10d('0x26')](()=>{});};}};