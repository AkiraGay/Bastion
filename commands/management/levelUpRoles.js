const a64_0x53d2=['roleLevelAdd','client','../../utils/numbers','It\x20allows\x20you\x20to\x20add\x20roles\x20to\x20a\x20level.\x20When\x20members\x20reach\x20that\x20level,\x20they\x27ll\x20be\x20awarded\x20those\x20roles.','../../utils/omnic','remove','resolveRoles','countDocuments','PremiumTier','get','user','ROLE_NOT_FOUND','NO_ROLES_FOR_LEVEL','resolver','exports','../../utils/constants','RED','has','ROLES_PER_LEVEL','fetchPremiumTier','MAX_LEVEL','Command','guild','getString','push','role','_id','catch','Level-Up\x20Roles','author','Level\x20','Constants','membershipLimitLevelRoles','cache','COLORS','channel','roles','GOLD','name','map','save','level','ROLE_LEVELS','resolveRole','premiumRoleLevels','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','apply','return\x20/\x22\x20+\x20this\x20+\x20\x22/','default','clamp','levelUpRoles\x20--level\x20NUMBER','length','roleNotFound','premiumLevelRoles','tag','levelUpRoles\x20--level\x20NUMBER\x20--role\x20ROLE','IRIS','../../utils/gamification','PREMIUM_MEMBERSHIP_REQUIRED','language','locale','membershipLimitRoleLevels','roleLevelClear','keys','DiscordError','levelUpRoles\x20--level\x20NUMBER\x20--remove','distinct','levelUpRoles','LIMITED_PREMIUM_MEMBERSHIP','NO_LEVEL_UP_ROLES','createDocument','join','GREEN','../../utils/errors','errors','BASTION_ERROR_TYPE','send','constructor','LIMITS','PLATINUM','document'];(function(_0x9a69d8,_0x53d2b8){const _0x8d9a6a=function(_0x50c09c){while(--_0x50c09c){_0x9a69d8['push'](_0x9a69d8['shift']());}};const _0x36da01=function(){const _0xbdf855={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3de4f0,_0x47f0e5,_0x13ea6b,_0x4acec1){_0x4acec1=_0x4acec1||{};let _0x5d0dcc=_0x47f0e5+'='+_0x13ea6b;let _0x53727c=0x0;for(let _0x2c5791=0x0,_0x564997=_0x3de4f0['length'];_0x2c5791<_0x564997;_0x2c5791++){const _0x606d60=_0x3de4f0[_0x2c5791];_0x5d0dcc+=';\x20'+_0x606d60;const _0x466082=_0x3de4f0[_0x606d60];_0x3de4f0['push'](_0x466082);_0x564997=_0x3de4f0['length'];if(_0x466082!==!![]){_0x5d0dcc+='='+_0x466082;}}_0x4acec1['cookie']=_0x5d0dcc;},'removeCookie':function(){return'dev';},'getCookie':function(_0x448c4f,_0x31d618){_0x448c4f=_0x448c4f||function(_0x1503a6){return _0x1503a6;};const _0x3c2223=_0x448c4f(new RegExp('(?:^|;\x20)'+_0x31d618['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x1870ec=function(_0x5219f2,_0x202344){_0x5219f2(++_0x202344);};_0x1870ec(_0x8d9a6a,_0x53d2b8);return _0x3c2223?decodeURIComponent(_0x3c2223[0x1]):undefined;}};const _0x34fac6=function(){const _0x28e01f=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x28e01f['test'](_0xbdf855['removeCookie']['toString']());};_0xbdf855['updateCookie']=_0x34fac6;let _0x38347a='';const _0x2e90df=_0xbdf855['updateCookie']();if(!_0x2e90df){_0xbdf855['setCookie'](['*'],'counter',0x1);}else if(_0x2e90df){_0x38347a=_0xbdf855['getCookie'](null,'counter');}else{_0xbdf855['removeCookie']();}};_0x36da01();}(a64_0x53d2,0x8c));const a64_0x8d9a=function(_0x9a69d8,_0x53d2b8){_0x9a69d8=_0x9a69d8-0x0;let _0x8d9a6a=a64_0x53d2[_0x9a69d8];return _0x8d9a6a;};const a64_0xbdf855=function(){let _0x32ccb3=!![];return function(_0x401583,_0x1040ed){const _0x48becc=_0x32ccb3?function(){if(_0x1040ed){const _0xf8fb8=_0x1040ed[a64_0x8d9a('0x44')](_0x401583,arguments);_0x1040ed=null;return _0xf8fb8;}}:function(){};_0x32ccb3=![];return _0x48becc;};}();const a64_0x50c09c=a64_0xbdf855(this,function(){const _0x175183=function(){const _0x591954=_0x175183[a64_0x8d9a('0x12')](a64_0x8d9a('0x45'))()['compile'](a64_0x8d9a('0x43'));return!_0x591954['test'](a64_0x50c09c);};return _0x175183();});a64_0x50c09c();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require('../../models/Role');const constants=require(a64_0x8d9a('0x25'));const errors=require(a64_0x8d9a('0xe'));const gamification=require(a64_0x8d9a('0x4f'));const numbers=require(a64_0x8d9a('0x18'));const omnic=require(a64_0x8d9a('0x1a'));module[a64_0x8d9a('0x24')]=class LevelUpRolesCommand extends tesseract_1[a64_0x8d9a('0x2b')]{constructor(){super(a64_0x8d9a('0x8'),{'description':a64_0x8d9a('0x19'),'triggers':[],'arguments':{'array':['role'],'boolean':[a64_0x8d9a('0x1b')],'string':[a64_0x8d9a('0x2f')],'number':[a64_0x8d9a('0x3f')],'coerce':{'level':_0x368745=>numbers[a64_0x8d9a('0x47')](_0x368745,0x1,gamification[a64_0x8d9a('0x2a')])}},'scope':a64_0x8d9a('0x2c'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':['MANAGE_ROLES'],'syntax':['levelUpRoles',a64_0x8d9a('0x48'),a64_0x8d9a('0x4d'),a64_0x8d9a('0x6')]});this['exec']=async(_0x4c25c4,_0x2aed56)=>{if(_0x2aed56['level']){if(_0x2aed56[a64_0x8d9a('0x2f')]){if(constants['isPublicBastion'](this['client'][a64_0x8d9a('0x20')])){const _0x5d911a=await omnic[a64_0x8d9a('0x29')](_0x4c25c4['guild'])[a64_0x8d9a('0x31')](()=>{});const _0x35e48e=await Role_1[a64_0x8d9a('0x46')][a64_0x8d9a('0x7')](a64_0x8d9a('0x3f'),{'guild':_0x4c25c4[a64_0x8d9a('0x2c')]['id'],'level':{'$exists':!![],'$ne':null}});if(_0x5d911a){if(_0x5d911a===omnic[a64_0x8d9a('0x1e')][a64_0x8d9a('0x3b')]&&_0x35e48e['length']>=constants['LIMITS'][a64_0x8d9a('0x3b')]['ROLE_LEVELS']){throw new errors[(a64_0x8d9a('0x5'))](errors[a64_0x8d9a('0x10')][a64_0x8d9a('0x9')],this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4[a64_0x8d9a('0x2c')]['document']['language'],'errors',a64_0x8d9a('0x2'),constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x3b')][a64_0x8d9a('0x40')]));}else if(_0x5d911a===omnic['PremiumTier']['PLATINUM']&&_0x35e48e[a64_0x8d9a('0x49')]>=constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x14')]['ROLE_LEVELS']){throw new errors[(a64_0x8d9a('0x5'))](errors['BASTION_ERROR_TYPE'][a64_0x8d9a('0x9')],this[a64_0x8d9a('0x17')]['locale'][a64_0x8d9a('0x2d')](_0x4c25c4['guild'][a64_0x8d9a('0x15')][a64_0x8d9a('0x0')],'errors','membershipLimitRoleLevels',constants['LIMITS']['PLATINUM'][a64_0x8d9a('0x40')]));}}else if(_0x35e48e['length']>=constants['LIMITS'][a64_0x8d9a('0x40')]){throw new errors[(a64_0x8d9a('0x5'))](errors[a64_0x8d9a('0x10')][a64_0x8d9a('0x50')],this['client'][a64_0x8d9a('0x1')]['getString'](_0x4c25c4['guild'][a64_0x8d9a('0x15')]['language'],a64_0x8d9a('0xf'),a64_0x8d9a('0x42'),constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x40')]));}const _0x44daa9=await Role_1['default'][a64_0x8d9a('0x1d')]({'guild':_0x4c25c4[a64_0x8d9a('0x2c')]['id'],'level':_0x2aed56['level']});if(_0x5d911a){if(_0x5d911a===omnic[a64_0x8d9a('0x1e')][a64_0x8d9a('0x3b')]&&_0x44daa9>=constants['LIMITS']['GOLD'][a64_0x8d9a('0x28')]){throw new errors[(a64_0x8d9a('0x5'))](errors['BASTION_ERROR_TYPE'][a64_0x8d9a('0x9')],this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4[a64_0x8d9a('0x2c')][a64_0x8d9a('0x15')]['language'],a64_0x8d9a('0xf'),'membershipLimitLevelRoles',constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x3b')]['ROLES_PER_LEVEL']));}else if(_0x5d911a===omnic[a64_0x8d9a('0x1e')][a64_0x8d9a('0x14')]&&_0x44daa9>=constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x14')][a64_0x8d9a('0x28')]){throw new errors[(a64_0x8d9a('0x5'))](errors[a64_0x8d9a('0x10')][a64_0x8d9a('0x9')],this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4['guild']['document'][a64_0x8d9a('0x0')],a64_0x8d9a('0xf'),a64_0x8d9a('0x36'),constants['LIMITS']['PLATINUM']['ROLES_PER_LEVEL']));}}else if(_0x44daa9>=constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x28')]){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a64_0x8d9a('0x50')],this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4['guild'][a64_0x8d9a('0x15')][a64_0x8d9a('0x0')],a64_0x8d9a('0xf'),a64_0x8d9a('0x4b'),constants[a64_0x8d9a('0x13')][a64_0x8d9a('0x28')]));}}const _0x132e99=this['client'][a64_0x8d9a('0x23')][a64_0x8d9a('0x41')](_0x4c25c4['guild'],_0x2aed56[a64_0x8d9a('0x2f')]['join']('\x20'));if(!_0x132e99)throw new errors[(a64_0x8d9a('0x5'))](errors[a64_0x8d9a('0x10')][a64_0x8d9a('0x21')],this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4[a64_0x8d9a('0x2c')][a64_0x8d9a('0x15')][a64_0x8d9a('0x0')],'error',a64_0x8d9a('0x4a')));let _0x4e6c67=await _0x132e99['fetchDocument']();if(!_0x4e6c67){_0x4e6c67=await _0x132e99[a64_0x8d9a('0xb')]();}_0x4e6c67['level']=_0x2aed56['level'];await _0x4e6c67[a64_0x8d9a('0x3e')]();return await _0x4c25c4[a64_0x8d9a('0x39')]['send']({'embed':{'color':tesseract_1[a64_0x8d9a('0x35')][a64_0x8d9a('0x38')][a64_0x8d9a('0xd')],'description':this[a64_0x8d9a('0x17')][a64_0x8d9a('0x1')][a64_0x8d9a('0x2d')](_0x4c25c4[a64_0x8d9a('0x2c')][a64_0x8d9a('0x15')][a64_0x8d9a('0x0')],'info',a64_0x8d9a('0x16'),_0x4c25c4[a64_0x8d9a('0x33')][a64_0x8d9a('0x4c')],_0x132e99[a64_0x8d9a('0x3c')],_0x2aed56[a64_0x8d9a('0x3f')])}})[a64_0x8d9a('0x31')](()=>{});}if(_0x2aed56[a64_0x8d9a('0x1b')]){await Role_1[a64_0x8d9a('0x46')]['updateMany']({'guild':_0x4c25c4[a64_0x8d9a('0x2c')]['id'],'level':_0x2aed56[a64_0x8d9a('0x3f')]},{'$unset':{'level':0x1}});return await _0x4c25c4['channel']['send']({'embed':{'color':tesseract_1[a64_0x8d9a('0x35')][a64_0x8d9a('0x38')][a64_0x8d9a('0x26')],'description':this[a64_0x8d9a('0x17')]['locale']['getString'](_0x4c25c4[a64_0x8d9a('0x2c')]['document']['language'],'info',a64_0x8d9a('0x3'),_0x4c25c4[a64_0x8d9a('0x33')][a64_0x8d9a('0x4c')],_0x2aed56['level'])}})[a64_0x8d9a('0x31')](()=>{});}const _0x1544df=await Role_1[a64_0x8d9a('0x46')]['find']({'guild':_0x4c25c4[a64_0x8d9a('0x2c')]['id'],'level':_0x2aed56[a64_0x8d9a('0x3f')]});if(!_0x1544df['length'])throw new Error(a64_0x8d9a('0x22'));const _0x4c2898=this['client']['resolver'][a64_0x8d9a('0x1c')](_0x4c25c4['guild'],_0x1544df[a64_0x8d9a('0x3d')](_0x2cd078=>_0x2cd078[a64_0x8d9a('0x30')]));return await _0x4c25c4[a64_0x8d9a('0x39')][a64_0x8d9a('0x11')]({'embed':{'color':tesseract_1['Constants']['COLORS'][a64_0x8d9a('0x4e')],'title':a64_0x8d9a('0x34')+_0x2aed56[a64_0x8d9a('0x3f')],'fields':[{'name':'Roles','value':_0x4c2898[a64_0x8d9a('0x3d')](_0x339959=>_0x339959[a64_0x8d9a('0x3c')])[a64_0x8d9a('0xc')]('\x0a')}]}})[a64_0x8d9a('0x31')](()=>{});}const _0x30e97e=await Role_1[a64_0x8d9a('0x46')]['find']({'guild':_0x4c25c4[a64_0x8d9a('0x2c')]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x30e97e['length'])throw new Error(a64_0x8d9a('0xa'));const _0x27eda9={};for(const _0x2b0c82 of _0x30e97e){if(_0x2b0c82[a64_0x8d9a('0x3f')]in _0x27eda9){_0x27eda9[_0x2b0c82[a64_0x8d9a('0x3f')]][a64_0x8d9a('0x2e')](_0x2b0c82['_id']);}else{_0x27eda9[_0x2b0c82['level']]=[_0x2b0c82[a64_0x8d9a('0x30')]];}}return await _0x4c25c4[a64_0x8d9a('0x39')][a64_0x8d9a('0x11')]({'embed':{'color':tesseract_1[a64_0x8d9a('0x35')][a64_0x8d9a('0x38')][a64_0x8d9a('0x4e')],'title':a64_0x8d9a('0x32'),'fields':Object[a64_0x8d9a('0x4')](_0x27eda9)[a64_0x8d9a('0x3d')](_0x3b09e3=>({'name':a64_0x8d9a('0x34')+_0x3b09e3,'value':_0x27eda9[_0x3b09e3][a64_0x8d9a('0x3d')](_0x36a23e=>_0x4c25c4[a64_0x8d9a('0x2c')][a64_0x8d9a('0x3a')][a64_0x8d9a('0x37')][a64_0x8d9a('0x27')](_0x36a23e)?_0x4c25c4[a64_0x8d9a('0x2c')][a64_0x8d9a('0x3a')][a64_0x8d9a('0x37')][a64_0x8d9a('0x1f')](_0x36a23e)[a64_0x8d9a('0x3c')]:_0x36a23e)[a64_0x8d9a('0xc')](',\x20')}))}})['catch'](()=>{});};}};