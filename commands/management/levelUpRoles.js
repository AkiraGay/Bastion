const a65_0x5f4c=['apply','Roles','LIMITS','It\x20allows\x20you\x20to\x20add\x20roles\x20to\x20a\x20level.\x20When\x20members\x20reach\x20that\x20level,\x20they\x27ll\x20be\x20awarded\x20those\x20roles.','distinct','level','MANAGE_ROLES','find','language','info','keys','PREMIUM_MEMBERSHIP_REQUIRED','catch','get','GOLD','ROLE_LEVELS','name','roleNotFound','levelUpRoles\x20--level\x20NUMBER','error','role','../../utils/errors','membershipLimitRoleLevels','document','../../utils/omnic','errors','fetchPremiumTier','BASTION_ERROR_TYPE','join','_id','PremiumTier','Constants','GREEN','exec','length','../../utils/numbers','save','membershipLimitLevelRoles','author','locale','user','test','resolveRole','premiumLevelRoles','createDocument','channel','PLATINUM','ROLES_PER_LEVEL','../../models/Role','DiscordError','cache','ROLE_NOT_FOUND','send','client','roles','tag','COLORS','LIMITED_PREMIUM_MEMBERSHIP','has','constructor','exports','NO_ROLES_FOR_LEVEL','default','getString','NO_LEVEL_UP_ROLES','Level\x20','remove','map','IRIS','updateMany','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','levelUpRoles','resolver','push','guild','roleLevelAdd','clamp','RED','premiumRoleLevels','MAX_LEVEL'];(function(_0x4a603f,_0x5f4cba){const _0x5519e9=function(_0x37a345){while(--_0x37a345){_0x4a603f['push'](_0x4a603f['shift']());}};const _0x8eaf1b=function(){const _0x1d1cad={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5f1952,_0x4debd8,_0x454fd7,_0x7dedf6){_0x7dedf6=_0x7dedf6||{};let _0x4dc91a=_0x4debd8+'='+_0x454fd7;let _0x31a852=0x0;for(let _0x5c1220=0x0,_0x433af2=_0x5f1952['length'];_0x5c1220<_0x433af2;_0x5c1220++){const _0x5011c7=_0x5f1952[_0x5c1220];_0x4dc91a+=';\x20'+_0x5011c7;const _0xe20980=_0x5f1952[_0x5011c7];_0x5f1952['push'](_0xe20980);_0x433af2=_0x5f1952['length'];if(_0xe20980!==!![]){_0x4dc91a+='='+_0xe20980;}}_0x7dedf6['cookie']=_0x4dc91a;},'removeCookie':function(){return'dev';},'getCookie':function(_0x12ea56,_0x38cc70){_0x12ea56=_0x12ea56||function(_0x7526d6){return _0x7526d6;};const _0x5029f4=_0x12ea56(new RegExp('(?:^|;\x20)'+_0x38cc70['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x170fe8=function(_0x1559ce,_0x569276){_0x1559ce(++_0x569276);};_0x170fe8(_0x5519e9,_0x5f4cba);return _0x5029f4?decodeURIComponent(_0x5029f4[0x1]):undefined;}};const _0x5c0c0c=function(){const _0x1a21f6=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x1a21f6['test'](_0x1d1cad['removeCookie']['toString']());};_0x1d1cad['updateCookie']=_0x5c0c0c;let _0xb4dfb8='';const _0x366702=_0x1d1cad['updateCookie']();if(!_0x366702){_0x1d1cad['setCookie'](['*'],'counter',0x1);}else if(_0x366702){_0xb4dfb8=_0x1d1cad['getCookie'](null,'counter');}else{_0x1d1cad['removeCookie']();}};_0x8eaf1b();}(a65_0x5f4c,0x19c));const a65_0x5519=function(_0x4a603f,_0x5f4cba){_0x4a603f=_0x4a603f-0x0;let _0x5519e9=a65_0x5f4c[_0x4a603f];return _0x5519e9;};const a65_0x1d1cad=function(){let _0xe6317=!![];return function(_0x5dbeff,_0xac97bd){const _0x390256=_0xe6317?function(){if(_0xac97bd){const _0x64150b=_0xac97bd[a65_0x5519('0x44')](_0x5dbeff,arguments);_0xac97bd=null;return _0x64150b;}}:function(){};_0xe6317=![];return _0x390256;};}();const a65_0x37a345=a65_0x1d1cad(this,function(){const _0x3fdf66=function(){const _0x7d40bf=_0x3fdf66[a65_0x5519('0x2f')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['compile'](a65_0x5519('0x3a'));return!_0x7d40bf[a65_0x5519('0x1d')](a65_0x37a345);};return _0x3fdf66();});a65_0x37a345();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require(a65_0x5519('0x24'));const constants=require('../../utils/constants');const errors=require(a65_0x5519('0x9'));const gamification=require('../../utils/gamification');const numbers=require(a65_0x5519('0x17'));const omnic=require(a65_0x5519('0xc'));module[a65_0x5519('0x30')]=class LevelUpRolesCommand extends tesseract_1['Command']{constructor(){super(a65_0x5519('0x3b'),{'description':a65_0x5519('0x47'),'triggers':[],'arguments':{'array':[a65_0x5519('0x8')],'boolean':['remove'],'string':[a65_0x5519('0x8')],'number':[a65_0x5519('0x49')],'coerce':{'level':_0x128b42=>numbers[a65_0x5519('0x40')](_0x128b42,0x1,gamification[a65_0x5519('0x43')])}},'scope':a65_0x5519('0x3e'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':['MANAGE_ROLES'],'userPermissions':[a65_0x5519('0x4a')],'syntax':[a65_0x5519('0x3b'),a65_0x5519('0x6'),'levelUpRoles\x20--level\x20NUMBER\x20--role\x20ROLE','levelUpRoles\x20--level\x20NUMBER\x20--remove']});this[a65_0x5519('0x15')]=async(_0x240711,_0x303a77)=>{if(_0x303a77[a65_0x5519('0x49')]){if(_0x303a77['role']){if(constants['isPublicBastion'](this[a65_0x5519('0x29')][a65_0x5519('0x1c')])){const _0x1895a3=await omnic[a65_0x5519('0xe')](_0x240711[a65_0x5519('0x3e')])[a65_0x5519('0x0')](()=>{});const _0x1bf954=await Role_1[a65_0x5519('0x32')][a65_0x5519('0x48')](a65_0x5519('0x49'),{'guild':_0x240711['guild']['id'],'level':{'$exists':!![],'$ne':null}});if(_0x1895a3){if(_0x1895a3===omnic[a65_0x5519('0x12')][a65_0x5519('0x2')]&&_0x1bf954[a65_0x5519('0x16')]>=constants['LIMITS']['GOLD'][a65_0x5519('0x3')]){throw new errors[(a65_0x5519('0x25'))](errors[a65_0x5519('0xf')]['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][a65_0x5519('0x1b')][a65_0x5519('0x33')](_0x240711['guild'][a65_0x5519('0xb')][a65_0x5519('0x4c')],a65_0x5519('0xd'),'membershipLimitRoleLevels',constants[a65_0x5519('0x46')][a65_0x5519('0x2')][a65_0x5519('0x3')]));}else if(_0x1895a3===omnic['PremiumTier'][a65_0x5519('0x22')]&&_0x1bf954['length']>=constants[a65_0x5519('0x46')][a65_0x5519('0x22')][a65_0x5519('0x3')]){throw new errors[(a65_0x5519('0x25'))](errors[a65_0x5519('0xf')][a65_0x5519('0x2d')],this[a65_0x5519('0x29')][a65_0x5519('0x1b')][a65_0x5519('0x33')](_0x240711[a65_0x5519('0x3e')][a65_0x5519('0xb')][a65_0x5519('0x4c')],'errors',a65_0x5519('0xa'),constants[a65_0x5519('0x46')][a65_0x5519('0x22')][a65_0x5519('0x3')]));}}else if(_0x1bf954[a65_0x5519('0x16')]>=constants[a65_0x5519('0x46')][a65_0x5519('0x3')]){throw new errors[(a65_0x5519('0x25'))](errors[a65_0x5519('0xf')][a65_0x5519('0x4f')],this[a65_0x5519('0x29')]['locale'][a65_0x5519('0x33')](_0x240711[a65_0x5519('0x3e')]['document'][a65_0x5519('0x4c')],a65_0x5519('0xd'),a65_0x5519('0x42'),constants[a65_0x5519('0x46')]['ROLE_LEVELS']));}const _0x493b96=await Role_1[a65_0x5519('0x32')]['countDocuments']({'guild':_0x240711[a65_0x5519('0x3e')]['id'],'level':_0x303a77[a65_0x5519('0x49')]});if(_0x1895a3){if(_0x1895a3===omnic[a65_0x5519('0x12')][a65_0x5519('0x2')]&&_0x493b96>=constants[a65_0x5519('0x46')][a65_0x5519('0x2')][a65_0x5519('0x23')]){throw new errors[(a65_0x5519('0x25'))](errors[a65_0x5519('0xf')][a65_0x5519('0x2d')],this[a65_0x5519('0x29')][a65_0x5519('0x1b')]['getString'](_0x240711[a65_0x5519('0x3e')][a65_0x5519('0xb')]['language'],a65_0x5519('0xd'),a65_0x5519('0x19'),constants[a65_0x5519('0x46')][a65_0x5519('0x2')][a65_0x5519('0x23')]));}else if(_0x1895a3===omnic[a65_0x5519('0x12')]['PLATINUM']&&_0x493b96>=constants[a65_0x5519('0x46')][a65_0x5519('0x22')][a65_0x5519('0x23')]){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a65_0x5519('0x2d')],this[a65_0x5519('0x29')][a65_0x5519('0x1b')]['getString'](_0x240711[a65_0x5519('0x3e')][a65_0x5519('0xb')]['language'],a65_0x5519('0xd'),'membershipLimitLevelRoles',constants[a65_0x5519('0x46')]['PLATINUM'][a65_0x5519('0x23')]));}}else if(_0x493b96>=constants['LIMITS'][a65_0x5519('0x23')]){throw new errors[(a65_0x5519('0x25'))](errors[a65_0x5519('0xf')][a65_0x5519('0x4f')],this[a65_0x5519('0x29')]['locale'][a65_0x5519('0x33')](_0x240711[a65_0x5519('0x3e')]['document'][a65_0x5519('0x4c')],a65_0x5519('0xd'),a65_0x5519('0x1f'),constants[a65_0x5519('0x46')][a65_0x5519('0x23')]));}}const _0x494016=this[a65_0x5519('0x29')][a65_0x5519('0x3c')][a65_0x5519('0x1e')](_0x240711[a65_0x5519('0x3e')],_0x303a77[a65_0x5519('0x8')][a65_0x5519('0x10')]('\x20'));if(!_0x494016)throw new errors[(a65_0x5519('0x25'))](errors['BASTION_ERROR_TYPE'][a65_0x5519('0x27')],this[a65_0x5519('0x29')][a65_0x5519('0x1b')][a65_0x5519('0x33')](_0x240711[a65_0x5519('0x3e')][a65_0x5519('0xb')]['language'],a65_0x5519('0x7'),a65_0x5519('0x5')));let _0x1bf370=await _0x494016['fetchDocument']();if(!_0x1bf370){_0x1bf370=await _0x494016[a65_0x5519('0x20')]();}_0x1bf370[a65_0x5519('0x49')]=_0x303a77[a65_0x5519('0x49')];await _0x1bf370[a65_0x5519('0x18')]();return await _0x240711[a65_0x5519('0x21')][a65_0x5519('0x28')]({'embed':{'color':tesseract_1[a65_0x5519('0x13')][a65_0x5519('0x2c')][a65_0x5519('0x14')],'description':this[a65_0x5519('0x29')]['locale'][a65_0x5519('0x33')](_0x240711['guild'][a65_0x5519('0xb')]['language'],a65_0x5519('0x4d'),a65_0x5519('0x3f'),_0x240711[a65_0x5519('0x1a')]['tag'],_0x494016[a65_0x5519('0x4')],_0x303a77[a65_0x5519('0x49')])}})[a65_0x5519('0x0')](()=>{});}if(_0x303a77[a65_0x5519('0x36')]){await Role_1[a65_0x5519('0x32')][a65_0x5519('0x39')]({'guild':_0x240711['guild']['id'],'level':_0x303a77[a65_0x5519('0x49')]},{'$unset':{'level':0x1}});return await _0x240711[a65_0x5519('0x21')][a65_0x5519('0x28')]({'embed':{'color':tesseract_1[a65_0x5519('0x13')][a65_0x5519('0x2c')][a65_0x5519('0x41')],'description':this[a65_0x5519('0x29')][a65_0x5519('0x1b')][a65_0x5519('0x33')](_0x240711['guild'][a65_0x5519('0xb')]['language'],'info','roleLevelClear',_0x240711[a65_0x5519('0x1a')][a65_0x5519('0x2b')],_0x303a77['level'])}})['catch'](()=>{});}const _0x3a6072=await Role_1['default'][a65_0x5519('0x4b')]({'guild':_0x240711[a65_0x5519('0x3e')]['id'],'level':_0x303a77[a65_0x5519('0x49')]});if(!_0x3a6072[a65_0x5519('0x16')])throw new Error(a65_0x5519('0x31'));const _0x4fa620=this[a65_0x5519('0x29')]['resolver']['resolveRoles'](_0x240711[a65_0x5519('0x3e')],_0x3a6072[a65_0x5519('0x37')](_0x329be7=>_0x329be7['_id']));return await _0x240711[a65_0x5519('0x21')]['send']({'embed':{'color':tesseract_1[a65_0x5519('0x13')][a65_0x5519('0x2c')][a65_0x5519('0x38')],'title':a65_0x5519('0x35')+_0x303a77[a65_0x5519('0x49')],'fields':[{'name':a65_0x5519('0x45'),'value':_0x4fa620['map'](_0x594d4a=>_0x594d4a[a65_0x5519('0x4')])['join']('\x0a')}]}})['catch'](()=>{});}const _0x2fc6d9=await Role_1['default'][a65_0x5519('0x4b')]({'guild':_0x240711[a65_0x5519('0x3e')]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x2fc6d9['length'])throw new Error(a65_0x5519('0x34'));const _0x4d23b3={};for(const _0x54502c of _0x2fc6d9){if(_0x54502c[a65_0x5519('0x49')]in _0x4d23b3){_0x4d23b3[_0x54502c[a65_0x5519('0x49')]][a65_0x5519('0x3d')](_0x54502c[a65_0x5519('0x11')]);}else{_0x4d23b3[_0x54502c[a65_0x5519('0x49')]]=[_0x54502c[a65_0x5519('0x11')]];}}return await _0x240711[a65_0x5519('0x21')][a65_0x5519('0x28')]({'embed':{'color':tesseract_1['Constants'][a65_0x5519('0x2c')][a65_0x5519('0x38')],'title':'Level-Up\x20Roles','fields':Object[a65_0x5519('0x4e')](_0x4d23b3)[a65_0x5519('0x37')](_0x3e1532=>({'name':a65_0x5519('0x35')+_0x3e1532,'value':_0x4d23b3[_0x3e1532][a65_0x5519('0x37')](_0x2a1551=>_0x240711[a65_0x5519('0x3e')][a65_0x5519('0x2a')]['cache'][a65_0x5519('0x2e')](_0x2a1551)?_0x240711['guild'][a65_0x5519('0x2a')][a65_0x5519('0x26')][a65_0x5519('0x1')](_0x2a1551)[a65_0x5519('0x4')]:_0x2a1551)['join'](',\x20')}))}})[a65_0x5519('0x0')](()=>{});};}};