const a32_0x17b4=['PREMIUM_MEMBERSHIP_REQUIRED','COLORS','errors','_id','Self\x20Roles','getString','RED','IRIS','client','findByIdAndUpdate','push','resolveRole','language','get','join','selfRolesAdd','Constants','LIMITED_PREMIUM_MEMBERSHIP','It\x20allows\x20you\x20to\x20set\x20up\x20Self\x20Roles\x20in\x20the\x20server.\x20Self\x20Roles\x20are\x20the\x20roles\x20which\x20server\x20members\x20can\x20assign\x20(and\x20unassign)\x20to\x20themselves.','locale','Command','MANAGE_ROLES','tag','exports','GOLD','@bastion/tesseract','add','info','length','ROLE_NOT_FOUND','remove','../../models/Role','GREEN','LIMITS','send','PremiumTier','author','default','membershipLimitSelfRoles','exec','../../utils/omnic','selfRolesList','return\x20/\x22\x20+\x20this\x20+\x20\x22/','guild','roleNotFound','catch','BASTION_ERROR_TYPE','constructor','countDocuments','premiumSelfRoles','has','channel','DiscordError','name','cache','PLATINUM','apply','SELF_ROLES','../../utils/errors','selfRolesRemove','roles','test','document'];(function(_0x41da5f,_0x17b42c){const _0xbb2479=function(_0x15fbf7){while(--_0x15fbf7){_0x41da5f['push'](_0x41da5f['shift']());}},_0x4ae86f=function(){const _0x5ca857={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x436273,_0x4a374a,_0x55a9f1,_0x399da9){_0x399da9=_0x399da9||{};let _0x476661=_0x4a374a+'='+_0x55a9f1,_0x39696f=0x0;for(let _0x2aed1f=0x0,_0x5a1c4d=_0x436273['length'];_0x2aed1f<_0x5a1c4d;_0x2aed1f++){const _0x4d93ee=_0x436273[_0x2aed1f];_0x476661+=';\x20'+_0x4d93ee;const _0x40b9c6=_0x436273[_0x4d93ee];_0x436273['push'](_0x40b9c6),_0x5a1c4d=_0x436273['length'],_0x40b9c6!==!![]&&(_0x476661+='='+_0x40b9c6);}_0x399da9['cookie']=_0x476661;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1d9487,_0x1dcbb7){_0x1d9487=_0x1d9487||function(_0x366f08){return _0x366f08;};const _0x523714=_0x1d9487(new RegExp('(?:^|;\x20)'+_0x1dcbb7['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x37b0c6=function(_0x3e5dcf,_0x1c965b){_0x3e5dcf(++_0x1c965b);};return _0x37b0c6(_0xbb2479,_0x17b42c),_0x523714?decodeURIComponent(_0x523714[0x1]):undefined;}},_0x508ab3=function(){const _0x4de44e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4de44e['test'](_0x5ca857['removeCookie']['toString']());};_0x5ca857['updateCookie']=_0x508ab3;let _0x802271='';const _0x47831d=_0x5ca857['updateCookie']();if(!_0x47831d)_0x5ca857['setCookie'](['*'],'counter',0x1);else _0x47831d?_0x802271=_0x5ca857['getCookie'](null,'counter'):_0x5ca857['removeCookie']();};_0x4ae86f();}(a32_0x17b4,0x178));const a32_0xbb24=function(_0x41da5f,_0x17b42c){_0x41da5f=_0x41da5f-0x0;let _0xbb2479=a32_0x17b4[_0x41da5f];return _0xbb2479;};const a32_0x55a9f1=function(){let _0x10eab6=!![];return function(_0x5c3042,_0x204333){const _0x52c3d0=_0x10eab6?function(){if(_0x204333){const _0x4ec0af=_0x204333[a32_0xbb24('0x3a')](_0x5c3042,arguments);return _0x204333=null,_0x4ec0af;}}:function(){};return _0x10eab6=![],_0x52c3d0;};}(),a32_0x4a374a=a32_0x55a9f1(this,function(){const _0x3b2454=function(){const _0x3c0a8d=_0x3b2454[a32_0xbb24('0x31')](a32_0xbb24('0x2c'))()['constructor']('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x3c0a8d[a32_0xbb24('0x0')](a32_0x4a374a);};return _0x3b2454();});a32_0x4a374a();'use strict';const tesseract_1=require(a32_0xbb24('0x1b')),Role_1=require(a32_0xbb24('0x21')),constants=require('../../utils/constants'),errors=require(a32_0xbb24('0x3c')),omnic=require(a32_0xbb24('0x2a'));module[a32_0xbb24('0x19')]=class SelfRoles extends tesseract_1[a32_0xbb24('0x16')]{constructor(){super('selfRoles',{'description':a32_0xbb24('0x14'),'triggers':[],'arguments':{'alias':{'add':['a'],'remove':['r']},'array':['add',a32_0xbb24('0x20')],'string':[a32_0xbb24('0x1c'),a32_0xbb24('0x20')]},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a32_0xbb24('0x17')],'userPermissions':[a32_0xbb24('0x17')],'syntax':['selfRoles','selfRoles\x20--add\x20ROLE','selfRoles\x20--remove\x20ROLE']}),this[a32_0xbb24('0x29')]=async(_0x2d1eab,_0x5181de)=>{if(_0x5181de[a32_0xbb24('0x1c')]){if(constants['isPublicBastion'](this[a32_0xbb24('0xa')]['user'])){const _0x501190=await Role_1[a32_0xbb24('0x27')][a32_0xbb24('0x32')]({'guild':_0x2d1eab['guild']['id'],'selfAssignable':!![]});if(_0x501190>=constants['LIMITS'][a32_0xbb24('0x3b')]){const _0x5d3c9f=await omnic['fetchPremiumTier'](_0x2d1eab['guild'])[a32_0xbb24('0x2f')](()=>{});if(_0x5d3c9f){if(_0x5d3c9f===omnic['PremiumTier'][a32_0xbb24('0x1a')]&&_0x501190>=constants[a32_0xbb24('0x23')][a32_0xbb24('0x1a')][a32_0xbb24('0x3b')])throw new errors[(a32_0xbb24('0x36'))](errors[a32_0xbb24('0x30')][a32_0xbb24('0x13')],this[a32_0xbb24('0xa')]['locale'][a32_0xbb24('0x7')](_0x2d1eab[a32_0xbb24('0x2d')][a32_0xbb24('0x1')][a32_0xbb24('0xe')],'errors',a32_0xbb24('0x28'),constants['LIMITS']['GOLD'][a32_0xbb24('0x3b')]));else{if(_0x5d3c9f===omnic[a32_0xbb24('0x25')][a32_0xbb24('0x39')]&&_0x501190>=constants[a32_0xbb24('0x23')][a32_0xbb24('0x39')][a32_0xbb24('0x3b')])throw new errors['DiscordError'](errors[a32_0xbb24('0x30')]['LIMITED_PREMIUM_MEMBERSHIP'],this['client']['locale'][a32_0xbb24('0x7')](_0x2d1eab[a32_0xbb24('0x2d')][a32_0xbb24('0x1')]['language'],'errors','membershipLimitSelfRoles',constants['LIMITS'][a32_0xbb24('0x39')]['SELF_ROLES']));}}else throw new errors[(a32_0xbb24('0x36'))](errors[a32_0xbb24('0x30')][a32_0xbb24('0x2')],this[a32_0xbb24('0xa')][a32_0xbb24('0x15')]['getString'](_0x2d1eab[a32_0xbb24('0x2d')][a32_0xbb24('0x1')][a32_0xbb24('0xe')],a32_0xbb24('0x4'),a32_0xbb24('0x33'),constants['LIMITS'][a32_0xbb24('0x3b')]));}}const _0x5c904c=this[a32_0xbb24('0xa')]['resolver'][a32_0xbb24('0xd')](_0x2d1eab['guild'],_0x5181de[a32_0xbb24('0x1c')][a32_0xbb24('0x10')]('\x20'));if(!_0x5c904c)throw new errors[(a32_0xbb24('0x36'))](errors[a32_0xbb24('0x30')][a32_0xbb24('0x1f')],this[a32_0xbb24('0xa')][a32_0xbb24('0x15')]['getString'](_0x2d1eab['guild']['document'][a32_0xbb24('0xe')],a32_0xbb24('0x4'),'roleNotFound'));await Role_1[a32_0xbb24('0x27')][a32_0xbb24('0xb')](_0x5c904c['id'],{'_id':_0x5c904c['id'],'guild':_0x2d1eab[a32_0xbb24('0x2d')]['id'],'selfAssignable':!![]},{'upsert':!![]}),await _0x2d1eab[a32_0xbb24('0x35')][a32_0xbb24('0x24')]({'embed':{'color':tesseract_1[a32_0xbb24('0x12')][a32_0xbb24('0x3')][a32_0xbb24('0x22')],'description':this[a32_0xbb24('0xa')][a32_0xbb24('0x15')]['getString'](_0x2d1eab['guild'][a32_0xbb24('0x1')][a32_0xbb24('0xe')],a32_0xbb24('0x1d'),a32_0xbb24('0x11'),_0x2d1eab['author'][a32_0xbb24('0x18')],_0x5c904c['name']),'footer':{'text':_0x5c904c['id']}}})[a32_0xbb24('0x2f')](()=>{});}else{if(_0x5181de[a32_0xbb24('0x20')]){const _0x153add=this[a32_0xbb24('0xa')]['resolver'][a32_0xbb24('0xd')](_0x2d1eab[a32_0xbb24('0x2d')],_0x5181de[a32_0xbb24('0x20')]['join']('\x20'));if(!_0x153add)throw new errors[(a32_0xbb24('0x36'))](errors['BASTION_ERROR_TYPE'][a32_0xbb24('0x1f')],this['client'][a32_0xbb24('0x15')][a32_0xbb24('0x7')](_0x2d1eab['guild'][a32_0xbb24('0x1')][a32_0xbb24('0xe')],a32_0xbb24('0x4'),a32_0xbb24('0x2e')));await Role_1['default'][a32_0xbb24('0xb')](_0x153add['id'],{'$unset':{'selfAssignable':0x1}}),await _0x2d1eab[a32_0xbb24('0x35')][a32_0xbb24('0x24')]({'embed':{'color':tesseract_1[a32_0xbb24('0x12')][a32_0xbb24('0x3')][a32_0xbb24('0x8')],'description':this[a32_0xbb24('0xa')][a32_0xbb24('0x15')][a32_0xbb24('0x7')](_0x2d1eab[a32_0xbb24('0x2d')]['document'][a32_0xbb24('0xe')],'info',a32_0xbb24('0x3d'),_0x2d1eab[a32_0xbb24('0x26')]['tag'],_0x153add[a32_0xbb24('0x37')]),'footer':{'text':_0x153add['id']}}})[a32_0xbb24('0x2f')](()=>{});}else{const _0x5a4995=await Role_1[a32_0xbb24('0x27')]['find']({'guild':_0x2d1eab[a32_0xbb24('0x2d')]['id'],'selfAssignable':!![]});if(!_0x5a4995[a32_0xbb24('0x1e')])throw new Error(this['client'][a32_0xbb24('0x15')][a32_0xbb24('0x7')](_0x2d1eab[a32_0xbb24('0x2d')][a32_0xbb24('0x1')]['language'],a32_0xbb24('0x4'),'noSelfRoles'));const _0x32bf5a=[];for(const _0x177bfa of _0x5a4995){!_0x2d1eab[a32_0xbb24('0x2d')][a32_0xbb24('0x3e')][a32_0xbb24('0x38')][a32_0xbb24('0x34')](_0x177bfa[a32_0xbb24('0x5')])&&await _0x177bfa['remove']()[a32_0xbb24('0x2f')](()=>{}),_0x32bf5a[a32_0xbb24('0xc')]({'name':_0x2d1eab[a32_0xbb24('0x2d')]['roles']['cache'][a32_0xbb24('0xf')](_0x177bfa['_id'])[a32_0xbb24('0x37')]||'-','value':_0x177bfa[a32_0xbb24('0x5')]});}await _0x2d1eab[a32_0xbb24('0x35')][a32_0xbb24('0x24')]({'embed':{'color':tesseract_1[a32_0xbb24('0x12')][a32_0xbb24('0x3')][a32_0xbb24('0x9')],'title':a32_0xbb24('0x6'),'description':this[a32_0xbb24('0xa')]['locale'][a32_0xbb24('0x7')](_0x2d1eab[a32_0xbb24('0x2d')]['document']['language'],a32_0xbb24('0x1d'),a32_0xbb24('0x2b')),'fields':_0x32bf5a}})[a32_0xbb24('0x2f')](()=>{});}}};}};