const a32_0x51ae=['ROLE_NOT_FOUND','Command','default','language','test','selfRolesList','Constants','resolver','isPublicBastion','selfRolesRemove','errors','MANAGE_ROLES','selfRoles','PLATINUM','../../utils/omnic','document','noSelfRoles','_id','GREEN','DiscordError','author','SELF_ROLES','compile','name','RED','exec','PremiumTier','apply','client','getString','LIMITED_PREMIUM_MEMBERSHIP','BASTION_ERROR_TYPE','find','info','push','membershipLimitSelfRoles','has','countDocuments','resolveRole','locale','GOLD','roleNotFound','LIMITS','selfRoles\x20--remove\x20ROLE','remove','channel','join','catch','selfRoles\x20--add\x20ROLE','get','cache','send','tag','guild','selfRolesAdd','user','add','../../utils/errors','premiumSelfRoles','roles','COLORS','fetchPremiumTier','findByIdAndUpdate'];(function(_0x3f56dc,_0x51aee3){const _0xf5f93=function(_0x30da3e){while(--_0x30da3e){_0x3f56dc['push'](_0x3f56dc['shift']());}};const _0x33c951=function(){const _0x382555={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x502f97,_0xf0d9b5,_0x59fbf8,_0x152453){_0x152453=_0x152453||{};let _0x48eb90=_0xf0d9b5+'='+_0x59fbf8;let _0x496ac0=0x0;for(let _0x580160=0x0,_0x135922=_0x502f97['length'];_0x580160<_0x135922;_0x580160++){const _0x376350=_0x502f97[_0x580160];_0x48eb90+=';\x20'+_0x376350;const _0x4d56fb=_0x502f97[_0x376350];_0x502f97['push'](_0x4d56fb);_0x135922=_0x502f97['length'];if(_0x4d56fb!==!![]){_0x48eb90+='='+_0x4d56fb;}}_0x152453['cookie']=_0x48eb90;},'removeCookie':function(){return'dev';},'getCookie':function(_0x474573,_0x141cb9){_0x474573=_0x474573||function(_0x1a7e27){return _0x1a7e27;};const _0x47dd1b=_0x474573(new RegExp('(?:^|;\x20)'+_0x141cb9['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x429176=function(_0x448809,_0x21bc78){_0x448809(++_0x21bc78);};_0x429176(_0xf5f93,_0x51aee3);return _0x47dd1b?decodeURIComponent(_0x47dd1b[0x1]):undefined;}};const _0xe59e47=function(){const _0x26043d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x26043d['test'](_0x382555['removeCookie']['toString']());};_0x382555['updateCookie']=_0xe59e47;let _0x282029='';const _0x5a8b33=_0x382555['updateCookie']();if(!_0x5a8b33){_0x382555['setCookie'](['*'],'counter',0x1);}else if(_0x5a8b33){_0x282029=_0x382555['getCookie'](null,'counter');}else{_0x382555['removeCookie']();}};_0x33c951();}(a32_0x51ae,0x16e));const a32_0xf5f9=function(_0x3f56dc,_0x51aee3){_0x3f56dc=_0x3f56dc-0x0;let _0xf5f93=a32_0x51ae[_0x3f56dc];return _0xf5f93;};const a32_0x382555=function(){let _0x3fb1fc=!![];return function(_0x240e06,_0x84c1ab){const _0xde9c87=_0x3fb1fc?function(){if(_0x84c1ab){const _0x309b84=_0x84c1ab[a32_0xf5f9('0x27')](_0x240e06,arguments);_0x84c1ab=null;return _0x309b84;}}:function(){};_0x3fb1fc=![];return _0xde9c87;};}();const a32_0x30da3e=a32_0x382555(this,function(){const _0x27a58b=function(){const _0x46e08b=_0x27a58b['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a32_0xf5f9('0x22')]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x46e08b[a32_0xf5f9('0x10')](a32_0x30da3e);};return _0x27a58b();});a32_0x30da3e();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require('../../models/Role');const constants=require('../../utils/constants');const errors=require(a32_0xf5f9('0x6'));const omnic=require(a32_0xf5f9('0x1a'));module['exports']=class SelfRoles extends tesseract_1[a32_0xf5f9('0xd')]{constructor(){super(a32_0xf5f9('0x18'),{'description':'It\x20allows\x20you\x20to\x20set\x20up\x20Self\x20Roles\x20in\x20the\x20server.\x20Self\x20Roles\x20are\x20the\x20roles\x20which\x20server\x20members\x20can\x20assign\x20(and\x20unassign)\x20to\x20themselves.','triggers':[],'arguments':{'alias':{'add':['a'],'remove':['r']},'array':[a32_0xf5f9('0x5'),a32_0xf5f9('0x38')],'string':[a32_0xf5f9('0x5'),a32_0xf5f9('0x38')]},'scope':a32_0xf5f9('0x2'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a32_0xf5f9('0x17')],'userPermissions':[a32_0xf5f9('0x17')],'syntax':[a32_0xf5f9('0x18'),a32_0xf5f9('0x3c'),a32_0xf5f9('0x37')]});this[a32_0xf5f9('0x25')]=async(_0x29effd,_0x5091f1)=>{if(_0x5091f1['add']){if(constants[a32_0xf5f9('0x14')](this[a32_0xf5f9('0x28')][a32_0xf5f9('0x4')])){const _0x1c70ae=await Role_1['default'][a32_0xf5f9('0x31')]({'guild':_0x29effd['guild']['id'],'selfAssignable':!![]});if(_0x1c70ae>=constants[a32_0xf5f9('0x36')][a32_0xf5f9('0x21')]){const _0x255935=await omnic[a32_0xf5f9('0xa')](_0x29effd[a32_0xf5f9('0x2')])[a32_0xf5f9('0x3b')](()=>{});if(_0x255935){if(_0x255935===omnic['PremiumTier'][a32_0xf5f9('0x34')]&&_0x1c70ae>=constants[a32_0xf5f9('0x36')][a32_0xf5f9('0x34')]['SELF_ROLES']){throw new errors[(a32_0xf5f9('0x1f'))](errors[a32_0xf5f9('0x2b')][a32_0xf5f9('0x2a')],this[a32_0xf5f9('0x28')][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')][a32_0xf5f9('0x1b')][a32_0xf5f9('0xf')],'errors',a32_0xf5f9('0x2f'),constants['LIMITS'][a32_0xf5f9('0x34')][a32_0xf5f9('0x21')]));}else if(_0x255935===omnic[a32_0xf5f9('0x26')][a32_0xf5f9('0x19')]&&_0x1c70ae>=constants[a32_0xf5f9('0x36')][a32_0xf5f9('0x19')][a32_0xf5f9('0x21')]){throw new errors[(a32_0xf5f9('0x1f'))](errors[a32_0xf5f9('0x2b')][a32_0xf5f9('0x2a')],this[a32_0xf5f9('0x28')][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd['guild'][a32_0xf5f9('0x1b')][a32_0xf5f9('0xf')],a32_0xf5f9('0x16'),a32_0xf5f9('0x2f'),constants[a32_0xf5f9('0x36')][a32_0xf5f9('0x19')][a32_0xf5f9('0x21')]));}}else{throw new errors[(a32_0xf5f9('0x1f'))](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[a32_0xf5f9('0x28')][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')]['document']['language'],a32_0xf5f9('0x16'),a32_0xf5f9('0x7'),constants['LIMITS'][a32_0xf5f9('0x21')]));}}}const _0x473a41=this[a32_0xf5f9('0x28')][a32_0xf5f9('0x13')][a32_0xf5f9('0x32')](_0x29effd['guild'],_0x5091f1[a32_0xf5f9('0x5')][a32_0xf5f9('0x3a')]('\x20'));if(!_0x473a41)throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a32_0xf5f9('0xc')],this['client'][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')]['document'][a32_0xf5f9('0xf')],'errors','roleNotFound'));await Role_1[a32_0xf5f9('0xe')][a32_0xf5f9('0xb')](_0x473a41['id'],{'_id':_0x473a41['id'],'guild':_0x29effd[a32_0xf5f9('0x2')]['id'],'selfAssignable':!![]},{'upsert':!![]});await _0x29effd[a32_0xf5f9('0x39')][a32_0xf5f9('0x0')]({'embed':{'color':tesseract_1[a32_0xf5f9('0x12')][a32_0xf5f9('0x9')][a32_0xf5f9('0x1e')],'description':this[a32_0xf5f9('0x28')][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')][a32_0xf5f9('0x1b')][a32_0xf5f9('0xf')],'info',a32_0xf5f9('0x3'),_0x29effd[a32_0xf5f9('0x20')]['tag'],_0x473a41[a32_0xf5f9('0x23')]),'footer':{'text':_0x473a41['id']}}})['catch'](()=>{});}else if(_0x5091f1['remove']){const _0x2e8e05=this[a32_0xf5f9('0x28')]['resolver'][a32_0xf5f9('0x32')](_0x29effd[a32_0xf5f9('0x2')],_0x5091f1[a32_0xf5f9('0x38')]['join']('\x20'));if(!_0x2e8e05)throw new errors[(a32_0xf5f9('0x1f'))](errors[a32_0xf5f9('0x2b')][a32_0xf5f9('0xc')],this[a32_0xf5f9('0x28')][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')]['document'][a32_0xf5f9('0xf')],a32_0xf5f9('0x16'),a32_0xf5f9('0x35')));await Role_1['default']['findByIdAndUpdate'](_0x2e8e05['id'],{'$unset':{'selfAssignable':0x1}});await _0x29effd[a32_0xf5f9('0x39')][a32_0xf5f9('0x0')]({'embed':{'color':tesseract_1[a32_0xf5f9('0x12')][a32_0xf5f9('0x9')][a32_0xf5f9('0x24')],'description':this['client'][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd[a32_0xf5f9('0x2')][a32_0xf5f9('0x1b')][a32_0xf5f9('0xf')],a32_0xf5f9('0x2d'),a32_0xf5f9('0x15'),_0x29effd[a32_0xf5f9('0x20')][a32_0xf5f9('0x1')],_0x2e8e05[a32_0xf5f9('0x23')]),'footer':{'text':_0x2e8e05['id']}}})[a32_0xf5f9('0x3b')](()=>{});}else{const _0x6d245=await Role_1[a32_0xf5f9('0xe')][a32_0xf5f9('0x2c')]({'guild':_0x29effd[a32_0xf5f9('0x2')]['id'],'selfAssignable':!![]});if(!_0x6d245['length']){throw new Error(this['client'][a32_0xf5f9('0x33')]['getString'](_0x29effd[a32_0xf5f9('0x2')]['document'][a32_0xf5f9('0xf')],'errors',a32_0xf5f9('0x1c')));}const _0x3af83e=[];for(const _0xeb6b41 of _0x6d245){if(!_0x29effd[a32_0xf5f9('0x2')][a32_0xf5f9('0x8')]['cache'][a32_0xf5f9('0x30')](_0xeb6b41['_id'])){await _0xeb6b41['remove']()['catch'](()=>{});}_0x3af83e[a32_0xf5f9('0x2e')]({'name':_0x29effd['guild'][a32_0xf5f9('0x8')][a32_0xf5f9('0x3e')][a32_0xf5f9('0x3d')](_0xeb6b41['_id'])['name']||'-','value':_0xeb6b41[a32_0xf5f9('0x1d')]});}await _0x29effd[a32_0xf5f9('0x39')][a32_0xf5f9('0x0')]({'embed':{'color':tesseract_1['Constants']['COLORS']['IRIS'],'title':'Self\x20Roles','description':this['client'][a32_0xf5f9('0x33')][a32_0xf5f9('0x29')](_0x29effd['guild']['document'][a32_0xf5f9('0xf')],a32_0xf5f9('0x2d'),a32_0xf5f9('0x11')),'fields':_0x3af83e}})['catch'](()=>{});}};}};