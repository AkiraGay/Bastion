const a32_0x2f23=['getString','has','send','../../utils/omnic','GREEN','catch','ROLE_NOT_FOUND','guild','selfRolesAdd','constructor','resolveRole','author','exec','Constants','client','_id','LIMITED_PREMIUM_MEMBERSHIP','language','resolver','compile','It\x20allows\x20you\x20to\x20set\x20up\x20Self\x20Roles\x20in\x20the\x20server.\x20Self\x20Roles\x20are\x20the\x20roles\x20which\x20server\x20members\x20can\x20assign\x20(and\x20unassign)\x20to\x20themselves.','roles','locale','RED','remove','document','GOLD','../../utils/constants','BASTION_ERROR_TYPE','../../models/Role','info','exports','IRIS','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','tag','errors','SELF_ROLES','DiscordError','Self\x20Roles','selfRolesList','selfRoles\x20--add\x20ROLE','fetchPremiumTier','length','selfRoles','findByIdAndUpdate','selfRolesRemove','selfRoles\x20--remove\x20ROLE','LIMITS','name','membershipLimitSelfRoles','find','add','cache','PremiumTier','join','channel','noSelfRoles','PLATINUM','COLORS','MANAGE_ROLES','countDocuments','apply'];(function(_0x11088f,_0x2f239d){const _0x2c0561=function(_0x329fcf){while(--_0x329fcf){_0x11088f['push'](_0x11088f['shift']());}};const _0x4ef164=function(){const _0x3fbd4e={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5c0f94,_0x3e60f7,_0x43f97d,_0x4f1522){_0x4f1522=_0x4f1522||{};let _0x4951b7=_0x3e60f7+'='+_0x43f97d;let _0x3f36c7=0x0;for(let _0x3b75a8=0x0,_0x5ad8da=_0x5c0f94['length'];_0x3b75a8<_0x5ad8da;_0x3b75a8++){const _0x19123d=_0x5c0f94[_0x3b75a8];_0x4951b7+=';\x20'+_0x19123d;const _0x7cf176=_0x5c0f94[_0x19123d];_0x5c0f94['push'](_0x7cf176);_0x5ad8da=_0x5c0f94['length'];if(_0x7cf176!==!![]){_0x4951b7+='='+_0x7cf176;}}_0x4f1522['cookie']=_0x4951b7;},'removeCookie':function(){return'dev';},'getCookie':function(_0x573dc4,_0x2f7fb1){_0x573dc4=_0x573dc4||function(_0x5da9d8){return _0x5da9d8;};const _0x1fc50a=_0x573dc4(new RegExp('(?:^|;\x20)'+_0x2f7fb1['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x3e95d2=function(_0x45a77b,_0x1fb36e){_0x45a77b(++_0x1fb36e);};_0x3e95d2(_0x2c0561,_0x2f239d);return _0x1fc50a?decodeURIComponent(_0x1fc50a[0x1]):undefined;}};const _0x23c826=function(){const _0x399669=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x399669['test'](_0x3fbd4e['removeCookie']['toString']());};_0x3fbd4e['updateCookie']=_0x23c826;let _0x2f3c28='';const _0x3c97a5=_0x3fbd4e['updateCookie']();if(!_0x3c97a5){_0x3fbd4e['setCookie'](['*'],'counter',0x1);}else if(_0x3c97a5){_0x2f3c28=_0x3fbd4e['getCookie'](null,'counter');}else{_0x3fbd4e['removeCookie']();}};_0x4ef164();}(a32_0x2f23,0xab));const a32_0x2c05=function(_0x11088f,_0x2f239d){_0x11088f=_0x11088f-0x0;let _0x2c0561=a32_0x2f23[_0x11088f];return _0x2c0561;};const a32_0x3fbd4e=function(){let _0x3cfa40=!![];return function(_0x8ccabc,_0x38cf10){const _0x5a3b82=_0x3cfa40?function(){if(_0x38cf10){const _0x32ad1c=_0x38cf10[a32_0x2c05('0xe')](_0x8ccabc,arguments);_0x38cf10=null;return _0x32ad1c;}}:function(){};_0x3cfa40=![];return _0x5a3b82;};}();const a32_0x329fcf=a32_0x3fbd4e(this,function(){const _0x226f4c=function(){const _0x1615aa=_0x226f4c[a32_0x2c05('0x18')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a32_0x2c05('0x22')](a32_0x2c05('0x30'));return!_0x1615aa['test'](a32_0x329fcf);};return _0x226f4c();});a32_0x329fcf();'use strict';const tesseract_1=require('@bastion/tesseract');const Role_1=require(a32_0x2c05('0x2c'));const constants=require(a32_0x2c05('0x2a'));const errors=require('../../utils/errors');const omnic=require(a32_0x2c05('0x12'));module[a32_0x2c05('0x2e')]=class SelfRoles extends tesseract_1['Command']{constructor(){super(a32_0x2c05('0x3a'),{'description':a32_0x2c05('0x23'),'triggers':[],'arguments':{'alias':{'add':['a'],'remove':['r']},'array':[a32_0x2c05('0x4'),'remove'],'string':[a32_0x2c05('0x4'),a32_0x2c05('0x27')]},'scope':a32_0x2c05('0x16'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[a32_0x2c05('0xc')],'userPermissions':['MANAGE_ROLES'],'syntax':[a32_0x2c05('0x3a'),a32_0x2c05('0x37'),a32_0x2c05('0x3d')]});this[a32_0x2c05('0x1b')]=async(_0x5a0534,_0x41bfa3)=>{if(_0x41bfa3['add']){if(constants['isPublicBastion'](this[a32_0x2c05('0x1d')]['user'])){const _0x5cdb9a=await Role_1['default'][a32_0x2c05('0xd')]({'guild':_0x5a0534[a32_0x2c05('0x16')]['id'],'selfAssignable':!![]});if(_0x5cdb9a>=constants[a32_0x2c05('0x0')]['SELF_ROLES']){const _0x1933e1=await omnic[a32_0x2c05('0x38')](_0x5a0534['guild'])[a32_0x2c05('0x14')](()=>{});if(_0x1933e1){if(_0x1933e1===omnic[a32_0x2c05('0x6')]['GOLD']&&_0x5cdb9a>=constants[a32_0x2c05('0x0')][a32_0x2c05('0x29')][a32_0x2c05('0x33')]){throw new errors[(a32_0x2c05('0x34'))](errors[a32_0x2c05('0x2b')]['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x28')]['language'],a32_0x2c05('0x32'),a32_0x2c05('0x2'),constants[a32_0x2c05('0x0')][a32_0x2c05('0x29')][a32_0x2c05('0x33')]));}else if(_0x1933e1===omnic[a32_0x2c05('0x6')][a32_0x2c05('0xa')]&&_0x5cdb9a>=constants[a32_0x2c05('0x0')][a32_0x2c05('0xa')][a32_0x2c05('0x33')]){throw new errors[(a32_0x2c05('0x34'))](errors['BASTION_ERROR_TYPE'][a32_0x2c05('0x1f')],this['client']['locale'][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')]['document'][a32_0x2c05('0x20')],'errors','membershipLimitSelfRoles',constants[a32_0x2c05('0x0')][a32_0x2c05('0xa')][a32_0x2c05('0x33')]));}}else{throw new errors[(a32_0x2c05('0x34'))](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[a32_0x2c05('0x1d')][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x28')][a32_0x2c05('0x20')],a32_0x2c05('0x32'),'premiumSelfRoles',constants['LIMITS']['SELF_ROLES']));}}}const _0x5a5035=this[a32_0x2c05('0x1d')][a32_0x2c05('0x21')][a32_0x2c05('0x19')](_0x5a0534[a32_0x2c05('0x16')],_0x41bfa3[a32_0x2c05('0x4')][a32_0x2c05('0x7')]('\x20'));if(!_0x5a5035)throw new errors[(a32_0x2c05('0x34'))](errors[a32_0x2c05('0x2b')][a32_0x2c05('0x15')],this[a32_0x2c05('0x1d')][a32_0x2c05('0x25')]['getString'](_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x28')]['language'],a32_0x2c05('0x32'),'roleNotFound'));await Role_1['default'][a32_0x2c05('0x3b')](_0x5a5035['id'],{'_id':_0x5a5035['id'],'guild':_0x5a0534['guild']['id'],'selfAssignable':!![]},{'upsert':!![]});await _0x5a0534['channel'][a32_0x2c05('0x11')]({'embed':{'color':tesseract_1[a32_0x2c05('0x1c')]['COLORS'][a32_0x2c05('0x13')],'description':this['client'][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')]['document']['language'],'info',a32_0x2c05('0x17'),_0x5a0534['author'][a32_0x2c05('0x31')],_0x5a5035['name']),'footer':{'text':_0x5a5035['id']}}})[a32_0x2c05('0x14')](()=>{});}else if(_0x41bfa3[a32_0x2c05('0x27')]){const _0x315c7b=this['client'][a32_0x2c05('0x21')]['resolveRole'](_0x5a0534[a32_0x2c05('0x16')],_0x41bfa3[a32_0x2c05('0x27')]['join']('\x20'));if(!_0x315c7b)throw new errors[(a32_0x2c05('0x34'))](errors[a32_0x2c05('0x2b')]['ROLE_NOT_FOUND'],this[a32_0x2c05('0x1d')][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534['guild']['document'][a32_0x2c05('0x20')],a32_0x2c05('0x32'),'roleNotFound'));await Role_1['default']['findByIdAndUpdate'](_0x315c7b['id'],{'$unset':{'selfAssignable':0x1}});await _0x5a0534[a32_0x2c05('0x8')][a32_0x2c05('0x11')]({'embed':{'color':tesseract_1[a32_0x2c05('0x1c')][a32_0x2c05('0xb')][a32_0x2c05('0x26')],'description':this['client'][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')]['document'][a32_0x2c05('0x20')],'info',a32_0x2c05('0x3c'),_0x5a0534[a32_0x2c05('0x1a')][a32_0x2c05('0x31')],_0x315c7b['name']),'footer':{'text':_0x315c7b['id']}}})['catch'](()=>{});}else{const _0x191f58=await Role_1['default'][a32_0x2c05('0x3')]({'guild':_0x5a0534[a32_0x2c05('0x16')]['id'],'selfAssignable':!![]});if(!_0x191f58[a32_0x2c05('0x39')]){throw new Error(this[a32_0x2c05('0x1d')][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x28')][a32_0x2c05('0x20')],a32_0x2c05('0x32'),a32_0x2c05('0x9')));}const _0x2f0393=[];for(const _0x36a609 of _0x191f58){if(!_0x5a0534[a32_0x2c05('0x16')]['roles'][a32_0x2c05('0x5')][a32_0x2c05('0x10')](_0x36a609['_id'])){await _0x36a609[a32_0x2c05('0x27')]()[a32_0x2c05('0x14')](()=>{});}_0x2f0393['push']({'name':_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x24')][a32_0x2c05('0x5')]['get'](_0x36a609[a32_0x2c05('0x1e')])[a32_0x2c05('0x1')]||'-','value':_0x36a609[a32_0x2c05('0x1e')]});}await _0x5a0534[a32_0x2c05('0x8')]['send']({'embed':{'color':tesseract_1['Constants']['COLORS'][a32_0x2c05('0x2f')],'title':a32_0x2c05('0x35'),'description':this[a32_0x2c05('0x1d')][a32_0x2c05('0x25')][a32_0x2c05('0xf')](_0x5a0534[a32_0x2c05('0x16')][a32_0x2c05('0x28')][a32_0x2c05('0x20')],a32_0x2c05('0x2d'),a32_0x2c05('0x36')),'fields':_0x2f0393}})[a32_0x2c05('0x14')](()=>{});}};}};