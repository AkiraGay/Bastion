const a34_0x309a=['noSelfRoles','remove','join','push','info','resolver','document','user','COLORS','exports','IRIS','guild','@bastion/tesseract','catch','findByIdAndUpdate','SELF_ROLES','../../utils/omnic','../../models/Role','LIMITED_PREMIUM_MEMBERSHIP','../../utils/errors','selfRolesList','name','language','fetchPremiumTier','PLATINUM','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','send','cache','add','premiumSelfRoles','isPublicBastion','constructor','DiscordError','resolveRole','tag','RED','selfRoles','PREMIUM_MEMBERSHIP_REQUIRED','channel','MANAGE_ROLES','Constants','errors','LIMITS','getString','locale','client','PremiumTier','GOLD','GREEN','find','get','roleNotFound','membershipLimitSelfRoles','ROLE_NOT_FOUND','_id','selfRolesAdd','selfRolesRemove','length','It\x20allows\x20you\x20to\x20set\x20up\x20Self\x20Roles\x20in\x20the\x20server.\x20Self\x20Roles\x20are\x20the\x20roles\x20which\x20server\x20members\x20can\x20assign\x20(and\x20unassign)\x20to\x20themselves.','BASTION_ERROR_TYPE','apply','roles','return\x20/\x22\x20+\x20this\x20+\x20\x22/','has','Command','author','Self\x20Roles','default'];(function(_0x2ec6c5,_0x27709f){const _0x309a07=function(_0x530aac){while(--_0x530aac){_0x2ec6c5['push'](_0x2ec6c5['shift']());}},_0x12c5f2=function(){const _0x3f33c2={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x20342f,_0x288dfb,_0x51ba51,_0x233b02){_0x233b02=_0x233b02||{};let _0x2a82b3=_0x288dfb+'='+_0x51ba51,_0x58af3d=0x0;for(let _0x20fda2=0x0,_0x23e30b=_0x20342f['length'];_0x20fda2<_0x23e30b;_0x20fda2++){const _0x1112a4=_0x20342f[_0x20fda2];_0x2a82b3+=';\x20'+_0x1112a4;const _0xb0f2d8=_0x20342f[_0x1112a4];_0x20342f['push'](_0xb0f2d8),_0x23e30b=_0x20342f['length'],_0xb0f2d8!==!![]&&(_0x2a82b3+='='+_0xb0f2d8);}_0x233b02['cookie']=_0x2a82b3;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4186cc,_0x12308c){_0x4186cc=_0x4186cc||function(_0x2b1de7){return _0x2b1de7;};const _0x19332f=_0x4186cc(new RegExp('(?:^|;\x20)'+_0x12308c['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x1ef3d1=function(_0x204ec0,_0x598bb6){_0x204ec0(++_0x598bb6);};return _0x1ef3d1(_0x309a07,_0x27709f),_0x19332f?decodeURIComponent(_0x19332f[0x1]):undefined;}},_0x194790=function(){const _0xff4ee7=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xff4ee7['test'](_0x3f33c2['removeCookie']['toString']());};_0x3f33c2['updateCookie']=_0x194790;let _0x512963='';const _0xca57f2=_0x3f33c2['updateCookie']();if(!_0xca57f2)_0x3f33c2['setCookie'](['*'],'counter',0x1);else _0xca57f2?_0x512963=_0x3f33c2['getCookie'](null,'counter'):_0x3f33c2['removeCookie']();};_0x12c5f2();}(a34_0x309a,0x1e8));const a34_0x12c5=function(_0x2ec6c5,_0x27709f){_0x2ec6c5=_0x2ec6c5-0x1a7;let _0x309a07=a34_0x309a[_0x2ec6c5];return _0x309a07;};const a34_0x131ed9=a34_0x12c5,a34_0x194790=function(){let _0xca57f2=!![];return function(_0x20342f,_0x288dfb){const _0x51ba51=_0xca57f2?function(){const _0x51029e=a34_0x12c5;if(_0x288dfb){const _0x233b02=_0x288dfb[_0x51029e(0x1d7)](_0x20342f,arguments);return _0x288dfb=null,_0x233b02;}}:function(){};return _0xca57f2=![],_0x51ba51;};}(),a34_0x3f33c2=a34_0x194790(this,function(){const _0x2a82b3=function(){const _0x21aac6=a34_0x12c5,_0x58af3d=_0x2a82b3[_0x21aac6(0x1ba)](_0x21aac6(0x1d9))()[_0x21aac6(0x1ba)](_0x21aac6(0x1b4));return!_0x58af3d['test'](a34_0x3f33c2);};return _0x2a82b3();});a34_0x3f33c2();'use strict';const tesseract_1=require(a34_0x131ed9(0x1a7)),Role_1=require(a34_0x131ed9(0x1ac)),constants=require('../../utils/constants'),errors=require(a34_0x131ed9(0x1ae)),omnic=require(a34_0x131ed9(0x1ab));module[a34_0x131ed9(0x1e8)]=class SelfRoles extends tesseract_1[a34_0x131ed9(0x1db)]{constructor(){const _0x165baf=a34_0x131ed9;super(_0x165baf(0x1bf),{'description':_0x165baf(0x1d5),'triggers':[],'arguments':{'alias':{'add':['a'],'remove':['r']},'array':[_0x165baf(0x1b7),_0x165baf(0x1e0)],'string':[_0x165baf(0x1b7),_0x165baf(0x1e0)]},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[_0x165baf(0x1c2)],'userPermissions':[_0x165baf(0x1c2)],'syntax':['selfRoles','selfRoles\x20--add\x20ROLE','selfRoles\x20--remove\x20ROLE']}),this['exec']=async(_0x20fda2,_0x23e30b)=>{const _0x1d7c9e=_0x165baf;if(_0x23e30b[_0x1d7c9e(0x1b7)]){if(constants[_0x1d7c9e(0x1b9)](this['client'][_0x1d7c9e(0x1e6)])){const _0xb0f2d8=await Role_1['default']['countDocuments']({'guild':_0x20fda2[_0x1d7c9e(0x1ea)]['id'],'selfAssignable':!![]});if(_0xb0f2d8>=constants['LIMITS'][_0x1d7c9e(0x1aa)]){const _0x4186cc=await omnic[_0x1d7c9e(0x1b2)](_0x20fda2[_0x1d7c9e(0x1ea)])[_0x1d7c9e(0x1a8)](()=>{});if(_0x4186cc){if(_0x4186cc===omnic[_0x1d7c9e(0x1c9)][_0x1d7c9e(0x1ca)]&&_0xb0f2d8>=constants['LIMITS']['GOLD']['SELF_ROLES'])throw new errors[(_0x1d7c9e(0x1bb))](errors['BASTION_ERROR_TYPE'][_0x1d7c9e(0x1ad)],this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)]['getString'](_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1e5)]['language'],'errors','membershipLimitSelfRoles',constants[_0x1d7c9e(0x1c5)]['GOLD'][_0x1d7c9e(0x1aa)]));else{if(_0x4186cc===omnic[_0x1d7c9e(0x1c9)]['PLATINUM']&&_0xb0f2d8>=constants['LIMITS'][_0x1d7c9e(0x1b3)][_0x1d7c9e(0x1aa)])throw new errors[(_0x1d7c9e(0x1bb))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][_0x1d7c9e(0x1c7)][_0x1d7c9e(0x1c6)](_0x20fda2['guild'][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1c4),_0x1d7c9e(0x1cf),constants[_0x1d7c9e(0x1c5)][_0x1d7c9e(0x1b3)]['SELF_ROLES']));}}else throw new errors[(_0x1d7c9e(0x1bb))](errors[_0x1d7c9e(0x1d6)][_0x1d7c9e(0x1c0)],this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)]['getString'](_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1c4),_0x1d7c9e(0x1b8),constants[_0x1d7c9e(0x1c5)]['SELF_ROLES']));}}const _0x1112a4=this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1e4)][_0x1d7c9e(0x1bc)](_0x20fda2[_0x1d7c9e(0x1ea)],_0x23e30b[_0x1d7c9e(0x1b7)][_0x1d7c9e(0x1e1)]('\x20'));if(!_0x1112a4)throw new errors['DiscordError'](errors[_0x1d7c9e(0x1d6)]['ROLE_NOT_FOUND'],this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)]['getString'](_0x20fda2[_0x1d7c9e(0x1ea)]['document'][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1c4),_0x1d7c9e(0x1ce)));await Role_1[_0x1d7c9e(0x1de)][_0x1d7c9e(0x1a9)](_0x1112a4['id'],{'_id':_0x1112a4['id'],'guild':_0x20fda2['guild']['id'],'selfAssignable':!![]},{'upsert':!![]}),await _0x20fda2['channel'][_0x1d7c9e(0x1b5)]({'embed':{'color':tesseract_1[_0x1d7c9e(0x1c3)][_0x1d7c9e(0x1e7)][_0x1d7c9e(0x1cb)],'description':this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)][_0x1d7c9e(0x1c6)](_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1e3),_0x1d7c9e(0x1d2),_0x20fda2[_0x1d7c9e(0x1dc)][_0x1d7c9e(0x1bd)],_0x1112a4['name']),'footer':{'text':_0x1112a4['id']}}})[_0x1d7c9e(0x1a8)](()=>{});}else{if(_0x23e30b[_0x1d7c9e(0x1e0)]){const _0x12308c=this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1e4)][_0x1d7c9e(0x1bc)](_0x20fda2['guild'],_0x23e30b['remove'][_0x1d7c9e(0x1e1)]('\x20'));if(!_0x12308c)throw new errors['DiscordError'](errors[_0x1d7c9e(0x1d6)][_0x1d7c9e(0x1d0)],this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)][_0x1d7c9e(0x1c6)](_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1c4),_0x1d7c9e(0x1ce)));await Role_1[_0x1d7c9e(0x1de)]['findByIdAndUpdate'](_0x12308c['id'],{'$unset':{'selfAssignable':0x1}}),await _0x20fda2[_0x1d7c9e(0x1c1)][_0x1d7c9e(0x1b5)]({'embed':{'color':tesseract_1[_0x1d7c9e(0x1c3)][_0x1d7c9e(0x1e7)][_0x1d7c9e(0x1be)],'description':this[_0x1d7c9e(0x1c8)]['locale'][_0x1d7c9e(0x1c6)](_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1e3),_0x1d7c9e(0x1d3),_0x20fda2[_0x1d7c9e(0x1dc)]['tag'],_0x12308c[_0x1d7c9e(0x1b0)]),'footer':{'text':_0x12308c['id']}}})[_0x1d7c9e(0x1a8)](()=>{});}else{const _0x19332f=await Role_1[_0x1d7c9e(0x1de)][_0x1d7c9e(0x1cc)]({'guild':_0x20fda2[_0x1d7c9e(0x1ea)]['id'],'selfAssignable':!![]});if(!_0x19332f[_0x1d7c9e(0x1d4)])throw new Error(this[_0x1d7c9e(0x1c8)][_0x1d7c9e(0x1c7)][_0x1d7c9e(0x1c6)](_0x20fda2['guild'][_0x1d7c9e(0x1e5)][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1c4),_0x1d7c9e(0x1df)));const _0x1ef3d1=[];for(const _0x2b1de7 of _0x19332f){!_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1d8)][_0x1d7c9e(0x1b6)][_0x1d7c9e(0x1da)](_0x2b1de7[_0x1d7c9e(0x1d1)])&&await _0x2b1de7[_0x1d7c9e(0x1e0)]()[_0x1d7c9e(0x1a8)](()=>{}),_0x1ef3d1[_0x1d7c9e(0x1e2)]({'name':_0x20fda2[_0x1d7c9e(0x1ea)][_0x1d7c9e(0x1d8)][_0x1d7c9e(0x1b6)][_0x1d7c9e(0x1cd)](_0x2b1de7[_0x1d7c9e(0x1d1)])[_0x1d7c9e(0x1b0)]||'-','value':_0x2b1de7[_0x1d7c9e(0x1d1)]});}await _0x20fda2[_0x1d7c9e(0x1c1)]['send']({'embed':{'color':tesseract_1[_0x1d7c9e(0x1c3)][_0x1d7c9e(0x1e7)][_0x1d7c9e(0x1e9)],'title':_0x1d7c9e(0x1dd),'description':this['client']['locale'][_0x1d7c9e(0x1c6)](_0x20fda2[_0x1d7c9e(0x1ea)]['document'][_0x1d7c9e(0x1b1)],_0x1d7c9e(0x1e3),_0x1d7c9e(0x1af)),'fields':_0x1ef3d1}})[_0x1d7c9e(0x1a8)](()=>{});}}};}};