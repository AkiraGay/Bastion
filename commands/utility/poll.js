const a132_0x5408=['React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','poll','return\x20/\x22\x20+\x20this\x20+\x20\x22/','LIMITS','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','language','../../utils/constants','@bastion/tesseract','client','Ends','reactions','PremiumTier','\x20votes\x20(','INVALID_COMMAND_SYNTAX','POLLS','errors','ends','test','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','has','join','map','COLORS','send','POLL_TIMEOUT','_id','BASTION_ERROR_TYPE','fetch','DiscordError','locale','length','channels','../../utils/numbers','guild','status','name','users','LIMITED_PREMIUM_MEMBERSHIP','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','user','POLL_NOT_FOUND','create','default','number','timeout','PREMIUM_MEMBERSHIP_REQUIRED','getString','channel','catch','GOLD','countDocuments','option','isPublicBastion','POLL','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','Constants','value','document','membershipLimitPolls','IRIS','size','membershipLimitPollTimeout','get','MANAGE_CHANNELS','PLATINUM','exec','react','../../utils/errors','embeds','clamp','defaultTimeout','bot','cache','fields','slice','title','premiumPollTimeout'];(function(_0x533162,_0x5408b0){const _0x424b64=function(_0x3dca76){while(--_0x3dca76){_0x533162['push'](_0x533162['shift']());}};const _0x293a0c=function(){const _0x38d4a1={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x299294,_0x5060ca,_0x23a29d,_0x15922e){_0x15922e=_0x15922e||{};let _0x37bd14=_0x5060ca+'='+_0x23a29d;let _0x5a6b52=0x0;for(let _0x18d7ad=0x0,_0x32f330=_0x299294['length'];_0x18d7ad<_0x32f330;_0x18d7ad++){const _0x2af568=_0x299294[_0x18d7ad];_0x37bd14+=';\x20'+_0x2af568;const _0x501b72=_0x299294[_0x2af568];_0x299294['push'](_0x501b72);_0x32f330=_0x299294['length'];if(_0x501b72!==!![]){_0x37bd14+='='+_0x501b72;}}_0x15922e['cookie']=_0x37bd14;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5d3e1e,_0x4b7d21){_0x5d3e1e=_0x5d3e1e||function(_0x4ac746){return _0x4ac746;};const _0xe0bb66=_0x5d3e1e(new RegExp('(?:^|;\x20)'+_0x4b7d21['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x41d7c0=function(_0x1d3864,_0x40fcbb){_0x1d3864(++_0x40fcbb);};_0x41d7c0(_0x424b64,_0x5408b0);return _0xe0bb66?decodeURIComponent(_0xe0bb66[0x1]):undefined;}};const _0x1984c9=function(){const _0x2a942d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2a942d['test'](_0x38d4a1['removeCookie']['toString']());};_0x38d4a1['updateCookie']=_0x1984c9;let _0x48aae1='';const _0x588a18=_0x38d4a1['updateCookie']();if(!_0x588a18){_0x38d4a1['setCookie'](['*'],'counter',0x1);}else if(_0x588a18){_0x48aae1=_0x38d4a1['getCookie'](null,'counter');}else{_0x38d4a1['removeCookie']();}};_0x293a0c();}(a132_0x5408,0x1c1));const a132_0x424b=function(_0x533162,_0x5408b0){_0x533162=_0x533162-0x0;let _0x424b64=a132_0x5408[_0x533162];return _0x424b64;};const a132_0x38d4a1=function(){let _0x17b5f1=!![];return function(_0x359306,_0x4248ba){const _0x62c857=_0x17b5f1?function(){if(_0x4248ba){const _0x21ca5a=_0x4248ba['apply'](_0x359306,arguments);_0x4248ba=null;return _0x21ca5a;}}:function(){};_0x17b5f1=![];return _0x62c857;};}();const a132_0x3dca76=a132_0x38d4a1(this,function(){const _0x255e03=function(){const _0x347928=_0x255e03['constructor'](a132_0x424b('0xf'))()['compile'](a132_0x424b('0x33'));return!_0x347928[a132_0x424b('0x1e')](a132_0x3dca76);};return _0x255e03();});a132_0x3dca76();'use strict';const tesseract_1=require(a132_0x424b('0x14'));const Poll_1=require('../../models/Poll');const constants=require(a132_0x424b('0x13'));const errors=require(a132_0x424b('0x3'));const numbers=require(a132_0x424b('0x2d'));const omnic=require('../../utils/omnic');module['exports']=class PollCommand extends tesseract_1['Command']{constructor(){super(a132_0x424b('0xe'),{'description':a132_0x424b('0x11'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a132_0x424b('0x39')],'string':[a132_0x424b('0x40'),a132_0x424b('0x2f')],'coerce':{'timeout':_0x34ab12=>typeof _0x34ab12===a132_0x424b('0x38')&&numbers[a132_0x424b('0x5')](_0x34ab12,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a132_0x424b('0x2e'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[a132_0x424b('0x4c')],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',a132_0x424b('0x43'),a132_0x424b('0x1f')]});this[a132_0x424b('0x1')]=async(_0x1f4e1e,_0x528f8e)=>{if(_0x528f8e[a132_0x424b('0x2f')]){const _0x32730d=await Poll_1[a132_0x424b('0x37')]['findOne']({'_id':_0x528f8e[a132_0x424b('0x2f')],'guild':_0x1f4e1e[a132_0x424b('0x2e')]['id']});if(!_0x32730d)throw new Error(a132_0x424b('0x35'));if(!_0x1f4e1e[a132_0x424b('0x2e')][a132_0x424b('0x2c')][a132_0x424b('0x8')][a132_0x424b('0x20')](_0x32730d[a132_0x424b('0x3c')]))throw new Error(a132_0x424b('0x35'));const _0x1170e6=_0x1f4e1e['guild'][a132_0x424b('0x2c')][a132_0x424b('0x8')][a132_0x424b('0x4b')](_0x32730d[a132_0x424b('0x3c')]);const _0x52bee1=await _0x1170e6['messages'][a132_0x424b('0x28')](_0x32730d[a132_0x424b('0x26')])[a132_0x424b('0x3d')](()=>{});if(!_0x52bee1)throw new Error(a132_0x424b('0x35'));const _0x11006a=_0x52bee1['embeds'][0x0][a132_0x424b('0x9')]['map'](_0x550bde=>_0x550bde[a132_0x424b('0x45')]);const _0x2371b8={};let _0x4ea514=0x0;for(const _0x2f1cb8 in this[a132_0x424b('0x17')]['slice'](0x0,_0x11006a[a132_0x424b('0x2b')])){if(_0x52bee1['reactions'][a132_0x424b('0x8')]['has'](this[a132_0x424b('0x17')][_0x2f1cb8])){await _0x52bee1[a132_0x424b('0x17')]['cache']['get'](this['reactions'][_0x2f1cb8])[a132_0x424b('0x31')]['fetch']()['catch'](()=>{});const _0x178114=_0x52bee1['reactions'][a132_0x424b('0x8')][a132_0x424b('0x4b')](this['reactions'][_0x2f1cb8])[a132_0x424b('0x31')][a132_0x424b('0x8')]['filter'](_0x23ba9c=>!_0x23ba9c[a132_0x424b('0x7')])[a132_0x424b('0x49')];_0x2371b8[this['reactions'][_0x2f1cb8]]=_0x178114;_0x4ea514+=_0x178114;}}return await _0x1f4e1e[a132_0x424b('0x3c')][a132_0x424b('0x24')]({'embed':{'color':tesseract_1['Constants'][a132_0x424b('0x23')][a132_0x424b('0x48')],'author':{'name':'POLL\x20STATUS'},'title':_0x52bee1[a132_0x424b('0x4')][0x0][a132_0x424b('0xb')],'fields':_0x52bee1[a132_0x424b('0x4')][0x0]['fields'][a132_0x424b('0x22')](_0x1512be=>({'name':_0x1512be['name']+'\x20'+_0x1512be['value'],'value':(_0x2371b8[_0x1512be['name']]||0x0)+'\x20/\x20'+_0x4ea514+a132_0x424b('0x19')+(_0x2371b8[_0x1512be['name']]?_0x2371b8[_0x1512be[a132_0x424b('0x30')]]/_0x4ea514*0x64:0x0)['toFixed'](0x2)+'%)'})),'footer':{'text':_0x52bee1['id']+'\x20â€¢\x20Ends'},'timestamp':_0x32730d[a132_0x424b('0x1d')]}});}if(!_0x528f8e['_'][a132_0x424b('0x2b')]||!_0x528f8e[a132_0x424b('0x40')]||!_0x528f8e[a132_0x424b('0x40')][a132_0x424b('0x2b')])throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a132_0x424b('0x1a')],this[a132_0x424b('0x30')]);const _0x2dce3b=_0x528f8e['_'][a132_0x424b('0x21')]('\x20');const _0x24c05a=_0x528f8e[a132_0x424b('0x39')]?_0x528f8e[a132_0x424b('0x39')]:this[a132_0x424b('0x6')];if(constants[a132_0x424b('0x41')](this[a132_0x424b('0x15')][a132_0x424b('0x34')])){const _0x27c563=await omnic['fetchPremiumTier'](_0x1f4e1e['guild'])[a132_0x424b('0x3d')](()=>{});if(_0x27c563){if(_0x27c563===omnic[a132_0x424b('0x18')]['GOLD']&&_0x24c05a>constants['LIMITS'][a132_0x424b('0x3e')][a132_0x424b('0x25')]){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')][a132_0x424b('0x32')],this[a132_0x424b('0x15')][a132_0x424b('0x2a')][a132_0x424b('0x3b')](_0x1f4e1e[a132_0x424b('0x2e')]['document'][a132_0x424b('0x12')],'errors',a132_0x424b('0x4a'),constants[a132_0x424b('0x10')][a132_0x424b('0x3e')][a132_0x424b('0x25')]));}else if(_0x27c563===omnic['PremiumTier'][a132_0x424b('0x0')]&&_0x24c05a>constants['LIMITS'][a132_0x424b('0x0')][a132_0x424b('0x25')]){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')][a132_0x424b('0x32')],this['client'][a132_0x424b('0x2a')][a132_0x424b('0x3b')](_0x1f4e1e['guild']['document']['language'],a132_0x424b('0x1c'),'membershipLimitPollTimeout',constants[a132_0x424b('0x10')][a132_0x424b('0x0')][a132_0x424b('0x25')]));}}else if(_0x24c05a>constants[a132_0x424b('0x10')][a132_0x424b('0x25')]){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')][a132_0x424b('0x3a')],this[a132_0x424b('0x15')][a132_0x424b('0x2a')][a132_0x424b('0x3b')](_0x1f4e1e[a132_0x424b('0x2e')][a132_0x424b('0x46')][a132_0x424b('0x12')],'errors',a132_0x424b('0xc'),constants[a132_0x424b('0x10')][a132_0x424b('0x25')]));}const _0x441484=await Poll_1['default'][a132_0x424b('0x3f')]({'guild':_0x1f4e1e['guild']['id'],'ends':{'$gte':new Date()}});if(_0x27c563){if(_0x27c563===omnic['PremiumTier']['GOLD']&&_0x441484>=constants['LIMITS'][a132_0x424b('0x3e')][a132_0x424b('0x1b')]){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')][a132_0x424b('0x32')],this[a132_0x424b('0x15')][a132_0x424b('0x2a')][a132_0x424b('0x3b')](_0x1f4e1e[a132_0x424b('0x2e')][a132_0x424b('0x46')][a132_0x424b('0x12')],a132_0x424b('0x1c'),a132_0x424b('0x47'),constants['LIMITS'][a132_0x424b('0x3e')][a132_0x424b('0x1b')]));}else if(_0x27c563===omnic[a132_0x424b('0x18')][a132_0x424b('0x0')]&&_0x441484>=constants[a132_0x424b('0x10')][a132_0x424b('0x0')][a132_0x424b('0x1b')]){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')][a132_0x424b('0x32')],this[a132_0x424b('0x15')][a132_0x424b('0x2a')][a132_0x424b('0x3b')](_0x1f4e1e[a132_0x424b('0x2e')][a132_0x424b('0x46')][a132_0x424b('0x12')],a132_0x424b('0x1c'),a132_0x424b('0x47'),constants[a132_0x424b('0x10')][a132_0x424b('0x0')]['POLLS']));}}else if(_0x441484>=constants['LIMITS']['POLLS']){throw new errors[(a132_0x424b('0x29'))](errors[a132_0x424b('0x27')]['PREMIUM_MEMBERSHIP_REQUIRED'],this[a132_0x424b('0x15')][a132_0x424b('0x2a')]['getString'](_0x1f4e1e[a132_0x424b('0x2e')][a132_0x424b('0x46')][a132_0x424b('0x12')],a132_0x424b('0x1c'),'premiumPolls',constants[a132_0x424b('0x10')][a132_0x424b('0x1b')]));}}const _0x4e2b0b=new Date(Date['now']()+_0x24c05a*0x36ee80);const _0x2443a7=await _0x1f4e1e[a132_0x424b('0x3c')]['send']({'embed':{'color':tesseract_1[a132_0x424b('0x44')][a132_0x424b('0x23')][a132_0x424b('0x48')],'author':{'name':a132_0x424b('0x42')},'title':_0x2dce3b,'description':a132_0x424b('0xd'),'fields':_0x528f8e['option'][a132_0x424b('0x22')]((_0x177277,_0xc2025c)=>({'name':this[a132_0x424b('0x17')][_0xc2025c],'value':_0x177277})),'footer':{'text':a132_0x424b('0x16')},'timestamp':_0x4e2b0b}});await Poll_1[a132_0x424b('0x37')][a132_0x424b('0x36')]({'_id':_0x2443a7['id'],'channel':_0x2443a7['channel']['id'],'guild':_0x2443a7['guild']['id'],'ends':_0x4e2b0b});for(const _0x4a97e5 of this[a132_0x424b('0x17')][a132_0x424b('0xa')](0x0,_0x528f8e[a132_0x424b('0x40')][a132_0x424b('0x2b')])){await _0x2443a7[a132_0x424b('0x2')](_0x4a97e5)[a132_0x424b('0x3d')](()=>{});}};this[a132_0x424b('0x17')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a132_0x424b('0x6')]=0x3;}};