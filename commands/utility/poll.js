const a159_0x6b89=['React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','fields','fetch','LIMITS','PREMIUM_MEMBERSHIP_REQUIRED','GOLD','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','option','test','defaultTimeout','../../utils/errors','create','now','channel','poll','timeout','exec','POLLS','MANAGE_CHANNELS','IRIS','\x20/\x20','Command','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','map','_id','has','status','../../utils/omnic','../../utils/constants','clamp','Constants','../../utils/numbers','toFixed','POLL_NOT_FOUND','value','slice','title','exports','filter','length','BASTION_ERROR_TYPE','../../models/Poll','errors','PremiumTier','countDocuments','premiumPolls','POLL_TIMEOUT','getString','DiscordError','ends','guild','fetchPremiumTier','get','locale','catch','document','embeds','channels','POLL','user','membershipLimitPollTimeout','PLATINUM','isPublicBastion','Ends','reactions','name','send','COLORS','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','language','cache','LIMITED_PREMIUM_MEMBERSHIP','join','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','messages','apply','constructor','return\x20/\x22\x20+\x20this\x20+\x20\x22/','number','membershipLimitPolls','default','client'];(function(_0x89a52a,_0x27a7f4){const _0x6b89d8=function(_0x537483){while(--_0x537483){_0x89a52a['push'](_0x89a52a['shift']());}},_0x4ee7af=function(){const _0x2ec503={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x15fd63,_0x42f0a3,_0x4ea435,_0x168be3){_0x168be3=_0x168be3||{};let _0x10622a=_0x42f0a3+'='+_0x4ea435,_0x4f2f3b=0x0;for(let _0x49b40a=0x0,_0x4d9b2e=_0x15fd63['length'];_0x49b40a<_0x4d9b2e;_0x49b40a++){const _0x3d9d1d=_0x15fd63[_0x49b40a];_0x10622a+=';\x20'+_0x3d9d1d;const _0x5c7435=_0x15fd63[_0x3d9d1d];_0x15fd63['push'](_0x5c7435),_0x4d9b2e=_0x15fd63['length'],_0x5c7435!==!![]&&(_0x10622a+='='+_0x5c7435);}_0x168be3['cookie']=_0x10622a;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1824ec,_0x48d41e){_0x1824ec=_0x1824ec||function(_0x1b7fea){return _0x1b7fea;};const _0x218e92=_0x1824ec(new RegExp('(?:^|;\x20)'+_0x48d41e['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x261b6e=function(_0x4dd2c8,_0x292154){_0x4dd2c8(++_0x292154);};return _0x261b6e(_0x6b89d8,_0x27a7f4),_0x218e92?decodeURIComponent(_0x218e92[0x1]):undefined;}},_0x10ae90=function(){const _0x10eca2=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x10eca2['test'](_0x2ec503['removeCookie']['toString']());};_0x2ec503['updateCookie']=_0x10ae90;let _0x3eed8a='';const _0x5064f2=_0x2ec503['updateCookie']();if(!_0x5064f2)_0x2ec503['setCookie'](['*'],'counter',0x1);else _0x5064f2?_0x3eed8a=_0x2ec503['getCookie'](null,'counter'):_0x2ec503['removeCookie']();};_0x4ee7af();}(a159_0x6b89,0x168));const a159_0x4ee7=function(_0x89a52a,_0x27a7f4){_0x89a52a=_0x89a52a-0x1b3;let _0x6b89d8=a159_0x6b89[_0x89a52a];return _0x6b89d8;};const _0x189a9e=a159_0x4ee7,a159_0x10ae90=function(){let _0x5064f2=!![];return function(_0x15fd63,_0x42f0a3){const _0x4ea435=_0x5064f2?function(){const _0x171dd4=a159_0x4ee7;if(_0x42f0a3){const _0x168be3=_0x42f0a3[_0x171dd4(0x1de)](_0x15fd63,arguments);return _0x42f0a3=null,_0x168be3;}}:function(){};return _0x5064f2=![],_0x4ea435;};}(),a159_0x2ec503=a159_0x10ae90(this,function(){const _0x10622a=function(){const _0x56c082=a159_0x4ee7,_0x4f2f3b=_0x10622a[_0x56c082(0x1df)](_0x56c082(0x1e0))()['constructor'](_0x56c082(0x1dc));return!_0x4f2f3b[_0x56c082(0x1ed)](a159_0x2ec503);};return _0x10622a();});a159_0x2ec503();'use strict';const tesseract_1=require('@bastion/tesseract'),Poll_1=require(_0x189a9e(0x1bc)),constants=require(_0x189a9e(0x201)),errors=require(_0x189a9e(0x1ef)),numbers=require(_0x189a9e(0x204)),omnic=require(_0x189a9e(0x200));module[_0x189a9e(0x1b8)]=class PollCommand extends tesseract_1[_0x189a9e(0x1fa)]{constructor(){const _0x322510=_0x189a9e;super(_0x322510(0x1f3),{'description':_0x322510(0x1fb),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':['timeout'],'string':[_0x322510(0x1ec),_0x322510(0x1ff)],'coerce':{'timeout':_0x49b40a=>typeof _0x49b40a===_0x322510(0x1e1)&&numbers[_0x322510(0x202)](_0x49b40a,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':_0x322510(0x1c5),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[_0x322510(0x1f7)],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',_0x322510(0x1eb),_0x322510(0x1d7)]}),this[_0x322510(0x1f5)]=async(_0x4d9b2e,_0x3d9d1d)=>{const _0x3aefc7=_0x322510;if(_0x3d9d1d[_0x3aefc7(0x1ff)]){const _0x261b6e=await Poll_1[_0x3aefc7(0x1e3)]['findOne']({'_id':_0x3d9d1d[_0x3aefc7(0x1ff)],'guild':_0x4d9b2e[_0x3aefc7(0x1c5)]['id']});if(!_0x261b6e)throw new Error(_0x3aefc7(0x1b4));if(!_0x4d9b2e['guild'][_0x3aefc7(0x1cc)][_0x3aefc7(0x1d9)][_0x3aefc7(0x1fe)](_0x261b6e['channel']))throw new Error(_0x3aefc7(0x1b4));const _0x1b7fea=_0x4d9b2e[_0x3aefc7(0x1c5)][_0x3aefc7(0x1cc)][_0x3aefc7(0x1d9)][_0x3aefc7(0x1c7)](_0x261b6e[_0x3aefc7(0x1f2)]),_0x4dd2c8=await _0x1b7fea[_0x3aefc7(0x1dd)][_0x3aefc7(0x1e7)](_0x261b6e[_0x3aefc7(0x1fd)])[_0x3aefc7(0x1c9)](()=>{});if(!_0x4dd2c8)throw new Error(_0x3aefc7(0x1b4));const _0x292154=_0x4dd2c8[_0x3aefc7(0x1cb)][0x0][_0x3aefc7(0x1e6)][_0x3aefc7(0x1fc)](_0x4d358d=>_0x4d358d[_0x3aefc7(0x1b5)]),_0x10eca2={};let _0x48c167=0x0;for(const _0x45a52e in this[_0x3aefc7(0x1d3)]['slice'](0x0,_0x292154['length'])){if(_0x4dd2c8[_0x3aefc7(0x1d3)][_0x3aefc7(0x1d9)][_0x3aefc7(0x1fe)](this[_0x3aefc7(0x1d3)][_0x45a52e])){await _0x4dd2c8['reactions']['cache'][_0x3aefc7(0x1c7)](this[_0x3aefc7(0x1d3)][_0x45a52e])['users'][_0x3aefc7(0x1e7)]()[_0x3aefc7(0x1c9)](()=>{});const _0x12aa89=_0x4dd2c8[_0x3aefc7(0x1d3)][_0x3aefc7(0x1d9)][_0x3aefc7(0x1c7)](this[_0x3aefc7(0x1d3)][_0x45a52e])['users']['cache'][_0x3aefc7(0x1b9)](_0x1d05a2=>!_0x1d05a2['bot'])['size'];_0x10eca2[this[_0x3aefc7(0x1d3)][_0x45a52e]]=_0x12aa89,_0x48c167+=_0x12aa89;}}return await _0x4d9b2e[_0x3aefc7(0x1f2)][_0x3aefc7(0x1d5)]({'embed':{'color':tesseract_1[_0x3aefc7(0x203)][_0x3aefc7(0x1d6)][_0x3aefc7(0x1f8)],'author':{'name':'POLL\x20STATUS'},'title':_0x4dd2c8[_0x3aefc7(0x1cb)][0x0][_0x3aefc7(0x1b7)],'fields':_0x4dd2c8['embeds'][0x0][_0x3aefc7(0x1e6)][_0x3aefc7(0x1fc)](_0x3e4da9=>({'name':_0x3e4da9[_0x3aefc7(0x1d4)]+'\x20'+_0x3e4da9['value'],'value':(_0x10eca2[_0x3e4da9[_0x3aefc7(0x1d4)]]||0x0)+_0x3aefc7(0x1f9)+_0x48c167+'\x20votes\x20('+(_0x10eca2[_0x3e4da9[_0x3aefc7(0x1d4)]]?_0x10eca2[_0x3e4da9[_0x3aefc7(0x1d4)]]/_0x48c167*0x64:0x0)[_0x3aefc7(0x1b3)](0x2)+'%)'})),'footer':{'text':_0x4dd2c8['id']+'\x20â€¢\x20Ends'},'timestamp':_0x261b6e[_0x3aefc7(0x1c4)]}});}if(!_0x3d9d1d['_'][_0x3aefc7(0x1ba)]||!_0x3d9d1d[_0x3aefc7(0x1ec)]||!(_0x3d9d1d[_0x3aefc7(0x1ec)]instanceof Array))throw new errors['DiscordError'](errors[_0x3aefc7(0x1bb)]['INVALID_COMMAND_SYNTAX'],this[_0x3aefc7(0x1d4)]);const _0x5c7435=_0x3d9d1d['_'][_0x3aefc7(0x1db)]('\x20'),_0x1824ec=_0x3d9d1d[_0x3aefc7(0x1f4)]?_0x3d9d1d['timeout']:this['defaultTimeout'];if(constants[_0x3aefc7(0x1d1)](this[_0x3aefc7(0x1e4)][_0x3aefc7(0x1ce)])){const _0x468086=await omnic[_0x3aefc7(0x1c6)](_0x4d9b2e[_0x3aefc7(0x1c5)])[_0x3aefc7(0x1c9)](()=>{});if(_0x468086){if(_0x468086===omnic['PremiumTier'][_0x3aefc7(0x1ea)]&&_0x1824ec>constants[_0x3aefc7(0x1e8)][_0x3aefc7(0x1ea)][_0x3aefc7(0x1c1)])throw new errors['DiscordError'](errors[_0x3aefc7(0x1bb)][_0x3aefc7(0x1da)],this[_0x3aefc7(0x1e4)][_0x3aefc7(0x1c8)][_0x3aefc7(0x1c2)](_0x4d9b2e[_0x3aefc7(0x1c5)][_0x3aefc7(0x1ca)][_0x3aefc7(0x1d8)],_0x3aefc7(0x1bd),_0x3aefc7(0x1cf),constants[_0x3aefc7(0x1e8)]['GOLD'][_0x3aefc7(0x1c1)]));else{if(_0x468086===omnic['PremiumTier'][_0x3aefc7(0x1d0)]&&_0x1824ec>constants[_0x3aefc7(0x1e8)]['PLATINUM'][_0x3aefc7(0x1c1)])throw new errors[(_0x3aefc7(0x1c3))](errors[_0x3aefc7(0x1bb)][_0x3aefc7(0x1da)],this[_0x3aefc7(0x1e4)][_0x3aefc7(0x1c8)][_0x3aefc7(0x1c2)](_0x4d9b2e[_0x3aefc7(0x1c5)][_0x3aefc7(0x1ca)]['language'],_0x3aefc7(0x1bd),'membershipLimitPollTimeout',constants['LIMITS'][_0x3aefc7(0x1d0)][_0x3aefc7(0x1c1)]));}}else{if(_0x1824ec>constants[_0x3aefc7(0x1e8)][_0x3aefc7(0x1c1)])throw new errors[(_0x3aefc7(0x1c3))](errors[_0x3aefc7(0x1bb)]['PREMIUM_MEMBERSHIP_REQUIRED'],this[_0x3aefc7(0x1e4)][_0x3aefc7(0x1c8)][_0x3aefc7(0x1c2)](_0x4d9b2e[_0x3aefc7(0x1c5)][_0x3aefc7(0x1ca)][_0x3aefc7(0x1d8)],_0x3aefc7(0x1bd),'premiumPollTimeout',constants[_0x3aefc7(0x1e8)][_0x3aefc7(0x1c1)]));}const _0x230cdf=await Poll_1[_0x3aefc7(0x1e3)][_0x3aefc7(0x1bf)]({'guild':_0x4d9b2e[_0x3aefc7(0x1c5)]['id'],'ends':{'$gte':new Date()}});if(_0x468086){if(_0x468086===omnic['PremiumTier'][_0x3aefc7(0x1ea)]&&_0x230cdf>=constants['LIMITS'][_0x3aefc7(0x1ea)][_0x3aefc7(0x1f6)])throw new errors[(_0x3aefc7(0x1c3))](errors[_0x3aefc7(0x1bb)][_0x3aefc7(0x1da)],this[_0x3aefc7(0x1e4)][_0x3aefc7(0x1c8)][_0x3aefc7(0x1c2)](_0x4d9b2e[_0x3aefc7(0x1c5)]['document'][_0x3aefc7(0x1d8)],_0x3aefc7(0x1bd),_0x3aefc7(0x1e2),constants[_0x3aefc7(0x1e8)]['GOLD'][_0x3aefc7(0x1f6)]));else{if(_0x468086===omnic[_0x3aefc7(0x1be)]['PLATINUM']&&_0x230cdf>=constants[_0x3aefc7(0x1e8)][_0x3aefc7(0x1d0)][_0x3aefc7(0x1f6)])throw new errors[(_0x3aefc7(0x1c3))](errors[_0x3aefc7(0x1bb)]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0x3aefc7(0x1e4)]['locale'][_0x3aefc7(0x1c2)](_0x4d9b2e['guild']['document'][_0x3aefc7(0x1d8)],_0x3aefc7(0x1bd),_0x3aefc7(0x1e2),constants['LIMITS'][_0x3aefc7(0x1d0)][_0x3aefc7(0x1f6)]));}}else{if(_0x230cdf>=constants['LIMITS']['POLLS'])throw new errors['DiscordError'](errors[_0x3aefc7(0x1bb)][_0x3aefc7(0x1e9)],this[_0x3aefc7(0x1e4)]['locale'][_0x3aefc7(0x1c2)](_0x4d9b2e[_0x3aefc7(0x1c5)][_0x3aefc7(0x1ca)][_0x3aefc7(0x1d8)],_0x3aefc7(0x1bd),_0x3aefc7(0x1c0),constants[_0x3aefc7(0x1e8)][_0x3aefc7(0x1f6)]));}}const _0x48d41e=new Date(Date[_0x3aefc7(0x1f1)]()+_0x1824ec*0x36ee80),_0x218e92=await _0x4d9b2e['channel'][_0x3aefc7(0x1d5)]({'embed':{'color':tesseract_1['Constants'][_0x3aefc7(0x1d6)][_0x3aefc7(0x1f8)],'author':{'name':_0x3aefc7(0x1cd)},'title':_0x5c7435,'description':_0x3aefc7(0x1e5),'fields':_0x3d9d1d['option'][_0x3aefc7(0x1fc)]((_0x2b36e1,_0x59792d)=>({'name':this['reactions'][_0x59792d],'value':_0x2b36e1})),'footer':{'text':_0x3aefc7(0x1d2)},'timestamp':_0x48d41e}});await Poll_1['default'][_0x3aefc7(0x1f0)]({'_id':_0x218e92['id'],'channel':_0x218e92[_0x3aefc7(0x1f2)]['id'],'guild':_0x218e92['guild']['id'],'ends':_0x48d41e});for(const _0x1235ab of this[_0x3aefc7(0x1d3)][_0x3aefc7(0x1b6)](0x0,_0x3d9d1d[_0x3aefc7(0x1ec)][_0x3aefc7(0x1ba)])){await _0x218e92['react'](_0x1235ab)[_0x3aefc7(0x1c9)](()=>{});}},this[_0x322510(0x1d3)]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],this[_0x322510(0x1ee)]=0x3;}};