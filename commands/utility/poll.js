const a131_0x46c4=['membershipLimitPolls','title','defaultTimeout','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','status','fields','Command','../../utils/errors','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','filter','DiscordError','COLORS','Constants','clamp','catch','\x20â€¢\x20Ends','send','BASTION_ERROR_TYPE','option','findOne','_id','bot','fetch','value','guild','MANAGE_CHANNELS','client','Ends','compile','premiumPollTimeout','POLLS','default','poll','create','size','getString','channel','join','apply','membershipLimitPollTimeout','INVALID_COMMAND_SYNTAX','POLL_TIMEOUT','cache','PREMIUM_MEMBERSHIP_REQUIRED','ends','now','LIMITS','POLL','length','get','constructor','users','document','PremiumTier','name','errors','PLATINUM','\x20votes\x20(','timeout','exports','return\x20/\x22\x20+\x20this\x20+\x20\x22/','embeds','has','language','slice','map','number','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','POLL_NOT_FOUND','react','\x20/\x20','GOLD','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','LIMITED_PREMIUM_MEMBERSHIP','countDocuments','reactions','locale','channels'];(function(_0x1c7874,_0x46c40f){const _0x214970=function(_0x1f2fc6){while(--_0x1f2fc6){_0x1c7874['push'](_0x1c7874['shift']());}};const _0x3195b6=function(){const _0x312ff1={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x45356b,_0x3b5f1a,_0x90d208,_0x5dc66f){_0x5dc66f=_0x5dc66f||{};let _0x5b6191=_0x3b5f1a+'='+_0x90d208;let _0x55fc64=0x0;for(let _0x53b484=0x0,_0x172f16=_0x45356b['length'];_0x53b484<_0x172f16;_0x53b484++){const _0x5c359e=_0x45356b[_0x53b484];_0x5b6191+=';\x20'+_0x5c359e;const _0x5f0f83=_0x45356b[_0x5c359e];_0x45356b['push'](_0x5f0f83);_0x172f16=_0x45356b['length'];if(_0x5f0f83!==!![]){_0x5b6191+='='+_0x5f0f83;}}_0x5dc66f['cookie']=_0x5b6191;},'removeCookie':function(){return'dev';},'getCookie':function(_0x73d454,_0x449637){_0x73d454=_0x73d454||function(_0x25fe5e){return _0x25fe5e;};const _0x25cb1c=_0x73d454(new RegExp('(?:^|;\x20)'+_0x449637['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x5b6eb1=function(_0xb8d5aa,_0x2ed2ce){_0xb8d5aa(++_0x2ed2ce);};_0x5b6eb1(_0x214970,_0x46c40f);return _0x25cb1c?decodeURIComponent(_0x25cb1c[0x1]):undefined;}};const _0x43c512=function(){const _0xab34c4=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xab34c4['test'](_0x312ff1['removeCookie']['toString']());};_0x312ff1['updateCookie']=_0x43c512;let _0x3fb340='';const _0x2eced7=_0x312ff1['updateCookie']();if(!_0x2eced7){_0x312ff1['setCookie'](['*'],'counter',0x1);}else if(_0x2eced7){_0x3fb340=_0x312ff1['getCookie'](null,'counter');}else{_0x312ff1['removeCookie']();}};_0x3195b6();}(a131_0x46c4,0xdb));const a131_0x2149=function(_0x1c7874,_0x46c40f){_0x1c7874=_0x1c7874-0x0;let _0x214970=a131_0x46c4[_0x1c7874];return _0x214970;};const a131_0x312ff1=function(){let _0x1b0382=!![];return function(_0xa34cd2,_0x97551a){const _0x4a2ed4=_0x1b0382?function(){if(_0x97551a){const _0x3aa84a=_0x97551a[a131_0x2149('0x35')](_0xa34cd2,arguments);_0x97551a=null;return _0x3aa84a;}}:function(){};_0x1b0382=![];return _0x4a2ed4;};}();const a131_0x1f2fc6=a131_0x312ff1(this,function(){const _0x3970d3=function(){const _0x431adf=_0x3970d3[a131_0x2149('0x41')](a131_0x2149('0x4b'))()[a131_0x2149('0x2b')](a131_0x2149('0x9'));return!_0x431adf['test'](a131_0x1f2fc6);};return _0x3970d3();});a131_0x1f2fc6();'use strict';const tesseract_1=require('@bastion/tesseract');const Poll_1=require('../../models/Poll');const constants=require('../../utils/constants');const errors=require(a131_0x2149('0x16'));const numbers=require('../../utils/numbers');const omnic=require('../../utils/omnic');module[a131_0x2149('0x4a')]=class PollCommand extends tesseract_1[a131_0x2149('0x15')]{constructor(){super(a131_0x2149('0x2f'),{'description':'It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x2149('0x49')],'string':[a131_0x2149('0x21'),a131_0x2149('0x13')],'coerce':{'timeout':_0x5127e0=>typeof _0x5127e0===a131_0x2149('0x3')&&numbers[a131_0x2149('0x1c')](_0x5127e0,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a131_0x2149('0x27'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[a131_0x2149('0x28')],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',a131_0x2149('0x17'),a131_0x2149('0x12')]});this['exec']=async(_0x5d263b,_0x3bd589)=>{if(_0x3bd589[a131_0x2149('0x13')]){const _0x474664=await Poll_1['default'][a131_0x2149('0x22')]({'_id':_0x3bd589['status'],'guild':_0x5d263b[a131_0x2149('0x27')]['id']});if(!_0x474664)throw new Error(a131_0x2149('0x5'));if(!_0x5d263b['guild'][a131_0x2149('0xe')][a131_0x2149('0x39')][a131_0x2149('0x4d')](_0x474664['channel']))throw new Error('POLL_NOT_FOUND');const _0xaba6f6=_0x5d263b[a131_0x2149('0x27')]['channels'][a131_0x2149('0x39')][a131_0x2149('0x40')](_0x474664['channel']);const _0x157f01=await _0xaba6f6['messages'][a131_0x2149('0x25')](_0x474664[a131_0x2149('0x23')])[a131_0x2149('0x1d')](()=>{});if(!_0x157f01)throw new Error('POLL_NOT_FOUND');const _0x2c6e02=_0x157f01[a131_0x2149('0x4c')][0x0][a131_0x2149('0x14')]['map'](_0x3985cb=>_0x3985cb[a131_0x2149('0x26')]);const _0x2d36ca={};let _0x129f54=0x0;for(const _0x250b9a in this[a131_0x2149('0xc')][a131_0x2149('0x1')](0x0,_0x2c6e02['length'])){if(_0x157f01['reactions'][a131_0x2149('0x39')][a131_0x2149('0x4d')](this['reactions'][_0x250b9a])){await _0x157f01[a131_0x2149('0xc')]['cache'][a131_0x2149('0x40')](this[a131_0x2149('0xc')][_0x250b9a])[a131_0x2149('0x42')]['fetch']()[a131_0x2149('0x1d')](()=>{});const _0x338856=_0x157f01[a131_0x2149('0xc')]['cache'][a131_0x2149('0x40')](this[a131_0x2149('0xc')][_0x250b9a])[a131_0x2149('0x42')][a131_0x2149('0x39')][a131_0x2149('0x18')](_0x52bc4b=>!_0x52bc4b[a131_0x2149('0x24')])[a131_0x2149('0x31')];_0x2d36ca[this[a131_0x2149('0xc')][_0x250b9a]]=_0x338856;_0x129f54+=_0x338856;}}return await _0x5d263b[a131_0x2149('0x33')][a131_0x2149('0x1f')]({'embed':{'color':tesseract_1[a131_0x2149('0x1b')][a131_0x2149('0x1a')]['IRIS'],'author':{'name':'POLL\x20STATUS'},'title':_0x157f01[a131_0x2149('0x4c')][0x0][a131_0x2149('0x10')],'fields':_0x157f01[a131_0x2149('0x4c')][0x0][a131_0x2149('0x14')][a131_0x2149('0x2')](_0x529af1=>({'name':_0x529af1[a131_0x2149('0x45')]+'\x20'+_0x529af1[a131_0x2149('0x26')],'value':(_0x2d36ca[_0x529af1[a131_0x2149('0x45')]]||0x0)+a131_0x2149('0x7')+_0x129f54+a131_0x2149('0x48')+(_0x2d36ca[_0x529af1[a131_0x2149('0x45')]]?_0x2d36ca[_0x529af1[a131_0x2149('0x45')]]/_0x129f54*0x64:0x0)['toFixed'](0x2)+'%)'})),'footer':{'text':_0x157f01['id']+a131_0x2149('0x1e')},'timestamp':_0x474664[a131_0x2149('0x3b')]}});}if(!_0x3bd589['_'][a131_0x2149('0x3f')]||!_0x3bd589[a131_0x2149('0x21')]||!_0x3bd589[a131_0x2149('0x21')]['length'])throw new errors[(a131_0x2149('0x19'))](errors[a131_0x2149('0x20')][a131_0x2149('0x37')],this[a131_0x2149('0x45')]);const _0x3e8764=_0x3bd589['_'][a131_0x2149('0x34')]('\x20');const _0x2d9bd3=_0x3bd589[a131_0x2149('0x49')]?_0x3bd589['timeout']:this[a131_0x2149('0x11')];if(constants['isPublicBastion'](this[a131_0x2149('0x29')]['user'])){const _0x51e34f=await omnic['fetchPremiumTier'](_0x5d263b['guild'])[a131_0x2149('0x1d')](()=>{});if(_0x51e34f){if(_0x51e34f===omnic[a131_0x2149('0x44')]['GOLD']&&_0x2d9bd3>constants[a131_0x2149('0x3d')]['GOLD'][a131_0x2149('0x38')]){throw new errors[(a131_0x2149('0x19'))](errors['BASTION_ERROR_TYPE'][a131_0x2149('0xa')],this[a131_0x2149('0x29')][a131_0x2149('0xd')]['getString'](_0x5d263b['guild'][a131_0x2149('0x43')][a131_0x2149('0x0')],a131_0x2149('0x46'),'membershipLimitPollTimeout',constants['LIMITS'][a131_0x2149('0x8')][a131_0x2149('0x38')]));}else if(_0x51e34f===omnic[a131_0x2149('0x44')]['PLATINUM']&&_0x2d9bd3>constants[a131_0x2149('0x3d')][a131_0x2149('0x47')][a131_0x2149('0x38')]){throw new errors[(a131_0x2149('0x19'))](errors[a131_0x2149('0x20')][a131_0x2149('0xa')],this[a131_0x2149('0x29')]['locale']['getString'](_0x5d263b[a131_0x2149('0x27')][a131_0x2149('0x43')][a131_0x2149('0x0')],a131_0x2149('0x46'),a131_0x2149('0x36'),constants[a131_0x2149('0x3d')][a131_0x2149('0x47')]['POLL_TIMEOUT']));}}else if(_0x2d9bd3>constants[a131_0x2149('0x3d')]['POLL_TIMEOUT']){throw new errors[(a131_0x2149('0x19'))](errors[a131_0x2149('0x20')]['PREMIUM_MEMBERSHIP_REQUIRED'],this[a131_0x2149('0x29')][a131_0x2149('0xd')][a131_0x2149('0x32')](_0x5d263b[a131_0x2149('0x27')][a131_0x2149('0x43')][a131_0x2149('0x0')],'errors',a131_0x2149('0x2c'),constants[a131_0x2149('0x3d')][a131_0x2149('0x38')]));}const _0xfc0fc1=await Poll_1[a131_0x2149('0x2e')][a131_0x2149('0xb')]({'guild':_0x5d263b['guild']['id'],'ends':{'$gte':new Date()}});if(_0x51e34f){if(_0x51e34f===omnic[a131_0x2149('0x44')][a131_0x2149('0x8')]&&_0xfc0fc1>=constants[a131_0x2149('0x3d')][a131_0x2149('0x8')][a131_0x2149('0x2d')]){throw new errors['DiscordError'](errors[a131_0x2149('0x20')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x2149('0x29')][a131_0x2149('0xd')][a131_0x2149('0x32')](_0x5d263b['guild'][a131_0x2149('0x43')][a131_0x2149('0x0')],'errors',a131_0x2149('0xf'),constants[a131_0x2149('0x3d')][a131_0x2149('0x8')][a131_0x2149('0x2d')]));}else if(_0x51e34f===omnic[a131_0x2149('0x44')]['PLATINUM']&&_0xfc0fc1>=constants['LIMITS'][a131_0x2149('0x47')][a131_0x2149('0x2d')]){throw new errors[(a131_0x2149('0x19'))](errors[a131_0x2149('0x20')][a131_0x2149('0xa')],this[a131_0x2149('0x29')][a131_0x2149('0xd')]['getString'](_0x5d263b[a131_0x2149('0x27')][a131_0x2149('0x43')]['language'],a131_0x2149('0x46'),a131_0x2149('0xf'),constants['LIMITS']['PLATINUM'][a131_0x2149('0x2d')]));}}else{throw new errors[(a131_0x2149('0x19'))](errors[a131_0x2149('0x20')][a131_0x2149('0x3a')],this[a131_0x2149('0x29')][a131_0x2149('0xd')][a131_0x2149('0x32')](_0x5d263b[a131_0x2149('0x27')]['document'][a131_0x2149('0x0')],a131_0x2149('0x46'),'premiumPolls',constants[a131_0x2149('0x3d')]['POLLS']));}}const _0x926483=new Date(Date[a131_0x2149('0x3c')]()+_0x2d9bd3*0x36ee80);const _0xf1ca7f=await _0x5d263b['channel']['send']({'embed':{'color':tesseract_1[a131_0x2149('0x1b')][a131_0x2149('0x1a')]['IRIS'],'author':{'name':a131_0x2149('0x3e')},'title':_0x3e8764,'description':a131_0x2149('0x4'),'fields':_0x3bd589[a131_0x2149('0x21')][a131_0x2149('0x2')]((_0x6bec0,_0x43de3c)=>({'name':this[a131_0x2149('0xc')][_0x43de3c],'value':_0x6bec0})),'footer':{'text':a131_0x2149('0x2a')},'timestamp':_0x926483}});await Poll_1['default'][a131_0x2149('0x30')]({'_id':_0xf1ca7f['id'],'channel':_0xf1ca7f[a131_0x2149('0x33')]['id'],'guild':_0xf1ca7f[a131_0x2149('0x27')]['id'],'ends':_0x926483});for(const _0x700ebf of this[a131_0x2149('0xc')]['slice'](0x0,_0x3bd589[a131_0x2149('0x21')][a131_0x2149('0x3f')])){await _0xf1ca7f[a131_0x2149('0x6')](_0x700ebf)[a131_0x2149('0x1d')](()=>{});}};this['reactions']=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a131_0x2149('0x11')]=0x3;}};