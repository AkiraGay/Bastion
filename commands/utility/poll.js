const a132_0x3442=['size','POLL','reactions','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','../../utils/errors','PremiumTier','fields','\x20/\x20','slice','locale','users','value','membershipLimitPolls','LIMITS','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','DiscordError','membershipLimitPollTimeout','POLL_NOT_FOUND','\x20â€¢\x20Ends','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','embeds','errors','premiumPollTimeout','messages','poll','findOne','send','POLLS','client','join','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','../../utils/numbers','PLATINUM','status','COLORS','Constants','GOLD','@bastion/tesseract','MANAGE_CHANNELS','name','length','fetch','exec','default','channel','Ends','bot','_id','getString','constructor','POLL_TIMEOUT','compile','channels','apply','Command','catch','../../utils/constants','\x20votes\x20(','POLL\x20STATUS','PREMIUM_MEMBERSHIP_REQUIRED','premiumPolls','language','timeout','cache','has','guild','toFixed','BASTION_ERROR_TYPE','title','document','map','defaultTimeout','clamp','get','ends','user','../../models/Poll','poll\x20--status\x20POLL_MESSAGE_ID','test','option','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','LIMITED_PREMIUM_MEMBERSHIP'];(function(_0xb25cf1,_0x344297){const _0x69d764=function(_0x2384c1){while(--_0x2384c1){_0xb25cf1['push'](_0xb25cf1['shift']());}};const _0x5eed15=function(){const _0x39d631={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5f2427,_0x261d6e,_0x34e853,_0x161bbc){_0x161bbc=_0x161bbc||{};let _0x38b3d8=_0x261d6e+'='+_0x34e853;let _0x2e0090=0x0;for(let _0x2b4d41=0x0,_0x1071b9=_0x5f2427['length'];_0x2b4d41<_0x1071b9;_0x2b4d41++){const _0xbe816e=_0x5f2427[_0x2b4d41];_0x38b3d8+=';\x20'+_0xbe816e;const _0x568a5e=_0x5f2427[_0xbe816e];_0x5f2427['push'](_0x568a5e);_0x1071b9=_0x5f2427['length'];if(_0x568a5e!==!![]){_0x38b3d8+='='+_0x568a5e;}}_0x161bbc['cookie']=_0x38b3d8;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4af94d,_0x10c4b7){_0x4af94d=_0x4af94d||function(_0x2e4968){return _0x2e4968;};const _0x606aef=_0x4af94d(new RegExp('(?:^|;\x20)'+_0x10c4b7['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x10fe83=function(_0x5ada8e,_0x15be49){_0x5ada8e(++_0x15be49);};_0x10fe83(_0x69d764,_0x344297);return _0x606aef?decodeURIComponent(_0x606aef[0x1]):undefined;}};const _0x91cd66=function(){const _0x5dd2ee=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5dd2ee['test'](_0x39d631['removeCookie']['toString']());};_0x39d631['updateCookie']=_0x91cd66;let _0x1d7c15='';const _0x47334e=_0x39d631['updateCookie']();if(!_0x47334e){_0x39d631['setCookie'](['*'],'counter',0x1);}else if(_0x47334e){_0x1d7c15=_0x39d631['getCookie'](null,'counter');}else{_0x39d631['removeCookie']();}};_0x5eed15();}(a132_0x3442,0x92));const a132_0x69d7=function(_0xb25cf1,_0x344297){_0xb25cf1=_0xb25cf1-0x0;let _0x69d764=a132_0x3442[_0xb25cf1];return _0x69d764;};const a132_0x39d631=function(){let _0x5b2ec7=!![];return function(_0x6ec006,_0x173ea7){const _0x296cfb=_0x5b2ec7?function(){if(_0x173ea7){const _0x2e5723=_0x173ea7[a132_0x69d7('0x47')](_0x6ec006,arguments);_0x173ea7=null;return _0x2e5723;}}:function(){};_0x5b2ec7=![];return _0x296cfb;};}();const a132_0x2384c1=a132_0x39d631(this,function(){const _0x254905=function(){const _0x5281b7=_0x254905[a132_0x69d7('0x43')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a132_0x69d7('0x45')](a132_0x69d7('0x15'));return!_0x5281b7[a132_0x69d7('0xe')](a132_0x2384c1);};return _0x254905();});a132_0x2384c1();'use strict';const tesseract_1=require(a132_0x69d7('0x37'));const Poll_1=require(a132_0x69d7('0xc'));const constants=require(a132_0x69d7('0x4a'));const errors=require(a132_0x69d7('0x16'));const numbers=require(a132_0x69d7('0x31'));const omnic=require('../../utils/omnic');module['exports']=class PollCommand extends tesseract_1[a132_0x69d7('0x48')]{constructor(){super(a132_0x69d7('0x2a'),{'description':a132_0x69d7('0x20'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a132_0x69d7('0x50')],'string':['option',a132_0x69d7('0x33')],'coerce':{'timeout':_0x3446a5=>typeof _0x3446a5==='number'&&numbers[a132_0x69d7('0x8')](_0x3446a5,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a132_0x69d7('0x1'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[a132_0x69d7('0x38')],'syntax':[a132_0x69d7('0xd'),a132_0x69d7('0x25'),a132_0x69d7('0x10')]});this[a132_0x69d7('0x3c')]=async(_0x47d8b3,_0x1351d1)=>{if(_0x1351d1[a132_0x69d7('0x33')]){const _0x4a528a=await Poll_1[a132_0x69d7('0x3d')][a132_0x69d7('0x2b')]({'_id':_0x1351d1[a132_0x69d7('0x33')],'guild':_0x47d8b3['guild']['id']});if(!_0x4a528a)throw new Error(a132_0x69d7('0x23'));if(!_0x47d8b3[a132_0x69d7('0x1')][a132_0x69d7('0x46')][a132_0x69d7('0x51')][a132_0x69d7('0x0')](_0x4a528a[a132_0x69d7('0x3e')]))throw new Error(a132_0x69d7('0x23'));const _0x5e4dd2=_0x47d8b3[a132_0x69d7('0x1')][a132_0x69d7('0x46')][a132_0x69d7('0x51')]['get'](_0x4a528a[a132_0x69d7('0x3e')]);const _0x4df810=await _0x5e4dd2[a132_0x69d7('0x29')][a132_0x69d7('0x3b')](_0x4a528a[a132_0x69d7('0x41')])[a132_0x69d7('0x49')](()=>{});if(!_0x4df810)throw new Error('POLL_NOT_FOUND');const _0x362076=_0x4df810[a132_0x69d7('0x26')][0x0][a132_0x69d7('0x18')][a132_0x69d7('0x6')](_0x43af51=>_0x43af51[a132_0x69d7('0x1d')]);const _0x3d4f3c={};let _0xba89b5=0x0;for(const _0x4e18da in this['reactions'][a132_0x69d7('0x1a')](0x0,_0x362076['length'])){if(_0x4df810['reactions']['cache'][a132_0x69d7('0x0')](this[a132_0x69d7('0x14')][_0x4e18da])){await _0x4df810['reactions'][a132_0x69d7('0x51')][a132_0x69d7('0x9')](this['reactions'][_0x4e18da])[a132_0x69d7('0x1c')][a132_0x69d7('0x3b')]()[a132_0x69d7('0x49')](()=>{});const _0x36f490=_0x4df810['reactions']['cache'][a132_0x69d7('0x9')](this[a132_0x69d7('0x14')][_0x4e18da])[a132_0x69d7('0x1c')][a132_0x69d7('0x51')]['filter'](_0x3cd2fa=>!_0x3cd2fa[a132_0x69d7('0x40')])[a132_0x69d7('0x12')];_0x3d4f3c[this['reactions'][_0x4e18da]]=_0x36f490;_0xba89b5+=_0x36f490;}}return await _0x47d8b3[a132_0x69d7('0x3e')][a132_0x69d7('0x2c')]({'embed':{'color':tesseract_1[a132_0x69d7('0x35')][a132_0x69d7('0x34')]['IRIS'],'author':{'name':a132_0x69d7('0x4c')},'title':_0x4df810['embeds'][0x0][a132_0x69d7('0x4')],'fields':_0x4df810[a132_0x69d7('0x26')][0x0]['fields']['map'](_0x148fe6=>({'name':_0x148fe6['name']+'\x20'+_0x148fe6[a132_0x69d7('0x1d')],'value':(_0x3d4f3c[_0x148fe6['name']]||0x0)+a132_0x69d7('0x19')+_0xba89b5+a132_0x69d7('0x4b')+(_0x3d4f3c[_0x148fe6[a132_0x69d7('0x39')]]?_0x3d4f3c[_0x148fe6[a132_0x69d7('0x39')]]/_0xba89b5*0x64:0x0)[a132_0x69d7('0x2')](0x2)+'%)'})),'footer':{'text':_0x4df810['id']+a132_0x69d7('0x24')},'timestamp':_0x4a528a[a132_0x69d7('0xa')]}});}if(!_0x1351d1['_'][a132_0x69d7('0x3a')]||!_0x1351d1[a132_0x69d7('0xf')]||!_0x1351d1[a132_0x69d7('0xf')]['length'])throw new errors['DiscordError'](errors[a132_0x69d7('0x3')]['INVALID_COMMAND_SYNTAX'],this['name']);const _0x44d957=_0x1351d1['_'][a132_0x69d7('0x2f')]('\x20');const _0x14f2d8=_0x1351d1[a132_0x69d7('0x50')]?_0x1351d1[a132_0x69d7('0x50')]:this[a132_0x69d7('0x7')];if(constants['isPublicBastion'](this[a132_0x69d7('0x2e')][a132_0x69d7('0xb')])){const _0x5ce76d=await omnic['fetchPremiumTier'](_0x47d8b3['guild'])[a132_0x69d7('0x49')](()=>{});if(_0x5ce76d){if(_0x5ce76d===omnic[a132_0x69d7('0x17')][a132_0x69d7('0x36')]&&_0x14f2d8>constants[a132_0x69d7('0x1f')][a132_0x69d7('0x36')][a132_0x69d7('0x44')]){throw new errors[(a132_0x69d7('0x21'))](errors[a132_0x69d7('0x3')][a132_0x69d7('0x11')],this[a132_0x69d7('0x2e')]['locale'][a132_0x69d7('0x42')](_0x47d8b3[a132_0x69d7('0x1')][a132_0x69d7('0x5')][a132_0x69d7('0x4f')],a132_0x69d7('0x27'),'membershipLimitPollTimeout',constants['LIMITS']['GOLD'][a132_0x69d7('0x44')]));}else if(_0x5ce76d===omnic['PremiumTier'][a132_0x69d7('0x32')]&&_0x14f2d8>constants[a132_0x69d7('0x1f')]['PLATINUM'][a132_0x69d7('0x44')]){throw new errors['DiscordError'](errors[a132_0x69d7('0x3')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a132_0x69d7('0x2e')]['locale']['getString'](_0x47d8b3[a132_0x69d7('0x1')]['document'][a132_0x69d7('0x4f')],a132_0x69d7('0x27'),a132_0x69d7('0x22'),constants[a132_0x69d7('0x1f')][a132_0x69d7('0x32')][a132_0x69d7('0x44')]));}}else if(_0x14f2d8>constants['LIMITS'][a132_0x69d7('0x44')]){throw new errors[(a132_0x69d7('0x21'))](errors[a132_0x69d7('0x3')][a132_0x69d7('0x4d')],this[a132_0x69d7('0x2e')][a132_0x69d7('0x1b')][a132_0x69d7('0x42')](_0x47d8b3[a132_0x69d7('0x1')][a132_0x69d7('0x5')]['language'],'errors',a132_0x69d7('0x28'),constants['LIMITS'][a132_0x69d7('0x44')]));}const _0x1032f9=await Poll_1[a132_0x69d7('0x3d')]['countDocuments']({'guild':_0x47d8b3[a132_0x69d7('0x1')]['id'],'ends':{'$gte':new Date()}});if(_0x5ce76d){if(_0x5ce76d===omnic['PremiumTier'][a132_0x69d7('0x36')]&&_0x1032f9>=constants[a132_0x69d7('0x1f')][a132_0x69d7('0x36')]['POLLS']){throw new errors[(a132_0x69d7('0x21'))](errors[a132_0x69d7('0x3')][a132_0x69d7('0x11')],this[a132_0x69d7('0x2e')][a132_0x69d7('0x1b')][a132_0x69d7('0x42')](_0x47d8b3[a132_0x69d7('0x1')]['document'][a132_0x69d7('0x4f')],a132_0x69d7('0x27'),a132_0x69d7('0x1e'),constants[a132_0x69d7('0x1f')][a132_0x69d7('0x36')][a132_0x69d7('0x2d')]));}else if(_0x5ce76d===omnic['PremiumTier']['PLATINUM']&&_0x1032f9>=constants[a132_0x69d7('0x1f')][a132_0x69d7('0x32')][a132_0x69d7('0x2d')]){throw new errors[(a132_0x69d7('0x21'))](errors['BASTION_ERROR_TYPE'][a132_0x69d7('0x11')],this[a132_0x69d7('0x2e')][a132_0x69d7('0x1b')][a132_0x69d7('0x42')](_0x47d8b3[a132_0x69d7('0x1')]['document']['language'],a132_0x69d7('0x27'),'membershipLimitPolls',constants[a132_0x69d7('0x1f')][a132_0x69d7('0x32')][a132_0x69d7('0x2d')]));}}else{throw new errors[(a132_0x69d7('0x21'))](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[a132_0x69d7('0x2e')][a132_0x69d7('0x1b')][a132_0x69d7('0x42')](_0x47d8b3[a132_0x69d7('0x1')]['document'][a132_0x69d7('0x4f')],a132_0x69d7('0x27'),a132_0x69d7('0x4e'),constants[a132_0x69d7('0x1f')]['POLLS']));}}const _0x196cdf=new Date(Date['now']()+_0x14f2d8*0x36ee80);const _0x1a7419=await _0x47d8b3[a132_0x69d7('0x3e')][a132_0x69d7('0x2c')]({'embed':{'color':tesseract_1[a132_0x69d7('0x35')][a132_0x69d7('0x34')]['IRIS'],'author':{'name':a132_0x69d7('0x13')},'title':_0x44d957,'description':a132_0x69d7('0x30'),'fields':_0x1351d1[a132_0x69d7('0xf')][a132_0x69d7('0x6')]((_0xdb63ac,_0x1f5c0c)=>({'name':this[a132_0x69d7('0x14')][_0x1f5c0c],'value':_0xdb63ac})),'footer':{'text':a132_0x69d7('0x3f')},'timestamp':_0x196cdf}});await Poll_1[a132_0x69d7('0x3d')]['create']({'_id':_0x1a7419['id'],'channel':_0x1a7419[a132_0x69d7('0x3e')]['id'],'guild':_0x1a7419[a132_0x69d7('0x1')]['id'],'ends':_0x196cdf});for(const _0x5b96f1 of this[a132_0x69d7('0x14')]['slice'](0x0,_0x1351d1[a132_0x69d7('0xf')][a132_0x69d7('0x3a')])){await _0x1a7419['react'](_0x5b96f1)[a132_0x69d7('0x49')](()=>{});}};this['reactions']=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a132_0x69d7('0x7')]=0x3;}};