const a131_0x219c=['IRIS','number','join','findOne','exports','poll\x20--status\x20POLL_MESSAGE_ID','get','Command','\x20/\x20','fetchPremiumTier','fetch','guild','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','language','BASTION_ERROR_TYPE','channel','length','react','POLLS','_id','../../utils/errors','LIMITED_PREMIUM_MEMBERSHIP','bot','now','title','client','../../utils/omnic','status','Constants','cache','constructor','DiscordError','ends','create','option','errors','name','getString','value','GOLD','messages','send','users','POLL','fields','membershipLimitPolls','COLORS','clamp','@bastion/tesseract','locale','reactions','default','PLATINUM','POLL_NOT_FOUND','timeout','membershipLimitPollTimeout','catch','map','LIMITS','document','POLL_TIMEOUT','\x20votes\x20(','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','premiumPolls','has','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','PremiumTier','filter','\x20â€¢\x20Ends','test','poll','slice','PREMIUM_MEMBERSHIP_REQUIRED','embeds'];(function(_0x9d513c,_0x219caf){const _0x454fda=function(_0x5536e0){while(--_0x5536e0){_0x9d513c['push'](_0x9d513c['shift']());}};const _0x30a241=function(){const _0x2f42d5={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x57ad5c,_0x5b555d,_0x53310,_0x2ab5a2){_0x2ab5a2=_0x2ab5a2||{};let _0x42b0b0=_0x5b555d+'='+_0x53310;let _0x5f0697=0x0;for(let _0x48ae38=0x0,_0x1d382b=_0x57ad5c['length'];_0x48ae38<_0x1d382b;_0x48ae38++){const _0x5e5368=_0x57ad5c[_0x48ae38];_0x42b0b0+=';\x20'+_0x5e5368;const _0x36fe8f=_0x57ad5c[_0x5e5368];_0x57ad5c['push'](_0x36fe8f);_0x1d382b=_0x57ad5c['length'];if(_0x36fe8f!==!![]){_0x42b0b0+='='+_0x36fe8f;}}_0x2ab5a2['cookie']=_0x42b0b0;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1bda54,_0xa05a4d){_0x1bda54=_0x1bda54||function(_0x89fe11){return _0x89fe11;};const _0x436bfb=_0x1bda54(new RegExp('(?:^|;\x20)'+_0xa05a4d['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x3d3a18=function(_0x3f5c4d,_0xed5fb3){_0x3f5c4d(++_0xed5fb3);};_0x3d3a18(_0x454fda,_0x219caf);return _0x436bfb?decodeURIComponent(_0x436bfb[0x1]):undefined;}};const _0x442ec6=function(){const _0x21285d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x21285d['test'](_0x2f42d5['removeCookie']['toString']());};_0x2f42d5['updateCookie']=_0x442ec6;let _0x5aea39='';const _0x3b8e60=_0x2f42d5['updateCookie']();if(!_0x3b8e60){_0x2f42d5['setCookie'](['*'],'counter',0x1);}else if(_0x3b8e60){_0x5aea39=_0x2f42d5['getCookie'](null,'counter');}else{_0x2f42d5['removeCookie']();}};_0x30a241();}(a131_0x219c,0x8d));const a131_0x454f=function(_0x9d513c,_0x219caf){_0x9d513c=_0x9d513c-0x0;let _0x454fda=a131_0x219c[_0x9d513c];return _0x454fda;};const a131_0x2f42d5=function(){let _0x3f5470=!![];return function(_0xf8748,_0x559f4a){const _0x2dda95=_0x3f5470?function(){if(_0x559f4a){const _0x36cae9=_0x559f4a['apply'](_0xf8748,arguments);_0x559f4a=null;return _0x36cae9;}}:function(){};_0x3f5470=![];return _0x2dda95;};}();const a131_0x5536e0=a131_0x2f42d5(this,function(){const _0x196bcb=function(){const _0x17236f=_0x196bcb[a131_0x454f('0x25')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['compile'](a131_0x454f('0x13'));return!_0x17236f[a131_0x454f('0x2')](a131_0x5536e0);};return _0x196bcb();});a131_0x5536e0();'use strict';const tesseract_1=require(a131_0x454f('0x37'));const Poll_1=require('../../models/Poll');const constants=require('../../utils/constants');const errors=require(a131_0x454f('0x1b'));const numbers=require('../../utils/numbers');const omnic=require(a131_0x454f('0x21'));module[a131_0x454f('0xb')]=class PollCommand extends tesseract_1[a131_0x454f('0xe')]{constructor(){super(a131_0x454f('0x3'),{'description':a131_0x454f('0x48'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x454f('0x3d')],'string':[a131_0x454f('0x29'),a131_0x454f('0x22')],'coerce':{'timeout':_0x13fcbe=>typeof _0x13fcbe===a131_0x454f('0x8')&&numbers[a131_0x454f('0x36')](_0x13fcbe,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':['MANAGE_CHANNELS'],'syntax':[a131_0x454f('0xc'),'poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION']});this['exec']=async(_0x4afeef,_0x3699c2)=>{if(_0x3699c2['status']){const _0x56cc0f=await Poll_1[a131_0x454f('0x3a')][a131_0x454f('0xa')]({'_id':_0x3699c2[a131_0x454f('0x22')],'guild':_0x4afeef['guild']['id']});if(!_0x56cc0f)throw new Error(a131_0x454f('0x3c'));if(!_0x4afeef[a131_0x454f('0x12')]['channels'][a131_0x454f('0x24')][a131_0x454f('0x47')](_0x56cc0f['channel']))throw new Error(a131_0x454f('0x3c'));const _0x1dd956=_0x4afeef[a131_0x454f('0x12')]['channels'][a131_0x454f('0x24')][a131_0x454f('0xd')](_0x56cc0f[a131_0x454f('0x16')]);const _0x4c2cf7=await _0x1dd956[a131_0x454f('0x2f')]['fetch'](_0x56cc0f[a131_0x454f('0x1a')])[a131_0x454f('0x3f')](()=>{});if(!_0x4c2cf7)throw new Error(a131_0x454f('0x3c'));const _0x1edbb0=_0x4c2cf7[a131_0x454f('0x6')][0x0][a131_0x454f('0x33')]['map'](_0x363fa5=>_0x363fa5[a131_0x454f('0x2d')]);const _0x38201d={};let _0x31b8a9=0x0;for(const _0x3ca6b3 in this[a131_0x454f('0x39')][a131_0x454f('0x4')](0x0,_0x1edbb0[a131_0x454f('0x17')])){if(_0x4c2cf7[a131_0x454f('0x39')][a131_0x454f('0x24')][a131_0x454f('0x47')](this[a131_0x454f('0x39')][_0x3ca6b3])){await _0x4c2cf7[a131_0x454f('0x39')][a131_0x454f('0x24')][a131_0x454f('0xd')](this[a131_0x454f('0x39')][_0x3ca6b3])['users'][a131_0x454f('0x11')]()[a131_0x454f('0x3f')](()=>{});const _0x21b7c1=_0x4c2cf7[a131_0x454f('0x39')][a131_0x454f('0x24')][a131_0x454f('0xd')](this['reactions'][_0x3ca6b3])[a131_0x454f('0x31')][a131_0x454f('0x24')][a131_0x454f('0x0')](_0x266bdf=>!_0x266bdf[a131_0x454f('0x1d')])['size'];_0x38201d[this[a131_0x454f('0x39')][_0x3ca6b3]]=_0x21b7c1;_0x31b8a9+=_0x21b7c1;}}return await _0x4afeef['channel'][a131_0x454f('0x30')]({'embed':{'color':tesseract_1[a131_0x454f('0x23')]['COLORS'][a131_0x454f('0x7')],'author':{'name':'POLL\x20STATUS'},'title':_0x4c2cf7[a131_0x454f('0x6')][0x0][a131_0x454f('0x1f')],'fields':_0x4c2cf7[a131_0x454f('0x6')][0x0][a131_0x454f('0x33')][a131_0x454f('0x40')](_0x5b7613=>({'name':_0x5b7613[a131_0x454f('0x2b')]+'\x20'+_0x5b7613[a131_0x454f('0x2d')],'value':(_0x38201d[_0x5b7613[a131_0x454f('0x2b')]]||0x0)+a131_0x454f('0xf')+_0x31b8a9+a131_0x454f('0x44')+(_0x38201d[_0x5b7613['name']]?_0x38201d[_0x5b7613[a131_0x454f('0x2b')]]/_0x31b8a9*0x64:0x0)['toFixed'](0x2)+'%)'})),'footer':{'text':_0x4c2cf7['id']+a131_0x454f('0x1')},'timestamp':_0x56cc0f[a131_0x454f('0x27')]}});}if(!_0x3699c2['_'][a131_0x454f('0x17')]||!_0x3699c2[a131_0x454f('0x29')]||!_0x3699c2[a131_0x454f('0x29')][a131_0x454f('0x17')])throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')]['INVALID_COMMAND_SYNTAX'],this[a131_0x454f('0x2b')]);const _0x51c921=_0x3699c2['_'][a131_0x454f('0x9')]('\x20');const _0x42f112=_0x3699c2[a131_0x454f('0x3d')]?_0x3699c2[a131_0x454f('0x3d')]:this['defaultTimeout'];if(constants['isPublicBastion'](this[a131_0x454f('0x20')]['user'])){const _0xd35038=await omnic[a131_0x454f('0x10')](_0x4afeef[a131_0x454f('0x12')])['catch'](()=>{});if(_0xd35038){if(_0xd35038===omnic[a131_0x454f('0x49')][a131_0x454f('0x2e')]&&_0x42f112>constants[a131_0x454f('0x41')][a131_0x454f('0x2e')][a131_0x454f('0x43')]){throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')][a131_0x454f('0x1c')],this[a131_0x454f('0x20')][a131_0x454f('0x38')]['getString'](_0x4afeef[a131_0x454f('0x12')][a131_0x454f('0x42')]['language'],a131_0x454f('0x2a'),a131_0x454f('0x3e'),constants[a131_0x454f('0x41')][a131_0x454f('0x2e')][a131_0x454f('0x43')]));}else if(_0xd35038===omnic[a131_0x454f('0x49')][a131_0x454f('0x3b')]&&_0x42f112>constants[a131_0x454f('0x41')][a131_0x454f('0x3b')][a131_0x454f('0x43')]){throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')][a131_0x454f('0x1c')],this[a131_0x454f('0x20')]['locale']['getString'](_0x4afeef['guild'][a131_0x454f('0x42')]['language'],'errors',a131_0x454f('0x3e'),constants[a131_0x454f('0x41')][a131_0x454f('0x3b')][a131_0x454f('0x43')]));}}else if(_0x42f112>constants['LIMITS']['POLL_TIMEOUT']){throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')][a131_0x454f('0x5')],this[a131_0x454f('0x20')][a131_0x454f('0x38')][a131_0x454f('0x2c')](_0x4afeef[a131_0x454f('0x12')][a131_0x454f('0x42')][a131_0x454f('0x14')],a131_0x454f('0x2a'),'premiumPollTimeout',constants['LIMITS'][a131_0x454f('0x43')]));}const _0x55fe86=await Poll_1[a131_0x454f('0x3a')]['countDocuments']({'guild':_0x4afeef[a131_0x454f('0x12')]['id'],'ends':{'$gte':new Date()}});if(_0xd35038){if(_0xd35038===omnic[a131_0x454f('0x49')][a131_0x454f('0x2e')]&&_0x55fe86>=constants['LIMITS'][a131_0x454f('0x2e')][a131_0x454f('0x19')]){throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')][a131_0x454f('0x1c')],this[a131_0x454f('0x20')]['locale'][a131_0x454f('0x2c')](_0x4afeef[a131_0x454f('0x12')][a131_0x454f('0x42')]['language'],a131_0x454f('0x2a'),a131_0x454f('0x34'),constants['LIMITS'][a131_0x454f('0x2e')][a131_0x454f('0x19')]));}else if(_0xd35038===omnic[a131_0x454f('0x49')][a131_0x454f('0x3b')]&&_0x55fe86>=constants[a131_0x454f('0x41')][a131_0x454f('0x3b')][a131_0x454f('0x19')]){throw new errors[(a131_0x454f('0x26'))](errors[a131_0x454f('0x15')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x454f('0x20')][a131_0x454f('0x38')][a131_0x454f('0x2c')](_0x4afeef[a131_0x454f('0x12')][a131_0x454f('0x42')]['language'],a131_0x454f('0x2a'),'membershipLimitPolls',constants['LIMITS']['PLATINUM'][a131_0x454f('0x19')]));}}else{throw new errors['DiscordError'](errors[a131_0x454f('0x15')]['PREMIUM_MEMBERSHIP_REQUIRED'],this[a131_0x454f('0x20')][a131_0x454f('0x38')][a131_0x454f('0x2c')](_0x4afeef[a131_0x454f('0x12')]['document'][a131_0x454f('0x14')],a131_0x454f('0x2a'),a131_0x454f('0x46'),constants[a131_0x454f('0x41')][a131_0x454f('0x19')]));}}const _0x122e74=new Date(Date[a131_0x454f('0x1e')]()+_0x42f112*0x36ee80);const _0x1c9ddc=await _0x4afeef[a131_0x454f('0x16')]['send']({'embed':{'color':tesseract_1[a131_0x454f('0x23')][a131_0x454f('0x35')][a131_0x454f('0x7')],'author':{'name':a131_0x454f('0x32')},'title':_0x51c921,'description':a131_0x454f('0x45'),'fields':_0x3699c2[a131_0x454f('0x29')][a131_0x454f('0x40')]((_0x85914c,_0x34d9e7)=>({'name':this[a131_0x454f('0x39')][_0x34d9e7],'value':_0x85914c})),'footer':{'text':'Ends'},'timestamp':_0x122e74}});await Poll_1[a131_0x454f('0x3a')][a131_0x454f('0x28')]({'_id':_0x1c9ddc['id'],'channel':_0x1c9ddc[a131_0x454f('0x16')]['id'],'guild':_0x1c9ddc['guild']['id'],'ends':_0x122e74});for(const _0x567b77 of this[a131_0x454f('0x39')]['slice'](0x0,_0x3699c2[a131_0x454f('0x29')][a131_0x454f('0x17')])){await _0x1c9ddc[a131_0x454f('0x18')](_0x567b77)[a131_0x454f('0x3f')](()=>{});}};this['reactions']=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this['defaultTimeout']=0x3;}};