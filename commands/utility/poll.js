const a131_0x52d7=['getString','LIMITED_PREMIUM_MEMBERSHIP','constructor','fields','fetch','document','fetchPremiumTier','membershipLimitPolls','premiumPolls','has','Ends','language','membershipLimitPollTimeout','channels','INVALID_COMMAND_SYNTAX','Constants','POLL_TIMEOUT','length','PREMIUM_MEMBERSHIP_REQUIRED','clamp','PremiumTier','toFixed','slice','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','bot','GOLD','DiscordError','../../utils/numbers','POLLS','size','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','BASTION_ERROR_TYPE','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','apply','Command','user','client','exec','get','map','../../utils/errors','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','reactions','timeout','value','cache','name','number','errors','status','COLORS','channel','guild','default','_id','@bastion/tesseract','option','IRIS','isPublicBastion','POLL\x20STATUS','now','PLATINUM','../../utils/omnic','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','locale','return\x20/\x22\x20+\x20this\x20+\x20\x22/','embeds','POLL','exports','catch','\x20votes\x20(','test','ends','\x20/\x20','join','users','defaultTimeout','LIMITS','poll','send','findOne','POLL_NOT_FOUND'];(function(_0x1cc31c,_0x52d7ee){const _0x768619=function(_0x212dd1){while(--_0x212dd1){_0x1cc31c['push'](_0x1cc31c['shift']());}};const _0x38658b=function(){const _0x5b713a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xa1523e,_0x526e02,_0x11380b,_0x3d2ac5){_0x3d2ac5=_0x3d2ac5||{};let _0x325bfc=_0x526e02+'='+_0x11380b;let _0x5b1848=0x0;for(let _0x5e8ac6=0x0,_0xce9fde=_0xa1523e['length'];_0x5e8ac6<_0xce9fde;_0x5e8ac6++){const _0x341aba=_0xa1523e[_0x5e8ac6];_0x325bfc+=';\x20'+_0x341aba;const _0x2db503=_0xa1523e[_0x341aba];_0xa1523e['push'](_0x2db503);_0xce9fde=_0xa1523e['length'];if(_0x2db503!==!![]){_0x325bfc+='='+_0x2db503;}}_0x3d2ac5['cookie']=_0x325bfc;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3b5bd8,_0x3f48b0){_0x3b5bd8=_0x3b5bd8||function(_0x352c1c){return _0x352c1c;};const _0x27897f=_0x3b5bd8(new RegExp('(?:^|;\x20)'+_0x3f48b0['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x1614a6=function(_0x438aa7,_0x26648f){_0x438aa7(++_0x26648f);};_0x1614a6(_0x768619,_0x52d7ee);return _0x27897f?decodeURIComponent(_0x27897f[0x1]):undefined;}};const _0x30309b=function(){const _0x23b6e2=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x23b6e2['test'](_0x5b713a['removeCookie']['toString']());};_0x5b713a['updateCookie']=_0x30309b;let _0x1ac019='';const _0x2e6b53=_0x5b713a['updateCookie']();if(!_0x2e6b53){_0x5b713a['setCookie'](['*'],'counter',0x1);}else if(_0x2e6b53){_0x1ac019=_0x5b713a['getCookie'](null,'counter');}else{_0x5b713a['removeCookie']();}};_0x38658b();}(a131_0x52d7,0xdc));const a131_0x7686=function(_0x1cc31c,_0x52d7ee){_0x1cc31c=_0x1cc31c-0x0;let _0x768619=a131_0x52d7[_0x1cc31c];return _0x768619;};const a131_0x5b713a=function(){let _0x2dc3fa=!![];return function(_0x1e9619,_0x3d341c){const _0x4d3951=_0x2dc3fa?function(){if(_0x3d341c){const _0x405c65=_0x3d341c[a131_0x7686('0x3b')](_0x1e9619,arguments);_0x3d341c=null;return _0x405c65;}}:function(){};_0x2dc3fa=![];return _0x4d3951;};}();const a131_0x212dd1=a131_0x5b713a(this,function(){const _0x4cd6b9=function(){const _0x30807b=_0x4cd6b9[a131_0x7686('0x1c')](a131_0x7686('0x9'))()['compile'](a131_0x7686('0x3a'));return!_0x30807b[a131_0x7686('0xf')](a131_0x212dd1);};return _0x4cd6b9();});a131_0x212dd1();'use strict';const tesseract_1=require(a131_0x7686('0x51'));const Poll_1=require('../../models/Poll');const constants=require('../../utils/constants');const errors=require(a131_0x7686('0x42'));const numbers=require(a131_0x7686('0x35'));const omnic=require(a131_0x7686('0x6'));module[a131_0x7686('0xc')]=class PollCommand extends tesseract_1[a131_0x7686('0x3c')]{constructor(){super(a131_0x7686('0x16'),{'description':a131_0x7686('0x31'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x7686('0x45')],'string':[a131_0x7686('0x0'),a131_0x7686('0x4b')],'coerce':{'timeout':_0x4e60c0=>typeof _0x4e60c0===a131_0x7686('0x49')&&numbers[a131_0x7686('0x2d')](_0x4e60c0,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a131_0x7686('0x4e'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':['MANAGE_CHANNELS'],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',a131_0x7686('0x7'),a131_0x7686('0x43')]});this[a131_0x7686('0x3f')]=async(_0xb98220,_0x25bba9)=>{if(_0x25bba9[a131_0x7686('0x4b')]){const _0x242fe4=await Poll_1[a131_0x7686('0x4f')][a131_0x7686('0x18')]({'_id':_0x25bba9[a131_0x7686('0x4b')],'guild':_0xb98220[a131_0x7686('0x4e')]['id']});if(!_0x242fe4)throw new Error(a131_0x7686('0x19'));if(!_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x27')][a131_0x7686('0x47')][a131_0x7686('0x23')](_0x242fe4[a131_0x7686('0x4d')]))throw new Error(a131_0x7686('0x19'));const _0x280379=_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x27')][a131_0x7686('0x47')][a131_0x7686('0x40')](_0x242fe4['channel']);const _0x37fb8e=await _0x280379['messages'][a131_0x7686('0x1e')](_0x242fe4[a131_0x7686('0x50')])[a131_0x7686('0xd')](()=>{});if(!_0x37fb8e)throw new Error(a131_0x7686('0x19'));const _0x1283c1=_0x37fb8e[a131_0x7686('0xa')][0x0]['fields'][a131_0x7686('0x41')](_0x1a19e8=>_0x1a19e8[a131_0x7686('0x46')]);const _0x21cf78={};let _0x1161b6=0x0;for(const _0x22c832 in this[a131_0x7686('0x44')]['slice'](0x0,_0x1283c1[a131_0x7686('0x2b')])){if(_0x37fb8e['reactions'][a131_0x7686('0x47')][a131_0x7686('0x23')](this[a131_0x7686('0x44')][_0x22c832])){await _0x37fb8e['reactions'][a131_0x7686('0x47')][a131_0x7686('0x40')](this[a131_0x7686('0x44')][_0x22c832])[a131_0x7686('0x13')][a131_0x7686('0x1e')]()['catch'](()=>{});const _0x20340f=_0x37fb8e[a131_0x7686('0x44')]['cache'][a131_0x7686('0x40')](this[a131_0x7686('0x44')][_0x22c832])[a131_0x7686('0x13')][a131_0x7686('0x47')]['filter'](_0x339eb3=>!_0x339eb3[a131_0x7686('0x32')])[a131_0x7686('0x37')];_0x21cf78[this[a131_0x7686('0x44')][_0x22c832]]=_0x20340f;_0x1161b6+=_0x20340f;}}return await _0xb98220[a131_0x7686('0x4d')][a131_0x7686('0x17')]({'embed':{'color':tesseract_1[a131_0x7686('0x29')]['COLORS'][a131_0x7686('0x1')],'author':{'name':a131_0x7686('0x3')},'title':_0x37fb8e[a131_0x7686('0xa')][0x0]['title'],'fields':_0x37fb8e[a131_0x7686('0xa')][0x0][a131_0x7686('0x1d')][a131_0x7686('0x41')](_0x1b3629=>({'name':_0x1b3629[a131_0x7686('0x48')]+'\x20'+_0x1b3629[a131_0x7686('0x46')],'value':(_0x21cf78[_0x1b3629[a131_0x7686('0x48')]]||0x0)+a131_0x7686('0x11')+_0x1161b6+a131_0x7686('0xe')+(_0x21cf78[_0x1b3629[a131_0x7686('0x48')]]?_0x21cf78[_0x1b3629[a131_0x7686('0x48')]]/_0x1161b6*0x64:0x0)[a131_0x7686('0x2f')](0x2)+'%)'})),'footer':{'text':_0x37fb8e['id']+'\x20â€¢\x20Ends'},'timestamp':_0x242fe4[a131_0x7686('0x10')]}});}if(!_0x25bba9['_']['length']||!_0x25bba9[a131_0x7686('0x0')]||!_0x25bba9['option'][a131_0x7686('0x2b')])throw new errors[(a131_0x7686('0x34'))](errors[a131_0x7686('0x39')][a131_0x7686('0x28')],this[a131_0x7686('0x48')]);const _0x476eed=_0x25bba9['_'][a131_0x7686('0x12')]('\x20');const _0x4e9397=_0x25bba9[a131_0x7686('0x45')]?_0x25bba9['timeout']:this[a131_0x7686('0x14')];if(constants[a131_0x7686('0x2')](this['client'][a131_0x7686('0x3d')])){const _0x3c4b9b=await omnic[a131_0x7686('0x20')](_0xb98220['guild'])[a131_0x7686('0xd')](()=>{});if(_0x3c4b9b){if(_0x3c4b9b===omnic[a131_0x7686('0x2e')][a131_0x7686('0x33')]&&_0x4e9397>constants[a131_0x7686('0x15')][a131_0x7686('0x33')][a131_0x7686('0x2a')]){throw new errors[(a131_0x7686('0x34'))](errors[a131_0x7686('0x39')][a131_0x7686('0x1b')],this[a131_0x7686('0x3e')][a131_0x7686('0x8')]['getString'](_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x1f')][a131_0x7686('0x25')],a131_0x7686('0x4a'),a131_0x7686('0x26'),constants[a131_0x7686('0x15')][a131_0x7686('0x33')][a131_0x7686('0x2a')]));}else if(_0x3c4b9b===omnic[a131_0x7686('0x2e')][a131_0x7686('0x5')]&&_0x4e9397>constants[a131_0x7686('0x15')][a131_0x7686('0x5')][a131_0x7686('0x2a')]){throw new errors['DiscordError'](errors[a131_0x7686('0x39')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x7686('0x3e')][a131_0x7686('0x8')][a131_0x7686('0x1a')](_0xb98220['guild']['document'][a131_0x7686('0x25')],a131_0x7686('0x4a'),'membershipLimitPollTimeout',constants[a131_0x7686('0x15')]['PLATINUM'][a131_0x7686('0x2a')]));}}else if(_0x4e9397>constants['LIMITS']['POLL_TIMEOUT']){throw new errors[(a131_0x7686('0x34'))](errors[a131_0x7686('0x39')][a131_0x7686('0x2c')],this[a131_0x7686('0x3e')][a131_0x7686('0x8')][a131_0x7686('0x1a')](_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x1f')][a131_0x7686('0x25')],a131_0x7686('0x4a'),'premiumPollTimeout',constants[a131_0x7686('0x15')][a131_0x7686('0x2a')]));}const _0x3cffd3=await Poll_1['default']['countDocuments']({'guild':_0xb98220[a131_0x7686('0x4e')]['id'],'ends':{'$gte':new Date()}});if(_0x3c4b9b){if(_0x3c4b9b===omnic[a131_0x7686('0x2e')][a131_0x7686('0x33')]&&_0x3cffd3>=constants[a131_0x7686('0x15')][a131_0x7686('0x33')]['POLLS']){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this['client']['locale'][a131_0x7686('0x1a')](_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x1f')][a131_0x7686('0x25')],a131_0x7686('0x4a'),a131_0x7686('0x21'),constants[a131_0x7686('0x15')][a131_0x7686('0x33')]['POLLS']));}else if(_0x3c4b9b===omnic[a131_0x7686('0x2e')][a131_0x7686('0x5')]&&_0x3cffd3>=constants[a131_0x7686('0x15')]['PLATINUM'][a131_0x7686('0x36')]){throw new errors[(a131_0x7686('0x34'))](errors[a131_0x7686('0x39')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x7686('0x3e')][a131_0x7686('0x8')][a131_0x7686('0x1a')](_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x1f')][a131_0x7686('0x25')],a131_0x7686('0x4a'),'membershipLimitPolls',constants[a131_0x7686('0x15')][a131_0x7686('0x5')][a131_0x7686('0x36')]));}}else{throw new errors[(a131_0x7686('0x34'))](errors['BASTION_ERROR_TYPE'][a131_0x7686('0x2c')],this[a131_0x7686('0x3e')][a131_0x7686('0x8')]['getString'](_0xb98220[a131_0x7686('0x4e')][a131_0x7686('0x1f')][a131_0x7686('0x25')],a131_0x7686('0x4a'),a131_0x7686('0x22'),constants[a131_0x7686('0x15')][a131_0x7686('0x36')]));}}const _0x5e78ac=new Date(Date[a131_0x7686('0x4')]()+_0x4e9397*0x36ee80);const _0x2ec8a1=await _0xb98220[a131_0x7686('0x4d')][a131_0x7686('0x17')]({'embed':{'color':tesseract_1[a131_0x7686('0x29')][a131_0x7686('0x4c')][a131_0x7686('0x1')],'author':{'name':a131_0x7686('0xb')},'title':_0x476eed,'description':a131_0x7686('0x38'),'fields':_0x25bba9[a131_0x7686('0x0')][a131_0x7686('0x41')]((_0x33b5df,_0x155fb4)=>({'name':this['reactions'][_0x155fb4],'value':_0x33b5df})),'footer':{'text':a131_0x7686('0x24')},'timestamp':_0x5e78ac}});await Poll_1[a131_0x7686('0x4f')]['create']({'_id':_0x2ec8a1['id'],'channel':_0x2ec8a1['channel']['id'],'guild':_0x2ec8a1[a131_0x7686('0x4e')]['id'],'ends':_0x5e78ac});for(const _0x3d1dd7 of this['reactions'][a131_0x7686('0x30')](0x0,_0x25bba9['option']['length'])){await _0x2ec8a1['react'](_0x3d1dd7)[a131_0x7686('0xd')](()=>{});}};this[a131_0x7686('0x44')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this['defaultTimeout']=0x3;}};