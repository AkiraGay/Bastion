const a131_0x5e1f=['fields','embeds','../../utils/numbers','_id','GOLD','join','status','LIMITED_PREMIUM_MEMBERSHIP','membershipLimitPolls','fetch','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','has','channel','premiumPollTimeout','countDocuments','Command','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','number','catch','exec','cache','users','locale','POLL\x20STATUS','guild','@bastion/tesseract','default','clamp','POLL','filter','defaultTimeout','client','test','poll','length','POLL_TIMEOUT','membershipLimitPollTimeout','POLLS','map','../../utils/constants','COLORS','PREMIUM_MEMBERSHIP_REQUIRED','size','channels','send','\x20/\x20','DiscordError','slice','language','IRIS','constructor','MANAGE_CHANNELS','ends','../../utils/omnic','option','name','\x20votes\x20(','bot','BASTION_ERROR_TYPE','PLATINUM','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','Constants','react','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','value','errors','get','reactions','create','getString','user','toFixed','document','Ends','premiumPolls','LIMITS','PremiumTier','timeout','POLL_NOT_FOUND'];(function(_0x13d59b,_0x5e1f45){const _0x9bd3fe=function(_0xa02cd9){while(--_0xa02cd9){_0x13d59b['push'](_0x13d59b['shift']());}};const _0x37821b=function(){const _0x277de0={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x58f711,_0x494b2f,_0x35c372,_0x428c7f){_0x428c7f=_0x428c7f||{};let _0x1122fc=_0x494b2f+'='+_0x35c372;let _0x52cdb7=0x0;for(let _0x431e6b=0x0,_0x580639=_0x58f711['length'];_0x431e6b<_0x580639;_0x431e6b++){const _0x468802=_0x58f711[_0x431e6b];_0x1122fc+=';\x20'+_0x468802;const _0x1d6ece=_0x58f711[_0x468802];_0x58f711['push'](_0x1d6ece);_0x580639=_0x58f711['length'];if(_0x1d6ece!==!![]){_0x1122fc+='='+_0x1d6ece;}}_0x428c7f['cookie']=_0x1122fc;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5a06f4,_0x33f300){_0x5a06f4=_0x5a06f4||function(_0x3ccafd){return _0x3ccafd;};const _0x379863=_0x5a06f4(new RegExp('(?:^|;\x20)'+_0x33f300['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x894dbe=function(_0xcd368f,_0x1ac6bc){_0xcd368f(++_0x1ac6bc);};_0x894dbe(_0x9bd3fe,_0x5e1f45);return _0x379863?decodeURIComponent(_0x379863[0x1]):undefined;}};const _0x435c06=function(){const _0xefb5e=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xefb5e['test'](_0x277de0['removeCookie']['toString']());};_0x277de0['updateCookie']=_0x435c06;let _0x56e54e='';const _0x360fe8=_0x277de0['updateCookie']();if(!_0x360fe8){_0x277de0['setCookie'](['*'],'counter',0x1);}else if(_0x360fe8){_0x56e54e=_0x277de0['getCookie'](null,'counter');}else{_0x277de0['removeCookie']();}};_0x37821b();}(a131_0x5e1f,0xb7));const a131_0x9bd3=function(_0x13d59b,_0x5e1f45){_0x13d59b=_0x13d59b-0x0;let _0x9bd3fe=a131_0x5e1f[_0x13d59b];return _0x9bd3fe;};const a131_0x277de0=function(){let _0x5c0d92=!![];return function(_0x1c44ba,_0x3a3b7f){const _0x26c4e7=_0x5c0d92?function(){if(_0x3a3b7f){const _0x357608=_0x3a3b7f['apply'](_0x1c44ba,arguments);_0x3a3b7f=null;return _0x357608;}}:function(){};_0x5c0d92=![];return _0x26c4e7;};}();const a131_0xa02cd9=a131_0x277de0(this,function(){const _0x562c0b=function(){const _0x1a4610=_0x562c0b[a131_0x9bd3('0x19')]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()['compile'](a131_0x9bd3('0x26'));return!_0x1a4610[a131_0x9bd3('0x7')](a131_0xa02cd9);};return _0x562c0b();});a131_0xa02cd9();'use strict';const tesseract_1=require(a131_0x9bd3('0x0'));const Poll_1=require('../../models/Poll');const constants=require(a131_0x9bd3('0xe'));const errors=require('../../utils/errors');const numbers=require(a131_0x9bd3('0x38'));const omnic=require(a131_0x9bd3('0x1c'));module['exports']=class PollCommand extends tesseract_1[a131_0x9bd3('0x45')]{constructor(){super(a131_0x9bd3('0x8'),{'description':a131_0x9bd3('0x46'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x9bd3('0x34')],'string':[a131_0x9bd3('0x1d'),a131_0x9bd3('0x3c')],'coerce':{'timeout':_0x5f448d=>typeof _0x5f448d===a131_0x9bd3('0x47')&&numbers[a131_0x9bd3('0x2')](_0x5f448d,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[a131_0x9bd3('0x1a')],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',a131_0x9bd3('0x40'),'poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION']});this[a131_0x9bd3('0x49')]=async(_0xfadaa8,_0x441968)=>{if(_0x441968[a131_0x9bd3('0x3c')]){const _0x3b6d9d=await Poll_1[a131_0x9bd3('0x1')]['findOne']({'_id':_0x441968['status'],'guild':_0xfadaa8[a131_0x9bd3('0x4e')]['id']});if(!_0x3b6d9d)throw new Error(a131_0x9bd3('0x35'));if(!_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x12')][a131_0x9bd3('0x4a')][a131_0x9bd3('0x41')](_0x3b6d9d[a131_0x9bd3('0x42')]))throw new Error('POLL_NOT_FOUND');const _0x2cf227=_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x12')][a131_0x9bd3('0x4a')][a131_0x9bd3('0x29')](_0x3b6d9d['channel']);const _0x45fdfc=await _0x2cf227['messages'][a131_0x9bd3('0x3f')](_0x3b6d9d[a131_0x9bd3('0x39')])[a131_0x9bd3('0x48')](()=>{});if(!_0x45fdfc)throw new Error(a131_0x9bd3('0x35'));const _0x2c8114=_0x45fdfc[a131_0x9bd3('0x37')][0x0][a131_0x9bd3('0x36')][a131_0x9bd3('0xd')](_0x34f637=>_0x34f637[a131_0x9bd3('0x27')]);const _0x29edd7={};let _0x2c7aa4=0x0;for(const _0x2588d3 in this[a131_0x9bd3('0x2a')][a131_0x9bd3('0x16')](0x0,_0x2c8114['length'])){if(_0x45fdfc[a131_0x9bd3('0x2a')][a131_0x9bd3('0x4a')]['has'](this[a131_0x9bd3('0x2a')][_0x2588d3])){await _0x45fdfc[a131_0x9bd3('0x2a')][a131_0x9bd3('0x4a')][a131_0x9bd3('0x29')](this[a131_0x9bd3('0x2a')][_0x2588d3])[a131_0x9bd3('0x4b')][a131_0x9bd3('0x3f')]()[a131_0x9bd3('0x48')](()=>{});const _0x1f961b=_0x45fdfc[a131_0x9bd3('0x2a')][a131_0x9bd3('0x4a')]['get'](this['reactions'][_0x2588d3])['users']['cache'][a131_0x9bd3('0x4')](_0x4508e7=>!_0x4508e7[a131_0x9bd3('0x20')])[a131_0x9bd3('0x11')];_0x29edd7[this['reactions'][_0x2588d3]]=_0x1f961b;_0x2c7aa4+=_0x1f961b;}}return await _0xfadaa8[a131_0x9bd3('0x42')][a131_0x9bd3('0x13')]({'embed':{'color':tesseract_1[a131_0x9bd3('0x24')][a131_0x9bd3('0xf')]['IRIS'],'author':{'name':a131_0x9bd3('0x4d')},'title':_0x45fdfc['embeds'][0x0]['title'],'fields':_0x45fdfc[a131_0x9bd3('0x37')][0x0][a131_0x9bd3('0x36')][a131_0x9bd3('0xd')](_0x2b05e9=>({'name':_0x2b05e9['name']+'\x20'+_0x2b05e9[a131_0x9bd3('0x27')],'value':(_0x29edd7[_0x2b05e9[a131_0x9bd3('0x1e')]]||0x0)+a131_0x9bd3('0x14')+_0x2c7aa4+a131_0x9bd3('0x1f')+(_0x29edd7[_0x2b05e9[a131_0x9bd3('0x1e')]]?_0x29edd7[_0x2b05e9['name']]/_0x2c7aa4*0x64:0x0)[a131_0x9bd3('0x2e')](0x2)+'%)'})),'footer':{'text':_0x45fdfc['id']+'\x20â€¢\x20Ends'},'timestamp':_0x3b6d9d[a131_0x9bd3('0x1b')]}});}if(!_0x441968['_'][a131_0x9bd3('0x9')]||!_0x441968['option']||!_0x441968['option'][a131_0x9bd3('0x9')])throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')]['INVALID_COMMAND_SYNTAX'],this['name']);const _0x18b35f=_0x441968['_'][a131_0x9bd3('0x3b')]('\x20');const _0xe336c0=_0x441968[a131_0x9bd3('0x34')]?_0x441968[a131_0x9bd3('0x34')]:this['defaultTimeout'];if(constants['isPublicBastion'](this[a131_0x9bd3('0x6')][a131_0x9bd3('0x2d')])){const _0x2041f1=await omnic['fetchPremiumTier'](_0xfadaa8['guild'])[a131_0x9bd3('0x48')](()=>{});if(_0x2041f1){if(_0x2041f1===omnic[a131_0x9bd3('0x33')][a131_0x9bd3('0x3a')]&&_0xe336c0>constants[a131_0x9bd3('0x32')][a131_0x9bd3('0x3a')][a131_0x9bd3('0xa')]){throw new errors[(a131_0x9bd3('0x15'))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][a131_0x9bd3('0x4c')][a131_0x9bd3('0x2c')](_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x2f')][a131_0x9bd3('0x17')],a131_0x9bd3('0x28'),a131_0x9bd3('0xb'),constants['LIMITS']['GOLD'][a131_0x9bd3('0xa')]));}else if(_0x2041f1===omnic['PremiumTier'][a131_0x9bd3('0x22')]&&_0xe336c0>constants[a131_0x9bd3('0x32')][a131_0x9bd3('0x22')][a131_0x9bd3('0xa')]){throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')][a131_0x9bd3('0x3d')],this['client'][a131_0x9bd3('0x4c')][a131_0x9bd3('0x2c')](_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x2f')][a131_0x9bd3('0x17')],a131_0x9bd3('0x28'),a131_0x9bd3('0xb'),constants[a131_0x9bd3('0x32')][a131_0x9bd3('0x22')][a131_0x9bd3('0xa')]));}}else if(_0xe336c0>constants['LIMITS'][a131_0x9bd3('0xa')]){throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')][a131_0x9bd3('0x10')],this[a131_0x9bd3('0x6')][a131_0x9bd3('0x4c')]['getString'](_0xfadaa8[a131_0x9bd3('0x4e')]['document'][a131_0x9bd3('0x17')],a131_0x9bd3('0x28'),a131_0x9bd3('0x43'),constants[a131_0x9bd3('0x32')][a131_0x9bd3('0xa')]));}const _0x3ecd6c=await Poll_1[a131_0x9bd3('0x1')][a131_0x9bd3('0x44')]({'guild':_0xfadaa8['guild']['id'],'ends':{'$gte':new Date()}});if(_0x2041f1){if(_0x2041f1===omnic[a131_0x9bd3('0x33')][a131_0x9bd3('0x3a')]&&_0x3ecd6c>=constants['LIMITS'][a131_0x9bd3('0x3a')][a131_0x9bd3('0xc')]){throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x9bd3('0x6')]['locale'][a131_0x9bd3('0x2c')](_0xfadaa8[a131_0x9bd3('0x4e')]['document'][a131_0x9bd3('0x17')],'errors',a131_0x9bd3('0x3e'),constants[a131_0x9bd3('0x32')][a131_0x9bd3('0x3a')][a131_0x9bd3('0xc')]));}else if(_0x2041f1===omnic[a131_0x9bd3('0x33')]['PLATINUM']&&_0x3ecd6c>=constants['LIMITS']['PLATINUM'][a131_0x9bd3('0xc')]){throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')][a131_0x9bd3('0x3d')],this[a131_0x9bd3('0x6')][a131_0x9bd3('0x4c')][a131_0x9bd3('0x2c')](_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x2f')][a131_0x9bd3('0x17')],a131_0x9bd3('0x28'),'membershipLimitPolls',constants[a131_0x9bd3('0x32')][a131_0x9bd3('0x22')][a131_0x9bd3('0xc')]));}}else{throw new errors[(a131_0x9bd3('0x15'))](errors[a131_0x9bd3('0x21')][a131_0x9bd3('0x10')],this[a131_0x9bd3('0x6')]['locale'][a131_0x9bd3('0x2c')](_0xfadaa8[a131_0x9bd3('0x4e')][a131_0x9bd3('0x2f')]['language'],'errors',a131_0x9bd3('0x31'),constants[a131_0x9bd3('0x32')]['POLLS']));}}const _0x82a382=new Date(Date['now']()+_0xe336c0*0x36ee80);const _0xc2d6f=await _0xfadaa8['channel']['send']({'embed':{'color':tesseract_1[a131_0x9bd3('0x24')][a131_0x9bd3('0xf')][a131_0x9bd3('0x18')],'author':{'name':a131_0x9bd3('0x3')},'title':_0x18b35f,'description':a131_0x9bd3('0x23'),'fields':_0x441968[a131_0x9bd3('0x1d')][a131_0x9bd3('0xd')]((_0x37a062,_0x4f21ad)=>({'name':this[a131_0x9bd3('0x2a')][_0x4f21ad],'value':_0x37a062})),'footer':{'text':a131_0x9bd3('0x30')},'timestamp':_0x82a382}});await Poll_1[a131_0x9bd3('0x1')][a131_0x9bd3('0x2b')]({'_id':_0xc2d6f['id'],'channel':_0xc2d6f[a131_0x9bd3('0x42')]['id'],'guild':_0xc2d6f[a131_0x9bd3('0x4e')]['id'],'ends':_0x82a382});for(const _0x3dcef5 of this[a131_0x9bd3('0x2a')][a131_0x9bd3('0x16')](0x0,_0x441968[a131_0x9bd3('0x1d')][a131_0x9bd3('0x9')])){await _0xc2d6f[a131_0x9bd3('0x25')](_0x3dcef5)['catch'](()=>{});}};this[a131_0x9bd3('0x2a')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a131_0x9bd3('0x5')]=0x3;}};