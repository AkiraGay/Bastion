const a131_0x1e5e=['^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','slice','PLATINUM','document','test','language','cache','membershipLimitPollTimeout','name','length','LIMITED_PREMIUM_MEMBERSHIP','INVALID_COMMAND_SYNTAX','membershipLimitPolls','bot','../../utils/errors','ends','isPublicBastion','clamp','getString','errors','POLL\x20STATUS','status','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','COLORS','reactions','defaultTimeout','title','join','users','timeout','Command','constructor','@bastion/tesseract','fetch','compile','\x20â€¢\x20Ends','premiumPollTimeout','../../utils/omnic','apply','_id','map','embeds','../../models/Poll','create','LIMITS','return\x20/\x22\x20+\x20this\x20+\x20\x22/','client','IRIS','POLLS','locale','react','exports','size','user','send','default','option','channels','\x20votes\x20(','../../utils/constants','messages','PremiumTier','PREMIUM_MEMBERSHIP_REQUIRED','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','channel','premiumPolls','catch','GOLD','guild','Constants','POLL_TIMEOUT','get','POLL_NOT_FOUND','countDocuments','fields','poll\x20--status\x20POLL_MESSAGE_ID','BASTION_ERROR_TYPE','DiscordError','POLL','poll'];(function(_0x21a5e9,_0x1e5e75){const _0x60fa3d=function(_0x1da06e){while(--_0x1da06e){_0x21a5e9['push'](_0x21a5e9['shift']());}};const _0x5a2c19=function(){const _0x1edd05={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x21d195,_0x2c78a9,_0x378e3d,_0x1b12d4){_0x1b12d4=_0x1b12d4||{};let _0x392d65=_0x2c78a9+'='+_0x378e3d;let _0x22c013=0x0;for(let _0x3618c4=0x0,_0x23e7c7=_0x21d195['length'];_0x3618c4<_0x23e7c7;_0x3618c4++){const _0x5d4574=_0x21d195[_0x3618c4];_0x392d65+=';\x20'+_0x5d4574;const _0x51f1fa=_0x21d195[_0x5d4574];_0x21d195['push'](_0x51f1fa);_0x23e7c7=_0x21d195['length'];if(_0x51f1fa!==!![]){_0x392d65+='='+_0x51f1fa;}}_0x1b12d4['cookie']=_0x392d65;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4042d2,_0x2b5763){_0x4042d2=_0x4042d2||function(_0x3e25ff){return _0x3e25ff;};const _0x170196=_0x4042d2(new RegExp('(?:^|;\x20)'+_0x2b5763['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x81b06a=function(_0x4c123c,_0x187ce7){_0x4c123c(++_0x187ce7);};_0x81b06a(_0x60fa3d,_0x1e5e75);return _0x170196?decodeURIComponent(_0x170196[0x1]):undefined;}};const _0x1f7c05=function(){const _0x4ac764=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x4ac764['test'](_0x1edd05['removeCookie']['toString']());};_0x1edd05['updateCookie']=_0x1f7c05;let _0xab7c5f='';const _0x2d9868=_0x1edd05['updateCookie']();if(!_0x2d9868){_0x1edd05['setCookie'](['*'],'counter',0x1);}else if(_0x2d9868){_0xab7c5f=_0x1edd05['getCookie'](null,'counter');}else{_0x1edd05['removeCookie']();}};_0x5a2c19();}(a131_0x1e5e,0x6c));const a131_0x60fa=function(_0x21a5e9,_0x1e5e75){_0x21a5e9=_0x21a5e9-0x0;let _0x60fa3d=a131_0x1e5e[_0x21a5e9];return _0x60fa3d;};const a131_0x1edd05=function(){let _0x585561=!![];return function(_0x3f275a,_0x1ae209){const _0x5b2cda=_0x585561?function(){if(_0x1ae209){const _0xcbc076=_0x1ae209[a131_0x60fa('0xc')](_0x3f275a,arguments);_0x1ae209=null;return _0xcbc076;}}:function(){};_0x585561=![];return _0x5b2cda;};}();const a131_0x1da06e=a131_0x1edd05(this,function(){const _0x121b43=function(){const _0x5c3644=_0x121b43[a131_0x60fa('0x5')](a131_0x60fa('0x13'))()[a131_0x60fa('0x8')](a131_0x60fa('0x36'));return!_0x5c3644[a131_0x60fa('0x3b')](a131_0x1da06e);};return _0x121b43();});a131_0x1da06e();'use strict';const tesseract_1=require(a131_0x60fa('0x6'));const Poll_1=require(a131_0x60fa('0x10'));const constants=require(a131_0x60fa('0x21'));const errors=require(a131_0x60fa('0x45'));const numbers=require('../../utils/numbers');const omnic=require(a131_0x60fa('0xb'));module[a131_0x60fa('0x19')]=class PollCommand extends tesseract_1[a131_0x60fa('0x4')]{constructor(){super(a131_0x60fa('0x35'),{'description':a131_0x60fa('0x25'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x60fa('0x3')],'string':['option',a131_0x60fa('0x4c')],'coerce':{'timeout':_0x271d02=>typeof _0x271d02==='number'&&numbers[a131_0x60fa('0x48')](_0x271d02,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a131_0x60fa('0x2a'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':['MANAGE_CHANNELS'],'syntax':[a131_0x60fa('0x31'),a131_0x60fa('0x37'),a131_0x60fa('0x4d')]});this['exec']=async(_0x38c411,_0x5d09d9)=>{if(_0x5d09d9['status']){const _0x855605=await Poll_1['default']['findOne']({'_id':_0x5d09d9[a131_0x60fa('0x4c')],'guild':_0x38c411['guild']['id']});if(!_0x855605)throw new Error(a131_0x60fa('0x2e'));if(!_0x38c411[a131_0x60fa('0x2a')]['channels'][a131_0x60fa('0x3d')]['has'](_0x855605[a131_0x60fa('0x26')]))throw new Error(a131_0x60fa('0x2e'));const _0x25048f=_0x38c411['guild'][a131_0x60fa('0x1f')]['cache'][a131_0x60fa('0x2d')](_0x855605[a131_0x60fa('0x26')]);const _0x1d19eb=await _0x25048f[a131_0x60fa('0x22')]['fetch'](_0x855605[a131_0x60fa('0xd')])['catch'](()=>{});if(!_0x1d19eb)throw new Error('POLL_NOT_FOUND');const _0x4bd7fe=_0x1d19eb['embeds'][0x0]['fields'][a131_0x60fa('0xe')](_0x5b3510=>_0x5b3510['value']);const _0x4f0da9={};let _0xb01b59=0x0;for(const _0x2d7074 in this[a131_0x60fa('0x4f')][a131_0x60fa('0x38')](0x0,_0x4bd7fe[a131_0x60fa('0x40')])){if(_0x1d19eb[a131_0x60fa('0x4f')]['cache']['has'](this['reactions'][_0x2d7074])){await _0x1d19eb['reactions'][a131_0x60fa('0x3d')][a131_0x60fa('0x2d')](this[a131_0x60fa('0x4f')][_0x2d7074])[a131_0x60fa('0x2')][a131_0x60fa('0x7')]()['catch'](()=>{});const _0x269971=_0x1d19eb['reactions'][a131_0x60fa('0x3d')][a131_0x60fa('0x2d')](this[a131_0x60fa('0x4f')][_0x2d7074])[a131_0x60fa('0x2')][a131_0x60fa('0x3d')]['filter'](_0xc0bd2d=>!_0xc0bd2d[a131_0x60fa('0x44')])[a131_0x60fa('0x1a')];_0x4f0da9[this[a131_0x60fa('0x4f')][_0x2d7074]]=_0x269971;_0xb01b59+=_0x269971;}}return await _0x38c411[a131_0x60fa('0x26')]['send']({'embed':{'color':tesseract_1[a131_0x60fa('0x2b')][a131_0x60fa('0x4e')][a131_0x60fa('0x15')],'author':{'name':a131_0x60fa('0x4b')},'title':_0x1d19eb['embeds'][0x0][a131_0x60fa('0x0')],'fields':_0x1d19eb[a131_0x60fa('0xf')][0x0][a131_0x60fa('0x30')][a131_0x60fa('0xe')](_0x4d09e6=>({'name':_0x4d09e6['name']+'\x20'+_0x4d09e6['value'],'value':(_0x4f0da9[_0x4d09e6[a131_0x60fa('0x3f')]]||0x0)+'\x20/\x20'+_0xb01b59+a131_0x60fa('0x20')+(_0x4f0da9[_0x4d09e6[a131_0x60fa('0x3f')]]?_0x4f0da9[_0x4d09e6['name']]/_0xb01b59*0x64:0x0)['toFixed'](0x2)+'%)'})),'footer':{'text':_0x1d19eb['id']+a131_0x60fa('0x9')},'timestamp':_0x855605[a131_0x60fa('0x46')]}});}if(!_0x5d09d9['_'][a131_0x60fa('0x40')]||!_0x5d09d9[a131_0x60fa('0x1e')]||!_0x5d09d9[a131_0x60fa('0x1e')][a131_0x60fa('0x40')])throw new errors['DiscordError'](errors[a131_0x60fa('0x32')][a131_0x60fa('0x42')],this[a131_0x60fa('0x3f')]);const _0x2382e9=_0x5d09d9['_'][a131_0x60fa('0x1')]('\x20');const _0x3b7861=_0x5d09d9['timeout']?_0x5d09d9[a131_0x60fa('0x3')]:this[a131_0x60fa('0x50')];if(constants[a131_0x60fa('0x47')](this[a131_0x60fa('0x14')][a131_0x60fa('0x1b')])){const _0x3e9fe3=await omnic['fetchPremiumTier'](_0x38c411[a131_0x60fa('0x2a')])[a131_0x60fa('0x28')](()=>{});if(_0x3e9fe3){if(_0x3e9fe3===omnic[a131_0x60fa('0x23')][a131_0x60fa('0x29')]&&_0x3b7861>constants[a131_0x60fa('0x12')]['GOLD']['POLL_TIMEOUT']){throw new errors[(a131_0x60fa('0x33'))](errors[a131_0x60fa('0x32')][a131_0x60fa('0x41')],this[a131_0x60fa('0x14')][a131_0x60fa('0x17')][a131_0x60fa('0x49')](_0x38c411[a131_0x60fa('0x2a')]['document']['language'],a131_0x60fa('0x4a'),a131_0x60fa('0x3e'),constants[a131_0x60fa('0x12')][a131_0x60fa('0x29')][a131_0x60fa('0x2c')]));}else if(_0x3e9fe3===omnic[a131_0x60fa('0x23')][a131_0x60fa('0x39')]&&_0x3b7861>constants[a131_0x60fa('0x12')][a131_0x60fa('0x39')]['POLL_TIMEOUT']){throw new errors[(a131_0x60fa('0x33'))](errors['BASTION_ERROR_TYPE'][a131_0x60fa('0x41')],this[a131_0x60fa('0x14')][a131_0x60fa('0x17')][a131_0x60fa('0x49')](_0x38c411[a131_0x60fa('0x2a')][a131_0x60fa('0x3a')][a131_0x60fa('0x3c')],a131_0x60fa('0x4a'),a131_0x60fa('0x3e'),constants[a131_0x60fa('0x12')]['PLATINUM'][a131_0x60fa('0x2c')]));}}else if(_0x3b7861>constants[a131_0x60fa('0x12')]['POLL_TIMEOUT']){throw new errors[(a131_0x60fa('0x33'))](errors[a131_0x60fa('0x32')]['PREMIUM_MEMBERSHIP_REQUIRED'],this['client'][a131_0x60fa('0x17')][a131_0x60fa('0x49')](_0x38c411['guild'][a131_0x60fa('0x3a')][a131_0x60fa('0x3c')],a131_0x60fa('0x4a'),a131_0x60fa('0xa'),constants[a131_0x60fa('0x12')][a131_0x60fa('0x2c')]));}const _0x142373=await Poll_1[a131_0x60fa('0x1d')][a131_0x60fa('0x2f')]({'guild':_0x38c411['guild']['id'],'ends':{'$gte':new Date()}});if(_0x3e9fe3){if(_0x3e9fe3===omnic['PremiumTier']['GOLD']&&_0x142373>=constants['LIMITS'][a131_0x60fa('0x29')][a131_0x60fa('0x16')]){throw new errors[(a131_0x60fa('0x33'))](errors[a131_0x60fa('0x32')][a131_0x60fa('0x41')],this['client'][a131_0x60fa('0x17')]['getString'](_0x38c411[a131_0x60fa('0x2a')]['document'][a131_0x60fa('0x3c')],'errors',a131_0x60fa('0x43'),constants[a131_0x60fa('0x12')][a131_0x60fa('0x29')][a131_0x60fa('0x16')]));}else if(_0x3e9fe3===omnic[a131_0x60fa('0x23')][a131_0x60fa('0x39')]&&_0x142373>=constants[a131_0x60fa('0x12')]['PLATINUM'][a131_0x60fa('0x16')]){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a131_0x60fa('0x41')],this[a131_0x60fa('0x14')]['locale'][a131_0x60fa('0x49')](_0x38c411[a131_0x60fa('0x2a')]['document'][a131_0x60fa('0x3c')],a131_0x60fa('0x4a'),a131_0x60fa('0x43'),constants[a131_0x60fa('0x12')][a131_0x60fa('0x39')][a131_0x60fa('0x16')]));}}else{throw new errors[(a131_0x60fa('0x33'))](errors[a131_0x60fa('0x32')][a131_0x60fa('0x24')],this[a131_0x60fa('0x14')][a131_0x60fa('0x17')][a131_0x60fa('0x49')](_0x38c411[a131_0x60fa('0x2a')][a131_0x60fa('0x3a')][a131_0x60fa('0x3c')],a131_0x60fa('0x4a'),a131_0x60fa('0x27'),constants[a131_0x60fa('0x12')][a131_0x60fa('0x16')]));}}const _0x3e4a89=new Date(Date['now']()+_0x3b7861*0x36ee80);const _0x3619c2=await _0x38c411[a131_0x60fa('0x26')][a131_0x60fa('0x1c')]({'embed':{'color':tesseract_1[a131_0x60fa('0x2b')][a131_0x60fa('0x4e')][a131_0x60fa('0x15')],'author':{'name':a131_0x60fa('0x34')},'title':_0x2382e9,'description':'React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','fields':_0x5d09d9[a131_0x60fa('0x1e')][a131_0x60fa('0xe')]((_0x3ed970,_0x905993)=>({'name':this[a131_0x60fa('0x4f')][_0x905993],'value':_0x3ed970})),'footer':{'text':'Ends'},'timestamp':_0x3e4a89}});await Poll_1[a131_0x60fa('0x1d')][a131_0x60fa('0x11')]({'_id':_0x3619c2['id'],'channel':_0x3619c2['channel']['id'],'guild':_0x3619c2[a131_0x60fa('0x2a')]['id'],'ends':_0x3e4a89});for(const _0x501660 of this['reactions']['slice'](0x0,_0x5d09d9['option'][a131_0x60fa('0x40')])){await _0x3619c2[a131_0x60fa('0x18')](_0x501660)[a131_0x60fa('0x28')](()=>{});}};this[a131_0x60fa('0x4f')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a131_0x60fa('0x50')]=0x3;}};