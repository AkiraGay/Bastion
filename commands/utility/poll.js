const a132_0x2029=['PremiumTier','status','POLL_TIMEOUT','send','test','option','LIMITED_PREMIUM_MEMBERSHIP','ends','\x20/\x20','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','guild','channels','number','length','\x20â€¢\x20Ends','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','now','Constants','GOLD','findOne','has','getString','membershipLimitPolls','name','user','DiscordError','POLL_NOT_FOUND','client','premiumPollTimeout','LIMITS','_id','../../utils/errors','compile','isPublicBastion','cache','title','PREMIUM_MEMBERSHIP_REQUIRED','\x20votes\x20(','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','map','filter','fields','errors','Ends','fetch','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','catch','constructor','slice','apply','COLORS','channel','../../utils/numbers','Command','create','messages','locale','return\x20/\x22\x20+\x20this\x20+\x20\x22/','IRIS','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','defaultTimeout','embeds','poll','POLLS','countDocuments','exec','premiumPolls','timeout','POLL\x20STATUS','PLATINUM','default','@bastion/tesseract','get','users','membershipLimitPollTimeout','fetchPremiumTier','document','value','clamp','reactions','language','toFixed','BASTION_ERROR_TYPE'];(function(_0x5edfba,_0x2029a5){const _0x392128=function(_0x1f092b){while(--_0x1f092b){_0x5edfba['push'](_0x5edfba['shift']());}};const _0x149928=function(){const _0x537e40={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x203019,_0x166345,_0x348682,_0x2c8fd2){_0x2c8fd2=_0x2c8fd2||{};let _0x2e2aeb=_0x166345+'='+_0x348682;let _0x54f1f7=0x0;for(let _0x4e2066=0x0,_0x3533ab=_0x203019['length'];_0x4e2066<_0x3533ab;_0x4e2066++){const _0x3257bf=_0x203019[_0x4e2066];_0x2e2aeb+=';\x20'+_0x3257bf;const _0x4b18cb=_0x203019[_0x3257bf];_0x203019['push'](_0x4b18cb);_0x3533ab=_0x203019['length'];if(_0x4b18cb!==!![]){_0x2e2aeb+='='+_0x4b18cb;}}_0x2c8fd2['cookie']=_0x2e2aeb;},'removeCookie':function(){return'dev';},'getCookie':function(_0x4d91c2,_0x3c5704){_0x4d91c2=_0x4d91c2||function(_0x31dab1){return _0x31dab1;};const _0x3ad49c=_0x4d91c2(new RegExp('(?:^|;\x20)'+_0x3c5704['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x2ad68e=function(_0x28094f,_0x1ff6d7){_0x28094f(++_0x1ff6d7);};_0x2ad68e(_0x392128,_0x2029a5);return _0x3ad49c?decodeURIComponent(_0x3ad49c[0x1]):undefined;}};const _0x1308af=function(){const _0xd03b3d=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xd03b3d['test'](_0x537e40['removeCookie']['toString']());};_0x537e40['updateCookie']=_0x1308af;let _0x45ae7c='';const _0x35f0fb=_0x537e40['updateCookie']();if(!_0x35f0fb){_0x537e40['setCookie'](['*'],'counter',0x1);}else if(_0x35f0fb){_0x45ae7c=_0x537e40['getCookie'](null,'counter');}else{_0x537e40['removeCookie']();}};_0x149928();}(a132_0x2029,0x1f2));const a132_0x3921=function(_0x5edfba,_0x2029a5){_0x5edfba=_0x5edfba-0x0;let _0x392128=a132_0x2029[_0x5edfba];return _0x392128;};const a132_0x537e40=function(){let _0x86abf8=!![];return function(_0x1668ee,_0x633911){const _0x2deae7=_0x86abf8?function(){if(_0x633911){const _0x460910=_0x633911[a132_0x3921('0x31')](_0x1668ee,arguments);_0x633911=null;return _0x460910;}}:function(){};_0x86abf8=![];return _0x2deae7;};}();const a132_0x1f092b=a132_0x537e40(this,function(){const _0x3de8e8=function(){const _0x272437=_0x3de8e8[a132_0x3921('0x2f')](a132_0x3921('0x39'))()[a132_0x3921('0x20')](a132_0x3921('0x9'));return!_0x272437[a132_0x3921('0x4')](a132_0x1f092b);};return _0x3de8e8();});a132_0x1f092b();'use strict';const tesseract_1=require(a132_0x3921('0x47'));const Poll_1=require('../../models/Poll');const constants=require('../../utils/constants');const errors=require(a132_0x3921('0x1f'));const numbers=require(a132_0x3921('0x34'));const omnic=require('../../utils/omnic');module['exports']=class PollCommand extends tesseract_1[a132_0x3921('0x35')]{constructor(){super(a132_0x3921('0x3e'),{'description':a132_0x3921('0x3b'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a132_0x3921('0x43')],'string':[a132_0x3921('0x5'),a132_0x3921('0x1')],'coerce':{'timeout':_0x3200ae=>typeof _0x3200ae===a132_0x3921('0xc')&&numbers[a132_0x3921('0x4e')](_0x3200ae,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a132_0x3921('0xa'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':['MANAGE_CHANNELS'],'syntax':['poll\x20--status\x20POLL_MESSAGE_ID',a132_0x3921('0x2d'),a132_0x3921('0x26')]});this[a132_0x3921('0x41')]=async(_0x379945,_0x25bc58)=>{if(_0x25bc58[a132_0x3921('0x1')]){const _0x520be1=await Poll_1['default'][a132_0x3921('0x13')]({'_id':_0x25bc58[a132_0x3921('0x1')],'guild':_0x379945[a132_0x3921('0xa')]['id']});if(!_0x520be1)throw new Error('POLL_NOT_FOUND');if(!_0x379945[a132_0x3921('0xa')][a132_0x3921('0xb')][a132_0x3921('0x22')][a132_0x3921('0x14')](_0x520be1[a132_0x3921('0x33')]))throw new Error(a132_0x3921('0x1a'));const _0x3e4aec=_0x379945[a132_0x3921('0xa')][a132_0x3921('0xb')][a132_0x3921('0x22')][a132_0x3921('0x48')](_0x520be1['channel']);const _0x3cb4bf=await _0x3e4aec[a132_0x3921('0x37')][a132_0x3921('0x2c')](_0x520be1[a132_0x3921('0x1e')])[a132_0x3921('0x2e')](()=>{});if(!_0x3cb4bf)throw new Error(a132_0x3921('0x1a'));const _0x301f35=_0x3cb4bf[a132_0x3921('0x3d')][0x0][a132_0x3921('0x29')][a132_0x3921('0x27')](_0x16e319=>_0x16e319[a132_0x3921('0x4d')]);const _0x13fc53={};let _0x41a4d1=0x0;for(const _0x2d992d in this[a132_0x3921('0x4f')][a132_0x3921('0x30')](0x0,_0x301f35[a132_0x3921('0xd')])){if(_0x3cb4bf[a132_0x3921('0x4f')][a132_0x3921('0x22')][a132_0x3921('0x14')](this[a132_0x3921('0x4f')][_0x2d992d])){await _0x3cb4bf[a132_0x3921('0x4f')][a132_0x3921('0x22')][a132_0x3921('0x48')](this['reactions'][_0x2d992d])[a132_0x3921('0x49')][a132_0x3921('0x2c')]()[a132_0x3921('0x2e')](()=>{});const _0x5b2748=_0x3cb4bf[a132_0x3921('0x4f')][a132_0x3921('0x22')]['get'](this['reactions'][_0x2d992d])[a132_0x3921('0x49')]['cache'][a132_0x3921('0x28')](_0x5496ae=>!_0x5496ae['bot'])['size'];_0x13fc53[this[a132_0x3921('0x4f')][_0x2d992d]]=_0x5b2748;_0x41a4d1+=_0x5b2748;}}return await _0x379945[a132_0x3921('0x33')][a132_0x3921('0x3')]({'embed':{'color':tesseract_1['Constants']['COLORS']['IRIS'],'author':{'name':a132_0x3921('0x44')},'title':_0x3cb4bf['embeds'][0x0][a132_0x3921('0x23')],'fields':_0x3cb4bf[a132_0x3921('0x3d')][0x0][a132_0x3921('0x29')]['map'](_0x4a0c29=>({'name':_0x4a0c29[a132_0x3921('0x17')]+'\x20'+_0x4a0c29[a132_0x3921('0x4d')],'value':(_0x13fc53[_0x4a0c29[a132_0x3921('0x17')]]||0x0)+a132_0x3921('0x8')+_0x41a4d1+a132_0x3921('0x25')+(_0x13fc53[_0x4a0c29[a132_0x3921('0x17')]]?_0x13fc53[_0x4a0c29[a132_0x3921('0x17')]]/_0x41a4d1*0x64:0x0)[a132_0x3921('0x51')](0x2)+'%)'})),'footer':{'text':_0x3cb4bf['id']+a132_0x3921('0xe')},'timestamp':_0x520be1[a132_0x3921('0x7')]}});}if(!_0x25bc58['_'][a132_0x3921('0xd')]||!_0x25bc58[a132_0x3921('0x5')]||!_0x25bc58[a132_0x3921('0x5')]['length'])throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE']['INVALID_COMMAND_SYNTAX'],this[a132_0x3921('0x17')]);const _0x596464=_0x25bc58['_']['join']('\x20');const _0x45361c=_0x25bc58['timeout']?_0x25bc58['timeout']:this[a132_0x3921('0x3c')];if(constants[a132_0x3921('0x21')](this['client'][a132_0x3921('0x18')])){const _0x5881b8=await omnic[a132_0x3921('0x4b')](_0x379945[a132_0x3921('0xa')])[a132_0x3921('0x2e')](()=>{});if(_0x5881b8){if(_0x5881b8===omnic[a132_0x3921('0x0')][a132_0x3921('0x12')]&&_0x45361c>constants[a132_0x3921('0x1d')][a132_0x3921('0x12')][a132_0x3921('0x2')]){throw new errors[(a132_0x3921('0x19'))](errors[a132_0x3921('0x52')][a132_0x3921('0x6')],this[a132_0x3921('0x1b')][a132_0x3921('0x38')][a132_0x3921('0x15')](_0x379945[a132_0x3921('0xa')][a132_0x3921('0x4c')][a132_0x3921('0x50')],a132_0x3921('0x2a'),a132_0x3921('0x4a'),constants[a132_0x3921('0x1d')]['GOLD'][a132_0x3921('0x2')]));}else if(_0x5881b8===omnic[a132_0x3921('0x0')]['PLATINUM']&&_0x45361c>constants['LIMITS'][a132_0x3921('0x45')][a132_0x3921('0x2')]){throw new errors[(a132_0x3921('0x19'))](errors[a132_0x3921('0x52')][a132_0x3921('0x6')],this[a132_0x3921('0x1b')][a132_0x3921('0x38')]['getString'](_0x379945[a132_0x3921('0xa')][a132_0x3921('0x4c')][a132_0x3921('0x50')],a132_0x3921('0x2a'),a132_0x3921('0x4a'),constants[a132_0x3921('0x1d')][a132_0x3921('0x45')][a132_0x3921('0x2')]));}}else if(_0x45361c>constants[a132_0x3921('0x1d')][a132_0x3921('0x2')]){throw new errors['DiscordError'](errors[a132_0x3921('0x52')][a132_0x3921('0x24')],this[a132_0x3921('0x1b')][a132_0x3921('0x38')][a132_0x3921('0x15')](_0x379945[a132_0x3921('0xa')]['document'][a132_0x3921('0x50')],a132_0x3921('0x2a'),a132_0x3921('0x1c'),constants[a132_0x3921('0x1d')][a132_0x3921('0x2')]));}const _0x4e05d8=await Poll_1['default'][a132_0x3921('0x40')]({'guild':_0x379945[a132_0x3921('0xa')]['id'],'ends':{'$gte':new Date()}});if(_0x5881b8){if(_0x5881b8===omnic[a132_0x3921('0x0')][a132_0x3921('0x12')]&&_0x4e05d8>=constants[a132_0x3921('0x1d')][a132_0x3921('0x12')][a132_0x3921('0x3f')]){throw new errors[(a132_0x3921('0x19'))](errors[a132_0x3921('0x52')][a132_0x3921('0x6')],this['client']['locale'][a132_0x3921('0x15')](_0x379945[a132_0x3921('0xa')][a132_0x3921('0x4c')]['language'],a132_0x3921('0x2a'),a132_0x3921('0x16'),constants[a132_0x3921('0x1d')][a132_0x3921('0x12')][a132_0x3921('0x3f')]));}else if(_0x5881b8===omnic[a132_0x3921('0x0')][a132_0x3921('0x45')]&&_0x4e05d8>=constants[a132_0x3921('0x1d')]['PLATINUM']['POLLS']){throw new errors[(a132_0x3921('0x19'))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this[a132_0x3921('0x1b')][a132_0x3921('0x38')]['getString'](_0x379945[a132_0x3921('0xa')][a132_0x3921('0x4c')][a132_0x3921('0x50')],a132_0x3921('0x2a'),a132_0x3921('0x16'),constants[a132_0x3921('0x1d')][a132_0x3921('0x45')][a132_0x3921('0x3f')]));}}else{throw new errors[(a132_0x3921('0x19'))](errors[a132_0x3921('0x52')][a132_0x3921('0x24')],this[a132_0x3921('0x1b')][a132_0x3921('0x38')][a132_0x3921('0x15')](_0x379945[a132_0x3921('0xa')]['document'][a132_0x3921('0x50')],a132_0x3921('0x2a'),a132_0x3921('0x42'),constants[a132_0x3921('0x1d')][a132_0x3921('0x3f')]));}}const _0x7522df=new Date(Date[a132_0x3921('0x10')]()+_0x45361c*0x36ee80);const _0x59754e=await _0x379945[a132_0x3921('0x33')][a132_0x3921('0x3')]({'embed':{'color':tesseract_1[a132_0x3921('0x11')][a132_0x3921('0x32')][a132_0x3921('0x3a')],'author':{'name':'POLL'},'title':_0x596464,'description':a132_0x3921('0xf'),'fields':_0x25bc58[a132_0x3921('0x5')][a132_0x3921('0x27')]((_0x24c6cd,_0x3e8385)=>({'name':this['reactions'][_0x3e8385],'value':_0x24c6cd})),'footer':{'text':a132_0x3921('0x2b')},'timestamp':_0x7522df}});await Poll_1[a132_0x3921('0x46')][a132_0x3921('0x36')]({'_id':_0x59754e['id'],'channel':_0x59754e[a132_0x3921('0x33')]['id'],'guild':_0x59754e[a132_0x3921('0xa')]['id'],'ends':_0x7522df});for(const _0x1443cb of this['reactions'][a132_0x3921('0x30')](0x0,_0x25bc58[a132_0x3921('0x5')][a132_0x3921('0xd')])){await _0x59754e['react'](_0x1443cb)['catch'](()=>{});}};this[a132_0x3921('0x4f')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a132_0x3921('0x3c')]=0x3;}};