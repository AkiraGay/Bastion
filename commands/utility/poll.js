const a160_0x21ff=['exec','cache','defaultTimeout','POLL','locale','messages','fields','PremiumTier','_id','poll\x20--status\x20POLL_MESSAGE_ID','slice','catch','BASTION_ERROR_TYPE','clamp','bot','embeds','membershipLimitPolls','value','../../utils/omnic','client','language','map','@bastion/tesseract','\x20votes\x20(','reactions','channel','COLORS','GOLD','LIMITED_PREMIUM_MEMBERSHIP','has','POLL_TIMEOUT','LIMITS','PREMIUM_MEMBERSHIP_REQUIRED','status','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','react','join','\x20/\x20','timeout','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','../../utils/constants','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','title','Constants','create','exports','MANAGE_CHANNELS','length','size','premiumPolls','getString','membershipLimitPollTimeout','Command','findOne','PLATINUM','POLLS','number','get','users','apply','document','IRIS','user','option','fetch','../../models/Poll','send','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','countDocuments','constructor','name','errors','guild','isPublicBastion','premiumPollTimeout','ends','fetchPremiumTier','toFixed','default','poll','POLL_NOT_FOUND','DiscordError','test','Ends'];(function(_0x4760d1,_0x434c18){const _0x21ff23=function(_0x329c9b){while(--_0x329c9b){_0x4760d1['push'](_0x4760d1['shift']());}},_0x97ae29=function(){const _0x43d736={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x17fefb,_0x3edfe4,_0x40fed0,_0x2d40d2){_0x2d40d2=_0x2d40d2||{};let _0x23b62b=_0x3edfe4+'='+_0x40fed0,_0x10fe85=0x0;for(let _0x53a32f=0x0,_0x1d2f2f=_0x17fefb['length'];_0x53a32f<_0x1d2f2f;_0x53a32f++){const _0x145b42=_0x17fefb[_0x53a32f];_0x23b62b+=';\x20'+_0x145b42;const _0x77c063=_0x17fefb[_0x145b42];_0x17fefb['push'](_0x77c063),_0x1d2f2f=_0x17fefb['length'],_0x77c063!==!![]&&(_0x23b62b+='='+_0x77c063);}_0x2d40d2['cookie']=_0x23b62b;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3e2bbb,_0x264987){_0x3e2bbb=_0x3e2bbb||function(_0x3ed12a){return _0x3ed12a;};const _0x12420b=_0x3e2bbb(new RegExp('(?:^|;\x20)'+_0x264987['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x44b996=function(_0x47cf0d,_0x1fd973){_0x47cf0d(++_0x1fd973);};return _0x44b996(_0x21ff23,_0x434c18),_0x12420b?decodeURIComponent(_0x12420b[0x1]):undefined;}},_0x48487b=function(){const _0x11209b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x11209b['test'](_0x43d736['removeCookie']['toString']());};_0x43d736['updateCookie']=_0x48487b;let _0x58af7f='';const _0x25ace9=_0x43d736['updateCookie']();if(!_0x25ace9)_0x43d736['setCookie'](['*'],'counter',0x1);else _0x25ace9?_0x58af7f=_0x43d736['getCookie'](null,'counter'):_0x43d736['removeCookie']();};_0x97ae29();}(a160_0x21ff,0x9c));const a160_0x97ae=function(_0x4760d1,_0x434c18){_0x4760d1=_0x4760d1-0x182;let _0x21ff23=a160_0x21ff[_0x4760d1];return _0x21ff23;};const a160_0x43cd82=a160_0x97ae,a160_0x48487b=function(){let _0x25ace9=!![];return function(_0x17fefb,_0x3edfe4){const _0x40fed0=_0x25ace9?function(){const _0x53eb0e=a160_0x97ae;if(_0x3edfe4){const _0x2d40d2=_0x3edfe4[_0x53eb0e(0x1c9)](_0x17fefb,arguments);return _0x3edfe4=null,_0x2d40d2;}}:function(){};return _0x25ace9=![],_0x40fed0;};}(),a160_0x43d736=a160_0x48487b(this,function(){const _0x23b62b=function(){const _0x544f86=a160_0x97ae,_0x10fe85=_0x23b62b[_0x544f86(0x1d3)]('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[_0x544f86(0x1d3)](_0x544f86(0x1b7));return!_0x10fe85[_0x544f86(0x18c)](a160_0x43d736);};return _0x23b62b();});a160_0x43d736();'use strict';const tesseract_1=require(a160_0x43cd82(0x1a4)),Poll_1=require(a160_0x43cd82(0x1cf)),constants=require(a160_0x43cd82(0x1b6)),errors=require('../../utils/errors'),numbers=require('../../utils/numbers'),omnic=require(a160_0x43cd82(0x1a0));module[a160_0x43cd82(0x1bb)]=class PollCommand extends tesseract_1[a160_0x43cd82(0x1c2)]{constructor(){const _0xf32679=a160_0x43cd82;super(_0xf32679(0x189),{'description':_0xf32679(0x1b0),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':['timeout'],'string':[_0xf32679(0x1cd),_0xf32679(0x1af)],'coerce':{'timeout':_0x53a32f=>typeof _0x53a32f===_0xf32679(0x1c6)&&numbers[_0xf32679(0x19b)](_0x53a32f,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':_0xf32679(0x182),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[_0xf32679(0x1bc)],'syntax':[_0xf32679(0x197),_0xf32679(0x1d1),_0xf32679(0x1b5)]}),this[_0xf32679(0x18e)]=async(_0x1d2f2f,_0x145b42)=>{const _0xfe5ac7=_0xf32679;if(_0x145b42['status']){const _0x44b996=await Poll_1['default'][_0xfe5ac7(0x1c3)]({'_id':_0x145b42[_0xfe5ac7(0x1af)],'guild':_0x1d2f2f[_0xfe5ac7(0x182)]['id']});if(!_0x44b996)throw new Error(_0xfe5ac7(0x18a));if(!_0x1d2f2f[_0xfe5ac7(0x182)]['channels'][_0xfe5ac7(0x18f)][_0xfe5ac7(0x1ab)](_0x44b996[_0xfe5ac7(0x1a7)]))throw new Error(_0xfe5ac7(0x18a));const _0x3ed12a=_0x1d2f2f[_0xfe5ac7(0x182)]['channels']['cache'][_0xfe5ac7(0x1c7)](_0x44b996[_0xfe5ac7(0x1a7)]),_0x47cf0d=await _0x3ed12a[_0xfe5ac7(0x193)][_0xfe5ac7(0x1ce)](_0x44b996[_0xfe5ac7(0x196)])['catch'](()=>{});if(!_0x47cf0d)throw new Error(_0xfe5ac7(0x18a));const _0x1fd973=_0x47cf0d[_0xfe5ac7(0x19d)][0x0][_0xfe5ac7(0x194)][_0xfe5ac7(0x1a3)](_0x928b4=>_0x928b4[_0xfe5ac7(0x19f)]),_0x11209b={};let _0x164dc6=0x0;for(const _0x302039 in this[_0xfe5ac7(0x1a6)]['slice'](0x0,_0x1fd973[_0xfe5ac7(0x1bd)])){if(_0x47cf0d[_0xfe5ac7(0x1a6)][_0xfe5ac7(0x18f)][_0xfe5ac7(0x1ab)](this[_0xfe5ac7(0x1a6)][_0x302039])){await _0x47cf0d[_0xfe5ac7(0x1a6)]['cache'][_0xfe5ac7(0x1c7)](this[_0xfe5ac7(0x1a6)][_0x302039])['users']['fetch']()[_0xfe5ac7(0x199)](()=>{});const _0x6382a1=_0x47cf0d[_0xfe5ac7(0x1a6)][_0xfe5ac7(0x18f)][_0xfe5ac7(0x1c7)](this[_0xfe5ac7(0x1a6)][_0x302039])[_0xfe5ac7(0x1c8)][_0xfe5ac7(0x18f)]['filter'](_0x35e9e0=>!_0x35e9e0[_0xfe5ac7(0x19c)])[_0xfe5ac7(0x1be)];_0x11209b[this['reactions'][_0x302039]]=_0x6382a1,_0x164dc6+=_0x6382a1;}}return await _0x1d2f2f[_0xfe5ac7(0x1a7)][_0xfe5ac7(0x1d0)]({'embed':{'color':tesseract_1[_0xfe5ac7(0x1b9)][_0xfe5ac7(0x1a8)]['IRIS'],'author':{'name':'POLL\x20STATUS'},'title':_0x47cf0d['embeds'][0x0][_0xfe5ac7(0x1b8)],'fields':_0x47cf0d[_0xfe5ac7(0x19d)][0x0][_0xfe5ac7(0x194)][_0xfe5ac7(0x1a3)](_0x381c43=>({'name':_0x381c43[_0xfe5ac7(0x1d4)]+'\x20'+_0x381c43[_0xfe5ac7(0x19f)],'value':(_0x11209b[_0x381c43[_0xfe5ac7(0x1d4)]]||0x0)+_0xfe5ac7(0x1b3)+_0x164dc6+_0xfe5ac7(0x1a5)+(_0x11209b[_0x381c43[_0xfe5ac7(0x1d4)]]?_0x11209b[_0x381c43['name']]/_0x164dc6*0x64:0x0)[_0xfe5ac7(0x187)](0x2)+'%)'})),'footer':{'text':_0x47cf0d['id']+'\x20â€¢\x20Ends'},'timestamp':_0x44b996[_0xfe5ac7(0x185)]}});}if(!_0x145b42['_'][_0xfe5ac7(0x1bd)]||!_0x145b42[_0xfe5ac7(0x1cd)]||!(_0x145b42['option']instanceof Array))throw new errors[(_0xfe5ac7(0x18b))](errors[_0xfe5ac7(0x19a)]['INVALID_COMMAND_SYNTAX'],this['name']);const _0x77c063=_0x145b42['_'][_0xfe5ac7(0x1b2)]('\x20'),_0x3e2bbb=_0x145b42[_0xfe5ac7(0x1b4)]?_0x145b42[_0xfe5ac7(0x1b4)]:this['defaultTimeout'];if(constants[_0xfe5ac7(0x183)](this[_0xfe5ac7(0x1a1)][_0xfe5ac7(0x1cc)])){const _0x29fe1c=await omnic[_0xfe5ac7(0x186)](_0x1d2f2f[_0xfe5ac7(0x182)])['catch'](()=>{});if(_0x29fe1c){if(_0x29fe1c===omnic[_0xfe5ac7(0x195)][_0xfe5ac7(0x1a9)]&&_0x3e2bbb>constants['LIMITS'][_0xfe5ac7(0x1a9)][_0xfe5ac7(0x1ac)])throw new errors[(_0xfe5ac7(0x18b))](errors[_0xfe5ac7(0x19a)]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0xfe5ac7(0x1a1)][_0xfe5ac7(0x192)]['getString'](_0x1d2f2f[_0xfe5ac7(0x182)][_0xfe5ac7(0x1ca)][_0xfe5ac7(0x1a2)],'errors',_0xfe5ac7(0x1c1),constants[_0xfe5ac7(0x1ad)]['GOLD'][_0xfe5ac7(0x1ac)]));else{if(_0x29fe1c===omnic[_0xfe5ac7(0x195)][_0xfe5ac7(0x1c4)]&&_0x3e2bbb>constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1c4)][_0xfe5ac7(0x1ac)])throw new errors['DiscordError'](errors[_0xfe5ac7(0x19a)]['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][_0xfe5ac7(0x192)][_0xfe5ac7(0x1c0)](_0x1d2f2f[_0xfe5ac7(0x182)][_0xfe5ac7(0x1ca)]['language'],_0xfe5ac7(0x1d5),_0xfe5ac7(0x1c1),constants['LIMITS'][_0xfe5ac7(0x1c4)]['POLL_TIMEOUT']));}}else{if(_0x3e2bbb>constants[_0xfe5ac7(0x1ad)]['POLL_TIMEOUT'])throw new errors[(_0xfe5ac7(0x18b))](errors['BASTION_ERROR_TYPE']['PREMIUM_MEMBERSHIP_REQUIRED'],this[_0xfe5ac7(0x1a1)][_0xfe5ac7(0x192)][_0xfe5ac7(0x1c0)](_0x1d2f2f[_0xfe5ac7(0x182)][_0xfe5ac7(0x1ca)]['language'],_0xfe5ac7(0x1d5),_0xfe5ac7(0x184),constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1ac)]));}const _0x18f860=await Poll_1[_0xfe5ac7(0x188)][_0xfe5ac7(0x1d2)]({'guild':_0x1d2f2f[_0xfe5ac7(0x182)]['id'],'ends':{'$gte':new Date()}});if(_0x29fe1c){if(_0x29fe1c===omnic[_0xfe5ac7(0x195)]['GOLD']&&_0x18f860>=constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1a9)][_0xfe5ac7(0x1c5)])throw new errors[(_0xfe5ac7(0x18b))](errors['BASTION_ERROR_TYPE'][_0xfe5ac7(0x1aa)],this['client'][_0xfe5ac7(0x192)][_0xfe5ac7(0x1c0)](_0x1d2f2f[_0xfe5ac7(0x182)]['document'][_0xfe5ac7(0x1a2)],_0xfe5ac7(0x1d5),_0xfe5ac7(0x19e),constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1a9)][_0xfe5ac7(0x1c5)]));else{if(_0x29fe1c===omnic[_0xfe5ac7(0x195)][_0xfe5ac7(0x1c4)]&&_0x18f860>=constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1c4)][_0xfe5ac7(0x1c5)])throw new errors['DiscordError'](errors[_0xfe5ac7(0x19a)]['LIMITED_PREMIUM_MEMBERSHIP'],this[_0xfe5ac7(0x1a1)][_0xfe5ac7(0x192)][_0xfe5ac7(0x1c0)](_0x1d2f2f[_0xfe5ac7(0x182)][_0xfe5ac7(0x1ca)][_0xfe5ac7(0x1a2)],_0xfe5ac7(0x1d5),_0xfe5ac7(0x19e),constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1c4)][_0xfe5ac7(0x1c5)]));}}else{if(_0x18f860>=constants[_0xfe5ac7(0x1ad)][_0xfe5ac7(0x1c5)])throw new errors[(_0xfe5ac7(0x18b))](errors['BASTION_ERROR_TYPE'][_0xfe5ac7(0x1ae)],this[_0xfe5ac7(0x1a1)][_0xfe5ac7(0x192)]['getString'](_0x1d2f2f[_0xfe5ac7(0x182)][_0xfe5ac7(0x1ca)][_0xfe5ac7(0x1a2)],_0xfe5ac7(0x1d5),_0xfe5ac7(0x1bf),constants['LIMITS'][_0xfe5ac7(0x1c5)]));}}const _0x264987=new Date(Date['now']()+_0x3e2bbb*0x36ee80),_0x12420b=await _0x1d2f2f['channel'][_0xfe5ac7(0x1d0)]({'embed':{'color':tesseract_1[_0xfe5ac7(0x1b9)][_0xfe5ac7(0x1a8)][_0xfe5ac7(0x1cb)],'author':{'name':_0xfe5ac7(0x191)},'title':_0x77c063,'description':'React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','fields':_0x145b42['option'][_0xfe5ac7(0x1a3)]((_0xfc1f19,_0x1a1fd2)=>({'name':this[_0xfe5ac7(0x1a6)][_0x1a1fd2],'value':_0xfc1f19})),'footer':{'text':_0xfe5ac7(0x18d)},'timestamp':_0x264987}});await Poll_1[_0xfe5ac7(0x188)][_0xfe5ac7(0x1ba)]({'_id':_0x12420b['id'],'channel':_0x12420b['channel']['id'],'guild':_0x12420b[_0xfe5ac7(0x182)]['id'],'ends':_0x264987});for(const _0x543f20 of this[_0xfe5ac7(0x1a6)][_0xfe5ac7(0x198)](0x0,_0x145b42[_0xfe5ac7(0x1cd)]['length'])){await _0x12420b[_0xfe5ac7(0x1b1)](_0x543f20)[_0xfe5ac7(0x199)](()=>{});}},this[_0xf32679(0x1a6)]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],this[_0xf32679(0x190)]=0x3;}};