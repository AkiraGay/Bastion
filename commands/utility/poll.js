const a131_0x2557=['getString','isPublicBastion','size','ends','Constants','LIMITS','exports','membershipLimitPollTimeout','slice','status','has','\x20/\x20','length','toFixed','clamp','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','now','@bastion/tesseract','react','get','DiscordError','\x20votes\x20(','channels','MANAGE_CHANNELS','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','return\x20/\x22\x20+\x20this\x20+\x20\x22/','../../utils/constants','fields','../../models/Poll','premiumPolls','constructor','poll','../../utils/omnic','fetchPremiumTier','messages','reactions','name','bot','embeds','errors','_id','test','countDocuments','join','default','value','POLLS','document','cache','map','premiumPollTimeout','fetch','BASTION_ERROR_TYPE','IRIS','membershipLimitPolls','compile','PREMIUM_MEMBERSHIP_REQUIRED','catch','POLL','client','locale','../../utils/errors','poll\x20--status\x20POLL_MESSAGE_ID','channel','number','title','PremiumTier','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','PLATINUM','POLL_NOT_FOUND','apply','option','users','guild','timeout','\x20â€¢\x20Ends','Ends','Command','LIMITED_PREMIUM_MEMBERSHIP','COLORS','user','defaultTimeout','send','exec','GOLD','filter','POLL_TIMEOUT'];(function(_0x489efe,_0x2557db){const _0x4990b8=function(_0x11a88f){while(--_0x11a88f){_0x489efe['push'](_0x489efe['shift']());}};const _0x148757=function(){const _0x4ddd3a={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3673f3,_0x3b1cc8,_0x3eaad8,_0x46465f){_0x46465f=_0x46465f||{};let _0x4630d4=_0x3b1cc8+'='+_0x3eaad8;let _0x2118c3=0x0;for(let _0x80cc99=0x0,_0x100780=_0x3673f3['length'];_0x80cc99<_0x100780;_0x80cc99++){const _0x4b9b46=_0x3673f3[_0x80cc99];_0x4630d4+=';\x20'+_0x4b9b46;const _0x3cae63=_0x3673f3[_0x4b9b46];_0x3673f3['push'](_0x3cae63);_0x100780=_0x3673f3['length'];if(_0x3cae63!==!![]){_0x4630d4+='='+_0x3cae63;}}_0x46465f['cookie']=_0x4630d4;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3d0f8e,_0x45c0d2){_0x3d0f8e=_0x3d0f8e||function(_0x590dd5){return _0x590dd5;};const _0x2f1705=_0x3d0f8e(new RegExp('(?:^|;\x20)'+_0x45c0d2['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0xa0105b=function(_0x5068a7,_0xfc73f4){_0x5068a7(++_0xfc73f4);};_0xa0105b(_0x4990b8,_0x2557db);return _0x2f1705?decodeURIComponent(_0x2f1705[0x1]):undefined;}};const _0x728c73=function(){const _0x2646fe=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2646fe['test'](_0x4ddd3a['removeCookie']['toString']());};_0x4ddd3a['updateCookie']=_0x728c73;let _0x229871='';const _0x1335f4=_0x4ddd3a['updateCookie']();if(!_0x1335f4){_0x4ddd3a['setCookie'](['*'],'counter',0x1);}else if(_0x1335f4){_0x229871=_0x4ddd3a['getCookie'](null,'counter');}else{_0x4ddd3a['removeCookie']();}};_0x148757();}(a131_0x2557,0x195));const a131_0x4990=function(_0x489efe,_0x2557db){_0x489efe=_0x489efe-0x0;let _0x4990b8=a131_0x2557[_0x489efe];return _0x4990b8;};const a131_0x4ddd3a=function(){let _0x3a325d=!![];return function(_0x5c22e0,_0x269edc){const _0x5c04ed=_0x3a325d?function(){if(_0x269edc){const _0x133479=_0x269edc[a131_0x4990('0xd')](_0x5c22e0,arguments);_0x269edc=null;return _0x133479;}}:function(){};_0x3a325d=![];return _0x5c04ed;};}();const a131_0x11a88f=a131_0x4ddd3a(this,function(){const _0x5b99a0=function(){const _0x30f8e6=_0x5b99a0[a131_0x4990('0x3c')](a131_0x4990('0x37'))()[a131_0x4990('0x55')](a131_0x4990('0xa'));return!_0x30f8e6[a131_0x4990('0x47')](a131_0x11a88f);};return _0x5b99a0();});a131_0x11a88f();'use strict';const tesseract_1=require(a131_0x4990('0x2f'));const Poll_1=require(a131_0x4990('0x3a'));const constants=require(a131_0x4990('0x38'));const errors=require(a131_0x4990('0x4'));const numbers=require('../../utils/numbers');const omnic=require(a131_0x4990('0x3e'));module[a131_0x4990('0x24')]=class PollCommand extends tesseract_1[a131_0x4990('0x14')]{constructor(){super(a131_0x4990('0x3d'),{'description':a131_0x4990('0x2d'),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[a131_0x4990('0x11')],'string':['option',a131_0x4990('0x27')],'coerce':{'timeout':_0xc491af=>typeof _0xc491af===a131_0x4990('0x7')&&numbers[a131_0x4990('0x2c')](_0xc491af,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':a131_0x4990('0x10'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[a131_0x4990('0x35')],'syntax':[a131_0x4990('0x5'),a131_0x4990('0x36'),'poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION']});this[a131_0x4990('0x1a')]=async(_0x3d78d5,_0x57562a)=>{if(_0x57562a['status']){const _0x17e2f6=await Poll_1[a131_0x4990('0x4a')]['findOne']({'_id':_0x57562a['status'],'guild':_0x3d78d5['guild']['id']});if(!_0x17e2f6)throw new Error(a131_0x4990('0xc'));if(!_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x34')][a131_0x4990('0x4e')][a131_0x4990('0x28')](_0x17e2f6[a131_0x4990('0x6')]))throw new Error(a131_0x4990('0xc'));const _0xf7c1d7=_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x34')][a131_0x4990('0x4e')][a131_0x4990('0x31')](_0x17e2f6[a131_0x4990('0x6')]);const _0x38b3a0=await _0xf7c1d7[a131_0x4990('0x40')][a131_0x4990('0x51')](_0x17e2f6[a131_0x4990('0x46')])[a131_0x4990('0x0')](()=>{});if(!_0x38b3a0)throw new Error('POLL_NOT_FOUND');const _0xf42ec7=_0x38b3a0['embeds'][0x0][a131_0x4990('0x39')][a131_0x4990('0x4f')](_0x2238cf=>_0x2238cf[a131_0x4990('0x4b')]);const _0x555270={};let _0x5d737d=0x0;for(const _0x3b1139 in this[a131_0x4990('0x41')][a131_0x4990('0x26')](0x0,_0xf42ec7[a131_0x4990('0x2a')])){if(_0x38b3a0['reactions']['cache'][a131_0x4990('0x28')](this['reactions'][_0x3b1139])){await _0x38b3a0[a131_0x4990('0x41')][a131_0x4990('0x4e')]['get'](this[a131_0x4990('0x41')][_0x3b1139])[a131_0x4990('0xf')][a131_0x4990('0x51')]()['catch'](()=>{});const _0x47d905=_0x38b3a0[a131_0x4990('0x41')]['cache'][a131_0x4990('0x31')](this[a131_0x4990('0x41')][_0x3b1139])[a131_0x4990('0xf')][a131_0x4990('0x4e')][a131_0x4990('0x1c')](_0x573630=>!_0x573630[a131_0x4990('0x43')])[a131_0x4990('0x20')];_0x555270[this['reactions'][_0x3b1139]]=_0x47d905;_0x5d737d+=_0x47d905;}}return await _0x3d78d5[a131_0x4990('0x6')][a131_0x4990('0x19')]({'embed':{'color':tesseract_1['Constants'][a131_0x4990('0x16')][a131_0x4990('0x53')],'author':{'name':'POLL\x20STATUS'},'title':_0x38b3a0[a131_0x4990('0x44')][0x0][a131_0x4990('0x8')],'fields':_0x38b3a0['embeds'][0x0][a131_0x4990('0x39')][a131_0x4990('0x4f')](_0x182831=>({'name':_0x182831[a131_0x4990('0x42')]+'\x20'+_0x182831['value'],'value':(_0x555270[_0x182831['name']]||0x0)+a131_0x4990('0x29')+_0x5d737d+a131_0x4990('0x33')+(_0x555270[_0x182831[a131_0x4990('0x42')]]?_0x555270[_0x182831[a131_0x4990('0x42')]]/_0x5d737d*0x64:0x0)[a131_0x4990('0x2b')](0x2)+'%)'})),'footer':{'text':_0x38b3a0['id']+a131_0x4990('0x12')},'timestamp':_0x17e2f6[a131_0x4990('0x21')]}});}if(!_0x57562a['_'][a131_0x4990('0x2a')]||!_0x57562a[a131_0x4990('0xe')]||!_0x57562a[a131_0x4990('0xe')]['length'])throw new errors[(a131_0x4990('0x32'))](errors[a131_0x4990('0x52')]['INVALID_COMMAND_SYNTAX'],this[a131_0x4990('0x42')]);const _0xb15f43=_0x57562a['_'][a131_0x4990('0x49')]('\x20');const _0x57cc21=_0x57562a[a131_0x4990('0x11')]?_0x57562a['timeout']:this['defaultTimeout'];if(constants[a131_0x4990('0x1f')](this[a131_0x4990('0x2')][a131_0x4990('0x17')])){const _0x234e47=await omnic[a131_0x4990('0x3f')](_0x3d78d5[a131_0x4990('0x10')])[a131_0x4990('0x0')](()=>{});if(_0x234e47){if(_0x234e47===omnic[a131_0x4990('0x9')][a131_0x4990('0x1b')]&&_0x57cc21>constants[a131_0x4990('0x23')][a131_0x4990('0x1b')][a131_0x4990('0x1d')]){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a131_0x4990('0x15')],this[a131_0x4990('0x2')]['locale']['getString'](_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x4d')]['language'],'errors',a131_0x4990('0x25'),constants[a131_0x4990('0x23')][a131_0x4990('0x1b')][a131_0x4990('0x1d')]));}else if(_0x234e47===omnic[a131_0x4990('0x9')][a131_0x4990('0xb')]&&_0x57cc21>constants[a131_0x4990('0x23')][a131_0x4990('0xb')][a131_0x4990('0x1d')]){throw new errors[(a131_0x4990('0x32'))](errors[a131_0x4990('0x52')][a131_0x4990('0x15')],this[a131_0x4990('0x2')][a131_0x4990('0x3')][a131_0x4990('0x1e')](_0x3d78d5[a131_0x4990('0x10')]['document']['language'],a131_0x4990('0x45'),a131_0x4990('0x25'),constants[a131_0x4990('0x23')][a131_0x4990('0xb')][a131_0x4990('0x1d')]));}}else if(_0x57cc21>constants[a131_0x4990('0x23')]['POLL_TIMEOUT']){throw new errors['DiscordError'](errors['BASTION_ERROR_TYPE'][a131_0x4990('0x56')],this[a131_0x4990('0x2')][a131_0x4990('0x3')]['getString'](_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x4d')]['language'],a131_0x4990('0x45'),a131_0x4990('0x50'),constants[a131_0x4990('0x23')][a131_0x4990('0x1d')]));}const _0x4484d2=await Poll_1['default'][a131_0x4990('0x48')]({'guild':_0x3d78d5[a131_0x4990('0x10')]['id'],'ends':{'$gte':new Date()}});if(_0x234e47){if(_0x234e47===omnic[a131_0x4990('0x9')][a131_0x4990('0x1b')]&&_0x4484d2>=constants[a131_0x4990('0x23')]['GOLD']['POLLS']){throw new errors[(a131_0x4990('0x32'))](errors[a131_0x4990('0x52')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x4990('0x2')][a131_0x4990('0x3')][a131_0x4990('0x1e')](_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x4d')]['language'],a131_0x4990('0x45'),'membershipLimitPolls',constants['LIMITS'][a131_0x4990('0x1b')]['POLLS']));}else if(_0x234e47===omnic[a131_0x4990('0x9')][a131_0x4990('0xb')]&&_0x4484d2>=constants[a131_0x4990('0x23')][a131_0x4990('0xb')][a131_0x4990('0x4c')]){throw new errors[(a131_0x4990('0x32'))](errors[a131_0x4990('0x52')]['LIMITED_PREMIUM_MEMBERSHIP'],this[a131_0x4990('0x2')]['locale'][a131_0x4990('0x1e')](_0x3d78d5[a131_0x4990('0x10')][a131_0x4990('0x4d')]['language'],a131_0x4990('0x45'),a131_0x4990('0x54'),constants[a131_0x4990('0x23')][a131_0x4990('0xb')][a131_0x4990('0x4c')]));}}else{throw new errors[(a131_0x4990('0x32'))](errors[a131_0x4990('0x52')][a131_0x4990('0x56')],this[a131_0x4990('0x2')]['locale'][a131_0x4990('0x1e')](_0x3d78d5[a131_0x4990('0x10')]['document']['language'],a131_0x4990('0x45'),a131_0x4990('0x3b'),constants['LIMITS']['POLLS']));}}const _0x396c8c=new Date(Date[a131_0x4990('0x2e')]()+_0x57cc21*0x36ee80);const _0xd88493=await _0x3d78d5[a131_0x4990('0x6')][a131_0x4990('0x19')]({'embed':{'color':tesseract_1[a131_0x4990('0x22')]['COLORS'][a131_0x4990('0x53')],'author':{'name':a131_0x4990('0x1')},'title':_0xb15f43,'description':'React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','fields':_0x57562a['option'][a131_0x4990('0x4f')]((_0x36145c,_0x205c81)=>({'name':this[a131_0x4990('0x41')][_0x205c81],'value':_0x36145c})),'footer':{'text':a131_0x4990('0x13')},'timestamp':_0x396c8c}});await Poll_1[a131_0x4990('0x4a')]['create']({'_id':_0xd88493['id'],'channel':_0xd88493[a131_0x4990('0x6')]['id'],'guild':_0xd88493[a131_0x4990('0x10')]['id'],'ends':_0x396c8c});for(const _0x41e4a4 of this[a131_0x4990('0x41')]['slice'](0x0,_0x57562a[a131_0x4990('0xe')]['length'])){await _0xd88493[a131_0x4990('0x30')](_0x41e4a4)[a131_0x4990('0x0')](()=>{});}};this[a131_0x4990('0x41')]=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'];this[a131_0x4990('0x18')]=0x3;}};