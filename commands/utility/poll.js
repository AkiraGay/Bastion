const a163_0x15afe1=a163_0x4d2c;function a163_0x5142(){const _0x21006b=['embeds','\x20â€¢\x20Ends','React\x20to\x20this\x20message\x20with\x20the\x20corresponding\x20emoji\x20to\x20vote\x20for\x20that\x20option.','PremiumTier','name','../../utils/omnic','@bastion/tesseract','now','premiumPolls','\x20votes\x20(','slice','(((.+)+)+)+$','Command','user','69DeTijr','1349316OgzBxS','../../models/Poll','apply','fields','122436VWhrCi','membershipLimitPolls','clamp','send','join','105538gFEutN','client','IRIS','filter','exports','39260mvedsf','POLLS','69555GOApDu','status','locale','cache','value','LIMITS','GOLD','countDocuments','POLL\x20STATUS','users','77329hRVaDY','membershipLimitPollTimeout','errors','POLL_NOT_FOUND','reactions','../../utils/constants','react','channels','channel','poll\x20--status\x20POLL_MESSAGE_ID','COLORS','defaultTimeout','fetchPremiumTier','toFixed','poll\x20--option\x20OPTIONS...\x20--\x20QUESTION','messages','get','BASTION_ERROR_TYPE','ends','POLL_TIMEOUT','toString','option','guild','timeout','fetch','LIMITED_PREMIUM_MEMBERSHIP','default','length','constructor','exec','INVALID_COMMAND_SYNTAX','PREMIUM_MEMBERSHIP_REQUIRED','MANAGE_CHANNELS','PLATINUM','DiscordError','isPublicBastion','search','183374YJcjtP','../../utils/errors','40MYYMzg','language','getString','poll\x20--timeout\x20HOURS\x20--option\x20OPTIONS...\x20--\x20QUESTION','map','Constants','POLL','It\x20allows\x20you\x20to\x20run\x20polls\x20in\x20the\x20server\x20for\x20at\x20least\x20an\x20hour\x20and\x20at\x20most\x20a\x20month.\x20You\x20can\x20set\x20at\x20most\x2013\x20options\x20for\x20the\x20poll.\x20It\x20also\x20allows\x20you\x20to\x20see\x20the\x20status\x20of\x20a\x20running\x20poll.','has','catch','document'];a163_0x5142=function(){return _0x21006b;};return a163_0x5142();}function a163_0x4d2c(_0x4e55e6,_0x4b189d){const _0x5433a5=a163_0x5142();return a163_0x4d2c=function(_0x50d09,_0xd98a9e){_0x50d09=_0x50d09-0xca;let _0x51421a=_0x5433a5[_0x50d09];return _0x51421a;},a163_0x4d2c(_0x4e55e6,_0x4b189d);}(function(_0xe0ff9a,_0x52ff95){const _0x4b2703=a163_0x4d2c,_0x187166=_0xe0ff9a();while(!![]){try{const _0x2123a6=parseInt(_0x4b2703(0x11f))/0x1+-parseInt(_0x4b2703(0xe9))/0x2+parseInt(_0x4b2703(0xdf))/0x3*(-parseInt(_0x4b2703(0xee))/0x4)+parseInt(_0x4b2703(0xf0))/0x5+parseInt(_0x4b2703(0xe0))/0x6+parseInt(_0x4b2703(0xfa))/0x7*(parseInt(_0x4b2703(0x121))/0x8)+parseInt(_0x4b2703(0xe4))/0x9;if(_0x2123a6===_0x52ff95)break;else _0x187166['push'](_0x187166['shift']());}catch(_0x334dd0){_0x187166['push'](_0x187166['shift']());}}}(a163_0x5142,0x33e10));const a163_0xd98a9e=(function(){let _0x298525=!![];return function(_0x55317c,_0x3dac12){const _0x402bb3=_0x298525?function(){const _0x5ca5dc=a163_0x4d2c;if(_0x3dac12){const _0x1e9aff=_0x3dac12[_0x5ca5dc(0xe2)](_0x55317c,arguments);return _0x3dac12=null,_0x1e9aff;}}:function(){};return _0x298525=![],_0x402bb3;};}()),a163_0x50d09=a163_0xd98a9e(this,function(){const _0x220be6=a163_0x4d2c;return a163_0x50d09[_0x220be6(0x10e)]()[_0x220be6(0x11e)](_0x220be6(0xdc))[_0x220be6(0x10e)]()[_0x220be6(0x116)](a163_0x50d09)[_0x220be6(0x11e)]('(((.+)+)+)+$');});a163_0x50d09();'use strict';const tesseract_1=require(a163_0x15afe1(0xd7)),Poll_1=require(a163_0x15afe1(0xe1)),constants=require(a163_0x15afe1(0xff)),errors=require(a163_0x15afe1(0x120)),numbers=require('../../utils/numbers'),omnic=require(a163_0x15afe1(0xd6));module[a163_0x15afe1(0xed)]=class PollCommand extends tesseract_1[a163_0x15afe1(0xdd)]{['reactions'];['defaultTimeout'];constructor(){const _0x2f940a=a163_0x15afe1;super('poll',{'description':_0x2f940a(0xcd),'triggers':[],'arguments':{'alias':{'timeout':['t'],'option':['o'],'status':['s']},'number':[_0x2f940a(0x111)],'string':[_0x2f940a(0x10f),_0x2f940a(0xf1)],'coerce':{'timeout':_0x4d9384=>typeof _0x4d9384==='number'&&numbers[_0x2f940a(0xe6)](_0x4d9384,0x1,0x2d0)},'default':{'timeout':0x3}},'scope':'guild','owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[_0x2f940a(0x11a)],'syntax':[_0x2f940a(0x103),_0x2f940a(0x108),_0x2f940a(0x124)]}),this['reactions']=['ðŸ‡¦','ðŸ‡§','ðŸ‡¨','ðŸ‡©','ðŸ‡ª','ðŸ‡«','ðŸ‡¬','ðŸ‡­','ðŸ‡®','ðŸ‡¯','ðŸ‡°','ðŸ‡±','ðŸ‡²'],this['defaultTimeout']=0x3;}[a163_0x15afe1(0x117)]=async(_0x4ebeee,_0x2aff3e)=>{const _0x25cd45=a163_0x15afe1;if(_0x2aff3e[_0x25cd45(0xf1)]){const _0x3972d7=await Poll_1[_0x25cd45(0x114)]['findOne']({'_id':_0x2aff3e[_0x25cd45(0xf1)],'guild':_0x4ebeee['guild']['id']});if(!_0x3972d7)throw new Error(_0x25cd45(0xfd));if(!_0x4ebeee[_0x25cd45(0x110)]['channels'][_0x25cd45(0xf3)][_0x25cd45(0xce)](_0x3972d7['channel']))throw new Error(_0x25cd45(0xfd));const _0x286316=_0x4ebeee[_0x25cd45(0x110)][_0x25cd45(0x101)][_0x25cd45(0xf3)][_0x25cd45(0x10a)](_0x3972d7[_0x25cd45(0x102)]),_0xc8e1c5=await _0x286316[_0x25cd45(0x109)][_0x25cd45(0x112)](_0x3972d7['_id'])[_0x25cd45(0xcf)](()=>{});if(!_0xc8e1c5)throw new Error(_0x25cd45(0xfd));const _0x4d4702=_0xc8e1c5[_0x25cd45(0xd1)][0x0][_0x25cd45(0xe3)]['map'](_0x25b928=>_0x25b928[_0x25cd45(0xf4)]),_0x56cb13={};let _0x9fcf5a=0x0;for(const _0x11b142 in this['reactions'][_0x25cd45(0xdb)](0x0,_0x4d4702['length'])){if(_0xc8e1c5[_0x25cd45(0xfe)][_0x25cd45(0xf3)][_0x25cd45(0xce)](this[_0x25cd45(0xfe)][_0x11b142])){await _0xc8e1c5['reactions'][_0x25cd45(0xf3)][_0x25cd45(0x10a)](this[_0x25cd45(0xfe)][_0x11b142])[_0x25cd45(0xf9)]['fetch']()[_0x25cd45(0xcf)](()=>{});const _0x2ab438=_0xc8e1c5[_0x25cd45(0xfe)][_0x25cd45(0xf3)][_0x25cd45(0x10a)](this['reactions'][_0x11b142])[_0x25cd45(0xf9)][_0x25cd45(0xf3)][_0x25cd45(0xec)](_0x4d5fd3=>!_0x4d5fd3['bot'])['size'];_0x56cb13[this[_0x25cd45(0xfe)][_0x11b142]]=_0x2ab438,_0x9fcf5a+=_0x2ab438;}}return await _0x4ebeee['channel']['send']({'embed':{'color':tesseract_1[_0x25cd45(0xcb)][_0x25cd45(0x104)][_0x25cd45(0xeb)],'author':{'name':_0x25cd45(0xf8)},'title':_0xc8e1c5['embeds'][0x0]['title'],'fields':_0xc8e1c5[_0x25cd45(0xd1)][0x0][_0x25cd45(0xe3)][_0x25cd45(0xca)](_0x2174ca=>({'name':_0x2174ca['name']+'\x20'+_0x2174ca[_0x25cd45(0xf4)],'value':(_0x56cb13[_0x2174ca[_0x25cd45(0xd5)]]||0x0)+'\x20/\x20'+_0x9fcf5a+_0x25cd45(0xda)+(_0x56cb13[_0x2174ca[_0x25cd45(0xd5)]]?_0x56cb13[_0x2174ca['name']]/_0x9fcf5a*0x64:0x0)[_0x25cd45(0x107)](0x2)+'%)'})),'footer':{'text':_0xc8e1c5['id']+_0x25cd45(0xd2)},'timestamp':_0x3972d7[_0x25cd45(0x10c)]}});}if(!_0x2aff3e['_'][_0x25cd45(0x115)]||!_0x2aff3e['option']||!(_0x2aff3e[_0x25cd45(0x10f)]instanceof Array))throw new errors[(_0x25cd45(0x11c))](errors['BASTION_ERROR_TYPE'][_0x25cd45(0x118)],this[_0x25cd45(0xd5)]);const _0x373dfb=_0x2aff3e['_'][_0x25cd45(0xe8)]('\x20'),_0x2d6ac6=_0x2aff3e[_0x25cd45(0x111)]?_0x2aff3e[_0x25cd45(0x111)]:this[_0x25cd45(0x105)];if(constants[_0x25cd45(0x11d)](this[_0x25cd45(0xea)][_0x25cd45(0xde)])){const _0x1ce44b=await omnic[_0x25cd45(0x106)](_0x4ebeee[_0x25cd45(0x110)])[_0x25cd45(0xcf)](()=>{});if(_0x1ce44b){if(_0x1ce44b===omnic[_0x25cd45(0xd4)]['GOLD']&&_0x2d6ac6>constants[_0x25cd45(0xf5)][_0x25cd45(0xf6)][_0x25cd45(0x10d)])throw new errors[(_0x25cd45(0x11c))](errors[_0x25cd45(0x10b)]['LIMITED_PREMIUM_MEMBERSHIP'],this['client']['locale'][_0x25cd45(0x123)](_0x4ebeee['guild'][_0x25cd45(0xd0)][_0x25cd45(0x122)],_0x25cd45(0xfc),_0x25cd45(0xfb),constants[_0x25cd45(0xf5)][_0x25cd45(0xf6)][_0x25cd45(0x10d)]));else{if(_0x1ce44b===omnic[_0x25cd45(0xd4)][_0x25cd45(0x11b)]&&_0x2d6ac6>constants[_0x25cd45(0xf5)][_0x25cd45(0x11b)]['POLL_TIMEOUT'])throw new errors[(_0x25cd45(0x11c))](errors['BASTION_ERROR_TYPE']['LIMITED_PREMIUM_MEMBERSHIP'],this['client'][_0x25cd45(0xf2)][_0x25cd45(0x123)](_0x4ebeee['guild'][_0x25cd45(0xd0)][_0x25cd45(0x122)],_0x25cd45(0xfc),_0x25cd45(0xfb),constants[_0x25cd45(0xf5)]['PLATINUM'][_0x25cd45(0x10d)]));}}else{if(_0x2d6ac6>constants['LIMITS']['POLL_TIMEOUT'])throw new errors[(_0x25cd45(0x11c))](errors[_0x25cd45(0x10b)][_0x25cd45(0x119)],this[_0x25cd45(0xea)][_0x25cd45(0xf2)][_0x25cd45(0x123)](_0x4ebeee[_0x25cd45(0x110)][_0x25cd45(0xd0)][_0x25cd45(0x122)],_0x25cd45(0xfc),'premiumPollTimeout',constants[_0x25cd45(0xf5)][_0x25cd45(0x10d)]));}const _0x4c5269=await Poll_1[_0x25cd45(0x114)][_0x25cd45(0xf7)]({'guild':_0x4ebeee[_0x25cd45(0x110)]['id'],'ends':{'$gte':new Date()}});if(_0x1ce44b){if(_0x1ce44b===omnic[_0x25cd45(0xd4)]['GOLD']&&_0x4c5269>=constants[_0x25cd45(0xf5)][_0x25cd45(0xf6)]['POLLS'])throw new errors['DiscordError'](errors[_0x25cd45(0x10b)][_0x25cd45(0x113)],this[_0x25cd45(0xea)][_0x25cd45(0xf2)][_0x25cd45(0x123)](_0x4ebeee['guild']['document']['language'],'errors',_0x25cd45(0xe5),constants[_0x25cd45(0xf5)][_0x25cd45(0xf6)][_0x25cd45(0xef)]));else{if(_0x1ce44b===omnic[_0x25cd45(0xd4)][_0x25cd45(0x11b)]&&_0x4c5269>=constants[_0x25cd45(0xf5)][_0x25cd45(0x11b)][_0x25cd45(0xef)])throw new errors[(_0x25cd45(0x11c))](errors[_0x25cd45(0x10b)][_0x25cd45(0x113)],this[_0x25cd45(0xea)][_0x25cd45(0xf2)][_0x25cd45(0x123)](_0x4ebeee[_0x25cd45(0x110)]['document'][_0x25cd45(0x122)],_0x25cd45(0xfc),'membershipLimitPolls',constants[_0x25cd45(0xf5)]['PLATINUM'][_0x25cd45(0xef)]));}}else{if(_0x4c5269>=constants['LIMITS'][_0x25cd45(0xef)])throw new errors[(_0x25cd45(0x11c))](errors[_0x25cd45(0x10b)][_0x25cd45(0x119)],this[_0x25cd45(0xea)]['locale'][_0x25cd45(0x123)](_0x4ebeee[_0x25cd45(0x110)][_0x25cd45(0xd0)][_0x25cd45(0x122)],'errors',_0x25cd45(0xd9),constants[_0x25cd45(0xf5)]['POLLS']));}}const _0x20d865=new Date(Date[_0x25cd45(0xd8)]()+_0x2d6ac6*0x36ee80),_0x3e957b=await _0x4ebeee[_0x25cd45(0x102)][_0x25cd45(0xe7)]({'embed':{'color':tesseract_1['Constants']['COLORS'][_0x25cd45(0xeb)],'author':{'name':_0x25cd45(0xcc)},'title':_0x373dfb,'description':_0x25cd45(0xd3),'fields':_0x2aff3e[_0x25cd45(0x10f)][_0x25cd45(0xca)]((_0x1f01ae,_0x214079)=>({'name':this['reactions'][_0x214079],'value':_0x1f01ae})),'footer':{'text':'Ends'},'timestamp':_0x20d865}});await Poll_1['default']['create']({'_id':_0x3e957b['id'],'channel':_0x3e957b[_0x25cd45(0x102)]['id'],'guild':_0x3e957b[_0x25cd45(0x110)]['id'],'ends':_0x20d865});for(const _0x3e11fa of this['reactions']['slice'](0x0,_0x2aff3e[_0x25cd45(0x10f)]['length'])){await _0x3e957b[_0x25cd45(0x100)](_0x3e11fa)['catch'](()=>{});}};};