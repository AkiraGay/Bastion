const a99_0x2054=['duration','Constants','setDeaf','getString','get','apply','keepAlive','Album','COLORS','filter','pipe','INVALID_COMMAND_SYNTAX','members','streamEndHandler','getInfo','url','--no-playlist','Command','length','end','exports','streamInfoHandler','constructor','--user-agent=Mozilla/5.0\x20(Macintosh;\x20Intel\x20Mac\x20OS\x20X\x2010_15_0)\x20AppleWebKit/604.1\x20(KHTML,\x20like\x20Gecko)\x20Version/13.0.4\x20Safari/604.1','webpage_url','locale','--youtube-skip-dash-manifest','voiceChannelId','href','isMusicMaster','title','.mp3','playing','error','name','voiceChannel','voice','musicDownloadError','--format=bestaudio[protocol^=http]','user','language','Artist','Logger','It\x20allows\x20you\x20to\x20play\x20a\x20music\x20in\x20the\x20server,\x20from\x20the\x20given\x20query\x20or\x20from\x20any\x20supported\x20source.','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','thumbnail','--quiet','uploader','\x20•\x20','test','configurations','leave','mkdir','ytsearch:','unjoinable','getSongInfo','play','--no-cache-dir','guild','activity','URL','dispatcherFinishHandler','textChannel','alt_title','BASTION_ERROR_TYPE','musicDisabledPublic','cache','fulltitle','author','--geo-bypass-country=US','music','tag','return\x20/\x22\x20+\x20this\x20+\x20\x22/','exec','joinable','PINK','promises','requester','Playing','client','Stopping\x20Playback','Added\x20to\x20Queue','isPublicBastion','--force-ipv4','push','ArgumentTypes','catch','fetchPremiumTier','startStreamDispatcher','repeat','--referer=https://bastion.traction.one','send','play\x20--link\x20https://www.youtube.com/watch?v=dQw4w9WgXcQ','join','member','history','presence','connection','track','setActivity','speakable','queue','rmdir','noMusicChannels','RED','enabled','textChannelId','musicDirectory','--ignore-errors','play\x20Remember\x20The\x20Name\x20by\x20Ed\x20Sheeran','createWriteStream','type','album','channel','link','--no-warnings','channels','document','errors','creator'];(function(_0x372e8a,_0x205409){const _0x3d132e=function(_0x457176){while(--_0x457176){_0x372e8a['push'](_0x372e8a['shift']());}},_0x588b27=function(){const _0x5ce404={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x55c16c,_0xc06c25,_0x2dd8f1,_0x1aeeee){_0x1aeeee=_0x1aeeee||{};let _0x1f1094=_0xc06c25+'='+_0x2dd8f1,_0x2f0db8=0x0;for(let _0x545a95=0x0,_0x177e92=_0x55c16c['length'];_0x545a95<_0x177e92;_0x545a95++){const _0x1a93b2=_0x55c16c[_0x545a95];_0x1f1094+=';\x20'+_0x1a93b2;const _0x4489da=_0x55c16c[_0x1a93b2];_0x55c16c['push'](_0x4489da),_0x177e92=_0x55c16c['length'],_0x4489da!==!![]&&(_0x1f1094+='='+_0x4489da);}_0x1aeeee['cookie']=_0x1f1094;},'removeCookie':function(){return'dev';},'getCookie':function(_0x140d49,_0x135d30){_0x140d49=_0x140d49||function(_0x3a1a02){return _0x3a1a02;};const _0x5d7f16=_0x140d49(new RegExp('(?:^|;\x20)'+_0x135d30['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0xbffb4e=function(_0x32c46e,_0x2f3178){_0x32c46e(++_0x2f3178);};return _0xbffb4e(_0x3d132e,_0x205409),_0x5d7f16?decodeURIComponent(_0x5d7f16[0x1]):undefined;}},_0x499433=function(){const _0x2967ba=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2967ba['test'](_0x5ce404['removeCookie']['toString']());};_0x5ce404['updateCookie']=_0x499433;let _0x5a3543='';const _0x514361=_0x5ce404['updateCookie']();if(!_0x514361)_0x5ce404['setCookie'](['*'],'counter',0x1);else _0x514361?_0x5a3543=_0x5ce404['getCookie'](null,'counter'):_0x5ce404['removeCookie']();};_0x588b27();}(a99_0x2054,0x14c));const a99_0x3d13=function(_0x372e8a,_0x205409){_0x372e8a=_0x372e8a-0x0;let _0x3d132e=a99_0x2054[_0x372e8a];return _0x3d132e;};const a99_0x5ce404=function(){let _0x5a3543=!![];return function(_0x514361,_0x55c16c){const _0xc06c25=_0x5a3543?function(){if(_0x55c16c){const _0x2dd8f1=_0x55c16c[a99_0x3d13('0x21')](_0x514361,arguments);return _0x55c16c=null,_0x2dd8f1;}}:function(){};return _0x5a3543=![],_0xc06c25;};}(),a99_0x457176=a99_0x5ce404(this,function(){const _0x1aeeee=function(){const _0x1f1094=_0x1aeeee[a99_0x3d13('0x32')](a99_0x3d13('0x64'))()[a99_0x3d13('0x32')](a99_0x3d13('0x48'));return!_0x1f1094[a99_0x3d13('0x4d')](a99_0x457176);};return _0x1aeeee();});a99_0x457176();'use strict';const fs=require('fs'),tesseract_1=require('@bastion/tesseract'),youtube=require('youtube-dl'),uuid_1=require('uuid'),constants=require('../../utils/constants'),errors=require('../../utils/errors'),omnic=require('../../utils/omnic');module[a99_0x3d13('0x30')]=class Play extends tesseract_1[a99_0x3d13('0x2d')]{constructor(){super('play',{'description':a99_0x3d13('0x47'),'triggers':[],'arguments':{'alias':{'link':'l'},'coerce':{'link':tesseract_1['Constants'][a99_0x3d13('0x71')][a99_0x3d13('0x58')]}},'scope':a99_0x3d13('0x56'),'owner':![],'cooldown':0x0,'ratelimit':0x1,'clientPermissions':[],'userPermissions':[],'syntax':[a99_0x3d13('0x11'),a99_0x3d13('0x0')]}),this['streamInfoHandler']=(_0x2f0db8,_0x545a95)=>{const _0x177e92=_0x545a95['id'],_0x1a93b2=_0x545a95[a99_0x3d13('0x6')]||_0x545a95[a99_0x3d13('0x3a')]||_0x545a95[a99_0x3d13('0x5f')]||_0x545a95[a99_0x3d13('0x5b')],_0x4489da=_0x545a95[a99_0x3d13('0x14')],_0x140d49=_0x545a95['artist']||_0x545a95[a99_0x3d13('0x1b')]||_0x545a95[a99_0x3d13('0x4b')],_0x135d30=_0x545a95[a99_0x3d13('0x1c')],_0x5d7f16=_0x545a95[a99_0x3d13('0x49')],_0xbffb4e=_0x545a95[a99_0x3d13('0x69')];_0x2f0db8[a99_0x3d13('0x62')][a99_0x3d13('0x9')]['push']({'id':_0x177e92,'track':_0x1a93b2,'album':_0x4489da,'artist':_0x140d49,'duration':_0x135d30,'thumbnail':_0x5d7f16,'requester':_0xbffb4e});const _0x3a1a02=[];_0x4489da&&_0x3a1a02['push']({'name':a99_0x3d13('0x23'),'value':_0x4489da,'inline':!![]}),_0x140d49&&_0x3a1a02[a99_0x3d13('0x70')]({'name':a99_0x3d13('0x45'),'value':_0x140d49,'inline':!![]}),_0x2f0db8[a99_0x3d13('0x62')][a99_0x3d13('0x5a')][a99_0x3d13('0x77')]({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')][a99_0x3d13('0x67')],'title':a99_0x3d13('0x6d'),'description':_0x1a93b2,'fields':_0x3a1a02,'thumbnail':{'url':_0x5d7f16},'footer':{'text':(_0x2f0db8[a99_0x3d13('0x62')]['queue'][a99_0x3d13('0x2e')]?'#'+(_0x2f0db8[a99_0x3d13('0x62')][a99_0x3d13('0x9')][a99_0x3d13('0x2e')]-0x1):'Up\x20Next')+('\x20•\x20'+_0x135d30+a99_0x3d13('0x4c')+(_0x2f0db8[a99_0x3d13('0x28')][a99_0x3d13('0x5e')][a99_0x3d13('0x20')](_0xbffb4e)['user']['tag']||_0xbffb4e))}}})[a99_0x3d13('0x72')](()=>{});},this[a99_0x3d13('0x29')]=_0x32c46e=>{!_0x32c46e[a99_0x3d13('0x62')][a99_0x3d13('0x3c')]&&this['startStreamDispatcher'](_0x32c46e);},this[a99_0x3d13('0x74')]=_0x2f3178=>{if(_0x2f3178[a99_0x3d13('0x62')][a99_0x3d13('0x9')][a99_0x3d13('0x2e')]){const _0x2967ba=_0x2f3178[a99_0x3d13('0x62')][a99_0x3d13('0x9')][0x0],_0x46e4c1=[];_0x2967ba[a99_0x3d13('0x14')]&&_0x46e4c1[a99_0x3d13('0x70')]({'name':'Album','value':_0x2967ba[a99_0x3d13('0x14')],'inline':!![]});_0x2967ba['artist']&&_0x46e4c1[a99_0x3d13('0x70')]({'name':'Artist','value':_0x2967ba['artist'],'inline':!![]});_0x2f3178['music'][a99_0x3d13('0x5a')][a99_0x3d13('0x77')]({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')]['PINK'],'title':a99_0x3d13('0x6a'),'description':_0x2967ba[a99_0x3d13('0x6')],'fields':_0x46e4c1,'thumbnail':{'url':_0x2967ba[a99_0x3d13('0x49')]},'footer':{'text':_0x2967ba[a99_0x3d13('0x1c')]+a99_0x3d13('0x4c')+(_0x2f3178[a99_0x3d13('0x28')][a99_0x3d13('0x5e')][a99_0x3d13('0x20')](_0x2967ba[a99_0x3d13('0x69')])[a99_0x3d13('0x43')][a99_0x3d13('0x63')]||_0x2967ba[a99_0x3d13('0x69')])}}})['catch'](()=>{}),_0x2f3178['music'][a99_0x3d13('0x3c')]=!![];const _0x7af54c=_0x2f3178[a99_0x3d13('0x40')]&&_0x2f3178[a99_0x3d13('0x40')]['connection'][a99_0x3d13('0x54')](this[a99_0x3d13('0xf')]+_0x2f3178['id']+'/'+_0x2967ba['id']+a99_0x3d13('0x3b'));this['client']['configurations'][a99_0x3d13('0x62')]&&this[a99_0x3d13('0x6b')]['configurations'][a99_0x3d13('0x62')][a99_0x3d13('0x57')]&&this[a99_0x3d13('0x6b')][a99_0x3d13('0x43')][a99_0x3d13('0x7')]({'name':_0x2967ba[a99_0x3d13('0x6')],'type':'LISTENING'})['catch'](()=>{}),_0x7af54c['on']('finish',()=>this['dispatcherFinishHandler'](_0x2f3178)),_0x7af54c['on'](a99_0x3d13('0x3d'),_0x1bea4d=>{tesseract_1[a99_0x3d13('0x46')][a99_0x3d13('0x3d')](_0x1bea4d),this[a99_0x3d13('0x59')](_0x2f3178);});}else _0x2f3178[a99_0x3d13('0x62')][a99_0x3d13('0x9')]=[],_0x2f3178['music']['history']=[],fs[a99_0x3d13('0x68')][a99_0x3d13('0xa')](this[a99_0x3d13('0xf')]+_0x2f3178['id'],{'recursive':!![]})['catch'](()=>{}),this[a99_0x3d13('0x6b')]['configurations'][a99_0x3d13('0x62')]&&this['client']['configurations'][a99_0x3d13('0x62')][a99_0x3d13('0x57')]&&this[a99_0x3d13('0x6b')][a99_0x3d13('0x43')]['setActivity'](this[a99_0x3d13('0x6b')][a99_0x3d13('0x4e')]['presence']instanceof Array?this['client'][a99_0x3d13('0x4e')][a99_0x3d13('0x4')][0x0][a99_0x3d13('0x57')]:this[a99_0x3d13('0x6b')]['configurations'][a99_0x3d13('0x4')]['activity'])[a99_0x3d13('0x72')](()=>{}),!_0x2f3178[a99_0x3d13('0x19')][a99_0x3d13('0x62')][a99_0x3d13('0x22')]&&(_0x2f3178[a99_0x3d13('0x40')]&&_0x2f3178[a99_0x3d13('0x40')][a99_0x3d13('0x15')][a99_0x3d13('0x4f')]()),_0x2f3178[a99_0x3d13('0x62')][a99_0x3d13('0x5a')]['send']({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')]['PINK'],'title':a99_0x3d13('0x6c')}})[a99_0x3d13('0x72')](()=>{});},this['dispatcherFinishHandler']=_0x25f0fc=>{_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x3c')]=![],_0x25f0fc[a99_0x3d13('0x62')]['skipVotes']=[],_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x9')][a99_0x3d13('0x2e')]&&_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x3')][a99_0x3d13('0x70')](_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x9')]['shift']()),!_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x9')][a99_0x3d13('0x2e')]&&_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x75')]&&(_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x9')]=_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x3')],_0x25f0fc[a99_0x3d13('0x62')][a99_0x3d13('0x3')]=[]),this[a99_0x3d13('0x74')](_0x25f0fc);},this[a99_0x3d13('0x65')]=async(_0x3a7827,_0xc55cf3)=>{const _0xcfac4e=_0x3a7827[a99_0x3d13('0x56')];if(!_0xcfac4e[a99_0x3d13('0x19')]['music']||!_0xcfac4e['document'][a99_0x3d13('0x62')][a99_0x3d13('0xd')])return await _0x3a7827[a99_0x3d13('0x15')]['send']({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')][a99_0x3d13('0xc')],'description':this[a99_0x3d13('0x6b')][a99_0x3d13('0x35')][a99_0x3d13('0x1f')](_0x3a7827['guild'][a99_0x3d13('0x19')][a99_0x3d13('0x44')],a99_0x3d13('0x1a'),constants[a99_0x3d13('0x6e')](_0x3a7827[a99_0x3d13('0x60')])?a99_0x3d13('0x5d'):'musicDisabled')}})[a99_0x3d13('0x72')](()=>{});if(constants['isPublicBastion'](this[a99_0x3d13('0x6b')][a99_0x3d13('0x43')])){const _0x918e4c=await omnic[a99_0x3d13('0x73')](_0x3a7827[a99_0x3d13('0x56')])[a99_0x3d13('0x72')](()=>{});if(!_0x918e4c)throw new errors['DiscordError'](errors[a99_0x3d13('0x5c')]['PREMIUM_MEMBERSHIP_REQUIRED'],this[a99_0x3d13('0x6b')][a99_0x3d13('0x35')]['getString'](_0x3a7827[a99_0x3d13('0x56')]['document'][a99_0x3d13('0x44')],a99_0x3d13('0x1a'),'premiumMusic'));}const _0x4a40a6=_0xc55cf3['_'][a99_0x3d13('0x1')]('\x20'),_0x11207a=_0x4a40a6['length']?await this['getSongInfo'](_0x4a40a6):null,_0x50fae4=_0xc55cf3[a99_0x3d13('0x16')]?_0xc55cf3[a99_0x3d13('0x16')][a99_0x3d13('0x38')]:_0x11207a?_0x11207a[a99_0x3d13('0x34')]||_0x11207a[a99_0x3d13('0x2b')]:null;if(!_0x50fae4)throw new errors['DiscordError'](errors[a99_0x3d13('0x5c')][a99_0x3d13('0x27')],this[a99_0x3d13('0x3e')]);_0xcfac4e['music'][a99_0x3d13('0x5a')]=_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x18')]['cache']['has'](_0xcfac4e[a99_0x3d13('0x19')][a99_0x3d13('0x62')][a99_0x3d13('0xe')])?_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x18')]['cache'][a99_0x3d13('0x20')](_0xcfac4e[a99_0x3d13('0x19')][a99_0x3d13('0x62')][a99_0x3d13('0xe')]):_0x3a7827[a99_0x3d13('0x15')],_0xcfac4e[a99_0x3d13('0x62')][a99_0x3d13('0x3f')]=_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x40')]&&_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x40')][a99_0x3d13('0x5')]?_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x40')][a99_0x3d13('0x15')]:_0x3a7827['guild'][a99_0x3d13('0x18')][a99_0x3d13('0x5e')][a99_0x3d13('0x25')](_0x4d2108=>_0x4d2108[a99_0x3d13('0x13')]==='voice')['has'](_0xcfac4e[a99_0x3d13('0x19')][a99_0x3d13('0x62')]['voiceChannelId'])?_0x3a7827['guild']['channels']['cache']['filter'](_0x335050=>_0x335050[a99_0x3d13('0x13')]===a99_0x3d13('0x40'))[a99_0x3d13('0x20')](_0xcfac4e[a99_0x3d13('0x19')]['music'][a99_0x3d13('0x37')]):_0x3a7827[a99_0x3d13('0x2')][a99_0x3d13('0x39')]()?_0x3a7827[a99_0x3d13('0x2')]['voice'][a99_0x3d13('0x15')]:null;if(!_0xcfac4e[a99_0x3d13('0x62')]['voiceChannel'])return await _0x3a7827[a99_0x3d13('0x15')]['send']({'embed':{'color':tesseract_1['Constants'][a99_0x3d13('0x24')][a99_0x3d13('0xc')],'description':this['client'][a99_0x3d13('0x35')][a99_0x3d13('0x1f')](_0x3a7827['guild']['document'][a99_0x3d13('0x44')],'errors',_0x3a7827['member'][a99_0x3d13('0x39')]()?'noMusicChannelsAsOwner':a99_0x3d13('0xb'))}})[a99_0x3d13('0x72')](()=>{});if(!_0xcfac4e[a99_0x3d13('0x62')][a99_0x3d13('0x3f')][a99_0x3d13('0x66')])return await _0x3a7827[a99_0x3d13('0x15')][a99_0x3d13('0x77')]({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')][a99_0x3d13('0xc')],'description':this[a99_0x3d13('0x6b')][a99_0x3d13('0x35')][a99_0x3d13('0x1f')](_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x19')][a99_0x3d13('0x44')],'errors',a99_0x3d13('0x52'),_0xcfac4e[a99_0x3d13('0x62')][a99_0x3d13('0x3f')]['name'])}})['catch'](()=>{});if(!_0xcfac4e['music'][a99_0x3d13('0x3f')][a99_0x3d13('0x8')])return await _0x3a7827['channel'][a99_0x3d13('0x77')]({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')][a99_0x3d13('0x24')]['RED'],'description':this['client'][a99_0x3d13('0x35')][a99_0x3d13('0x1f')](_0x3a7827['guild'][a99_0x3d13('0x19')][a99_0x3d13('0x44')],a99_0x3d13('0x1a'),'unspeakable',_0xcfac4e[a99_0x3d13('0x62')][a99_0x3d13('0x3f')][a99_0x3d13('0x3e')])}})['catch'](()=>{});const _0x396543=await _0xcfac4e['music'][a99_0x3d13('0x3f')][a99_0x3d13('0x1')]();_0x396543['on'](a99_0x3d13('0x3d'),tesseract_1['Logger'][a99_0x3d13('0x3d')]),_0x396543['on']('failed',tesseract_1[a99_0x3d13('0x46')]['error']),_0x3a7827['guild']['me'][a99_0x3d13('0x40')]['setMute'](![])[a99_0x3d13('0x72')](()=>{}),_0x3a7827[a99_0x3d13('0x56')]['me']['voice'][a99_0x3d13('0x1e')](!![])[a99_0x3d13('0x72')](()=>{});const _0x56efd6=uuid_1['v4'](),_0x58a9b8=youtube(_0x50fae4,['--ignore-errors','--force-ipv4',a99_0x3d13('0x61'),a99_0x3d13('0x2c'),a99_0x3d13('0x55'),a99_0x3d13('0x4a'),'--no-warnings',a99_0x3d13('0x33'),a99_0x3d13('0x76'),a99_0x3d13('0x42'),a99_0x3d13('0x36')],{});_0x58a9b8['on']('info',_0x5b883d=>this[a99_0x3d13('0x31')](_0xcfac4e,{..._0x5b883d,'id':_0x56efd6,'requester':_0x3a7827[a99_0x3d13('0x60')]['id']})),_0x58a9b8['on'](a99_0x3d13('0x2f'),()=>this[a99_0x3d13('0x29')](_0xcfac4e)),_0x58a9b8['on'](a99_0x3d13('0x3d'),()=>{_0x3a7827[a99_0x3d13('0x15')]['send']({'embed':{'color':tesseract_1[a99_0x3d13('0x1d')]['COLORS'][a99_0x3d13('0xc')],'description':this[a99_0x3d13('0x6b')][a99_0x3d13('0x35')][a99_0x3d13('0x1f')](_0x3a7827[a99_0x3d13('0x56')][a99_0x3d13('0x19')]['language'],a99_0x3d13('0x1a'),a99_0x3d13('0x41'))}})[a99_0x3d13('0x72')](()=>{});}),await fs[a99_0x3d13('0x68')][a99_0x3d13('0x50')](this[a99_0x3d13('0xf')]+_0x3a7827[a99_0x3d13('0x56')]['id']+'/',{'recursive':!![]})[a99_0x3d13('0x72')](tesseract_1[a99_0x3d13('0x46')][a99_0x3d13('0x3d')]),_0x58a9b8[a99_0x3d13('0x26')](fs[a99_0x3d13('0x12')](this[a99_0x3d13('0xf')]+_0x3a7827[a99_0x3d13('0x56')]['id']+'/'+_0x56efd6+'.mp3'));},this[a99_0x3d13('0xf')]='./music/';}[a99_0x3d13('0x53')](_0x1b6028){return new Promise((_0x5369ae,_0x4aaae9)=>youtube[a99_0x3d13('0x2a')](a99_0x3d13('0x51')+_0x1b6028,[a99_0x3d13('0x10'),a99_0x3d13('0x6f'),'--geo-bypass-country=US',a99_0x3d13('0x2c'),a99_0x3d13('0x55'),a99_0x3d13('0x4a'),a99_0x3d13('0x17'),a99_0x3d13('0x33'),'--referer=https://bastion.traction.one','--format=bestaudio[protocol^=http]','--youtube-skip-dash-manifest'],(_0x5b3a77,_0x4ebf43)=>{if(_0x5b3a77)return _0x4aaae9(_0x5b3a77);return _0x5369ae(_0x4ebf43);}));}};