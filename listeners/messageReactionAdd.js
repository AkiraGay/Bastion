const a165_0x287f=['color','MANAGE_CHANNELS','findById','bot','url','YELLOW','reactions','handleReactionPinning','COLORS','_id','roles','return\x20/\x22\x20+\x20this\x20+\x20\x22/','default','partial','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','Accepted','Starboard','name','starboardChannelId','reactionAnnouncements','constructor','pin','Listener','starboard','MANAGE_MESSAGES','Constants','users','map','MANAGE_GUILD','content','Added\x20via\x20Reaction\x20Roles','member','../utils/emojis','[Click\x20here\x20to\x20Jump\x20to\x20the\x20Message.](','permissions','../utils/memcache','first','Auto\x20Removed\x20via\x20Reaction\x20Roles','Source','attachments','Suggestion\x20','channel','has','send','handleReactionAnnouncement','author','findOne','emoji','announcementsChannelId','title','channels','edit','tag','fetch','handleStarboard','catch','\x20‚Ä¢\x20','Rejected','guild','permissionsFor','compile','suggestionsChannelId','values','handleReactionRoles','startsWith','exec','cache','RED','get','../models/Role','remove','reactionPinning','footer','test','filter','messageReactionAdd','animated','embeds','exclusive','displayAvatarURL','push','text','message','apply','user','includes'];(function(_0x37010c,_0x287f69){const _0x3c4367=function(_0x35f893){while(--_0x35f893){_0x37010c['push'](_0x37010c['shift']());}};const _0x559a24=function(){const _0x44b937={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2a7658,_0xa5d068,_0x30512a,_0x1f5d3c){_0x1f5d3c=_0x1f5d3c||{};let _0x57f7d5=_0xa5d068+'='+_0x30512a;let _0x578813=0x0;for(let _0x412974=0x0,_0x4777e2=_0x2a7658['length'];_0x412974<_0x4777e2;_0x412974++){const _0x1eed5c=_0x2a7658[_0x412974];_0x57f7d5+=';\x20'+_0x1eed5c;const _0x5c1faf=_0x2a7658[_0x1eed5c];_0x2a7658['push'](_0x5c1faf);_0x4777e2=_0x2a7658['length'];if(_0x5c1faf!==!![]){_0x57f7d5+='='+_0x5c1faf;}}_0x1f5d3c['cookie']=_0x57f7d5;},'removeCookie':function(){return'dev';},'getCookie':function(_0x36c848,_0x276b2c){_0x36c848=_0x36c848||function(_0x58063c){return _0x58063c;};const _0x3ce39a=_0x36c848(new RegExp('(?:^|;\x20)'+_0x276b2c['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));const _0x4eadde=function(_0x2432f4,_0x499fb5){_0x2432f4(++_0x499fb5);};_0x4eadde(_0x3c4367,_0x287f69);return _0x3ce39a?decodeURIComponent(_0x3ce39a[0x1]):undefined;}};const _0x5918df=function(){const _0x2d1bf9=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x2d1bf9['test'](_0x44b937['removeCookie']['toString']());};_0x44b937['updateCookie']=_0x5918df;let _0x453656='';const _0x1e8a89=_0x44b937['updateCookie']();if(!_0x1e8a89){_0x44b937['setCookie'](['*'],'counter',0x1);}else if(_0x1e8a89){_0x453656=_0x44b937['getCookie'](null,'counter');}else{_0x44b937['removeCookie']();}};_0x559a24();}(a165_0x287f,0x14b));const a165_0x3c43=function(_0x37010c,_0x287f69){_0x37010c=_0x37010c-0x0;let _0x3c4367=a165_0x287f[_0x37010c];return _0x3c4367;};const a165_0x44b937=function(){let _0x58b735=!![];return function(_0x32ab9e,_0x2f8483){const _0x26a6ee=_0x58b735?function(){if(_0x2f8483){const _0x33fdb9=_0x2f8483[a165_0x3c43('0xa')](_0x32ab9e,arguments);_0x2f8483=null;return _0x33fdb9;}}:function(){};_0x58b735=![];return _0x26a6ee;};}();const a165_0x35f893=a165_0x44b937(this,function(){const _0x294b25=function(){const _0x57a9de=_0x294b25[a165_0x3c43('0x21')](a165_0x3c43('0x18'))()[a165_0x3c43('0x49')](a165_0x3c43('0x1b'));return!_0x57a9de[a165_0x3c43('0x0')](a165_0x35f893);};return _0x294b25();});a165_0x35f893();'use strict';const tesseract_1=require('@bastion/tesseract');const ReactionRoleGroup_1=require('../models/ReactionRoleGroup');const Role_1=require(a165_0x3c43('0x52'));const emojis=require(a165_0x3c43('0x2d'));const memcache_1=require(a165_0x3c43('0x30'));module['exports']=class MessageReactionAddListener extends tesseract_1[a165_0x3c43('0x23')]{constructor(){super(a165_0x3c43('0x2'),{'mode':tesseract_1[a165_0x3c43('0x26')]['LISTENER_MODE']['ON']});this['handleSuggestions']=async(_0x1aff2b,_0x42460e)=>{if(_0x42460e[a165_0x3c43('0xb')]['bot'])return;if(!['‚úÖ','‚ùé'][a165_0x3c43('0xc')](_0x1aff2b[a165_0x3c43('0x3c')]['name']))return;if(!_0x1aff2b[a165_0x3c43('0x9')]['channel']['permissionsFor'](_0x42460e)[a165_0x3c43('0x37')](a165_0x3c43('0xe')))return;const _0x2a4dbe=_0x1aff2b['message'];const _0x3603ee=_0x2a4dbe[a165_0x3c43('0x4')][0x0];if(!_0x3603ee)return;if(!_0x3603ee['title'][a165_0x3c43('0x4d')]('Suggestion'))return;_0x3603ee[a165_0x3c43('0xd')]=_0x1aff2b[a165_0x3c43('0x3c')]['name']==='‚úÖ'?tesseract_1[a165_0x3c43('0x26')][a165_0x3c43('0x15')]['GREEN']:_0x1aff2b[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]==='‚ùé'?tesseract_1['Constants'][a165_0x3c43('0x15')][a165_0x3c43('0x50')]:tesseract_1[a165_0x3c43('0x26')][a165_0x3c43('0x15')]['INDIGO'];_0x3603ee[a165_0x3c43('0x3e')]=a165_0x3c43('0x35')+(_0x1aff2b[a165_0x3c43('0x3c')]['name']==='‚úÖ'?a165_0x3c43('0x1c'):_0x1aff2b[a165_0x3c43('0x3c')]['name']==='‚ùé'?a165_0x3c43('0x46'):'');await _0x2a4dbe[a165_0x3c43('0x40')]({'embed':_0x3603ee});};this[a165_0x3c43('0x43')]=async(_0x3a631c,_0x476914,_0x299137)=>{if(!['üå†','üåü','‚≠ê'][a165_0x3c43('0xc')](_0x3a631c[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]))return;if(_0x476914[a165_0x3c43('0x17')][a165_0x3c43('0x4f')]['size']<=0x1)return;if(_0x3a631c[a165_0x3c43('0x9')][a165_0x3c43('0x3a')]['id']===_0x476914[a165_0x3c43('0xb')]['id'])return;const _0x26bd44=_0x3a631c[a165_0x3c43('0x9')][a165_0x3c43('0x34')][a165_0x3c43('0x1')](_0x1cc205=>Boolean(_0x1cc205['height']&&_0x1cc205['width']));const _0x97cf00=_0x26bd44[a165_0x3c43('0x31')]();if(!_0x3a631c['message'][a165_0x3c43('0x2a')]&&!_0x97cf00)return;const _0x4de16a=memcache_1['default'][a165_0x3c43('0x51')](a165_0x3c43('0x24'));if(_0x4de16a&&_0x4de16a instanceof Array&&_0x4de16a[a165_0x3c43('0xc')](_0x3a631c[a165_0x3c43('0x9')]['id']))return;await _0x299137[a165_0x3c43('0x38')]({'embed':{'color':tesseract_1[a165_0x3c43('0x26')][a165_0x3c43('0x15')][a165_0x3c43('0x12')],'author':{'name':_0x3a631c['message'][a165_0x3c43('0x3a')][a165_0x3c43('0x41')],'iconURL':_0x3a631c[a165_0x3c43('0x9')][a165_0x3c43('0x3a')][a165_0x3c43('0x6')]({'dynamic':!![],'size':0x40})},'description':_0x3a631c[a165_0x3c43('0x9')][a165_0x3c43('0x2a')],'fields':[{'name':a165_0x3c43('0x33'),'value':a165_0x3c43('0x2e')+_0x3a631c['message'][a165_0x3c43('0x11')]+')','inline':!![]}],'image':{'url':_0x97cf00?_0x97cf00['url']:null},'footer':{'text':a165_0x3c43('0x1d')}}});if(_0x4de16a&&_0x4de16a instanceof Array){_0x4de16a[a165_0x3c43('0x7')](_0x3a631c[a165_0x3c43('0x9')]['id']);}memcache_1[a165_0x3c43('0x19')]['set'](a165_0x3c43('0x24'),_0x4de16a?_0x4de16a:[_0x3a631c[a165_0x3c43('0x9')]['id']]);};this[a165_0x3c43('0x39')]=async(_0x30e461,_0xe842d4,_0x3e241e)=>{if(!['üì£','üì¢'][a165_0x3c43('0xc')](_0x30e461[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]))return;if(!_0xe842d4[a165_0x3c43('0x2f')][a165_0x3c43('0x37')](a165_0x3c43('0x29')))return;const _0x470be4=_0xe842d4['user'][a165_0x3c43('0x41')]+'\x20announced\x20via\x20Announcement\x20Pinnning.';const _0x34edfc=_0x30e461[a165_0x3c43('0x9')]['embeds']&&_0x30e461['message'][a165_0x3c43('0x4')]['length']?_0x30e461['message'][a165_0x3c43('0x4')][0x0]:{};_0x34edfc[a165_0x3c43('0x55')]={..._0x34edfc[a165_0x3c43('0x55')],'text':_0x34edfc[a165_0x3c43('0x55')]&&_0x34edfc[a165_0x3c43('0x55')]['text']?_0x470be4+a165_0x3c43('0x45')+_0x34edfc[a165_0x3c43('0x55')][a165_0x3c43('0x8')]:_0x470be4};await _0x3e241e[a165_0x3c43('0x38')](_0x30e461[a165_0x3c43('0x9')]['content'],{'embed':_0x34edfc,'files':[..._0x30e461[a165_0x3c43('0x9')][a165_0x3c43('0x34')][a165_0x3c43('0x4b')]()]});};this['handleReactionPinning']=async(_0x22eff5,_0x49e479)=>{if(!['üìå','üìç'][a165_0x3c43('0xc')](_0x22eff5[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]))return;if(!_0x22eff5['message']['channel'][a165_0x3c43('0x48')](_0x49e479)['has'](a165_0x3c43('0x25')))return;await _0x22eff5[a165_0x3c43('0x9')][a165_0x3c43('0x22')]();};this[a165_0x3c43('0x4c')]=async(_0x44beaf,_0x259419)=>{if(_0x259419['user'][a165_0x3c43('0x10')])return;const _0x4f0a5f=await ReactionRoleGroup_1[a165_0x3c43('0x19')][a165_0x3c43('0xf')](_0x44beaf[a165_0x3c43('0x9')]['id']);if(!_0x4f0a5f)return;const _0x36638c=_0x44beaf[a165_0x3c43('0x3c')]['id']?'<'+(_0x44beaf['emoji'][a165_0x3c43('0x3')]?'a':'')+':'+_0x44beaf[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]+':'+_0x44beaf[a165_0x3c43('0x3c')]['id']+'>':_0x44beaf[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')];const _0x1191e5=emojis['parseEmoji'](_0x36638c);if(_0x1191e5){const _0x36449a=await Role_1['default'][a165_0x3c43('0x3b')]({'$or':_0x4f0a5f[a165_0x3c43('0x17')][a165_0x3c43('0x28')](_0x20e696=>({'_id':_0x20e696})),'guild':_0x44beaf[a165_0x3c43('0x9')][a165_0x3c43('0x47')]['id'],'emoji':_0x1191e5['value']});if(!_0x36449a)return;if(_0x4f0a5f[a165_0x3c43('0x5')]){for(const _0x354bce of _0x44beaf[a165_0x3c43('0x9')][a165_0x3c43('0x13')][a165_0x3c43('0x4f')][a165_0x3c43('0x1')](_0x1da6b9=>_0x1da6b9[a165_0x3c43('0x27')][a165_0x3c43('0x4f')]['has'](_0x259419[a165_0x3c43('0xb')]['id'])&&_0x1da6b9[a165_0x3c43('0x3c')][a165_0x3c43('0x1e')]!==_0x44beaf['emoji'][a165_0x3c43('0x1e')])[a165_0x3c43('0x4b')]()){await _0x354bce[a165_0x3c43('0x27')][a165_0x3c43('0x53')](_0x259419)[a165_0x3c43('0x44')](()=>{});}await _0x259419[a165_0x3c43('0x17')][a165_0x3c43('0x53')](_0x4f0a5f['roles'],a165_0x3c43('0x32'));}await _0x259419['roles']['add'](_0x36449a[a165_0x3c43('0x16')],a165_0x3c43('0x2b'));}};this[a165_0x3c43('0x4e')]=async(_0x407c77,_0x3c9d7c)=>{if(_0x407c77[a165_0x3c43('0x1a')]){_0x407c77=await _0x407c77[a165_0x3c43('0x42')]();}if(_0x407c77[a165_0x3c43('0x9')]['partial']){_0x407c77[a165_0x3c43('0x9')]=await _0x407c77['message'][a165_0x3c43('0x42')]();}if(!_0x407c77[a165_0x3c43('0x9')][a165_0x3c43('0x47')])return;const _0x3f6191=_0x407c77['message'][a165_0x3c43('0x47')][a165_0x3c43('0x2c')](_0x3c9d7c);this[a165_0x3c43('0x4c')](_0x407c77,_0x3f6191)[a165_0x3c43('0x44')](()=>{});const _0x5b79ff=await _0x407c77[a165_0x3c43('0x9')][a165_0x3c43('0x47')]['getDocument']();if(_0x5b79ff[a165_0x3c43('0x4a')]&&_0x407c77['message'][a165_0x3c43('0x36')]['id']===_0x5b79ff[a165_0x3c43('0x4a')]){this['handleSuggestions'](_0x407c77,_0x3f6191)[a165_0x3c43('0x44')](()=>{});}if(_0x5b79ff[a165_0x3c43('0x1f')]&&_0x407c77[a165_0x3c43('0x9')][a165_0x3c43('0x47')][a165_0x3c43('0x3f')][a165_0x3c43('0x4f')][a165_0x3c43('0x37')](_0x5b79ff[a165_0x3c43('0x1f')])){this[a165_0x3c43('0x43')](_0x407c77,_0x3f6191,_0x407c77[a165_0x3c43('0x9')]['guild'][a165_0x3c43('0x3f')]['cache'][a165_0x3c43('0x51')](_0x5b79ff['starboardChannelId']))[a165_0x3c43('0x44')](()=>{});}if(_0x5b79ff[a165_0x3c43('0x20')]&&_0x407c77[a165_0x3c43('0x9')]['guild'][a165_0x3c43('0x3f')][a165_0x3c43('0x4f')]['has'](_0x5b79ff[a165_0x3c43('0x3d')])){this[a165_0x3c43('0x39')](_0x407c77,_0x3f6191,_0x407c77[a165_0x3c43('0x9')]['guild'][a165_0x3c43('0x3f')][a165_0x3c43('0x4f')][a165_0x3c43('0x51')](_0x5b79ff['announcementsChannelId']))[a165_0x3c43('0x44')](()=>{});}if(_0x5b79ff[a165_0x3c43('0x54')]){this[a165_0x3c43('0x14')](_0x407c77,_0x3f6191)[a165_0x3c43('0x44')](()=>{});}};}};