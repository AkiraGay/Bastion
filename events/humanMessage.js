const a147_0xf5e3=['createDM','Logger','apply','info','length','size','getConstant','multiplier','../utils/numbers','handleVotingChannels','splice','messages','handleTriggers','../models/Trigger','status','parse','bastion.name','language','channel','locale','random','smallestNeighbor','Level-up\x20Reward','MAX_LEVEL','roles','_id','cache','filter','handleLevelRoles','floor','../utils/omnic','relayDirectMessages','remove','handleGamification','stringify','LEVELED\x20UP!','catch','experience','document','DEFAUL_CURRENCY_REWARD_MULTIPLIER','default','handleKarma','reply','findById','map','success','tag','owner','levelUp','../utils/emojis','responseReaction','push','guild','parseEmoji','humanMessage','setTimeout','mentions','content','MAX_EXPERIENCE','toLowerCase','trigger','Constants','getString','handleDirectMessageRelay','send','author','find','@bastion/tesseract','fetchApplication','reaction','generateEmbed','premiumSinceTimestamp','error','response','member','../utils/embeds','discord.js','test','IRIS','thank\x20you','credit','COLORS','computeLevel','level','gamification','../models/Config','enabled','replace','return\x20/\x22\x20+\x20this\x20+\x20\x22/','client','add','../models/Member','recentUsers','user','react','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','users','has','includes','constructor','/chat/instant?message=','get','../models/Role','../utils/gamification'];(function(_0x1457fc,_0xf5e3fd){const _0x311906=function(_0x2b6a0d){while(--_0x2b6a0d){_0x1457fc['push'](_0x1457fc['shift']());}},_0x5664a8=function(){const _0x1559a8={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xd506a7,_0x115786,_0x7216b2,_0x3224a7){_0x3224a7=_0x3224a7||{};let _0x162dee=_0x115786+'='+_0x7216b2,_0x48d47d=0x0;for(let _0x210859=0x0,_0x40aaa2=_0xd506a7['length'];_0x210859<_0x40aaa2;_0x210859++){const _0x1e4ee2=_0xd506a7[_0x210859];_0x162dee+=';\x20'+_0x1e4ee2;const _0x355bc2=_0xd506a7[_0x1e4ee2];_0xd506a7['push'](_0x355bc2),_0x40aaa2=_0xd506a7['length'],_0x355bc2!==!![]&&(_0x162dee+='='+_0x355bc2);}_0x3224a7['cookie']=_0x162dee;},'removeCookie':function(){return'dev';},'getCookie':function(_0x48a861,_0x30648c){_0x48a861=_0x48a861||function(_0x3e942a){return _0x3e942a;};const _0x4f52aa=_0x48a861(new RegExp('(?:^|;\x20)'+_0x30648c['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0xc6517a=function(_0x518e3f,_0x16212c){_0x518e3f(++_0x16212c);};return _0xc6517a(_0x311906,_0xf5e3fd),_0x4f52aa?decodeURIComponent(_0x4f52aa[0x1]):undefined;}},_0x1994c9=function(){const _0x510354=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x510354['test'](_0x1559a8['removeCookie']['toString']());};_0x1559a8['updateCookie']=_0x1994c9;let _0x4ad61f='';const _0x96a1be=_0x1559a8['updateCookie']();if(!_0x96a1be)_0x1559a8['setCookie'](['*'],'counter',0x1);else _0x96a1be?_0x4ad61f=_0x1559a8['getCookie'](null,'counter'):_0x1559a8['removeCookie']();};_0x5664a8();}(a147_0xf5e3,0x178));const a147_0x3119=function(_0x1457fc,_0xf5e3fd){_0x1457fc=_0x1457fc-0x0;let _0x311906=a147_0xf5e3[_0x1457fc];return _0x311906;};const _0x355bce=a147_0x3119,a147_0x1559a8=function(){let _0x4ad61f=!![];return function(_0x96a1be,_0xd506a7){const _0x115786=_0x4ad61f?function(){const _0x1cf10c=a147_0x3119;if(_0xd506a7){const _0x7216b2=_0xd506a7[_0x1cf10c('0x2a')](_0x96a1be,arguments);return _0xd506a7=null,_0x7216b2;}}:function(){};return _0x4ad61f=![],_0x115786;};}(),a147_0x2b6a0d=a147_0x1559a8(this,function(){const _0x3224a7=function(){const _0xd18cbc=a147_0x3119,_0x162dee=_0x3224a7['constructor'](_0xd18cbc('0x18'))()[_0xd18cbc('0x23')](_0xd18cbc('0x1f'));return!_0x162dee[_0xd18cbc('0xd')](a147_0x2b6a0d);};return _0x3224a7();});a147_0x2b6a0d();'use strict';const tesseract_1=require(_0x355bce('0x3')),discord_js_1=require(_0x355bce('0xc')),embeds=require(_0x355bce('0xb')),emojis=require(_0x355bce('0x59')),gamification=require(_0x355bce('0x27')),numbers=require(_0x355bce('0x30')),omnic=require(_0x355bce('0x46')),variables=require('../utils/variables'),Config_1=require(_0x355bce('0x15')),Member_1=require(_0x355bce('0x1b')),Role_1=require(_0x355bce('0x26')),TextChannel_1=require('../models/TextChannel'),Trigger_1=require(_0x355bce('0x35'));module['exports']=class HumanMessageEvent extends tesseract_1['ModuleManagerEvent']{constructor(){const _0x4a6fb1=_0x355bce;super(_0x4a6fb1('0x5e')),this['handleLevelRoles']=async(_0x48d47d,_0x210859)=>{const _0x606e46=_0x4a6fb1,_0x40aaa2=await Role_1[_0x606e46('0x50')][_0x606e46('0x2')]({'guild':_0x48d47d[_0x606e46('0x5c')]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x40aaa2||!_0x40aaa2[_0x606e46('0x2c')])return;const _0x1e4ee2=numbers[_0x606e46('0x3d')](_0x210859,_0x40aaa2[_0x606e46('0x54')](_0x30648c=>_0x30648c['level'])),_0x355bc2=_0x40aaa2['filter'](_0x4f52aa=>_0x4f52aa[_0x606e46('0x13')]!==_0x1e4ee2&&_0x48d47d['guild'][_0x606e46('0x40')][_0x606e46('0x42')][_0x606e46('0x21')](_0x4f52aa[_0x606e46('0x41')])),_0x48a861=_0x40aaa2[_0x606e46('0x43')](_0xc6517a=>_0xc6517a['level']===_0x1e4ee2&&_0x48d47d[_0x606e46('0x5c')][_0x606e46('0x40')][_0x606e46('0x42')][_0x606e46('0x21')](_0xc6517a[_0x606e46('0x41')]));_0x48a861[_0x606e46('0x2c')]&&(await _0x48d47d[_0x606e46('0xa')]['roles'][_0x606e46('0x1a')](_0x48a861['map'](_0x3e942a=>_0x3e942a[_0x606e46('0x41')])),await _0x48d47d[_0x606e46('0xa')]['roles'][_0x606e46('0x48')](_0x355bc2[_0x606e46('0x54')](_0x518e3f=>_0x518e3f[_0x606e46('0x41')])));},this[_0x4a6fb1('0x49')]=async _0x16212c=>{const _0x1bf9c7=_0x4a6fb1,_0x510354=this['recentUsers'][_0x1bf9c7('0x25')](_0x16212c[_0x1bf9c7('0x5c')]['id'])||[];if(_0x510354[_0x1bf9c7('0x22')](_0x16212c[_0x1bf9c7('0x1')]['id']))return;const _0x527d90=_0x16212c[_0x1bf9c7('0x19')],_0x4ecfd3=_0x16212c[_0x1bf9c7('0x5c')],_0x203d93=_0x16212c['member'];if(!_0x4ecfd3[_0x1bf9c7('0x4e')][_0x1bf9c7('0x14')]||!_0x4ecfd3[_0x1bf9c7('0x4e')]['gamification'][_0x1bf9c7('0x16')])return;if(_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x13')]>=gamification[_0x1bf9c7('0x3f')]||_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x4d')]>=gamification[_0x1bf9c7('0x62')](_0x4ecfd3[_0x1bf9c7('0x4e')]['gamification'][_0x1bf9c7('0x2f')]))return;_0x203d93['document']['experience']=_0x203d93[_0x1bf9c7('0x7')]?_0x203d93[_0x1bf9c7('0x4e')]['experience']+0x2:_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x4d')]+0x1;const _0x11ef47=gamification[_0x1bf9c7('0x12')](_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x4d')],_0x4ecfd3[_0x1bf9c7('0x4e')][_0x1bf9c7('0x14')][_0x1bf9c7('0x2f')]);_0x11ef47>_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x13')]&&(await _0x203d93[_0x1bf9c7('0x10')](_0x11ef47*gamification[_0x1bf9c7('0x4f')],_0x1bf9c7('0x3e'),_0x203d93[_0x1bf9c7('0x4e')]),_0x4ecfd3[_0x1bf9c7('0x4e')]['gamification'][_0x1bf9c7('0x33')]&&_0x16212c[_0x1bf9c7('0x3a')]['send']({'embed':{'color':tesseract_1[_0x1bf9c7('0x65')][_0x1bf9c7('0x11')][_0x1bf9c7('0xe')],'fields':[{'name':_0x1bf9c7('0x4b'),'value':_0x527d90['locale'][_0x1bf9c7('0x66')](_0x4ecfd3[_0x1bf9c7('0x4e')][_0x1bf9c7('0x39')],_0x1bf9c7('0x2b'),_0x1bf9c7('0x58'),_0x16212c[_0x1bf9c7('0x1')][_0x1bf9c7('0x56')],_0x11ef47)}]}})[_0x1bf9c7('0x4c')](()=>{}),this[_0x1bf9c7('0x44')](_0x16212c,_0x203d93[_0x1bf9c7('0x4e')][_0x1bf9c7('0x13')])[_0x1bf9c7('0x4c')](tesseract_1[_0x1bf9c7('0x29')][_0x1bf9c7('0x8')])),_0x203d93[_0x1bf9c7('0x4e')]['level']=_0x11ef47,await _0x203d93['document']['save'](),_0x510354[_0x1bf9c7('0x5b')](_0x16212c[_0x1bf9c7('0x1')]['id']),this[_0x1bf9c7('0x1c')]['set'](_0x16212c[_0x1bf9c7('0x5c')]['id'],_0x510354),_0x16212c[_0x1bf9c7('0x19')][_0x1bf9c7('0x5f')](()=>{const _0x1e6659=_0x1bf9c7,_0x488382=this[_0x1e6659('0x1c')][_0x1e6659('0x25')](_0x16212c['guild']['id']);_0x488382[_0x1e6659('0x32')](_0x488382['indexOf'](_0x16212c[_0x1e6659('0x1')]['id']),0x1),this[_0x1e6659('0x1c')]['set'](_0x16212c[_0x1e6659('0x5c')]['id'],_0x488382);},0x32c8);},this['handleTriggers']=async _0x51017c=>{const _0x40e798=_0x4a6fb1;if(!_0x51017c[_0x40e798('0x61')])return;const _0x4ec616=await Trigger_1['default'][_0x40e798('0x2')]({'guild':_0x51017c[_0x40e798('0x5c')]['id']}),_0x218a90=[],_0xd389a2=[];for(const _0x247552 of _0x4ec616){const _0x2b3b68=new RegExp(_0x247552[_0x40e798('0x64')][_0x40e798('0x17')](/\?/g,'.')[_0x40e798('0x17')](/\*+/g,'.*'),'ig');if(!_0x2b3b68[_0x40e798('0xd')](_0x51017c[_0x40e798('0x61')]))continue;_0x247552['responseMessage']&&_0x218a90[_0x40e798('0x5b')](_0x247552['responseMessage']);if(_0x247552[_0x40e798('0x5a')]){const _0x1e9813=emojis[_0x40e798('0x5d')](_0x247552[_0x40e798('0x5a')]);_0x1e9813&&_0xd389a2['push'](_0x1e9813[_0x40e798('0x5')]);}}_0x218a90[_0x40e798('0x2c')]&&_0x51017c['channel']['send']({'embed':{...embeds[_0x40e798('0x6')](JSON[_0x40e798('0x37')](variables['replaceMessageVariables'](JSON[_0x40e798('0x4a')](_0x218a90[Math[_0x40e798('0x45')](Math[_0x40e798('0x3c')]()*_0x218a90[_0x40e798('0x2c')])]),_0x51017c))),'footer':{'text':_0x51017c['client'][_0x40e798('0x3b')][_0x40e798('0x2e')](_0x40e798('0x38'))+'\x20Trigger'}}})[_0x40e798('0x4c')](tesseract_1[_0x40e798('0x29')][_0x40e798('0x8')]),_0xd389a2['length']&&_0x51017c['react'](_0xd389a2[Math[_0x40e798('0x45')](Math[_0x40e798('0x3c')]()*_0xd389a2[_0x40e798('0x2c')])])[_0x40e798('0x4c')](tesseract_1['Logger'][_0x40e798('0x8')]);},this[_0x4a6fb1('0x31')]=async _0x1629a0=>{const _0xafb5b=_0x4a6fb1,_0x2f9ab2=await TextChannel_1[_0xafb5b('0x50')]['findOne']({'_id':_0x1629a0[_0xafb5b('0x3a')]['id'],'voting':!![]});if(!_0x2f9ab2)return;_0x1629a0[_0xafb5b('0x1e')]('👍')[_0xafb5b('0x4c')](()=>{}),_0x1629a0[_0xafb5b('0x1e')]('👎')[_0xafb5b('0x4c')](()=>{});},this[_0x4a6fb1('0x51')]=async _0x546eed=>{const _0x45cd8d=_0x4a6fb1;if(!_0x546eed['content'])return;if((_0x546eed['content'][_0x45cd8d('0x63')]()[_0x45cd8d('0x22')]('thanks')||_0x546eed[_0x45cd8d('0x61')][_0x45cd8d('0x63')]()[_0x45cd8d('0x22')](_0x45cd8d('0xf')))&&_0x546eed[_0x45cd8d('0x60')][_0x45cd8d('0x20')]&&_0x546eed['mentions']['users'][_0x45cd8d('0x2d')]){const _0x591387=Array['from'](_0x546eed[_0x45cd8d('0x60')][_0x45cd8d('0x20')]['keys']())[_0x45cd8d('0x43')](_0x116afd=>_0x116afd!==_0x546eed[_0x45cd8d('0xa')]['id']);await Member_1[_0x45cd8d('0x50')]['updateMany']({'user':{'$in':_0x591387},'guild':_0x546eed[_0x45cd8d('0x5c')]['id']},{'$inc':{'karma':0x1}}),_0x546eed['react']('🆙')[_0x45cd8d('0x4c')](()=>{});}},this['handleInstantResponses']=async _0x2e5f18=>{const _0x138310=_0x4a6fb1;if(!_0x2e5f18[_0x138310('0x61')])return;const _0x27505a=await omnic['makeRequest'](_0x138310('0x24')+encodeURIComponent(_0x2e5f18[_0x138310('0x61')]))['then'](_0x2abb22=>_0x2abb22['json']());if(_0x27505a[_0x138310('0x36')]!==_0x138310('0x55'))return;const _0x56ed62=_0x27505a[_0x138310('0x9')][_0x138310('0x52')]instanceof Array?_0x27505a[_0x138310('0x9')][_0x138310('0x52')]:[_0x27505a[_0x138310('0x9')][_0x138310('0x52')]];for(const _0x4a7b33 of _0x56ed62){await _0x2e5f18[_0x138310('0x3a')][_0x138310('0x0')](_0x4a7b33)[_0x138310('0x4c')](()=>{});}},this[_0x4a6fb1('0x67')]=async _0x4950f7=>{const _0x25426f=_0x4a6fb1,_0x3fcf83=await Config_1[_0x25426f('0x50')][_0x25426f('0x53')](_0x4950f7[_0x25426f('0x19')][_0x25426f('0x1d')]['id']);if(_0x3fcf83[_0x25426f('0x47')]&&_0x4950f7['content']){const _0x8ad582=await _0x4950f7[_0x25426f('0x19')][_0x25426f('0x4')](),_0x893e91=_0x8ad582[_0x25426f('0x57')]instanceof discord_js_1['Team']?_0x8ad582[_0x25426f('0x57')][_0x25426f('0x57')][_0x25426f('0x1d')]:_0x8ad582[_0x25426f('0x57')];if(_0x4950f7[_0x25426f('0x1')]['id']===_0x893e91['id'])return;const _0x313413=await _0x893e91[_0x25426f('0x28')]();await _0x313413[_0x25426f('0x0')]({'embed':{'color':tesseract_1[_0x25426f('0x65')][_0x25426f('0x11')][_0x25426f('0xe')],'author':{'name':_0x4950f7['author'][_0x25426f('0x56')],'iconURL':_0x4950f7['author']['displayAvatarURL']({'dynamic':!![],'size':0x40})},'description':_0x4950f7['content'],'footer':{'text':_0x4950f7[_0x25426f('0x1')]['id']}}});}},this['exec']=async _0x3d19c5=>{const _0x169829=_0x4a6fb1;_0x3d19c5[_0x169829('0x5c')]?(this[_0x169829('0x49')](_0x3d19c5)['catch'](()=>{}),this[_0x169829('0x34')](_0x3d19c5)[_0x169829('0x4c')](()=>{}),this[_0x169829('0x51')](_0x3d19c5)[_0x169829('0x4c')](tesseract_1['Logger'][_0x169829('0x8')]),this[_0x169829('0x31')](_0x3d19c5)['catch'](()=>{})):(this['handleInstantResponses'](_0x3d19c5)[_0x169829('0x4c')](()=>{}),this[_0x169829('0x67')](_0x3d19c5)[_0x169829('0x4c')](()=>{}));},this[_0x4a6fb1('0x1c')]=new Map();}};