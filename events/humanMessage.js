const a146_0x1de4=['messages','Logger','owner','tag','document','add','ModuleManagerEvent','../models/Role','MAX_LEVEL','parse','credit','map','info','parseEmoji','replace','push','json','get','author','success','handleTriggers','indexOf','getString','then','send','bastion.name','save','../models/Config','splice','remove','findOne','content','MAX_EXPERIENCE','apply','handleDirectMessageRelay','Constants','responseReaction','../models/Trigger','recentUsers','/chat/instant?message=','gamification','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','has','humanMessage','default','findById','catch','displayAvatarURL','relayDirectMessages','error','../utils/variables','setTimeout','status','Team','channel','computeLevel','getConstant','../utils/emojis','discord.js','set','level','guild','member','createDM','length','response','handleGamification','reply','user','IRIS','handleInstantResponses','handleLevelRoles','includes','_id','experience','LEVELED\x20UP!','../utils/gamification','roles','reaction','../models/TextChannel','Level-up\x20Reward','generateEmbed','random','locale','floor','responseMessage','multiplier','constructor','handleVotingChannels','react','../utils/embeds','client','cache'];(function(_0x48ef63,_0x1de496){const _0x285ea4=function(_0x557e60){while(--_0x557e60){_0x48ef63['push'](_0x48ef63['shift']());}},_0x4bf96c=function(){const _0x1c2117={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x3501e2,_0x48e54c,_0x2ebdf3,_0x1097e1){_0x1097e1=_0x1097e1||{};let _0x3dfdb8=_0x48e54c+'='+_0x2ebdf3,_0x56b5e8=0x0;for(let _0x221010=0x0,_0x17bd58=_0x3501e2['length'];_0x221010<_0x17bd58;_0x221010++){const _0x2114fb=_0x3501e2[_0x221010];_0x3dfdb8+=';\x20'+_0x2114fb;const _0x50dfd3=_0x3501e2[_0x2114fb];_0x3501e2['push'](_0x50dfd3),_0x17bd58=_0x3501e2['length'],_0x50dfd3!==!![]&&(_0x3dfdb8+='='+_0x50dfd3);}_0x1097e1['cookie']=_0x3dfdb8;},'removeCookie':function(){return'dev';},'getCookie':function(_0x505cb8,_0x644306){_0x505cb8=_0x505cb8||function(_0x49c5c6){return _0x49c5c6;};const _0x5eb890=_0x505cb8(new RegExp('(?:^|;\x20)'+_0x644306['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x5c29b5=function(_0x1ef133,_0xfe9d6b){_0x1ef133(++_0xfe9d6b);};return _0x5c29b5(_0x285ea4,_0x1de496),_0x5eb890?decodeURIComponent(_0x5eb890[0x1]):undefined;}},_0x8838d=function(){const _0x42b646=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x42b646['test'](_0x1c2117['removeCookie']['toString']());};_0x1c2117['updateCookie']=_0x8838d;let _0x27204f='';const _0x5914cd=_0x1c2117['updateCookie']();if(!_0x5914cd)_0x1c2117['setCookie'](['*'],'counter',0x1);else _0x5914cd?_0x27204f=_0x1c2117['getCookie'](null,'counter'):_0x1c2117['removeCookie']();};_0x4bf96c();}(a146_0x1de4,0x196));const a146_0x285e=function(_0x48ef63,_0x1de496){_0x48ef63=_0x48ef63-0x0;let _0x285ea4=a146_0x1de4[_0x48ef63];return _0x285ea4;};const a146_0x1c2117=function(){let _0x27204f=!![];return function(_0x5914cd,_0x3501e2){const _0x48e54c=_0x27204f?function(){if(_0x3501e2){const _0x2ebdf3=_0x3501e2[a146_0x285e('0x5c')](_0x5914cd,arguments);return _0x3501e2=null,_0x2ebdf3;}}:function(){};return _0x27204f=![],_0x48e54c;};}(),a146_0x557e60=a146_0x1c2117(this,function(){const _0x1097e1=function(){const _0x3dfdb8=_0x1097e1['constructor']('return\x20/\x22\x20+\x20this\x20+\x20\x22/')()[a146_0x285e('0x35')](a146_0x285e('0x7'));return!_0x3dfdb8['test'](a146_0x557e60);};return _0x1097e1();});a146_0x557e60();'use strict';const tesseract_1=require('@bastion/tesseract'),discord_js_1=require(a146_0x285e('0x18')),embeds=require(a146_0x285e('0x38')),emojis=require(a146_0x285e('0x17')),gamification=require(a146_0x285e('0x2a')),omnic=require('../utils/omnic'),variables=require(a146_0x285e('0x10')),Config_1=require(a146_0x285e('0x56')),Role_1=require(a146_0x285e('0x42')),TextChannel_1=require(a146_0x285e('0x2d')),Trigger_1=require(a146_0x285e('0x3'));module['exports']=class HumanMessageEvent extends tesseract_1[a146_0x285e('0x41')]{constructor(){super(a146_0x285e('0x9')),this[a146_0x285e('0x25')]=async(_0x56b5e8,_0x221010)=>{const _0x17bd58=await Role_1[a146_0x285e('0xa')]['find']({'guild':_0x56b5e8[a146_0x285e('0x1b')]['id'],'level':{'$exists':!![]}}),_0x2114fb=_0x17bd58['filter'](_0x505cb8=>_0x505cb8[a146_0x285e('0x1a')]!==_0x221010&&_0x56b5e8['guild']['roles'][a146_0x285e('0x3a')][a146_0x285e('0x8')](_0x505cb8[a146_0x285e('0x27')])),_0x50dfd3=_0x17bd58['filter'](_0x644306=>_0x644306[a146_0x285e('0x1a')]===_0x221010&&_0x56b5e8[a146_0x285e('0x1b')][a146_0x285e('0x2b')][a146_0x285e('0x3a')][a146_0x285e('0x8')](_0x644306[a146_0x285e('0x27')]));_0x50dfd3[a146_0x285e('0x1e')]&&(await _0x56b5e8[a146_0x285e('0x1c')][a146_0x285e('0x2b')][a146_0x285e('0x40')](_0x50dfd3[a146_0x285e('0x46')](_0x5eb890=>_0x5eb890[a146_0x285e('0x27')])),await _0x56b5e8[a146_0x285e('0x1c')][a146_0x285e('0x2b')][a146_0x285e('0x58')](_0x2114fb[a146_0x285e('0x46')](_0x5c29b5=>_0x5c29b5['_id'])));},this[a146_0x285e('0x20')]=async _0x49c5c6=>{const _0x1ef133=this[a146_0x285e('0x4')][a146_0x285e('0x4c')](_0x49c5c6[a146_0x285e('0x1b')]['id'])||[];if(_0x1ef133[a146_0x285e('0x26')](_0x49c5c6['author']['id']))return;const _0xfe9d6b=_0x49c5c6[a146_0x285e('0x39')],_0x42b646=_0x49c5c6[a146_0x285e('0x1b')],_0x30feea=_0x49c5c6['member'];if(!_0x42b646[a146_0x285e('0x3f')]['gamification']||!_0x42b646[a146_0x285e('0x3f')][a146_0x285e('0x6')]['enabled'])return;if(_0x30feea['document'][a146_0x285e('0x1a')]>=gamification[a146_0x285e('0x43')]||_0x30feea[a146_0x285e('0x3f')][a146_0x285e('0x28')]>=gamification[a146_0x285e('0x5b')](_0x42b646['document'][a146_0x285e('0x6')][a146_0x285e('0x34')]))return;_0x30feea[a146_0x285e('0x3f')][a146_0x285e('0x28')]+=0x1;const _0x2cf4af=gamification[a146_0x285e('0x15')](_0x30feea['document'][a146_0x285e('0x28')],_0x42b646[a146_0x285e('0x3f')][a146_0x285e('0x6')][a146_0x285e('0x34')]);_0x2cf4af>_0x30feea['document'][a146_0x285e('0x1a')]&&(await _0x30feea[a146_0x285e('0x45')](_0x2cf4af*gamification['DEFAUL_CURRENCY_REWARD_MULTIPLIER'],a146_0x285e('0x2e'),_0x30feea[a146_0x285e('0x3f')]),_0x42b646[a146_0x285e('0x3f')][a146_0x285e('0x6')][a146_0x285e('0x3b')]&&_0x49c5c6[a146_0x285e('0x14')][a146_0x285e('0x53')]({'embed':{'color':tesseract_1[a146_0x285e('0x1')]['COLORS']['IRIS'],'fields':[{'name':a146_0x285e('0x29'),'value':_0xfe9d6b[a146_0x285e('0x31')][a146_0x285e('0x51')](_0x42b646['document']['language'],a146_0x285e('0x47'),'levelUp',_0x49c5c6['author']['tag'],_0x2cf4af)}]}})['catch'](()=>{}),this[a146_0x285e('0x25')](_0x49c5c6,_0x30feea[a146_0x285e('0x3f')]['level'])['catch'](tesseract_1['Logger'][a146_0x285e('0xf')])),_0x30feea[a146_0x285e('0x3f')][a146_0x285e('0x1a')]=_0x2cf4af,await _0x30feea[a146_0x285e('0x3f')][a146_0x285e('0x55')](),_0x1ef133[a146_0x285e('0x4a')](_0x49c5c6['author']['id']),this[a146_0x285e('0x4')][a146_0x285e('0x19')](_0x49c5c6[a146_0x285e('0x1b')]['id'],_0x1ef133),_0x49c5c6[a146_0x285e('0x39')][a146_0x285e('0x11')](()=>{const _0xfe4880=this[a146_0x285e('0x4')][a146_0x285e('0x4c')](_0x49c5c6[a146_0x285e('0x1b')]['id']);_0xfe4880[a146_0x285e('0x57')](_0xfe4880[a146_0x285e('0x50')](_0x49c5c6[a146_0x285e('0x4d')]['id']),0x1),this[a146_0x285e('0x4')][a146_0x285e('0x19')](_0x49c5c6[a146_0x285e('0x1b')]['id'],_0xfe4880);},0x32c8);},this[a146_0x285e('0x4f')]=async _0x318d73=>{if(!_0x318d73[a146_0x285e('0x5a')])return;const _0x50d0b0=await Trigger_1[a146_0x285e('0xa')]['find']({'guild':_0x318d73[a146_0x285e('0x1b')]['id']}),_0x581ee6=[],_0x25b36d=[];for(const _0x5d78aa of _0x50d0b0){const _0x4650ce=new RegExp(_0x5d78aa['trigger'][a146_0x285e('0x49')](/\?/g,'.')['replace'](/\*+/g,'.*'),'ig');if(!_0x4650ce['test'](_0x318d73[a146_0x285e('0x5a')]))continue;_0x5d78aa[a146_0x285e('0x33')]&&_0x581ee6[a146_0x285e('0x4a')](_0x5d78aa[a146_0x285e('0x33')]);if(_0x5d78aa['responseReaction']){const _0xf1447e=emojis[a146_0x285e('0x48')](_0x5d78aa[a146_0x285e('0x2')]);_0xf1447e&&_0x25b36d['push'](_0xf1447e[a146_0x285e('0x2c')]);}}_0x581ee6[a146_0x285e('0x1e')]&&_0x318d73[a146_0x285e('0x14')][a146_0x285e('0x53')]({'embed':{...embeds[a146_0x285e('0x2f')](JSON[a146_0x285e('0x44')](variables['replaceMessageVariables'](JSON['stringify'](_0x581ee6[Math[a146_0x285e('0x32')](Math[a146_0x285e('0x30')]()*_0x581ee6['length'])]),_0x318d73))),'footer':{'text':_0x318d73[a146_0x285e('0x39')][a146_0x285e('0x31')][a146_0x285e('0x16')](a146_0x285e('0x54'))+'\x20Trigger'}}})['catch'](tesseract_1[a146_0x285e('0x3c')]['error']),_0x25b36d[a146_0x285e('0x1e')]&&_0x318d73[a146_0x285e('0x37')](_0x25b36d[Math['floor'](Math[a146_0x285e('0x30')]()*_0x25b36d['length'])])[a146_0x285e('0xc')](tesseract_1['Logger']['error']);},this[a146_0x285e('0x36')]=async _0x44723f=>{const _0x361da8=await TextChannel_1['default'][a146_0x285e('0x59')]({'_id':_0x44723f[a146_0x285e('0x14')]['id'],'voting':!![]});if(!_0x361da8)return;_0x44723f[a146_0x285e('0x37')]('👍')['catch'](()=>{}),_0x44723f[a146_0x285e('0x37')]('👎')[a146_0x285e('0xc')](()=>{});},this[a146_0x285e('0x24')]=async _0x54a11e=>{if(!_0x54a11e['content'])return;const _0x314740=await omnic['makeRequest'](a146_0x285e('0x5')+encodeURIComponent(_0x54a11e[a146_0x285e('0x5a')]))[a146_0x285e('0x52')](_0x5b856f=>_0x5b856f[a146_0x285e('0x4b')]());if(_0x314740[a146_0x285e('0x12')]!==a146_0x285e('0x4e'))return;const _0x26536b=_0x314740[a146_0x285e('0x1f')][a146_0x285e('0x21')]instanceof Array?_0x314740['response'][a146_0x285e('0x21')]:[_0x314740[a146_0x285e('0x1f')][a146_0x285e('0x21')]];for(const _0x174d54 of _0x26536b){await _0x54a11e[a146_0x285e('0x14')][a146_0x285e('0x53')](_0x174d54)['catch'](()=>{});}},this['handleDirectMessageRelay']=async _0x43c657=>{const _0x3e9d27=await Config_1[a146_0x285e('0xa')][a146_0x285e('0xb')](_0x43c657[a146_0x285e('0x39')][a146_0x285e('0x22')]['id']);if(_0x3e9d27[a146_0x285e('0xe')]&&_0x43c657[a146_0x285e('0x5a')]){const _0x3269db=await _0x43c657['client']['fetchApplication'](),_0x3e5458=_0x3269db[a146_0x285e('0x3d')]instanceof discord_js_1[a146_0x285e('0x13')]?_0x3269db[a146_0x285e('0x3d')][a146_0x285e('0x3d')][a146_0x285e('0x22')]:_0x3269db['owner'];if(_0x43c657[a146_0x285e('0x4d')]['id']===_0x3e5458['id'])return;const _0x1bbe17=await _0x3e5458[a146_0x285e('0x1d')]();await _0x1bbe17[a146_0x285e('0x53')]({'embed':{'color':tesseract_1[a146_0x285e('0x1')]['COLORS'][a146_0x285e('0x23')],'author':{'name':_0x43c657['author'][a146_0x285e('0x3e')],'iconURL':_0x43c657['author'][a146_0x285e('0xd')]({'dynamic':!![],'size':0x40})},'description':_0x43c657[a146_0x285e('0x5a')],'footer':{'text':_0x43c657[a146_0x285e('0x4d')]['id']}}});}},this['exec']=async _0x1cfa44=>{_0x1cfa44[a146_0x285e('0x1b')]?(this[a146_0x285e('0x20')](_0x1cfa44)[a146_0x285e('0xc')](()=>{}),this['handleTriggers'](_0x1cfa44)[a146_0x285e('0xc')](()=>{}),this['handleVotingChannels'](_0x1cfa44)[a146_0x285e('0xc')](()=>{})):(this['handleInstantResponses'](_0x1cfa44)[a146_0x285e('0xc')](()=>{}),this[a146_0x285e('0x0')](_0x1cfa44)[a146_0x285e('0xc')](()=>{}));},this[a146_0x285e('0x4')]=new Map();}};