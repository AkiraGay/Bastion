const a164_0x2a9a=['COLORS','discord.js','getConstant','status','IRIS','../models/Config','tag','author','guild','handleLevelRoles','MAX_LEVEL','content','floor','thank\x20you','MAX_EXPERIENCE','../utils/emojis','üëçüèª','thanks','success','handleVotingChannels','reaction','parseEmoji','computeLevel','findById','levelUp','_id','owner','has','handleKarma','json','set','splice','send','handleDirectMessageRelay','save','user','constructor','react','../utils/gamification','findOne','return\x20/\x22\x20+\x20this\x20+\x20\x22/','makeRequest','add','bastion.name','Logger','handleGamification','remove','length','reply','mentions','includes','Level-up\x20Reward','enabled','roles','../utils/embeds','displayAvatarURL','from','humanMessage','setTimeout','handleInstantResponses','experience','handleTriggers','parse','\x20Trigger','locale','catch','getString','fetchApplication','gamification','/chat/instant?message=','then','error','toLowerCase','find','multiplier','recentUsers','replaceMessageVariables','users','channel','map','../models/TextChannel','LEVELED\x20UP!','push','exec','document','default','responseMessage','credit','random','Constants','premiumSinceTimestamp','replace','../models/Member','filter','responseReaction','client','../utils/omnic','level','relayDirectMessages','indexOf','../utils/variables','smallestNeighbor','size','member','response','test'];(function(_0x3121a2,_0x4622dc){const _0x2a9a73=function(_0x5c3152){while(--_0x5c3152){_0x3121a2['push'](_0x3121a2['shift']());}},_0x414d05=function(){const _0x552b60={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x130269,_0x67abd2,_0x532990,_0x569295){_0x569295=_0x569295||{};let _0x5bdce6=_0x67abd2+'='+_0x532990,_0x4d005b=0x0;for(let _0x1e989f=0x0,_0x1a9a27=_0x130269['length'];_0x1e989f<_0x1a9a27;_0x1e989f++){const _0x2f97ad=_0x130269[_0x1e989f];_0x5bdce6+=';\x20'+_0x2f97ad;const _0x5e5767=_0x130269[_0x2f97ad];_0x130269['push'](_0x5e5767),_0x1a9a27=_0x130269['length'],_0x5e5767!==!![]&&(_0x5bdce6+='='+_0x5e5767);}_0x569295['cookie']=_0x5bdce6;},'removeCookie':function(){return'dev';},'getCookie':function(_0x333039,_0x56de61){_0x333039=_0x333039||function(_0x511f44){return _0x511f44;};const _0x3d7e0f=_0x333039(new RegExp('(?:^|;\x20)'+_0x56de61['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)')),_0x31c356=function(_0x487387,_0x211e67){_0x487387(++_0x211e67);};return _0x31c356(_0x2a9a73,_0x4622dc),_0x3d7e0f?decodeURIComponent(_0x3d7e0f[0x1]):undefined;}},_0x1f5d6d=function(){const _0x1856da=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x1856da['test'](_0x552b60['removeCookie']['toString']());};_0x552b60['updateCookie']=_0x1f5d6d;let _0x4089bc='';const _0x3d2dc9=_0x552b60['updateCookie']();if(!_0x3d2dc9)_0x552b60['setCookie'](['*'],'counter',0x1);else _0x3d2dc9?_0x4089bc=_0x552b60['getCookie'](null,'counter'):_0x552b60['removeCookie']();};_0x414d05();}(a164_0x2a9a,0x18b));const a164_0x414d=function(_0x3121a2,_0x4622dc){_0x3121a2=_0x3121a2-0x1d6;let _0x2a9a73=a164_0x2a9a[_0x3121a2];return _0x2a9a73;};const a164_0x1ab1a8=a164_0x414d,a164_0x1f5d6d=function(){let _0x3d2dc9=!![];return function(_0x130269,_0x67abd2){const _0x532990=_0x3d2dc9?function(){if(_0x67abd2){const _0x569295=_0x67abd2['apply'](_0x130269,arguments);return _0x67abd2=null,_0x569295;}}:function(){};return _0x3d2dc9=![],_0x532990;};}(),a164_0x552b60=a164_0x1f5d6d(this,function(){const _0x5bdce6=function(){const _0x4578c7=a164_0x414d,_0x4d005b=_0x5bdce6[_0x4578c7(0x217)](_0x4578c7(0x21b))()[_0x4578c7(0x217)]('^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}');return!_0x4d005b[_0x4578c7(0x1f2)](a164_0x552b60);};return _0x5bdce6();});a164_0x552b60();'use strict';const tesseract_1=require('@bastion/tesseract'),discord_js_1=require(a164_0x1ab1a8(0x1f4)),embeds=require(a164_0x1ab1a8(0x229)),emojis=require(a164_0x1ab1a8(0x202)),gamification=require(a164_0x1ab1a8(0x219)),numbers=require('../utils/numbers'),omnic=require(a164_0x1ab1a8(0x1e9)),variables=require(a164_0x1ab1a8(0x1ed)),Config_1=require(a164_0x1ab1a8(0x1f8)),Member_1=require(a164_0x1ab1a8(0x1e5)),Role_1=require('../models/Role'),TextChannel_1=require(a164_0x1ab1a8(0x1d9)),Trigger_1=require('../models/Trigger');module['exports']=class HumanMessageEvent extends tesseract_1['ModuleManagerEvent']{constructor(){const _0x4aa397=a164_0x1ab1a8;super(_0x4aa397(0x22c)),this[_0x4aa397(0x1fc)]=async(_0x1e989f,_0x1a9a27)=>{const _0x58cd5a=_0x4aa397,_0x2f97ad=await Role_1[_0x58cd5a(0x1de)][_0x58cd5a(0x23c)]({'guild':_0x1e989f[_0x58cd5a(0x1fb)]['id'],'level':{'$exists':!![],'$ne':null}});if(!_0x2f97ad||!_0x2f97ad['length'])return;const _0x5e5767=numbers[_0x58cd5a(0x1ee)](_0x1a9a27,_0x2f97ad[_0x58cd5a(0x1d8)](_0x3d7e0f=>_0x3d7e0f[_0x58cd5a(0x1ea)])),_0x333039=_0x2f97ad[_0x58cd5a(0x1e6)](_0x31c356=>_0x31c356[_0x58cd5a(0x1ea)]!==_0x5e5767&&_0x1e989f[_0x58cd5a(0x1fb)][_0x58cd5a(0x228)]['cache'][_0x58cd5a(0x20e)](_0x31c356[_0x58cd5a(0x20c)])),_0x56de61=_0x2f97ad['filter'](_0x511f44=>_0x511f44['level']===_0x5e5767&&_0x1e989f[_0x58cd5a(0x1fb)][_0x58cd5a(0x228)]['cache'][_0x58cd5a(0x20e)](_0x511f44[_0x58cd5a(0x20c)]));_0x56de61[_0x58cd5a(0x222)]&&(await _0x1e989f[_0x58cd5a(0x1f0)][_0x58cd5a(0x228)][_0x58cd5a(0x21d)](_0x56de61[_0x58cd5a(0x1d8)](_0x487387=>_0x487387[_0x58cd5a(0x20c)])),await _0x1e989f[_0x58cd5a(0x1f0)][_0x58cd5a(0x228)][_0x58cd5a(0x221)](_0x333039[_0x58cd5a(0x1d8)](_0x211e67=>_0x211e67[_0x58cd5a(0x20c)])));},this[_0x4aa397(0x220)]=async _0x1856da=>{const _0x79a0e1=_0x4aa397,_0x2aa8f8=this[_0x79a0e1(0x23e)]['get'](_0x1856da[_0x79a0e1(0x1fb)]['id'])||[];if(_0x2aa8f8[_0x79a0e1(0x225)](_0x1856da[_0x79a0e1(0x1fa)]['id']))return;const _0x7ec76b=_0x1856da[_0x79a0e1(0x1e8)],_0x52241a=_0x1856da[_0x79a0e1(0x1fb)],_0x3801e3=_0x1856da['member'];if(!_0x52241a[_0x79a0e1(0x1dd)][_0x79a0e1(0x237)]||!_0x52241a[_0x79a0e1(0x1dd)][_0x79a0e1(0x237)][_0x79a0e1(0x227)])return;if(_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x1ea)]>=gamification[_0x79a0e1(0x1fd)]||_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x22f)]>=gamification[_0x79a0e1(0x201)](_0x52241a[_0x79a0e1(0x1dd)]['gamification'][_0x79a0e1(0x23d)]))return;_0x3801e3['document'][_0x79a0e1(0x22f)]=_0x3801e3[_0x79a0e1(0x1e3)]?_0x3801e3[_0x79a0e1(0x1dd)]['experience']+0x2:_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x22f)]+0x1;const _0x57afda=gamification[_0x79a0e1(0x209)](_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x22f)],_0x52241a['document'][_0x79a0e1(0x237)][_0x79a0e1(0x23d)]);_0x57afda>_0x3801e3['document'][_0x79a0e1(0x1ea)]&&(await _0x3801e3[_0x79a0e1(0x1e0)](_0x57afda*gamification['DEFAUL_CURRENCY_REWARD_MULTIPLIER'],_0x79a0e1(0x226),_0x3801e3[_0x79a0e1(0x1dd)]),_0x52241a['document']['gamification']['messages']&&_0x1856da[_0x79a0e1(0x1d7)][_0x79a0e1(0x213)]({'embed':{'color':tesseract_1[_0x79a0e1(0x1e2)][_0x79a0e1(0x1f3)][_0x79a0e1(0x1f7)],'fields':[{'name':_0x79a0e1(0x1da),'value':_0x7ec76b['locale'][_0x79a0e1(0x235)](_0x52241a[_0x79a0e1(0x1dd)]['language'],'info',_0x79a0e1(0x20b),_0x1856da[_0x79a0e1(0x1fa)][_0x79a0e1(0x1f9)],_0x57afda)}]}})['catch'](()=>{}),this['handleLevelRoles'](_0x1856da,_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x1ea)])[_0x79a0e1(0x234)](tesseract_1[_0x79a0e1(0x21f)][_0x79a0e1(0x23a)])),_0x3801e3[_0x79a0e1(0x1dd)][_0x79a0e1(0x1ea)]=_0x57afda,await _0x3801e3['document'][_0x79a0e1(0x215)](),_0x2aa8f8[_0x79a0e1(0x1db)](_0x1856da[_0x79a0e1(0x1fa)]['id']),this['recentUsers'][_0x79a0e1(0x211)](_0x1856da[_0x79a0e1(0x1fb)]['id'],_0x2aa8f8),_0x1856da[_0x79a0e1(0x1e8)][_0x79a0e1(0x22d)](()=>{const _0xbebb78=_0x79a0e1,_0x236b12=this['recentUsers']['get'](_0x1856da['guild']['id']);_0x236b12[_0xbebb78(0x212)](_0x236b12[_0xbebb78(0x1ec)](_0x1856da[_0xbebb78(0x1fa)]['id']),0x1),this['recentUsers']['set'](_0x1856da[_0xbebb78(0x1fb)]['id'],_0x236b12);},0x32c8);},this[_0x4aa397(0x230)]=async _0x4f163a=>{const _0x35aaf7=_0x4aa397;if(!_0x4f163a['content'])return;const _0x1567d3=await Trigger_1[_0x35aaf7(0x1de)][_0x35aaf7(0x23c)]({'guild':_0x4f163a[_0x35aaf7(0x1fb)]['id']}),_0x732f77=[],_0x4e9355=[];for(const _0x593852 of _0x1567d3){const _0x5b89b8=new RegExp(_0x593852['trigger']['replace'](/\?/g,'.')[_0x35aaf7(0x1e4)](/\*+/g,'.*'),'ig');if(!_0x5b89b8['test'](_0x4f163a[_0x35aaf7(0x1fe)]))continue;_0x593852[_0x35aaf7(0x1df)]&&_0x732f77[_0x35aaf7(0x1db)](_0x593852[_0x35aaf7(0x1df)]);if(_0x593852[_0x35aaf7(0x1e7)]){const _0x2d32af=emojis[_0x35aaf7(0x208)](_0x593852[_0x35aaf7(0x1e7)]);_0x2d32af&&_0x4e9355[_0x35aaf7(0x1db)](_0x2d32af[_0x35aaf7(0x207)]);}}_0x732f77[_0x35aaf7(0x222)]&&_0x4f163a[_0x35aaf7(0x1d7)]['send']({'embed':{...embeds['generateEmbed'](JSON[_0x35aaf7(0x231)](variables[_0x35aaf7(0x23f)](JSON['stringify'](_0x732f77[Math[_0x35aaf7(0x1ff)](Math['random']()*_0x732f77[_0x35aaf7(0x222)])]),_0x4f163a))),'footer':{'text':_0x4f163a[_0x35aaf7(0x1e8)][_0x35aaf7(0x233)][_0x35aaf7(0x1f5)](_0x35aaf7(0x21e))+_0x35aaf7(0x232)}}})['catch'](tesseract_1['Logger'][_0x35aaf7(0x23a)]),_0x4e9355['length']&&_0x4f163a[_0x35aaf7(0x218)](_0x4e9355[Math['floor'](Math[_0x35aaf7(0x1e1)]()*_0x4e9355[_0x35aaf7(0x222)])])[_0x35aaf7(0x234)](tesseract_1['Logger'][_0x35aaf7(0x23a)]);},this['handleVotingChannels']=async _0x5a9d96=>{const _0x1d0117=_0x4aa397,_0x328f23=await TextChannel_1[_0x1d0117(0x1de)][_0x1d0117(0x21a)]({'_id':_0x5a9d96['channel']['id'],'voting':!![]});if(!_0x328f23)return;_0x5a9d96[_0x1d0117(0x218)]('üëç')['catch'](()=>{}),_0x5a9d96[_0x1d0117(0x218)]('üëé')[_0x1d0117(0x234)](()=>{});},this[_0x4aa397(0x20f)]=async _0x14e9d9=>{const _0x49df4d=_0x4aa397;if(!_0x14e9d9['content'])return;if((_0x14e9d9[_0x49df4d(0x1fe)][_0x49df4d(0x23b)]()['includes'](_0x49df4d(0x204))||_0x14e9d9[_0x49df4d(0x1fe)][_0x49df4d(0x23b)]()[_0x49df4d(0x225)](_0x49df4d(0x200)))&&_0x14e9d9['mentions'][_0x49df4d(0x1d6)]&&_0x14e9d9[_0x49df4d(0x224)]['users'][_0x49df4d(0x1ef)]){const _0x320363=Array[_0x49df4d(0x22b)](_0x14e9d9[_0x49df4d(0x224)]['users']['keys']())[_0x49df4d(0x1e6)](_0x1126b7=>_0x1126b7!==_0x14e9d9[_0x49df4d(0x1f0)]['id']);await Member_1[_0x49df4d(0x1de)]['updateMany']({'user':{'$in':_0x320363},'guild':_0x14e9d9[_0x49df4d(0x1fb)]['id']},{'$inc':{'karma':0x1}}),_0x14e9d9[_0x49df4d(0x218)](_0x49df4d(0x203))[_0x49df4d(0x234)](()=>{});}},this['handleInstantResponses']=async _0x5a8490=>{const _0xd1812d=_0x4aa397;if(!_0x5a8490[_0xd1812d(0x1fe)])return;const _0x3c6441=await omnic[_0xd1812d(0x21c)](_0xd1812d(0x238)+encodeURIComponent(_0x5a8490[_0xd1812d(0x1fe)]))[_0xd1812d(0x239)](_0x25eb49=>_0x25eb49[_0xd1812d(0x210)]());if(_0x3c6441[_0xd1812d(0x1f6)]!==_0xd1812d(0x205))return;const _0x2c41c3=_0x3c6441['response']['reply']instanceof Array?_0x3c6441[_0xd1812d(0x1f1)]['reply']:[_0x3c6441[_0xd1812d(0x1f1)][_0xd1812d(0x223)]];for(const _0x191576 of _0x2c41c3){await _0x5a8490[_0xd1812d(0x1d7)][_0xd1812d(0x213)](_0x191576)[_0xd1812d(0x234)](()=>{});}},this[_0x4aa397(0x214)]=async _0x4d86c0=>{const _0x480378=_0x4aa397,_0x4b1363=await Config_1[_0x480378(0x1de)][_0x480378(0x20a)](_0x4d86c0[_0x480378(0x1e8)]['user']['id']);if(_0x4b1363[_0x480378(0x1eb)]&&_0x4d86c0['content']){const _0x423778=await _0x4d86c0['client'][_0x480378(0x236)](),_0x2c65a4=_0x423778[_0x480378(0x20d)]instanceof discord_js_1['Team']?_0x423778['owner']['owner'][_0x480378(0x216)]:_0x423778['owner'];if(_0x4d86c0[_0x480378(0x1fa)]['id']===_0x2c65a4['id'])return;const _0x198e5f=await _0x2c65a4['createDM']();await _0x198e5f[_0x480378(0x213)]({'embed':{'color':tesseract_1[_0x480378(0x1e2)]['COLORS'][_0x480378(0x1f7)],'author':{'name':_0x4d86c0[_0x480378(0x1fa)][_0x480378(0x1f9)],'iconURL':_0x4d86c0[_0x480378(0x1fa)][_0x480378(0x22a)]({'dynamic':!![],'size':0x40})},'description':_0x4d86c0['content'],'footer':{'text':_0x4d86c0[_0x480378(0x1fa)]['id']}}});}},this[_0x4aa397(0x1dc)]=async _0x58acd7=>{const _0x1aef2d=_0x4aa397;_0x58acd7[_0x1aef2d(0x1fb)]?(this[_0x1aef2d(0x220)](_0x58acd7)[_0x1aef2d(0x234)](()=>{}),this['handleTriggers'](_0x58acd7)['catch'](()=>{}),this[_0x1aef2d(0x20f)](_0x58acd7)[_0x1aef2d(0x234)](tesseract_1[_0x1aef2d(0x21f)][_0x1aef2d(0x23a)]),this[_0x1aef2d(0x206)](_0x58acd7)[_0x1aef2d(0x234)](()=>{})):(this[_0x1aef2d(0x22e)](_0x58acd7)[_0x1aef2d(0x234)](()=>{}),this[_0x1aef2d(0x214)](_0x58acd7)['catch'](()=>{}));},this['recentUsers']=new Map();}};